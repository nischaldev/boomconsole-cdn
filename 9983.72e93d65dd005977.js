(self.webpackChunkngx_boomconsole=self.webpackChunkngx_boomconsole||[]).push([[9983],{4954:(wo,Nn,yt)=>{"use strict";yt.d(Nn,{$:()=>R});var qe=yt(4650),vt=yt(9446);let R=(()=>{const je=class{constructor(pe){this._activeModal=pe,this.slides=[],this.currentSlideUrl="",this.i=0}ngOnInit(){this.slides=this.imageUrl||[],this.slides.length>0&&(this.currentSlideUrl=this.slides[this.i]?.url||this.slides[this.i]?.path)}showSlide(pe){this.slides&&this.slides.length>0&&pe>=0&&pe<this.slides.length&&(this.currentSlideUrl=this.slides[pe].url||this.slides[pe].path)}getPrev(){this.i>0&&(this.i=this.i-1),this.showSlide(this.i)}getNext(){this.i<this.slides.length-1&&(this.i=this.i+1),this.showSlide(this.i)}handleKeyboardEvent(pe){"ArrowLeft"===pe.key?this.getPrev():"ArrowRight"===pe.key&&this.getNext()}};let ot=je;return je.\u0275fac=function(q){return new(q||je)(qe.Y36(vt.Kz))},je.\u0275cmp=qe.Xpm({type:je,selectors:[["app-full-image-preview"]],hostBindings:function(q,$e){1&q&&qe.NdJ("keydown",function(st){return $e.handleKeyboardEvent(st)},!1,qe.Jf7)},inputs:{imageUrl:"imageUrl",i:"i"},decls:15,vars:3,consts:[["type","button","aria-label","Close",1,"btn-close",3,"click"],["id","carouselExampleControls",1,"carousel","slide"],[1,"carousel-inner"],[1,"carousel-item","active"],["alt","slide",1,"d-block","w-100",3,"src"],["role","button",1,"carousel-control-prev",3,"click"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"sr-only"],["role","button",1,"carousel-control-next",3,"click"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"carousel-index"]],template:function(q,$e){1&q&&(qe.TgZ(0,"button",0),qe.NdJ("click",function(){return $e._activeModal.dismiss()}),qe.qZA(),qe.TgZ(1,"div",1)(2,"div",2)(3,"div",3),qe._UZ(4,"img",4),qe.qZA()(),qe.TgZ(5,"a",5),qe.NdJ("click",function(){return $e.getPrev()}),qe._UZ(6,"span",6),qe.TgZ(7,"span",7),qe._uU(8,"Previous"),qe.qZA()(),qe.TgZ(9,"a",8),qe.NdJ("click",function(){return $e.getNext()}),qe._UZ(10,"span",9),qe.TgZ(11,"span",7),qe._uU(12,"Next"),qe.qZA()(),qe.TgZ(13,"div",10),qe._uU(14),qe.qZA()()),2&q&&(qe.xp6(4),qe.Q6J("src",$e.currentSlideUrl,qe.LSH),qe.xp6(10),qe.AsE("",$e.i+1," / ",$e.slides.length,""))},styles:[".btn-close[_ngcontent-%COMP%]{position:absolute;right:-10px;z-index:999;top:-10px;background-color:#fff;border-radius:50%;padding:8px;opacity:1;box-shadow:0 3px 3px #0000004d}#carouselExampleControls[_ngcontent-%COMP%]{position:relative;width:100%;max-width:800px;margin:auto}.carousel-inner[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.carousel-control-prev[_ngcontent-%COMP%], .carousel-control-next[_ngcontent-%COMP%]{position:absolute;top:50%;width:5%;height:50px;background-color:#00000080;color:#fff;border:none;border-radius:50%;transform:translateY(-50%);display:flex;align-items:center;justify-content:center}.carousel-control-prev[_ngcontent-%COMP%]{left:10px}.carousel-control-next[_ngcontent-%COMP%]{right:10px}.carousel-control-prev-icon[_ngcontent-%COMP%], .carousel-control-next-icon[_ngcontent-%COMP%]{background-size:100%,100%;background-repeat:no-repeat;background-position:center}.carousel-index[_ngcontent-%COMP%]{position:absolute;bottom:10px;left:50%;transform:translate(-50%);background-color:#00000080;color:#fff;padding:5px 10px;border-radius:5px}"]}),ot})()},3139:(wo,Nn,yt)=>{"use strict";yt.d(Nn,{f:()=>ne});var qe=yt(5861),vt=yt(9808),R=yt(6251),ot=yt(7899),je=yt(4006),Wt=yt(6636),pe=yt.n(Wt),q=yt(2340),$e=yt(9402),U=yt(4650),st=yt(7518),dt=yt(9446),it=yt(7009),Ye=yt(384),Xe=yt(8154),Ve=yt(8180),Nt=yt(4383),se=yt(1685),$=yt(6895);function ee(Y,X){1&Y&&(U.TgZ(0,"div",18),U._UZ(1,"span",19),U.qZA())}function re(Y,X){if(1&Y&&(U.TgZ(0,"div",20)(1,"p",21),U._uU(2),U.TgZ(3,"a",22),U._uU(4,"here"),U.qZA(),U._uU(5,". "),U.qZA()()),2&Y){const Q=U.oxw(2);U.xp6(2),U.hij(" Your quota for uploading file ",null==Q.uploadFilesInfo?null:Q.uploadFilesInfo.limit," has exceeded. Please upgrade your plan "),U.xp6(1),U.Q6J("routerLink","/subscription")}}function le(Y,X){if(1&Y&&U._UZ(0,"img",38),2&Y){const Q=U.oxw(2).$implicit;U.Q6J("src",Q.preview,U.LSH)}}function ie(Y,X){if(1&Y&&(U.TgZ(0,"a",36),U.YNc(1,le,1,1,"img",37),U.qZA()),2&Y){const Q=U.oxw().$implicit;U.Q6J("href",Q.url,U.LSH),U.xp6(1),U.Q6J("ngIf",Q.preview)}}function ve(Y,X){1&Y&&(U.TgZ(0,"span"),U._uU(1,"\u2022 Uploading..."),U.qZA())}function he(Y,X){1&Y&&(U.TgZ(0,"span"),U._uU(1,"\u2022 Uploaded"),U.qZA())}function xe(Y,X){if(1&Y&&(U.TgZ(0,"span"),U._uU(1),U.qZA()),2&Y){const Q=U.oxw().$implicit;U.xp6(1),U.hij("\u2022 Error: ",Q.error,"")}}function Le(Y,X){if(1&Y&&(U.TgZ(0,"a",39),U._uU(1,"Open"),U.qZA()),2&Y){const Q=U.oxw().$implicit;U.Q6J("href",Q.url,U.LSH)}}function Ze(Y,X){if(1&Y){const Q=U.EpF();U.TgZ(0,"div",25),U.YNc(1,ie,2,2,"a",26),U.TgZ(2,"div",27)(3,"span",28),U._uU(4),U.qZA(),U.TgZ(5,"div",29)(6,"div",30),U._uU(7),U.qZA(),U.TgZ(8,"div",31),U._uU(9),U.YNc(10,ve,2,0,"span",32),U.YNc(11,he,2,0,"span",32),U.YNc(12,xe,2,1,"span",32),U.qZA()(),U.TgZ(13,"div",33),U.YNc(14,Le,2,1,"a",34),U.TgZ(15,"button",35),U.NdJ("click",function(){const oe=U.CHM(Q).index,ge=U.oxw(3);return U.KtG(ge.removeFile(oe))}),U._uU(16," Remove "),U.qZA()()()()}if(2&Y){const Q=X.$implicit,W=U.oxw(3);U.xp6(1),U.Q6J("ngIf",Q.url&&W.isImageExtension(Q.extension)),U.xp6(3),U.Oqu(W.getFileIconFromExtension(Q.extension)),U.xp6(2),U.s9C("title",Q.file.name),U.xp6(1),U.hij(" ",Q.file.name," "),U.xp6(2),U.hij(" ",W.formatFileSize(Q.file.size)," "),U.xp6(1),U.Q6J("ngIf","uploading"===Q.status),U.xp6(1),U.Q6J("ngIf","done"===Q.status),U.xp6(1),U.Q6J("ngIf","error"===Q.status),U.xp6(2),U.Q6J("ngIf",Q.url)}}function ct(Y,X){if(1&Y&&(U.TgZ(0,"div",23),U.YNc(1,Ze,17,9,"div",24),U.qZA()),2&Y){const Q=U.oxw(2);U.xp6(1),U.Q6J("ngForOf",Q.uploadedFiles)}}function Se(Y,X){if(1&Y){const Q=U.EpF();U.TgZ(0,"div",4)(1,"h2",5),U._uU(2,"Upload to Folder"),U.qZA(),U.TgZ(3,"div",6)(4,"label",7),U._uU(5,"Document(s)"),U.qZA(),U.YNc(6,ee,2,0,"div",8),U.TgZ(7,"div",9)(8,"input",10),U.NdJ("change",function(J){U.CHM(Q);const oe=U.oxw();return U.KtG(oe.uploadAttachments(J))}),U.qZA()(),U.YNc(9,re,6,2,"div",11),U.qZA(),U.YNc(10,ct,2,1,"div",12),U.TgZ(11,"div",6)(12,"label",13),U._uU(13,"Description"),U.qZA(),U.TgZ(14,"textarea",14),U.NdJ("keyup",function(J){U.CHM(Q);const oe=U.oxw();return U.KtG(oe.handleDescriptionChange(J))}),U.qZA()(),U.TgZ(15,"div",15)(16,"button",16),U.NdJ("click",function(){U.CHM(Q);const J=U.oxw();return U.KtG(J.saveUploadedCaptures())}),U._uU(17," Save Data "),U.qZA(),U.TgZ(18,"button",17),U.NdJ("click",function(){U.CHM(Q);const J=U.oxw();return U.KtG(J._activeModal.close())}),U._uU(19," Close "),U.qZA()()()}if(2&Y){const Q=U.oxw();U.xp6(6),U.Q6J("ngIf",Q.uploadLoader),U.xp6(3),U.Q6J("ngIf",!Q.isAllowedToUploadFile),U.xp6(1),U.Q6J("ngIf",Q.uploadedFiles&&Q.uploadedFiles.length>0),U.xp6(6),U.Q6J("disabled",Q.uploadLoader||Q.loader||!Q.isAllowedToUploadFile||!Q.hasAnyUploadedFiles())}}function rt(Y,X){1&Y&&(U.TgZ(0,"div",18),U._UZ(1,"span",19),U.qZA())}function gt(Y,X){1&Y&&(U.TgZ(0,"div",18),U._UZ(1,"span",19),U.qZA())}function Ft(Y,X){1&Y&&(U.TgZ(0,"div",48),U._uU(1," Document name is required. "),U.qZA())}function $t(Y,X){1&Y&&(U.TgZ(0,"div",48),U._uU(1," Document name cannot be longer than 10 characters. "),U.qZA())}const Kt=function(Y,X,Q){return{"ng-untouched":Y,"ng-pristine":X,"ng-invalid":Q}};function Bt(Y,X){if(1&Y){const Q=U.EpF();U.TgZ(0,"input",46),U.NdJ("change",function(J){U.CHM(Q);const oe=U.oxw(3);return U.KtG(oe.handleFileNameChange(J))}),U.qZA(),U.YNc(1,Ft,2,0,"div",47),U.YNc(2,$t,2,0,"div",47)}if(2&Y){const Q=U.oxw(3);let W,J,oe;U.Q6J("ngClass",U.kEZ(3,Kt,null==(W=Q.myForm.get("documentName"))?null:W.untouched,null==(W=Q.myForm.get("documentName"))?null:W.pristine,(null==(W=Q.myForm.get("documentName"))?null:W.invalid)&&(null==(W=Q.myForm.get("documentName"))?null:W.touched))),U.xp6(1),U.Q6J("ngIf",(null==(J=Q.myForm.get("documentName"))?null:J.hasError("required"))&&(null==(J=Q.myForm.get("documentName"))?null:J.touched)),U.xp6(1),U.Q6J("ngIf",(null==(oe=Q.myForm.get("documentName"))?null:oe.hasError("maxlength"))&&(null==(oe=Q.myForm.get("documentName"))?null:oe.touched))}}function Yt(Y,X){if(1&Y&&(U.TgZ(0,"div",6)(1,"label",7),U._uU(2,"Document Name"),U.qZA(),U.YNc(3,rt,2,0,"div",44),U.YNc(4,gt,2,0,"div",8),U.YNc(5,Bt,3,7,"ng-template",null,45,U.W1O),U.qZA()),2&Y){const Q=U.MAs(6),W=U.oxw(2);U.xp6(3),U.Q6J("ngIf",W.uploadLoader)("ngIfElse",Q),U.xp6(1),U.Q6J("ngIf",W.loader)}}function on(Y,X){if(1&Y){const Q=U.EpF();U.TgZ(0,"button",16),U.NdJ("click",function(J){U.CHM(Q);const oe=U.oxw(2);return U.KtG(oe.saveDocument(J))}),U._uU(1," Save Data "),U.qZA()}if(2&Y){const Q=U.oxw(2);U.Q6J("disabled",Q.isSaving||Q.uploadLoader||Q.loader||!Q.isAllowedToUploadFile)}}function un(Y,X){if(1&Y){const Q=U.EpF();U.TgZ(0,"button",16),U.NdJ("click",function(){U.CHM(Q);const J=U.oxw(3);return U.KtG(J.updateDocument())}),U._uU(1," Update Data "),U.qZA()}if(2&Y){const Q=U.oxw(3);U.Q6J("disabled",Q.uploadLoader||Q.loader||!Q.isAllowedToUploadFile)}}function hn(Y,X){if(1&Y&&U.YNc(0,un,2,1,"button",49),2&Y){const Q=U.oxw(2);U.Q6J("ngIf",Q.documentId)}}function me(Y,X){if(1&Y){const Q=U.EpF();U.TgZ(0,"div",4)(1,"h2",5),U._uU(2,"Save to Folder"),U.qZA(),U.TgZ(3,"form",40),U.YNc(4,Yt,7,3,"div",41),U.TgZ(5,"div",15),U.YNc(6,on,2,1,"button",42),U.YNc(7,hn,1,1,"ng-template",null,43,U.W1O),U.TgZ(9,"button",17),U.NdJ("click",function(){U.CHM(Q);const J=U.oxw();return U.KtG(J._activeModal.close(!0))}),U._uU(10," Close "),U.qZA()()()()}if(2&Y){const Q=U.MAs(8),W=U.oxw();U.xp6(3),U.Q6J("formGroup",W.myForm),U.xp6(1),U.Q6J("ngIf",!W.selectedFileURL),U.xp6(2),U.Q6J("ngIf",!W.documentId)("ngIfElse",Q)}}let ne=(()=>{const X=class{constructor(W,J,oe,ge,Ce,Pe,Je,He){this._snapshot=W,this._activeModal=J,this._snackBar=oe,this._auth=ge,this._itemService=Ce,this._snackbarService=Pe,this._folder=Je,this.captureService=He,this.upload=!1,this.isUploadFromConsole=!1,this.loader=!1,this.folderSelector="#boom-sidebar-upload",this.captureTypes=R.Z,this.selectedFolders=[],this.boomgptComposition=ot.rG,this.selectedFileURL="",this.uploadedFiles=[],this.selectedDescription="",this.uploadLoader=!1,this.isAllowedToUploadFile=!0,this.isSaving=!1,this.validImageField=["png","jpeg","jpg","svg","webp"],this.validDocumentField=["pdf","txt","docx","doc","xlsx","pptx","mp4","mov","avi","wmv","mpeg"],this.getUserProfile();const Fe=this._auth.loadFromLocalStorage();this.userCompositionId=Fe.userConcept}ngOnDestroy(){this.subs.unsubscribe()}ngOnInit(){let W=localStorage.getItem("profile");W&&(this.userDetails=W=JSON.parse(W)),pe()({token:W.token,userId:W.theUserId||W.userId,userConcept:W.userConcept,...q.d}),Wt.FolderTreeModule.renderTreeSidebar({sidebarQuerySelector:this.folderSelector,navigateThroughLabel:!0,showCheckbox:!0},!0),this.myForm=new je.cw({documentName:new je.NI(this.docTitle,[je.kI.required,je.kI.maxLength(50)])}),this.subs=this._snapshot.queryParams.subscribe(J=>{if(J.s){const oe=Wt.FolderTreeModule.globalFolders;this.currentFolderId=J.s;const Ce=oe.filter(Pe=>Pe.id==J.s).map(Pe=>({id:Pe?.id,name:Pe?.name}));Wt.FolderTreeModule.updateSelectedFolders(this.folderSelector,Ce,!0)}else this.currentFolderId=""}),this.isUploadFromConsole||(Wt.FolderTreeModule.updateSelectedFolders(this.folderSelector,[{id:this.projectId,name:""}],!0),Wt.FolderTreeModule.setCurrentFolderId(this.projectId,this.folderSelector))}getUserProfile(){this._auth.getUserProfile().subscribe({next:W=>{const J=W?.data?.the_user?.entity.person;this.userProfile={first_name:J?.first_name,last_name:J?.last_name,profile_img:J?.profile_img,userid:W?.id}}})}getFileExtension(W){return W.split(".").pop()?.toLowerCase()||""}getFileIcon(W){switch(this.getFileExtension(W)){case"pdf":return"\u{1f4c4}";case"doc":case"docx":return"\u{1f4dd}";case"xls":case"xlsx":return"\u{1f4ca}";case"ppt":case"pptx":return"\u{1f4c8}";case"txt":return"\u{1f4c3}";case"mp4":case"mov":case"avi":case"wmv":case"mpeg":return"\u{1f3ac}";case"jpg":case"jpeg":case"png":case"gif":case"webp":return"\u{1f5bc}\ufe0f";default:return"\u{1f4c1}"}}uploadAttachment(W){var J=this;return(0,qe.Z)(function*(){J.fileUploadErrorMessage="";const oe=["jpg","jpeg","png"],ge=["doc","docx","xls","xlsx","ppt","pptx","txt","pdf","md","mp4","mov","avi","wmv","mpeg"];let Ce;if(W&&W.target&&W.target.files){if(!W.target.files[0])return null;Ce=W.target.files[0]}else{if(!W||!W.name&&!W.size)return null;Ce=W}if(!Ce)return null;const Je=Ce.name.split(".").pop()?.toLowerCase()||"",He=Ce.size/1024,Fe=yield J._folder.checkUserSubscription("fileSize"),nt=Fe?.isAllowedToCreate,wt=Fe?.limit;if(He>=nt)return J.fileUploadErrorMessage=`File size must be less than ${wt} KB`,J._snackbarService.openSnackBar(J.fileUploadErrorMessage,"warning"),null;J.uploadLoader=!0;try{if(oe.includes(Je)){const pt=new FormData;pt.append("image",Ce);const Ut=yield(0,vt.n)(J._itemService.uploadNewImage(pt));return J.uploadLoader=!1,{url:Ut?.data,file:Ce,extension:Je}}if(ge.includes(Je)){const pt=new FormData;pt.append("file",Ce);const Ut=yield(0,vt.n)(J._itemService.uploadFile(pt));return J.uploadLoader=!1,{url:Ut?.data,file:Ce,extension:Je}}return J.uploadLoader=!1,J._snackbarService.openSnackBar("Invalid File Format","error"),null}catch{return J.uploadLoader=!1,J._snackbarService.openSnackBar("Sorry, couldn't upload file at the moment.","error"),null}})()}uploadAttachments(W){var J=this;return(0,qe.Z)(function*(){if(!W.target.files||0===W.target.files.length)return;const oe=W.target.files,ge=W.target;setTimeout(()=>ge.value="",0);const Ce=Array.from(oe);Ce.forEach(Je=>{const He=(Je.name.split(".").pop()||"").toLowerCase(),Fe={file:Je,extension:He,preview:null,url:void 0,status:"pending"};if(J.validImageField.includes(He)){const nt=new FileReader;nt.onload=()=>Fe.preview=nt.result,nt.readAsDataURL(Je)}J.uploadedFiles.push(Fe)}),J.uploadLoader=!0;const Pe=J.uploadedFiles.slice(-Ce.length).map(Je=>(Je.status="uploading",J.uploadAttachment(Je.file).then(He=>{He&&He.url?(Je.url=He.url,Je.status="done"):(Je.status="error",Je.error="Upload failed")})));yield Promise.allSettled(Pe),J.uploadLoader=J.uploadedFiles.some(Je=>"uploading"===Je.status)})()}uploadImage(W){const J=new FormData;J.append("image",W),this._itemService.uploadNewImage(J).subscribe({next:oe=>{this.selectedFileURL=oe.data,this.uploadLoader=!1},error:()=>{this.uploadLoader=!1,this._snackbarService.openSnackBar("Sorry, couldn't upload file at the moment.","error")}})}uploadFile(W){const J=new FormData;J.append("file",W),this._itemService.uploadFile(J).subscribe({next:oe=>{this.selectedFileURL=oe.data,this.uploadLoader=!1},error:()=>{this.uploadLoader=!1,this._snackbarService.openSnackBar("Sorry, couldn't upload file at the moment.","error")}})}editSelectedFolders(W){this.selectedFolders=W}saveUploadedCaptures(){var W=this;return(0,qe.Z)(function*(){if(W.fileUploadErrorMessage)return void W._snackbarService.openSnackBar(W.fileUploadErrorMessage,"warning");if(!W.hasAnyUploadedFiles())return void W._snackbarService.openSnackBar("No files ready for upload","warning");let J;W.loader=!0;const oe={};for(let ge=0;ge<W.uploadedFiles.length;ge++){const Ce=W.uploadedFiles[ge];if("done"!==Ce.status)continue;J={title:Ce.file.name,short_desc:"",data_type:W.validImageField.includes(Ce.extension)?R.Z.Image:R.Z.Document,image:Ce.url,filepath:Ce.url,filename:Ce.file.name,boom_folder:{category_name:"",category_id:""},source_url:"",created_at:String(Date.now()),note:W.selectedDescription},oe[W.boomgptComposition]=J;const Pe=Wt.FolderTreeModule.selectedFolders;W.selectedFolders=Pe.map(He=>parseInt(He?.id||He.category_id));const Je=Pe.map(He=>({id:parseInt(He?.id||He.category_id),name:He?.name||He.category_name}));if(W.selectedFolders?.length>0)for(let He=0;He<Je.length;He++){const Fe=Je[He],nt={category_name:Fe?.name||"",category_id:Fe?.id||""};J={...J,boom_folder:{...nt}},oe[W.boomgptComposition]=J,yield W.captureService.uploadDocument(oe,W.userDetails.theUserId,Fe?.id||Fe?.id,W.userDetails.userConcept)}else J={...J,boom_folder:{category_name:"",category_id:""}},oe[W.boomgptComposition]=J,yield W.captureService.uploadDocument(oe,W.userDetails.theUserId,W.userDetails.userConcept,W.userDetails.userConcept)}W._activeModal.close("Media Uploaded!")})()}removeFile(W){W>=0&&W<this.uploadedFiles.length&&this.uploadedFiles.splice(W,1)}hasAnyUploadedFiles(){return this.uploadedFiles.some(W=>"done"===W.status)}isImageExtension(W){return this.validImageField.includes(W)}getFileIconFromExtension(W){switch(W){case"pdf":return"\u{1f4c4}";case"doc":case"docx":return"\u{1f4dd}";case"xls":case"xlsx":return"\u{1f4ca}";case"ppt":case"pptx":return"\u{1f4c8}";case"txt":return"\u{1f4c3}";case"mp4":case"mov":case"avi":case"wmv":case"mpeg":return"\u{1f3ac}";case"jpg":case"jpeg":case"png":case"gif":case"webp":return"\u{1f5bc}\ufe0f";default:return"\u{1f4c1}"}}formatFileSize(W){if(0===W)return"0 B";const ge=Math.floor(Math.log(W)/Math.log(1024));return parseFloat((W/Math.pow(1024,ge)).toFixed(2))+" "+["B","KB","MB","GB","TB"][ge]}handleFileNameChange(W){W.preventDefault(),this.isdocValue.docTitle=W.target.value}saveDocument(W){var J=this;return(0,qe.Z)(function*(){if(W.preventDefault(),J.isdocValue.folderId=Wt.FolderTreeModule.selectedFolders,J.myForm?.valid){J.isSaving=!0,J.loader=!0;try{const oe=localStorage.getItem("profile"),ge=JSON.parse(oe);if((yield(0,$e.oKR)(J.projectId,"my_console_s")).find(Je=>Je?.data?.the_createDocument?.docTitle==J.isdocValue.docTitle))return J._snackbarService.openSnackBar("document already exist","error"),J.isSaving=!1,void(J.loader=!1);{let Je;if(yield Promise.all(J.isdocValue.folderId&&J.isdocValue.folderId?.map(function(){var He=(0,qe.Z)(function*(Fe){const nt={the_createDocument:{docTitle:J.isdocValue?.docTitle,folderId:parseInt(Fe?.category_id),createdByEmail:ge?.email||"",created_by:ge?.userConcept||"",assignUsers:J.isdocValue?.assignUsers||"",content:J.isdocValue?.content||"",types:J.isdocValue?.types||"",methodTypes:J.isdocValue?.methodTypes||"",methodUrl:J.isdocValue?.methodUrl||"",authType:J.isdocValue?.authType||"",username:J.isdocValue?.username||"",password:J.isdocValue?.password||"",bearerToken:J.isdocValue?.bearerToken||"",jsonList:J.isdocValue?.jsonList||"",languageType:J.isdocValue?.languageType||"",codeEditor:J.isdocValue?.codeEditor||"",desAboutReturnOpt:J.isdocValue?.desAboutReturnOpt||"",docsUrl:J.isdocValue?.docsUrl||"",imagesUrl:J.isdocValue?.imagesUrl||""}},wt=yield(0,$e.J0M)(parseInt(Fe.category_id)),pt=yield(0,$e.joo)(nt,void 0,void 0,void 0,ge.theUserId,4);yield(0,$e.GIn)(wt,pt,"my_console"),yield $e.smK.SyncDataOnline();const Ut=yield(0,$e.J0M)(pt.id);Je={title:"Document Invitaion",body:`You are assign for ${J.isdocValue?.docTitle} document`,timestamp:(new Date).toISOString(),link:`projects/view/${parseInt(Fe?.category_id)}?tab=Documentation&docid=${Ut.id}`}});return function(Fe){return He.apply(this,arguments)}}())),J.isdocValue?.assignUsers.length>0){const He=J.isdocValue?.assignUsers?.map(Fe=>Fe.id);if(He.length>0){const Fe={userConceptIds:He,fs_notification:Je};(yield fetch(q.N.baseUrl+"/notification-bulk/send",{method:"POST",body:JSON.stringify(Fe),headers:{"Content-Type":"application/json",Authorization:`Bearer ${J.userDetails.token}`}})).ok||J._snackbarService.openSnackBar("Unable to send notification","error")}}J._snackbarService.openSnackBar("document created successful","success"),J.isSaving=!1,J.loader=!1,J.childComponent(),J._activeModal.close()}}catch{J._snackbarService.openSnackBar("Error creating Document","error")}}})()}updateDocument(){var W=this;return(0,qe.Z)(function*(){if(W.isSaving=!0,W.loader=!0,W.myForm?.valid){W.isdocValue.folderId=Wt.FolderTreeModule.selectedFolders,W.isdocValue.docTitle=W.myForm.value.documentName;try{let J;const oe=new $e.MYZ;if(oe.userId=W.userProfile?.userid,oe.compositionId=W.documentId,W.isdocValue.folderId&&W.isdocValue?.folderId?.map(ge=>{oe.patchObject={docTitle:W.isdocValue?.docTitle||"",folderId:parseInt(ge?.category_id)||"",categoryName:ge&&ge?.category_name||"",last_updated_by:W.userProfile.first_name+" "+W.userProfile.last_name||"",assignUsers:W.isdocValue?.assignUsers||"",content:W.isdocValue?.content||"",types:W.isdocValue?.types||"",methodTypes:W.isdocValue?.methodTypes||"",methodUrl:W.isdocValue?.methodUrl||"",authType:W.isdocValue?.authType||"",username:W.isdocValue?.username||"",password:W.isdocValue?.password||"",bearerToken:W.isdocValue?.bearerToken||"",jsonList:W.isdocValue?.jsonList||"",languageType:W.isdocValue?.languageType||"",codeEditor:W.isdocValue?.codeEditor||"",desAboutReturnOpt:W.isdocValue?.desAboutReturnOpt||"",docsUrl:W.isdocValue?.docsUrl||"",imagesUrl:W.isdocValue?.imagesUrl||""},J={title:"Document Invitaion",body:`You are assign for ${W.isdocValue?.docTitle} document`,timestamp:(new Date).toISOString(),link:`projects/view/${parseInt(ge?.category_id)}?tab=Documentation&docid=${W.documentId}`}}),yield(0,$e.hrH)(oe),$e.smK.SyncDataOnline(),W.isSaving=!1,W.loader=!1,W.isdocValue?.assignUsers.length>0){const ge=W.isdocValue?.assignUsers?.map(Ce=>Ce.id);ge.length>0&&(yield fetch("https://theta.boomconcole.com/api/notification-bulk/send",{method:"POST",body:JSON.stringify({userConceptIds:ge,fs_notification:J}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${W.userDetails.token}`}}))}W._snackbarService.openSnackBar("Document Update successful","success"),W._activeModal.close()}catch{W._snackbarService.openSnackBar("Failed to Update Document","error")}W.childComponent()}})()}handleDescriptionChange(W){this.selectedDescription=W.target.value}};let Y=X;return X.\u0275fac=function(J){return new(J||X)(U.Y36(st.gz),U.Y36(dt.Kz),U.Y36(it.ux),U.Y36(Ye.e),U.Y36(Xe.e),U.Y36(Ve.o),U.Y36(Nt.s),U.Y36(se.F))},X.\u0275cmp=U.Xpm({type:X,selectors:[["app-folder-upload-modal"]],inputs:{upload:"upload",isdoc:"isdoc",isdocValue:"isdocValue",singleDocValue:"singleDocValue",projectId:"projectId",documentId:"documentId",docTitle:"docTitle",childComponent:"childComponent",isUploadFromConsole:"isUploadFromConsole"},decls:5,vars:2,consts:[[1,"modal-body","row"],[1,"col-lg-5","col-md-6","col-sm-12","sidebar_wrapper"],["id","boom-sidebar-upload",1,"sidebar","bg-white"],["class","col-lg-7 col-md-6 col-sm-12",4,"ngIf"],[1,"col-lg-7","col-md-6","col-sm-12"],[1,"mb-3"],[1,"form-group"],["for","document",1,"form-label"],["class","loading","style","position: relative; min-height: 70px",4,"ngIf"],[1,"mb-2"],["type","file","name","document","id","document","multiple","","accept","application/msword, .docx, .doc, application/vnd.ms-excel, application/vnd.ms-powerpoint, text/plain, application/pdf, image/jpeg, image/jpg, image/png, video/mp4, video/mpeg, video/quicktime, video/x-msvideo, video/x-ms-wmv",1,"form-control",3,"change"],["class","d-inline-block",4,"ngIf"],["class","uploaded-list",4,"ngIf"],["for","description",1,"form-label"],["name","description","id","description","rows","3","placeholder","Add Description",1,"form-control",3,"keyup"],[1,"d-flex","flex-row","gap-2"],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-secondary",3,"click"],[1,"loading",2,"position","relative","min-height","70px"],[1,"loader",2,"position","relative"],[1,"d-inline-block"],[1,"text-danger","exceed-limit-msg"],["target","_blank",3,"routerLink"],[1,"uploaded-list"],["class","card d-flex align-items-center justify-content-start border rounded p-2 mb-2 uploaded-item",4,"ngFor","ngForOf"],[1,"card","d-flex","align-items-center","justify-content-start","border","rounded","p-2","mb-2","uploaded-item"],["target","_blank","class","d-flex align-items-center gap-2 no-decoration w-100",3,"href",4,"ngIf"],[1,"w-100","d-flex","align-items-center","gap-2"],[2,"font-size","24px","margin-right","10px"],[1,"file-meta"],[1,"file-name",3,"title"],[1,"file-sub","small","text-muted"],[4,"ngIf"],[1,"ms-auto","d-flex","gap-2"],["target","_blank","class","btn btn-sm btn-outline-secondary",3,"href",4,"ngIf"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],["target","_blank",1,"d-flex","align-items-center","gap-2","no-decoration","w-100",3,"href"],["alt","Image","class","thumb",3,"src",4,"ngIf"],["alt","Image",1,"thumb",3,"src"],["target","_blank",1,"btn","btn-sm","btn-outline-secondary",3,"href"],[3,"formGroup"],["class","form-group",4,"ngIf"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateDocumentAs",""],["class","loading","style","position: relative; min-height: 70px",4,"ngIf","ngIfElse"],["loaded",""],["formControlName","documentName","type","text","name","documentName","id","document","required","",1,"form-control",3,"ngClass","change"],["style","color: red",4,"ngIf"],[2,"color","red"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"]],template:function(J,oe){1&J&&(U.TgZ(0,"div",0)(1,"div",1),U._UZ(2,"div",2),U.qZA(),U.YNc(3,Se,20,4,"div",3),U.YNc(4,me,11,4,"div",3),U.qZA()),2&J&&(U.xp6(3),U.Q6J("ngIf",!oe.isdoc),U.xp6(1),U.Q6J("ngIf",oe.isdoc))},dependencies:[$.mk,$.sg,$.O5,st.rH,je._Y,je.Fj,je.JJ,je.JL,je.Q7,je.sg,je.u],styles:[".exceed-limit-msg[_ngcontent-%COMP%]{font-size:.875rem;margin-top:.5rem;margin-bottom:0}.exceed-limit-msg[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;color:#1f75cb}.exceed-limit-msg[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .exceed-limit-msg[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus{color:#ff9472}.sidebar_wrapper[_ngcontent-%COMP%]{max-height:600px;overflow:scroll}.uploaded-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}.uploaded-item[_ngcontent-%COMP%]{display:flex;align-items:center}.thumb[_ngcontent-%COMP%]{width:64px;height:48px;object-fit:cover;border-radius:4px;margin-right:8px;background:#f8f9fa;border:1px solid #e9ecef}.file-meta[_ngcontent-%COMP%]{overflow:hidden}.file-name[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:500}.no-decoration[_ngcontent-%COMP%]{text-decoration:none;color:inherit}"]}),Y})()},1685:(wo,Nn,yt)=>{"use strict";yt.d(Nn,{F:()=>Ye});var qe=yt(5861),vt=yt(6296),R=yt(9402),ot=yt(7899),je=yt(2902),Wt=yt(2340),pe=yt(4650),q=yt(8154),$e=yt(4383),U=yt(8180),st=yt(384),dt=yt(5495);let it=(()=>{const Ve=class{constructor(se,$){this._authService=se,this._items=$;const ee=this._authService.loadFromLocalStorage();ee&&(this.userConcept=ee.userConcept,this.userId=ee.theUserId)}formatDocumentation(se){if(!se)return[];const $=se?.[0]?.data?.the_documentation||[];return{isDocumentation:!0,types:$?.the_documentation_type?.[0]?.data?.the_type,title:$?.the_documentation_doc_title?.[0]?.data?.the_doc_title,data_type:"documentation",boom_folder:{category_name:$.categoryName,category_id:$.folderId},short_desc:$?.the_documentation_doc_title?.[0]?.data?.the_doc_title,visual_text:$?.the_documentation_content?.[0]?.data?.the_content,codeEditor:$?.the_documentation_code_editor?.[0]?.data?.the_code_editor,desAboutReturnOpt:$?.the_documentation_return?.[0]?.data?.the_return,methodTypes:$?.the_documentation_method?.[0]?.data?.the_method,url:$?.the_documentation_method_url?.[0]?.data?.the_method_url,authType:$?.the_documentation_auth_type?.[0]?.data?.the_auth_type,jsonKeyValuePair:Array.isArray($?.the_documentation_s_json_list)?$.the_documentation_s_json_list.map(ee=>{const re=ee.data.the_json_list.the_json_list_key?.[0],le=ee.data.the_json_list.the_json_list_value?.[0],ie=re?.data?.the_key,ve=le?.data?.the_value;return{keyValuePairs:{[ie]:ve}}}):[],imagesUrl:Array.isArray($?.the_documentation_s_image_url)?$.the_documentation_s_image_url.map(ee=>ee?.data?.the_image_url):[],docsUrl:Array.isArray($?.the_documentation_s_doc_url)?$.the_documentation_s_doc_url.map(ee=>ee?.data?.the_doc_url):[],videoLinks:Array.isArray($?.the_documentation_s_video_link)?$.the_documentation_s_video_link.map(ee=>ee?.data?.the_video_link):[],bearer_token:$?.the_documentation_bearer_token?.[0]?.data?.the_bearer_token,basicAuthUserName:$?.the_documentation_username?.[0]?.data?.the_username,basicAuthpassword:$?.the_documentation_password?.[0]?.data?.the_password,note:"",created_by_email:$?.the_documentation_creator_email?.[0]?.data?.the_creator_email,source_url:"",id:se?.[0]?.id,created_at:se?.[0]?.created_at}}getSingleDocumentationDetails(se){var $=this;return(0,qe.Z)(function*(){try{const ee=[{composition:se,listLinkers:[],fullLinkers:["the_documentation_doc_title","the_documentation_type","the_documentation_created_by","the_documentation_creator_email","the_documentation_content","the_documentation_api_script","the_documentation_api_body","the_documentation_method","the_documentation_method_url","the_documentation_auth_type","the_documentation_username","the_documentation_password","the_documentation_bearer_token","the_documentation_language","the_documentation_code_editor","the_documentation_return","the_documentation_s_json_list","the_documentation_s_doc_url","the_documentation_s_video_link","the_documentation_s_image_url"],inpage:500,page:1,logic:"or",filterSearches:[]},{listLinkers:[],fullLinkers:["the_json_list_key","the_json_list_value"],inpage:1e3,page:1,logic:"or",filterSearches:[]}],re=yield(0,R.eHe)(ee);return $.formatDocumentation([re])}catch(ee){return console.error("Error fetching new doc data:",ee),[]}})()}};let Xe=Ve;return Ve.\u0275fac=function($){return new($||Ve)(pe.LFG(st.e),pe.LFG(q.e))},Ve.\u0275prov=pe.Yz7({token:Ve,factory:Ve.\u0275fac,providedIn:"root"}),Xe})(),Ye=(()=>{const Ve=class{constructor(se,$,ee,re,le,ie){this._apiServices=se,this._folderService=$,this._snackbarService=ee,this._authService=re,this.crmService=le,this.documentationService=ie,this.allCapturesInCurrentFolder=[],this.allFolders=[],this.storeBoomconsoleEntity=Wt.N.storeBoomconsoleEntityId,this.types=[],this.userConcept=this._authService.loadFromLocalStorage().userConcept,this.entityId=this._authService.loadFromLocalStorage()?.entityId}getCaptures(se,$){var ee=this;return(0,qe.Z)(function*(){const re=yield ee.getAllTypes();ee.types=re;const le=[];re.forEach(xe=>{if(xe.connections)try{const Le=JSON.parse(xe.connections);Le.connections&&Array.isArray(Le.connections)&&le.push(...Le.connections)}catch(Le){console.error("Error parsing connections for type:",xe.name,Le)}});const ie=[...new Set(le)],ve=new Set(re.map(xe=>xe.name)),he=["the_entity_title","the_entity_type","the_entity_name","the_entity_data_type","the_entity_first_name","the_entity_last_name","the_entity_tag","the_entity_note","the_entity_source_url","the_entity_avatar","the_documentation_doc_title","the_documentation_type","the_documentation_created_by","the_documentation_creator_email","the_documentation_content","the_documentation_api_script","the_documentation_api_body","the_documentation_method","the_documentation_method_url","the_documentation_auth_type","the_documentation_username","the_documentation_password","the_documentation_bearer_token","the_documentation_language","the_documentation_code_editor","the_documentation_return","the_documentation_s_json_list","the_documentation_s_doc_url","the_documentation_s_video_link","the_documentation_s_image_url","self",...ie];return new Promise(xe=>{const Le=new R.LtL;Le.typeConnection="the_documentation_s_json_list",Le.name="json",Le.selectors=["the_json_list_key","the_json_list_value"];const Ze=new R.LtL;Ze.name="access1",Ze.typeConnection=je.Oc,Ze.reverse=!0;const ct=new R.LtL;ct.name="access2",ct.typeConnection=je.Oc,ct.reverse=!0;const Se=new R.LtL;Se.typeConnection=je.u,Se.name="contain",Se.freeschemaQueries=[Le,Ze],Se.selectors=he;const rt=new R.LtL;rt.name="folder",rt.typeConnection=je.NF,rt.freeschemaQueries=[ct],rt.selectors=he;const gt=new R.LtL;gt.name="top",gt.conceptIds=[Number(se)],gt.outputFormat=R.xY7,gt.freeschemaQueries=[rt,Se],(0,R.og0)(gt,$).subscribe(Ft=>{const Kt=(Ft?.[0]?.data?Object.keys(Ft[0]?.data):[]).find(ne=>"id"!==ne);let Bt=[];const Yt=Ft?.[0]?.data?.boomFolder?.[je.u],on=ve,un=re;if(Yt?.length){let ne=[];Yt.forEach(Y=>{if(Y?.data?.the_entity){const X=ee.crmService.formatNewEntityContactsConsole([Y],"preview"),Q=hn(Y);Q?.shared&&X.forEach(W=>{W.shared=Q.shared}),ne=[...ne,...X]}else if(Y?.data?.[ot.rG]?.crm_data){const X=ee.crmService.formatOldEntityContactsConsole([Y],"preview"),Q=hn(Y);Q?.shared&&ne.push(Q?.shared),Q?.shared&&X.forEach(W=>{W.shared=Q.shared}),ne=[...ne,...X]}else{const X=me(Y);X&&ne.push(X)}}),Bt=ne,xe(Bt)}else{let ne=[];Kt===je.TB?ne=Ft?.[0]?.data?.[je.TB]?.[je.u]:"the_user"===Kt&&(ne=Ft?.[0]?.data?.the_user?.[je.u]),Bt=ne?.map(Y=>me(Y)),Bt=Bt?.filter(Boolean),Bt=Bt.map(Y=>{const X=Y?.types||Y?.the_entity_type||Y?.type||Y?.data_type;if(X){const Q=ne.find(W=>W.id===Y.id);if(Q&&Q.data){let W=Q.data?.the_documentation||Q.data?.the_entity;!W&&X&&(W=Q.data?.[X]),W||(W=Q.data);const J=ee.extractDynamicConnections(W,X);Object.keys(J).length>0&&(Y.dynamicConnections=J)}}return Y}),xe(Bt||[])}function hn(ne){if(ne?.data){const Y={...ne},X=ne?.data?.the_entity?.the_user_s_read_access_reverse||ne?.data?.boomgpt?.the_user_s_read_access_reverse;return X&&(Y.shared=X),Y}}function me(ne){if(ne?.data?.[je.TB]&&Object.keys(ne?.data?.[je.TB]).length){const W={name:ne?.data?.[je.TB]?.name?.data?.the_name,parent:ne?.data?.[je.TB]?.parent?.data?.the_parent,id:ne?.id,created_at:ne?.created_on},J=ne?.data?.[je.TB][`${je.Oc}_reverse`];return J&&(W.shared=J,delete ne?.data?.[je.TB][`${je.Oc}_reverse`]),W}if(ne?.data?.[ot.rG]){const J={...function Q(W,J,oe){const ge={};for(const Ce in W)if(Ce===`${J}_s_${oe}_by`)ge.shared=W[Ce];else{if("comment"===Ce)continue;{const Pe=W[Ce]?.data;if(Pe&&"object"==typeof Pe){const Je=Object.keys(Pe)[0];ge[Ce]=Pe[Je]}}}return ge}(ne.data[ot.rG],ot.rG,je.Zm),id:ne.id,created_at:ne.created_on},oe=ne?.data?.[ot.rG][`${je.Oc}_reverse`];return oe&&(J.shared=oe,delete ne?.data?.[ot.rG][`${je.Oc}_reverse`]),J}if(ne?.data?.the_documentation)return function X(W){if(!W?.data?.the_documentation)return null;const J=W.data.the_documentation,oe=function Y(W){const J={};for(const oe in W){const ge=W[oe];if(ge?.data&&"object"==typeof ge.data){const Ce=Object.keys(ge.data)[0];J[oe]=ge.data[Ce]}}return J}(J);return{isDocumentation:!0,data_type:"documentation",id:W.id,created_at:W.created_on,title:oe.the_documentation_doc_title,short_desc:oe.the_documentation_doc_title,visual_text:oe.the_documentation_content,types:oe.the_documentation_type,codeEditor:oe.the_documentation_code_editor,desAboutReturnOpt:oe.the_documentation_return,methodTypes:oe.the_documentation_method,url:oe.the_documentation_method_url,authType:oe.the_documentation_auth_type,bearer_token:oe.the_documentation_bearer_token,basicAuthUserName:oe.the_documentation_username,basicAuthpassword:oe.the_documentation_password,created_by_email:oe.the_documentation_creator_email,jsonKeyValuePair:Array.isArray(J.the_documentation_s_json_list)?J.the_documentation_s_json_list.map(ge=>{const Ce=ge.data?.the_json_list?.the_json_list_key?.[0],Pe=ge.data?.the_json_list?.the_json_list_value?.[0],Je=Ce?.data?.the_key,He=Pe?.data?.the_value;return{keyValuePairs:{[Je]:He}}}):[],imagesUrl:Array.isArray(J.the_documentation_s_image_url)?J.the_documentation_s_image_url.map(ge=>ge?.data?.the_image_url):[],docsUrl:Array.isArray(J.the_documentation_s_doc_url)?J.the_documentation_s_doc_url.map(ge=>ge?.data?.the_doc_url):[],videoLinks:Array.isArray(J.the_documentation_s_video_link)?J.the_documentation_s_video_link.map(ge=>ge?.data?.the_video_link):[],note:"",source_url:""}}(ne);if(ne?.data){const J=Object.keys(ne.data).find(oe=>on.has(oe)&&"object"==typeof ne.data[oe]);if(J){const oe=ne.data[J],ge=un.find(Je=>Je.name===J),Ce={id:ne.id,created_at:ne.created_on,type:J,data_type:J,type_id:ge?.id||null,icon:ge?.icon||"",viewWidget:ge?.viewWidget||null};for(const Je in oe){const He=oe[Je];if(He?.data){const Fe=Object.keys(He.data);Fe.length>0&&(Ce[Je]=He.data[Fe[0]])}else if(Array.isArray(He)&&He.length>0){const Fe=He[0];if(Fe?.data){const nt=Object.keys(Fe.data);nt.length>0&&(Ce[Je]=Fe.data[nt[0]])}}}const Pe=Object.keys(Ce).find(Je=>(Je.endsWith("_name")||Je.endsWith("_title"))&&Ce[Je]&&"string"==typeof Ce[Je]);return Pe&&Ce[Pe]?(Ce.title=Ce[Pe],Ce.name=Ce[Pe]):(Ce.title=J.replace(/_/g," ").replace(/^the /,""),Ce.name=Ce.title),Ce}}return null}xe(Ft)})})})()}getAllTypes(){var se=this;return(0,qe.Z)(function*(){try{const $=new R.LtL;$.name="viewWidget",$.typeConnection="the_type_s_view_widget",$.selectors=["the_widget_name"];const ee=new R.LtL;ee.name="icon",ee.typeConnection="the_type_icon",ee.selectors=["the_icon"];const re=new R.LtL;re.name="type",re.typeConnection="the_entity_s_type",re.selectors=["the_type_name","the_type_connections"],re.freeschemaQueries=[$,ee];const le=new R.LtL;le.name="top",le.conceptIds=[se.storeBoomconsoleEntity],le.freeschemaQueries=[re],le.outputFormat=R.xY7;const ie=yield(0,R.T0c)(le,""),ve=[],he=ie?.[0]?.data?.the_entity;return he?.the_entity_s_type&&he.the_entity_s_type.forEach(Le=>{const Ze=Le.data?.the_type,ct=Ze?.the_type_name?.data?.the_name||"",Se=Ze?.the_type_connections?.data?.the_connections||"";console.log("Icon data structure for",ct,":",Ze?.the_type_icon);const rt=Ze?.the_type_icon?.data?.the_icon||"";let gt=null;Ze?.the_type_s_view_widget?.[0]&&(gt=Ze.the_type_s_view_widget[0].id.toString()),ve.push({id:Le.id.toString(),name:ct,connections:Se,viewWidget:gt,icon:rt})}),ve}catch($){return console.error("Error fetching types:",$),[]}})()}getIconForType(se){return this.types.find(ee=>ee.name===se)?.icon||""}getViewWidgetForType(se){return this.types.find(ee=>ee.name===se)?.viewWidget||null}getConnectionsForType(se){const $=this.types.find(ee=>ee.name===se);if(!$||!$.connections)return[];try{const ee=JSON.parse($.connections);if(ee.connections&&Array.isArray(ee.connections))return ee.connections}catch(ee){console.error("Error parsing connections for type:",se,ee)}return[]}getConnectionValuesForItem(se){const $=se?.the_entity_type||se?.type;if(!$)return{};const ee=this.getConnectionsForType($),re={};return ee.forEach(le=>{const ie=se?.[le]||se?.data?.[le];ie&&(re[le]=ie)}),re}extractDynamicConnections(se,$){if(!$)return{};const ee=this.getConnectionsForType($),re={};return ee.forEach(le=>{if(se?.[le]){const ie=se[le];if(Array.isArray(ie)&&ie.length>0){const ve=ie[0];if(ve?.data){const he=Object.keys(ve.data);he.length>0&&(re[le]=ve.data[he[0]])}}else if(ie?.data){const ve=Object.keys(ie.data);ve.length>0&&(re[le]=ie.data[ve[0]])}}}),re}getCategories(se){return new Promise(($,ee)=>{const re=`${je.CH}_s`;(0,R.zAo)(Number(se),[re]).then(le=>{let ie=le?.filter(he=>he?.data?.[je.TB]&&he?.data?.[je.TB]?.name);ie=ie?.map(he=>{const xe={...he};return{name:xe?.data?.[je.TB]?.name,parent:xe?.data?.[je.TB]?.parent,description:xe?.data?.[je.TB]?.description,id:xe?.id}}),ie=ie?.sort(function(he,xe){const Le=he?.name?.toLowerCase(),Ze=xe?.name?.toLowerCase();return Le.localeCompare(Ze)}),$({message:"success",status:200,data:ie})}).catch(le=>{ee({message:"error",status:500,error:le.message})})})}getCategoriesById(se,$){return new Promise((ee,re)=>{(0,R.zAo)(se,[`${je.CH}_s`]).then(ie=>{let ve=ie?.filter(xe=>xe?.data?.[je.TB]&&xe?.data?.[je.TB]?.name);ve=ve?.map(xe=>{const Le={...xe};return{name:Le?.data?.[je.TB]?.name,parent:Le?.data?.[je.TB]?.parent,description:Le?.data?.[je.TB]?.description,id:Le?.id}}),ve=ve?.filter(xe=>xe?.id!==$),ve=ve?.sort(function(xe,Le){const Ze=xe?.name?.toLowerCase(),ct=Le?.name?.toLowerCase();return Ze.localeCompare(ct)});let he={};if($===se)he={count:ve?.length,data:ve};else{const xe=[],Le=Ze=>{ve?.forEach(ct=>{ct?.parent==Ze&&(xe.push(ct),Le(ct?.id))})};Le($),he={count:xe?.length,data:xe},ee(he)}}).catch(ie=>{re(ie)})})}getSharedCaptures(se){var $=this;return new Promise((ee,re)=>{(0,R.$Er)(se,je.Oc,100,1).then(function(){var ie=(0,qe.Z)(function*(ve){const he=ve,xe=new Map;he.forEach((X,Q)=>{xe.set(X.id,Q)});const Le=he?.map(X=>({...X})),Ze=Le?.filter(X=>X?.data?.boomgpt?.crm_data),ct=$.crmService.formatOldEntityContacts(Ze,"preview"),Se=he?.filter(X=>null!=X?.data?.the_entity),gt=(yield Promise.all(Se.map(function(){var X=(0,qe.Z)(function*(Q){return yield $.crmService.getSingleEntityDetails(Q?.id,"sharedwithme")});return function(Q){return X.apply(this,arguments)}}()))).flat().map(X=>({...X,title:X?.profileInformation?.name?.value,data_type:X?.type})),Ft=he?.filter(X=>null!=X?.data?.the_documentation),Kt=(yield Promise.all(Ft.map(function(){var X=(0,qe.Z)(function*(Q){return yield $.documentationService.getSingleDocumentationDetails(Q?.id)});return function(Q){return X.apply(this,arguments)}}()))).flat().map(X=>({...X,title:X?.title,data_type:X?.data_type}));let Bt=Le?.filter(X=>Object.prototype.hasOwnProperty.call(X?.data,ot.co));Bt=Bt?.map(X=>{let Q;return Object.prototype.hasOwnProperty.call(X?.data,ot.co)&&(Q={parent:"1",name:X?.data?.boomFolder?.name,created_at:X?.created_at,id:X?.id}),Q});let Yt=Le?.filter(X=>Object.prototype.hasOwnProperty.call(X?.data,ot.rG));Yt=Yt?.map(X=>{let Q;return Object.prototype.hasOwnProperty.call(X?.data,ot.rG)&&(Q={...X?.data?.[ot.rG],created_at:X?.created_at,id:X?.id},Q.boom_folder={category_id:1,category_parent:"",category_name:"Shared With Me"}),Q});const hn=[...Bt,...Yt,...gt,...Kt,...ct],me=new Map;hn.forEach(X=>{X&&X.id&&me.set(X.id,X)});const Y=Array.from(me.values()).sort((X,Q)=>(xe.get(X.id)??1/0)-(xe.get(Q.id)??1/0));ee(Y)});return function(ve){return ie.apply(this,arguments)}}()).catch(ie=>{re(ie)})})}selectFilteredCaptures(se,$,ee,re,le){let ie=[];if(!le)return[];const ve=le?.filter(Se=>Se?.data_type),he=le?.filter(Se=>Se?.name&&!Se?.type),Le=[...new Map(he?.map(Se=>[Se?.id,Se])).values()].sort((Se,rt)=>{const gt=Se?.name,Ft=rt?.name;return gt?.localeCompare(Ft)});se||Le.push({id:1,name:"Shared With Me"});const Ze=Le?.map(Se=>({...Se,data_type:Se?.data_type?Se?.data_type:"1folder"})),ct=new Set(this.types.map(Se=>Se.name));switch(ie=[...Ze,...ve].filter(Se=>"1folder"===Se?.data_type&&re?.folder||("extension_youchat"==Se?.data_type||"extension_poechat"==Se?.data_type||"extension_googlebard"==Se?.data_type||"extension_chatgpt"==Se?.data_type)&&re?.aichat||"extension_whatsapp_chat"==Se?.data_type&&re?.human_chat||("screenshot"==Se?.data_type||"traced_url"==Se?.data_type||"plain_text"==Se?.data_type||"visual_text"==Se?.data_type||"url"==Se?.data_type||"only_images"==Se?.data_type||"all_but_css"==Se?.data_type||"full_page"==Se?.data_type||"youtube_notes"==Se?.data_type||"all"==Se?.data_type)&&re?.captures||("Document"==Se?.data_type||"Image"==Se?.data_type)&&re?.document_image||("extension_linkedin"==Se?.data_type||"extension_whatsapp"==Se?.data_type||"individual"==Se?.data_type||"company"==Se?.data_type||"student"==Se?.data_type||"employee"==Se?.data_type||"patient"==Se?.data_type||"extension_merojob"==Se?.data_type||"government"==Se?.data_type||"extension_indeed"==Se?.data_type||"extension_maps"==Se?.data_type||"maps"==Se?.data_type||"web_crm"==Se?.data_type||"extension_monster"==Se?.data_type)&&re?.crm||"item_amazon"===Se?.data_type||"item_ebay"===Se?.data_type||"item_costco"===Se?.data_type||"item_kayak"===Se?.data_type||"item_expedia"===Se?.data_type||"item_agoda"===Se?.data_type||"documentation"===Se?.data_type||"sticky_note"===Se?.data_type||"widget"===Se?.data_type||"lms_chat"===Se?.data_type||ct.has(Se?.data_type)&&re?.captures),$){case"type":ie.sort(ee?(Se,rt)=>{const gt=Se?.data_type,Ft=rt?.data_type;return gt?.localeCompare(Ft)}:(Se,rt)=>{const gt=Se?.data_type;return rt?.data_type.localeCompare(gt)});break;case"title":ie.sort(ee?(Se,rt)=>(Se?.title||Se?.name).localeCompare(rt?.title||rt?.name):(Se,rt)=>(rt?.title||rt?.name).localeCompare(Se?.title||Se?.name));break;case"note":ie.sort(ee?(Se,rt)=>Se?.note.localeCompare(rt?.note):(Se,rt)=>rt?.note.localeCompare(Se?.note))}return ie}selectCaptureListsByIds(se,$){if(!se)return;const ee=[];return $.forEach(re=>{const le=se?.filter(ie=>ie?.id==re);ee.push(le[0])}),0==$?.length?null:ee}searchCaptures(se,$){return new Promise(ee=>{this._apiServices.getRecursiveSearchData(se,[],$).subscribe(re=>{let le=re?.map(he=>{if(he?.data?.data?.[ot.rG]||he?.data?.data?.the_entity)return{...he?.data?.data?.[ot.rG]||he?.data?.data?.the_entity,id:he?.id,parent:[...he?.parent]}});le=le?.filter(he=>he);const ve=(le?.length>0?[...le]:[])?.map(he=>{let xe="",Le="",Ze="";if("extension_chatgpt"===he?.data_type||"extension_googlebard"===he?.data_type||"extension_poechat"===he?.data_type||"extension_youchat"===he?.data_type){const Se=he?.answer,rt=document.createElement("div");rt.innerHTML=Se,Le=rt?.textContent,Ze=rt?.textContent?.toLowerCase()}else"item_amazon"===he?.data_type||"item_ebay"===he?.data_type||"item_costco"===he?.data_type||"item_kayak"===he?.data_type||"item_expedia"===he?.data_type||"item_agoda"===he?.data_type?(Le=`${he?.itemData?.description} ${he?.itemData?.delivery}`,Ze=Le?.toLowerCase()):("extension_indeed"===he?.data_type||"extension_indeed"===he?.type||"extension_linkedin"===he?.data_type||"extension_linkedin"===he?.type||"extension_monster"===he?.data_type||"extension_monster"===he?.type||"extension_maps"===he?.data_type||"extension_maps"===he?.type||"web_crm"===he?.data_type||"extension_whatsapp"===he?.data_type||"extension_whatsapp"===he?.type||"individual"==he?.type||"company"==he?.type||"student"==he?.type||"employee"==he?.type||"patient"==he?.type||"extension_merojob"==he?.type||"government"==he?.type||"extension_whatsapp_chat"===he?.data_type)&&(Le=`${he?.crm_data?.name} ${he?.crm_data?.addresses?.[0]?.location||""} ${he?.crm_data?.companyWebsite||""}  ${he?.crm_data?.ceo||""} ${he?.crm_data?.founded||""} ${he?.crm_data?.companySize||""} ${he?.crm_data?.companyRevenue||""} ${he?.crm_data?.about} || ''`,Ze=Le?.toLowerCase());const ct=Ze?.indexOf($.toLowerCase());if(-1!==ct){const Se=Math.max(0,ct-20),rt=Math.min(Ze?.length,ct+$?.length+20);xe=Le?.substring(Se,rt)}else xe="";return{...he,searchedContent:xe}});if(ve?.length){let he=[];ve.forEach(xe=>{let Le=[];Le=xe?.the_entity_type?this.crmService.formatNewEntityContacts([xe],"preview"):xe?.crm_data?this.crmService.formatOldEntityContacts([xe],"preview"):[{...xe}],Le=Le?.map(Ze=>({...Ze,searchedContent:xe.searchedContent,parent:xe.parent})),he=[...he,...Le]}),ee(he)}else ee(ve)})})}moveDataToFolder(se,$,ee,re,le){var ie=this;return(0,qe.Z)(function*(){let ve=localStorage.getItem("profile");ve&&(ve=JSON.parse(ve)),ie.allCapturesInCurrentFolder=[...le];const he=$,xe=he?.filter(Ze=>Ze?.title),Le=he?.filter(Ze=>Ze?.name&&!Ze.type);se.ctrlKey?(xe?.length>0&&(yield ie.copyCapturesToNewFolder(xe,ee.id||ve.userConcept)),Le?.length>0&&ie.validFolderCopy(Le,ee.id||ve.userConcept)&&(yield ie.copyFoldersToNewFolder(Le,ee.id||ve.userConcept)),ie._snackbarService.openSnackBar("Data copied to folder!","success")):(xe?.length>0&&(yield ie.moveCapturesToNewFolder(xe,re||ve.userConcept,ee.id||ve.userConcept)),Le?.length>0&&ie.validFolderMove(Le,ee.id||ve.userConcept)&&(yield ie.moveFoldersToNewFolder(Le,re||ve.userConcept,ee.id||ve.userConcept)),ie._snackbarService.openSnackBar("Data moved to folder!","success"))})()}moveCapturesToNewFolder(se,$,ee){return(0,qe.Z)(function*(){var ie,re=!1,le=!1;try{for(var he,ve=(0,vt.Z)(se);re=!(he=yield ve.next()).done;re=!1){const Bt=he.value;{const Yt=yield(0,R.Mu8)(Number(Bt?.id)),on=yield(0,R.J0M)(Number(Bt?.id)),un=yield(0,R.Mu8)(Number($)),hn=yield(0,R.J0M)(Number(ee)),me=yield(0,R.kqu)(un,Yt,"",je.u,!0);var Ze,xe=!1,Le=!1;try{for(var Se,ct=(0,vt.Z)(me);xe=!(Se=yield ct.next()).done;xe=!1){const ne=Se.value;yield(0,R.TAP)(ne?.id)}}catch(ne){Le=!0,Ze=ne}finally{try{xe&&null!=ct.return&&(yield ct.return())}finally{if(Le)throw Ze}}if("isBoomgpt"in Bt){const ne=yield(0,R.kqu)(un,Yt,"",je.u,!0);var Ft,rt=!1,gt=!1;try{for(var Kt,$t=(0,vt.Z)(ne);rt=!(Kt=yield $t.next()).done;rt=!1){const Y=Kt.value;yield(0,R.TAP)(Y?.id)}}catch(Y){gt=!0,Ft=Y}finally{try{rt&&null!=$t.return&&(yield $t.return())}finally{if(gt)throw Ft}}}yield(0,R.KFq)(hn,on,je.u)}}}catch(Bt){le=!0,ie=Bt}finally{try{re&&null!=ve.return&&(yield ve.return())}finally{if(le)throw ie}}yield R.smK.SyncDataOnline()})()}moveFoldersToNewFolder(se,$,ee){return(0,qe.Z)(function*(){try{var ie,re=!1,le=!1;try{for(var he,ve=(0,vt.Z)(se);re=!(he=yield ve.next()).done;re=!1){const Bt=he.value;{const Yt=yield(0,R.Mu8)(Bt?.id),on=yield(0,R.J0M)(Bt?.id),un=yield(0,R.Mu8)($),hn=yield(0,R.J0M)(ee),me=yield(0,R.kqu)(un,Yt,"",je.u,!0),ne=yield(0,R.kqu)(un,Yt,"",je.NF,!0);var Ze,xe=!1,Le=!1;try{for(var Se,ct=(0,vt.Z)(me);xe=!(Se=yield ct.next()).done;xe=!1){const Y=Se.value;yield(0,R.TAP)(Y?.id)}}catch(Y){Le=!0,Ze=Y}finally{try{xe&&null!=ct.return&&(yield ct.return())}finally{if(Le)throw Ze}}var Ft,rt=!1,gt=!1;try{for(var Kt,$t=(0,vt.Z)(ne);rt=!(Kt=yield $t.next()).done;rt=!1){const Y=Kt.value;yield(0,R.TAP)(Y?.id)}}catch(Y){gt=!0,Ft=Y}finally{try{rt&&null!=$t.return&&(yield $t.return())}finally{if(gt)throw Ft}}yield(0,R.KFq)(hn,on,je.u),yield(0,R.KFq)(hn,on,je.NF)}}}catch(Bt){le=!0,ie=Bt}finally{try{re&&null!=ve.return&&(yield ve.return())}finally{if(le)throw ie}}yield R.smK.SyncDataOnline()}catch(Bt){console.warn(Bt)}})()}validFolderMove(se,$){return se.some(re=>re.id==$)?(this._snackbarService.openSnackBar("Cannot move a folder inside same folder!","error"),!1):!se?.map(re=>{const le=[];return this._folderService.getAllDescendentFolders(re?.id,le,this.allCapturesInCurrentFolder),!le?.length||!le.includes(Number($))||(this._snackbarService.openSnackBar("The destination folder is a subfolder of the source folder.","error"),!1)}).includes(!1)}copyCapturesToNewFolder(se,$){return(0,qe.Z)(function*(){var le,ee=!1,re=!1;try{for(var ve,ie=(0,vt.Z)(se);ee=!(ve=yield ie.next()).done;ee=!1){const he=ve.value;{const xe=yield(0,R.J0M)(he?.id),Le=yield(0,R.J0M)($);yield(0,R.KFq)(Le,xe,je.u)}}}catch(he){re=!0,le=he}finally{try{ee&&null!=ie.return&&(yield ie.return())}finally{if(re)throw le}}yield R.smK.SyncDataOnline()})()}copyFoldersToNewFolder(se,$){return(0,qe.Z)(function*(){try{var le,ee=!1,re=!1;try{for(var ve,ie=(0,vt.Z)(se);ee=!(ve=yield ie.next()).done;ee=!1){const he=ve.value;{const xe=yield(0,R.J0M)($),Le={};Le[ot.co]={...he};const Ze=yield(0,R.joo)(Le);yield(0,R.KFq)(xe,Ze,je.u),yield(0,R.KFq)(xe,Ze,je.NF)}}}catch(he){re=!0,le=he}finally{try{ee&&null!=ie.return&&(yield ie.return())}finally{if(re)throw le}}yield R.smK.SyncDataOnline()}catch(he){console.warn(he)}})()}validFolderCopy(se,$){return se.some(re=>re.id==$)?(this._snackbarService.openSnackBar("Cannot copy a folder inside same folder!","error"),!1):!se?.map(re=>{const le=[];return this._folderService.getAllDescendentFolders(re?.id,le,this.allCapturesInCurrentFolder),!le?.length||!le.includes(Number($))||(this._snackbarService.openSnackBar("The destination folder is a subfolder of the source folder.","error"),!1)}).includes(!1)}uploadDocument(se,$,ee,re){return(0,qe.Z)(function*(){try{const le=yield(0,R.joo)(se,null,null,null,$,null,null),ie=yield(0,R.J0M)(ee);yield(0,R.KFq)(ie,le,je.u);const ve=yield(0,R.J0M)(re);yield(0,R.GIn)(ve,le,je.cx,!0),yield R.smK.SyncDataOnline();const he=yield(0,R.J0M)(le?.id);return{...se?.[ot.rG],id:he?.id}}catch(le){throw console.error("Error uploading document:",le),le}})()}deleteCaptureConnection(se,$,ee,re){var le=this;return(0,qe.Z)(function*(){const ie=yield(0,R.Mu8)(Number(se)),ve=[];for(const he of $){const xe=yield(0,R.Mu8)(Number(he)),Le=yield(0,R.kqu)(ie,xe,"",je.u,!0),Ze=yield(0,R.Mu8)(Number(le.entityId)),ct=yield(0,R.kqu)(Ze,xe,"","the_entity_s_crm_contact_s",!0);yield Promise.all([Le?.map(function(){var rt=(0,qe.Z)(function*(gt){yield(0,R.TAP)(gt?.id)});return function(gt){return rt.apply(this,arguments)}}()),ct?.map(function(){var rt=(0,qe.Z)(function*(gt){yield(0,R.TAP)(gt?.id)});return function(gt){return rt.apply(this,arguments)}}())]);const Se=["extension_indeed","extension_linkedin","extension_monster","extension_maps","extension_whatsapp","extension_merojob","web_crm"];if(Array.isArray(re))for(const rt of re)if(Se.includes(rt)){let gt=rt;gt=gt.replace("extension_","")+"_contact";const Ft=`the_entity_s_${gt}_s`;yield le.searchAndDeleteEntityContact(he,Ft,gt)}ve.push({success:!0,id:he})}return ve})()}searchAndDeleteEntityContact(se,$,ee){var re=this;return(0,qe.Z)(function*(){try{const le=new R.LtL;le.typeConnection=$,le.name="entity";const ie=new R.LtL;ie.typeConnection=$,ie.isOldConnectionType=!0,ie.reverse=!0,ie.name="contact",ie.freeschemaQueries=[le];const ve=new R.LtL;ve.conceptIds=[se],ve.name="top",ve.freeschemaQueries=[ie],ve.selectors=["self"],ve.outputFormat=R.xY7,(0,R.og0)(ve,"").subscribe(function(){var he=(0,qe.Z)(function*(xe){const Le=xe?.[0].id,Ze=xe?.[0]?.data?.boomgpt?.[$+"_reverse"]?.[0]?.id;if(Le==se){const ct=yield(0,R.J0M)(Number(Le)),Se=yield(0,R.J0M)(Number(Ze)),rt=xe?.[0]?.data?.boomgpt?.[$+"_reverse"]?.[0]?.data?.the_entity?.[$];if((yield(0,R.kqu)(Se,ct,ee,"",!0))?.map(function(){var Ft=(0,qe.Z)(function*($t){yield(0,R.TAP)($t?.id)});return function($t){return Ft.apply(this,arguments)}}()),rt&&1==rt?.length){const Ft=yield(0,R.J0M)(Number(re.userConcept));(yield(0,R.kqu)(Ft,Se,"contact","",!0))?.map(function(){var Kt=(0,qe.Z)(function*(Bt){yield(0,R.TAP)(Bt?.id)});return function(Bt){return Kt.apply(this,arguments)}}())}}});return function(xe){return he.apply(this,arguments)}}())}catch{console.error("Error: search and delete Entity Contact")}})()}deleteFolderConnection(se,$){return(0,qe.Z)(function*(){const ee=yield(0,R.Mu8)(Number(se)),re=[];for(const le of $){const ie=yield(0,R.Mu8)(Number(le)),ve=yield(0,R.kqu)(ee,ie,"",je.u,!0),he=yield(0,R.kqu)(ee,ie,"",je.NF,!0);yield Promise.all(he?.map(function(){var xe=(0,qe.Z)(function*(Le){yield(0,R.TAP)(Le?.id)});return function(Le){return xe.apply(this,arguments)}}())),ve?.map(function(){var xe=(0,qe.Z)(function*(Le){yield(0,R.TAP)(Le?.id)});return function(Le){return xe.apply(this,arguments)}}()),re.push({success:!0,id:le})}return re})()}};let Xe=Ve;return Ve.\u0275fac=function($){return new($||Ve)(pe.LFG(q.e),pe.LFG($e.s),pe.LFG(U.o),pe.LFG(st.e),pe.LFG(dt._),pe.LFG(it))},Ve.\u0275prov=pe.Yz7({token:Ve,factory:Ve.\u0275fac,providedIn:"root"}),Xe})()},4383:(wo,Nn,yt)=>{"use strict";yt.d(Nn,{s:()=>Ye});var qe=yt(5861),vt=yt(7899),R=yt(2902),ot=yt(9653);const je=(0,ot.ZF)("mycategories");var st=yt(4650),dt=yt(384),it=yt(8154);let Ye=(()=>{const Ve=class{constructor(se,$,ee){this.authService=se,this.itemService=$,this.store=ee,this.allCategories$=this.store.pipe((0,ot.Ys)((0,ot.P1)(je,Ve=>typeof Ve>"u"?null:Ve.filter(se=>se?.name)))),this.allTotalFolders=[],this.canCreateFolder=!1}nest(se,$=""){return se.filter(ee=>ee?.parent==$).map(ee=>({...ee,children:this.nest(se,ee?.id)}))}getSiblingFolders(se,$){return $.filter(re=>se?re?.parent==se:""==re?.parent).map(re=>re?.name)}getFolderDirectory(se,$,ee=[]){if(se){const re=$.filter(ie=>ie?.id==se)[0],le=re?.parent;ee.unshift(re),le&&this.getFolderDirectory(le,$,ee)}}getNodeDirectory(se,$){const ee=[];let re=[...$];if(se?.length>0)return se.forEach(le=>{const ie=re.filter(ve=>ve?.id==le?.id)[0];ee.push(ie),re=ie?.children}),ee}getAllDescendentFolders(se,$=[],ee){const re=[...ee];for(const le in re)re[le]?.category_parent==se&&($.push(re[le]?.category_name?.toLowerCase()),this.getAllDescendentFolders(re[le]?.id,$,ee))}checkUserSubscription(se){var $=this;return(0,qe.Z)(function*(){return new Promise((ee,re)=>{$.checkDataType=se;const le=$.authService.loadFromLocalStorage();var ie;$.userConceptId=le.userConcept,$.itemService.getMySubscription().subscribe({next:(ie=(0,qe.Z)(function*(ve){$.subscribedPlanId=ve?.pricings?.[0]?.productId;let he="",xe=!1;if(!$.subscribedPlanId){const gt=(yield $.getFreePlanDetails())?.filter($t=>"0"===$t?.internal_product?.data?.price);he=gt[0]?.internal_product?.data?.name,$.subscribedPlanId=Number(gt[0]?.internal_product?.id)}xe=yield $.checkPlanLimitation();let Ze=0,ct=0;"folder"===$.checkDataType?(Ze=Number($.userFolderLimit),ct=$.allTotalFolders.length):"file"===$.checkDataType?(Ze=$.filesUploadLimit,ct=$.uploadedFilesCount):"fileSize"===$.checkDataType&&(Ze=$.filesUploadSizeLimit,ct=0),ee({limit:Ze,createdCount:ct,isAllowedToCreate:xe,subscription:he})}),function(he){return ie.apply(this,arguments)}),error:ie=>{console.error(ie),re(ie)},complete:()=>{}})})})()}checkPlanLimitation(){var se=this;return(0,qe.Z)(function*(){return new Promise($=>{var re;se.itemService.searchLinkMultipleAll([{composition:se.subscribedPlanId,listLinkers:[`${R.$t}_s`,`${R.aJ}_s`,`${R.r}_s`],inpage:100,page:1,logic:"or",filterSearches:[]}]).subscribe({next:(re=(0,qe.Z)(function*(le){if(console.log("RESPONSE",le),se.userFolderLimit=le?.internal_product?.[`internal_product_s_${R.$t}_s`]?.[0]?.[vt.FK]?.data?.limit,se.filesUploadLimit=le?.internal_product?.[`internal_product_s_${R.aJ}_s`]?.[0]?.[vt.aK]?.data?.limit,se.filesUploadSizeLimit=le?.internal_product?.[`internal_product_s_${R.r}_s`]?.[0]?.[vt.s$]?.data?.limit,"folder"===se.checkDataType){const ie=yield se.checkCreatedFolders();$(ie)}else if("file"===se.checkDataType){const ie=yield se.checkUploadFileLimitations();$(ie)}else if("fileSize"===se.checkDataType){const ie=se.filesUploadSizeLimit?.toLowerCase();let ve,he;if(ie&&(ve=ie.includes("mb"),he=ie.includes("gb")),ve){const xe=ie.split("mb"),Le=1024*Number(xe[0]);$(Le)}else if(he){const xe=ie.split("gb"),Le=1024*Number(xe[0])*1024;$(Le)}}}),function(ie){return re.apply(this,arguments)})})})})()}checkUserSubscription_old(se){var $=this;return(0,qe.Z)(function*(){return new Promise((ee,re)=>{$.checkDataType=se;const le=$.authService.loadFromLocalStorage();var ve;$.userConceptId=le.userConcept,$.itemService.getSemanticConnection({compositionId:$.userConceptId,linker:R.PJ+"_s"}).subscribe({next:(ve=(0,qe.Z)(function*(he){let xe="",Le=!1;if(he.count&&he.output.length){const Ft=he?.output?.sort((Kt,Bt)=>{const Yt=new Date(Kt?.data[vt.LI].timestamp).getTime(),on=new Date(Bt?.data[vt.LI].timestamp).getTime();return Number(on)-Number(Yt)});$.subscribedPlanId=Number(Ft[0]?.id),xe=Ft[0]?.data[vt.LI]?.name,Le=yield $.checkLimitation()}else{const $t=(yield $.getFreePlanDetails())?.filter(on=>"0"===on?.internal_product?.data?.price);xe=$t[0]?.internal_product?.data?.name;const Bt=Number($t[0]?.internal_product?.id);Le=yield $.updateUserToFreePackage(Bt)}const ct={...$.authService.loadFromLocalStorage(),pkg:xe};$.authService.saveToLocalStorage(ct);let Se=0,rt=0;"folder"===$.checkDataType?(Se=Number($.userFolderLimit),rt=$.allTotalFolders.length):"file"===$.checkDataType&&(Se=$.filesUploadLimit,rt=$.uploadedFilesCount),ee({limit:Se,createdCount:rt,isAllowedToCreate:Le,subscription:xe,subscriptionId:$.subscribedPlanId})}),function(xe){return ve.apply(this,arguments)}),error:ve=>{console.error(ve),re(ve)},complete:()=>{}})})})()}updateUserToFreePackage(se){var $=this;return(0,qe.Z)(function*(){return new Promise((ee,re)=>{const le={compositionJsons:[{[vt.LI]:{id:se,name:"Free",time:"yearly",price:0,timestamp:(new Date).toISOString(),expireDate:"Never"}}],compositionToJoin:$.userConceptId,direction:"backward",linker:R.PJ,both:!0,count:!0};$.itemService.createCompositionAndLinker(le).subscribe({next:ie=>{const ve=ie?.data[0][vt.LI]?.id;$.subscribedPlanId=ve;const he=$.connectPackageToProductDetails(se);ee(he)},error:ie=>{console.error(ie),re(ie)},complete:()=>{}})})})()}connectPackageToProductDetails(se){var $=this;return(0,qe.Z)(function*(){return new Promise(ee=>{var le;$.itemService.createSemanticConnection({compositionId1:se,compositionId2:$.subscribedPlanId,linker:R.uC}).subscribe({next:(le=(0,qe.Z)(function*(){const ie=yield $.checkLimitation();ee(ie)}),function(){return le.apply(this,arguments)}),error:le=>{console.error(le)},complete:()=>{}})})})()}checkLimitation(){var se=this;return(0,qe.Z)(function*(){return new Promise($=>{var re;se.itemService.searchLinkMultipleAll([{composition:se.userConceptId,listLinkers:[`${R.PJ}_s`],inpage:100,page:1,logic:"or",filterSearches:[]},{listLinkers:[`${R.uC}_by`]},{listLinkers:[`${R.$t}_s`,`${R.aJ}_s`]}]).subscribe({next:(re=(0,qe.Z)(function*(le){const ie=le?.the_user?.the_user_s_get_package_s;if(ie.length){let ve={};if(ve=le?.the_user?.the_user_s_get_package_s[0],ie.length>1&&(ve=ie?.sort((Le,Ze)=>{const ct=new Date(Le[vt.LI]?.data?.timestamp).getTime(),Se=new Date(Ze[vt.LI]?.data?.timestamp).getTime();return Number(Se)-Number(ct)})[0]),ve?.[vt.LI]?.subscription_package_s_package_product_by){const xe=ve?.[vt.LI]?.subscription_package_s_package_product_by?.[0]?.internal_product?.internal_product_s_folder_limit_s?.[0]?.[vt.FK]?.data?.limit;se.userFolderLimit=xe;const Le=ve?.[vt.LI]?.subscription_package_s_package_product_by?.[0]?.internal_product?.internal_product_s_upload_file_limit_s?.[0]?.[vt.aK]?.data?.limit;se.filesUploadLimit=Le}}if("folder"===se.checkDataType){const ve=yield se.checkCreatedFolders();$(ve)}if("file"===se.checkDataType){const ve=yield se.checkUploadFileLimitations();$(ve)}}),function(ie){return re.apply(this,arguments)})})})})()}checkCreatedFolders(){return new Promise((se,$)=>{this.allCategories$.subscribe({next:ee=>{this.allTotalFolders=ee;const re=Number(this.userFolderLimit);this.canCreateFolder=this.allTotalFolders.length<re||!0===isNaN(re),se(this.canCreateFolder)},error:ee=>{console.error(ee),$(ee)}})})}getFreePlanDetails(){return new Promise(se=>{this.itemService.listAllWithoutAuthWithLinker([{type:"internal_product",listLinkers:[`${R.$t}_s`,`${R.aJ}_s`],inpage:100,page:1,logic:"or",filterSearches:[]}]).subscribe({next:ee=>{se(ee)}})})}checkUploadFileLimitations(){return new Promise((se,$)=>{this.itemService.getSemanticConnection({compositionId:this.userConceptId,linker:`${R.cx}_s`}).subscribe({next:re=>{const le=re?.output;this.uploadedFilesCount=le?le.length:0;let ie=!1;const ve=Number(this.filesUploadLimit);ie=this.uploadedFilesCount<ve||!0===isNaN(ve),se(ie)},error:re=>{console.error(re),$(re)}})})}checkUploadFileLimitations_old(){return new Promise((se,$)=>{this.itemService.searchLinkMultipleAll([{composition:this.userConceptId,listLinkers:[`${R.cx}_s`],inpage:100,page:1,logic:"or",filterSearches:[]}]).subscribe({next:re=>{const le=re?.the_user?.[`the_user_s_${R.cx}_s`];this.uploadedFilesCount=le?le.length:0;let ie=!1;const ve=Number(this.filesUploadLimit);ie=this.uploadedFilesCount<ve||!0===isNaN(ve),se(ie)},error:re=>{console.error(re),$(re)}})})}};let Xe=Ve;return Ve.\u0275fac=function($){return new($||Ve)(st.LFG(dt.e),st.LFG(it.e),st.LFG(ot.yh))},Ve.\u0275prov=st.Yz7({token:Ve,factory:Ve.\u0275fac,providedIn:"root"}),Xe})()},9808:(wo,Nn,yt)=>{"use strict";yt.d(Nn,{n:()=>vt});var qe=yt(6805);function vt(R,ot){const je="object"==typeof ot;return new Promise((Wt,pe)=>{let $e,q=!1;R.subscribe({next:U=>{$e=U,q=!0},error:pe,complete:()=>{q?Wt($e):je?Wt(ot.defaultValue):pe(new qe.K)}})})}},6636:wo=>{self,wo.exports=(()=>{"use strict";var Nn={26:function(vt,R,ot){var je=this&&this.__createBinding||(Object.create?function(me,ne,Y,X){void 0===X&&(X=Y);var Q=Object.getOwnPropertyDescriptor(ne,Y);Q&&!("get"in Q?!ne.__esModule:Q.writable||Q.configurable)||(Q={enumerable:!0,get:function(){return ne[Y]}}),Object.defineProperty(me,X,Q)}:function(me,ne,Y,X){void 0===X&&(X=Y),me[X]=ne[Y]}),Wt=this&&this.__setModuleDefault||(Object.create?function(me,ne){Object.defineProperty(me,"default",{enumerable:!0,value:ne})}:function(me,ne){me.default=ne}),pe=this&&this.__importStar||function(me){if(me&&me.__esModule)return me;var ne={};if(null!=me)for(var Y in me)"default"!==Y&&Object.prototype.hasOwnProperty.call(me,Y)&&je(ne,me,Y);return Wt(ne,me),ne},q=this&&this.__awaiter||function(me,ne,Y,X){return new(Y||(Y=Promise))(function(Q,W){function J(Ce){try{ge(X.next(Ce))}catch(Pe){W(Pe)}}function oe(Ce){try{ge(X.throw(Ce))}catch(Pe){W(Pe)}}function ge(Ce){var Pe;Ce.done?Q(Ce.value):(Pe=Ce.value,Pe instanceof Y?Pe:new Y(function(Je){Je(Pe)})).then(J,oe)}ge((X=X.apply(me,ne||[])).next())})};Object.defineProperty(R,"__esModule",{value:!0}),R.handleAddSharedWithMeFolder=R.getPathToFolder=R.deleteFolder=R.createFolder=R.setCurrentFolderId=R.updateSelectedFolders=R.insertFolderListItem=R.handleFolderRightOption=R.getAllFolders=R.nestedInsertFolderTree=R.addEventListenerToCheckboxElement=R.folderToggler=R.createNestedTreeAndAddToDOM=R.currentFolderId=R.globalFolders=R.selectedFolders=void 0;const $e=pe(ot(215)),U=ot(793),st=pe(ot(793)),dt=ot(726),it=ot(777),Ye=ot(356);R.selectedFolders=[],R.globalFolders=[];let Xe=[],Ve={},Nt=[],se=!1,$=!1,ee=!1,re=[],le=[];function ie(me){return q(this,void 0,void 0,function*(){try{const ne=me.querySelectorAll(`#${U.myprefix}category_list_tree`);if(!ne.length)return;me.getElementById(`${U.myprefix}loader`);const Y=yield $e.getUser();ne?.forEach(X=>{for(var Q;X?.firstChild;)null===(Q=X?.firstChild)||void 0===Q||Q.remove();let W=me.querySelectorAll(`.${U.myprefix}root_folder`);W?.length>0&&W.forEach(ge=>ge?.remove());let J=document.createElement("div");J.classList.add(`${U.myprefix}root_folder`),J.textContent="Boom",J.addEventListener("contextmenu",ge=>{ge.preventDefault(),oe?.params.disableRightClick||rt(ge,me,!1)});const oe=(0,Ye.getCurrentTreeParams)(me);Ft(J,oe),gt(J,oe),X.before(J),console.log("Folder MS Completed Adding root listeners"),xe(X,Y.userConcept,me,oe),console.log("Folder MS Completed Adding nested tree"),ve(me)}),Yt(me)}catch(ne){console.error("Error in creating nested tree",ne)}})}function ve(me){let ne=me.querySelectorAll(`.${U.myprefix}toggler`);for(let Y=0;Y<ne.length;Y++)ne[Y].addEventListener("click",function(){this.parentElement.querySelector(`.${U.myprefix}submenuLevel`).classList.toggle(`${U.myprefix}active`);let X=this.parentElement.querySelector(`.${U.myprefix}openFolderContent`).getAttribute("data-folder-id");Xe=Xe.includes(X)?Xe.filter(Q=>Q!==X):[...Xe,X]})}function he(me){me?.addEventListener("change",ne=>{null!=R.selectedFolders&&R.selectedFolders.some(Y=>Y.id==ne.target.value)?R.selectedFolders=null==R.selectedFolders?void 0:R.selectedFolders.filter(Y=>Y.id!=ne.target.value):R.selectedFolders.push({name:ne.target.name,id:ne.target.value})})}function xe(me,ne,Y,X,Q=!1){var W,J,oe,ge;try{const Ce=le.find(Fe=>"the_user_s_read_access"==Fe.characterValue),Pe=new Map;Nt.filter(Fe=>{var nt,wt;return 1==ne?Ce?.id==Fe.typeId&&(null===(wt=null===(nt=Ve?.[Fe.toTheConceptId])||void 0===nt?void 0:nt.data)||void 0===wt?void 0:wt.boomFolder):Fe.ofTheConceptId==ne&&Ce?.id!=Fe.typeId}).sort((Fe,nt)=>{var wt,pt,Ut,Zt;if(1===Fe.toTheConceptId)return 1;if(1===nt.toTheConceptId)return-1;const Rt=Ve?.[Fe.toTheConceptId],jt=Ve?.[nt.toTheConceptId],Pt=(null===(pt=null===(wt=Rt?.data)||void 0===wt?void 0:wt[dt.boomFolderComposition])||void 0===pt?void 0:pt.name)||"",Xt=(null===(Zt=null===(Ut=jt?.data)||void 0===Ut?void 0:Ut[dt.boomFolderComposition])||void 0===Zt?void 0:Zt.name)||"";return Pt?.localeCompare(Xt||"")}).map(Fe=>{const nt=`${Fe.ofTheConceptId}-${Fe.toTheConceptId}`;Pe.has(nt)||Pe.set(nt,Fe)});const Je=Array.from(Pe.values());let He=0;for(let Fe=0;Fe<Je.length;Fe++){let nt=Je[Fe],wt=Ve[nt.toTheConceptId],pt=wt?.id,Ut="";if(!(null===(W=wt?.data)||void 0===W)&&W[dt.boomFolderComposition]&&(Ut=null===(oe=null===(J=wt?.data)||void 0===J?void 0:J[dt.boomFolderComposition])||void 0===oe?void 0:oe.name),!Ut||!pt){He+=1;continue}let Zt=Se(me,pt,Ut,Y,X,Q);null!==(ge=X?.params)&&void 0!==ge&&ge.showCheckbox&&he(Zt);let Rt=!1;if(1==nt.id&&Nt.some(jt=>{var Pt,Xt;return Ce?.id==jt.typeId&&(null===(Xt=null===(Pt=Ve?.[jt.toTheConceptId])||void 0===Pt?void 0:Pt.data)||void 0===Xt?void 0:Xt.boomFolder)})&&(Rt=!0),Nt.some(jt=>nt.toTheConceptId==jt.ofTheConceptId)||Rt){let jt=me.querySelectorAll(":scope > li")[Fe-He];jt.setAttribute("class",`${U.myprefix}has_submenu`);let Pt=document.createElement("ul"),Xt=document.createElement("span");Xt.setAttribute("class",`${U.myprefix}toggler`),Pt.setAttribute("class",`${U.myprefix}submenuLevel`),(Xe.includes(wt.id.toString())||R.currentFolderId==pt)&&Pt.classList.add(`${U.myprefix}active`),jt.append(Pt);let wn=jt.querySelectorAll("ul")[0];jt.insertBefore(Xt,wn),xe(wn,nt.toTheConceptId,Y,X,!!Rt||Q)}}}catch(Ce){console.error("FolderMS nested Intert Folder Error:",Ce)}}function Le(me,ne){return q(this,void 0,void 0,function*(){it.Logger.logfunction("getAllFolders");try{$=!0;const X=(yield $e.getUser())?.userConcept;let Q=yield(0,it.RecursiveSearchApiRaw)(X,[],"",["the_boom_folder_s_folder","the_user_s_read_access"]);console.log("FolderMS",Q);let W=Q.compositionIds,J=Q.internalConnections,oe=Q.externalConnections,ge=yield(0,it.GetCompositionFromConnectionsWithDataIdIndex)(W,J),Ce=yield(0,it.GetConnectionBulk)(oe),Pe=[],Je=[],He=[];Ve=ge,Nt=yield Promise.all(Ce.filter(Fe=>{var nt;const wt=`${Fe.ofTheConceptId}-${Fe.toTheConceptId}`,pt=`${Fe.toTheConceptId}-${Fe.ofTheConceptId}`;if(He.includes(wt))return!1;He.push(wt),He.push(pt),Pe.includes(Fe.typeId)||Pe.push(Fe.typeId);const Ut=Ve?.[Fe.toTheConceptId];return!(null===(nt=Ut?.data)||void 0===nt||!nt[dt.boomFolderComposition])}));for(let Fe=0;Fe<Pe.length;Fe++)Je.push((0,it.GetTheConcept)(Pe[Fe]));if(le=yield Promise.all(Je),yield un(X,me,ne),yield function(Fe,nt,wt){var pt,Ut,Zt,Rt;return q(this,void 0,void 0,function*(){it.Logger.logfunction("setGlobalFolders",[nt]);let jt=[];for(let Pt=0;Pt<Fe.length;Pt++){const Xt=Fe[Pt],wn=wt[Xt.toTheConceptId];null!==(Ut=null===(pt=wn?.data)||void 0===pt?void 0:pt[dt.boomFolderComposition])&&void 0!==Ut&&Ut.name&&jt.push({id:Xt.toTheConceptId,name:(null===(Rt=null===(Zt=wn?.data)||void 0===Zt?void 0:Zt[dt.boomFolderComposition])||void 0===Rt?void 0:Rt.name)||"",parent:Xt.ofTheConceptId==nt?"":Xt.ofTheConceptId.toString()})}R.globalFolders=jt?.filter(Pt=>Pt&&Pt?.name),R.globalFolders=null==R.globalFolders?void 0:R.globalFolders.sort(function(Pt,Xt){var wn,Fo;let ii=null===(wn=Pt?.name)||void 0===wn?void 0:wn.toLowerCase(),ri=null===(Fo=Xt?.name)||void 0===Fo?void 0:Fo.toLowerCase();return ii.localeCompare(ri)})})}(Ce,X,ge),console.log("FolderMS fetched all folders adding to tree"),ee=!0,$=!1,me){const Fe=(0,Ye.getShadowRoot)(me);if(!Fe)return R.globalFolders;yield ie(Fe)}else ne&&(yield ie(ne));return R.globalFolders}catch(Y){console.error("Error in fetching folders",Y)}})}function Ze(me,ne,Y,X=!1){var Q,W;Xe=[...Xe,ne.toString()];let J=Y.querySelectorAll(`#${U.myprefix}new_category_wrapper`);J?.length>0&&J.forEach(Rt=>Rt?.remove());let oe=document.createElement("div");oe.setAttribute("id",`${U.myprefix}new_category_wrapper`);let ge=document.createElement("input");ge.setAttribute("type","text"),ge.setAttribute("id",`${U.myprefix}new_category_input`),ge.setAttribute("class",`${U.myprefix}field_input`),ge.setAttribute("placeholder","New Folder name");const Ce="New Folder";let Pe=R.globalFolders.filter(Rt=>Rt?.parent==ne).filter(Rt=>{let jt=Rt?.name;return Rt?.parent==ne&&jt.match(/^New Folder \([0-9]*\)/gm)||jt.match(/^New Folder/gm)}),Je=Pe.sort((Rt,jt)=>{var Pt,Xt;return(null===(Pt=Rt?.name)||void 0===Pt?void 0:Pt.replace(/\D/g,""))-(null===(Xt=jt?.name)||void 0===Xt?void 0:Xt.replace(/\D/g,""))}),Fe=(null===(Q=Je[Je.length-1])||void 0===Q?void 0:Q.name)?.replace(/\D/g,"");ge.value=Pe.length>0?Ce+` (${Number(Fe)+1})`:Ce,X&&(ge.value=me.getAttribute("data-name"));let nt=document.createElement("div");nt.setAttribute("class",`${U.myprefix}field_error`);let wt=document.createElement("div");wt.setAttribute("class",`${U.myprefix}field_success`);let pt=document.createElement("input");pt.setAttribute("type","button"),pt.setAttribute("id",`${U.myprefix}new_category_button`),pt.setAttribute("value","Save");let Ut=document.createElement("input");if(Ut.setAttribute("type","button"),Ut.setAttribute("id",`${U.myprefix}small_close_button`),Ut.setAttribute("value","Close"),oe.append(ge),oe.append(nt),oe.append(pt),oe.append(Ut),X){const Rt=R.globalFolders.find(Pt=>Pt.id.toString()==me.getAttribute("data-id"));Y.querySelector(`[data-id="${Rt.id}"]`)?.insertAdjacentElement("afterend",oe)}else me?.append(oe);ge.focus(),ge.select();let Zt=!1;ge.addEventListener("focusout",Rt=>{Zt?Zt=!1:ct(ne,ge,oe,nt,wt,Y,X)}),ge.addEventListener("keyup",Rt=>{"Escape"==Rt.key?(Zt=!0,oe?.remove(),setTimeout(()=>{Zt&&(Zt=!1)},200)):"Enter"==Rt.key&&ct(ne,ge,oe,nt,wt,Y,X)}),null===(W=document.querySelectorAll(`.${U.myprefix}sidebar_body`)[0])||void 0===W||W.append(wt),pt.addEventListener("click",Rt=>q(this,void 0,void 0,function*(){return ct(ne,ge,oe,nt,wt,Y,X)})),Ut.addEventListener("click",Rt=>{oe?.remove()})}function ct(me,ne,Y,X,Q,W,J){if(se)return;se=!0;const oe=R.globalFolders.find(Ce=>Ce.id==me);let ge=!1;if(J?oe&&oe?.name&&"Contacts"!=oe.name&&"Projects"!=oe.name&&"Chats"!=oe.name&&(ge=""!=ne.value.trim()&&!(null!=R.globalFolders&&R.globalFolders.some(Ce=>Ce?.name==ne.value.trim()&&Ce?.parent==oe.parent))):ge=""!=ne.value.trim()&&!(null!=R.globalFolders&&R.globalFolders.some(Ce=>Ce?.name==ne.value.trim()&&Ce?.parent==me)),!J&&ge){let Ce={};Ce=me?{name:ne.value.trim(),parent:me}:{name:ne.value.trim(),parent:""},Y?.remove(),q(this,void 0,void 0,function*(){yield Kt(Ce.name,""==Ce.parent?void 0:parseInt(Ce.parent),W),Q.innerHTML="New Folder Created!",setTimeout(()=>{Q.remove()},2500),X.innerHTML=""})}else J&&ge?q(this,void 0,void 0,function*(){var Ce;const Pe=Ve[oe.id],Je=new it.PatcherStructure;Je.compositionId=oe.id,!(null===(Ce=Pe?.data)||void 0===Ce)&&Ce.boomFolder&&(Je.patchObject={name:ne.value.trim()},Ve[oe.id].data.boomFolder.name=ne.value.trim()),R.globalFolders=R.globalFolders.map(He=>He.id==oe.id?Object.assign(Object.assign({},He),{name:ne.value.trim()}):He),setTimeout(()=>{if(Y?.parentNode)try{Y?.remove()}catch(He){console.log(He)}},0),yield ie(W),yield(0,it.UpdateCompositionLocal)(Je),$t({id:oe.id,name:ne.value,parent:oe.parent},"update"),Q.innerHTML="Updated Folder!",setTimeout(()=>{Q?.remove()},2500),X.innerHTML="",setTimeout(()=>q(this,void 0,void 0,function*(){yield Le(void 0,W)}),500)}):J&&!ge?(console.log(Y,"formwrapper not allwoed but is update"),Q.innerHTML="",X.innerHTML="Folder already exists or not valid."):(Q.innerHTML="",X.innerHTML="Folder already exists or not valid.");se=!1}function Se(me,ne,Y,X,Q,W=!1){var J,oe;let ge=document.createElement("li");ge.setAttribute("data-id",ne),ge.setAttribute("data-name",Y);let Ce=document.createElement("label"),Pe=null;var He;Q.params.showCheckbox&&(Pe=document.createElement("input"),Pe.setAttribute("type","checkbox"),Pe.setAttribute("id",U.myprefix+Y),Pe.setAttribute("value",ne),Pe.setAttribute("name",Y),Pe.checked=(He=ne,!!Array.isArray(R.selectedFolders)&&!(null==R.selectedFolders||!R.selectedFolders.find(Fe=>Fe.id==He))),Pe.setAttribute("class",`${U.myprefix}folder_checkbox`),(null!==(J=parseInt(ne))&&void 0!==J?J:0)<0&&(Pe.style.display="none"),Ce.append(Pe)),!(null===(oe=Q?.params)||void 0===oe)&&oe.onCurrentFolderChange&&R.currentFolderId==parseInt(ne)&&Ce.classList.add(`${U.myprefix}current_folder`),Ft(Ce,Q),"1"!=ne&&gt(ge,Q),ge.append(Ce);const Je=document.createElement("span");return Je.innerText=Y,Je.classList.add(U.myprefix+"openFolderContent"),Je.setAttribute("data-folder-id",ne),Ce.append(Je),Ce.addEventListener("contextmenu",He=>{var Fe;He.preventDefault(),"1"==ne||null!==(Fe=Q?.params)&&void 0!==Fe&&Fe.disableRightClick||W||rt(He,X)}),me.append(ge),Pe}function rt(me,ne,Y=!0){var X,Q,W,J,oe;null===(X=ne.getElementById(`${U.myprefix}folder_actions`))||void 0===X||X.remove();const ge=me.currentTarget.parentElement;let Ce=ge.getAttribute("data-id"),Pe=me.pageY+5-window.scrollY,Je=me.pageX+5-window.scrollX;window.innerHeight>200&&window.innerHeight-Pe<115?Pe-=125:window.innerWidth>300&&window.innerWidth-Je<130&&(Je-=125);let He=`\n  <div id="${U.myprefix}folder_actions" \n    style="top: ${Pe}px; left: ${Je}px;">\n    <ul>\n      <li><a id="${U.myprefix}folder_action_create" role="button">New Folder</a></li>\n      ${Y?`\n        <li><a id="${U.myprefix}folder_action_rename" role="button">Rename Folder</a></li>\n        <li><a id="${U.myprefix}folder_action_delete" role="button">Delete Folder</a></li>\n        `:""}\n    </ul>\n  </div>\n  `;null===(Q=ne.querySelector(`.${U.myprefix}boom_sidebar`))||void 0===Q||Q.insertAdjacentHTML("beforeend",He);const Fe=()=>{var nt;null===(nt=ne.getElementById(`${U.myprefix}folder_actions`))||void 0===nt||nt.remove(),window.removeEventListener("click",Fe)};window.addEventListener("click",Fe),ne.addEventListener("click",nt=>{var wt,pt;null!==(wt=ne.querySelector(`.${U.myprefix}boom_sidebar #${U.myprefix}folder_actions`))&&void 0!==wt&&wt.contains(nt.target)||null===(pt=ne.getElementById(`${U.myprefix}folder_actions`))||void 0===pt||pt.remove()}),null===(W=ne.getElementById(`${U.myprefix}folder_action_create`))||void 0===W||W.addEventListener("click",()=>{var nt;Ze(ge,Ce,ne),null===(nt=ne.getElementById(`${U.myprefix}folder_actions`))||void 0===nt||nt.remove()}),null===(J=ne.getElementById(`${U.myprefix}folder_action_rename`))||void 0===J||J.addEventListener("click",()=>{Ze(ge,Ce,ne,!0)}),null===(oe=ne.getElementById(`${U.myprefix}folder_action_delete`))||void 0===oe||oe.addEventListener("click",()=>q(this,void 0,void 0,function*(){var nt,wt,pt;null===(nt=ne.getElementById(`${U.myprefix}folder_actions`))||void 0===nt||nt.remove();const Ut=R.globalFolders.find(Rt=>Rt.id==parseInt(Ce));let Zt=(0,Ye.getCurrentTreeParams)(ne);null!==(wt=Zt?.params)&&void 0!==wt&&wt.manualDeleteFn?null===(pt=Zt?.params)||void 0===pt||pt.manualDeleteFn(Ut):(yield Bt(Ut,ne),yield Le(void 0,ne))}))}function gt(me,ne){var Y;null!=(null===(Y=ne?.params)||void 0===Y?void 0:Y.dropFn)&&(me.addEventListener("dragover",X=>{var Q,W,J,oe;if(X.preventDefault(),null===(Q=X.currentTarget)||void 0===Q||!Q.querySelector(`.${U.myprefix}dragover`)){let ge=document.createElement("div");null===(W=ge?.classList)||void 0===W||W.add(`${U.myprefix}dragover`),X.currentTarget.querySelector("label")?null===(J=X.currentTarget.querySelector("label"))||void 0===J||J.insertAdjacentElement("afterend",ge):null===(oe=X.currentTarget)||void 0===oe||oe.append(ge)}}),me.addEventListener("dragleave",X=>{var Q,W;X.preventDefault(),null===(W=null===(Q=X.currentTarget)||void 0===Q?void 0:Q.querySelector(`.${U.myprefix}dragover`))||void 0===W||W.remove()}),me.addEventListener("drop",X=>{var Q,W,J,oe;X.preventDefault(),X.stopPropagation(),null===(W=null===(Q=X.currentTarget)||void 0===Q?void 0:Q.querySelector(`.${U.myprefix}dragover`))||void 0===W||W.remove();let ge=R.globalFolders.find(Ce=>Ce.id.toString()==X.currentTarget.getAttribute("data-id"));ge||(ge={id:void 0,name:void 0}),null!==(J=ne?.params)&&void 0!==J&&J.dropFn&&(null===(oe=ne?.params)||void 0===oe||oe.dropFn(X,ge))}))}function Ft(me,ne){var Y,X,Q,W,J;if(null!==(Y=ne?.params)&&void 0!==Y&&Y.onCurrentFolderChange){me.addEventListener("click",ge=>{var Ce,Pe,Je,He;const Fe=null===(Ce=ge?.currentTarget)||void 0===Ce?void 0:Ce.parentElement,nt=Fe?.getAttribute("data-id");if("li"==Fe.tagName.toLowerCase()&&Fe.querySelector(":scope > ul")){null===(Pe=Fe.querySelector(":scope > ul"))||void 0===Pe||Pe.classList.add(`${U.myprefix}active`);let wt=Fe.getAttribute("data-id");Xe=[...Xe,wt]}null!==(Je=ne?.params)&&void 0!==Je&&Je.onCurrentFolderChange&&(null===(He=ne?.params)||void 0===He||He.onCurrentFolderChange(nt?parseInt(nt):void 0))});const oe=document.createElement("span");oe.classList.add(`${U.myprefix}clickable_folder_icon_placeholder`),me.prepend(oe),"span"==(null===(X=me?.tagName)||void 0===X?void 0:X.toLowerCase())&&"li"==(null===(W=null===(Q=me?.parentElement)||void 0===Q?void 0:Q.tagName)||void 0===W?void 0:W.toLowerCase())&&null!==(J=me?.parentElement)&&void 0!==J&&J.querySelector(":scope > ul")&&me.parentElement.addEventListener("click",ge=>{var Ce,Pe,Je,He;const Fe=null===(Ce=ge?.currentTarget)||void 0===Ce?void 0:Ce.parentElement,nt=Fe?.getAttribute("data-id");if("li"==Fe.tagName.toLowerCase()&&Fe.querySelector(":scope > ul")){null===(Pe=Fe.querySelector(":scope > ul"))||void 0===Pe||Pe.classList.add(`${U.myprefix}active`);let wt=Fe.getAttribute("data-id");Xe=[...Xe,wt]}null!==(Je=ne?.params)&&void 0!==Je&&Je.onCurrentFolderChange&&(null===(He=ne?.params)||void 0===He||He.onCurrentFolderChange(nt?parseInt(nt):void 0))})}}function $t(me,ne){const Y=document.createEvent("Event");Y.initEvent("onBCFolderCreated",!0,!0),Y.folder=me,Y.actionType=ne,document.dispatchEvent(Y)}function Kt(me,ne,Y){var X,Q,W;return q(this,void 0,void 0,function*(){const J=new it.LocalTransaction;try{yield J.initialize(),Date.now();const oe=ne||st.config.userConcept;if(re.some(pt=>pt.name==me&&pt.parent==oe))for(;re.some(pt=>pt.name==me&&pt.parent==oe);)yield hn(100);re.push({name:me,parent:oe});let ge=R.globalFolders.find(pt=>pt.name==me&&pt.parent==oe);if(ge)return(0,it.GetTheConceptLocal)(ge.id);let Ce,Pe,Je=!1;const He=yield $e.getUser();if(ne){if("Projects"==(null===(Q=null===(X=Ve[ne]?.data)||void 0===X?void 0:X[dt.boomFolderComposition])||void 0===Q?void 0:Q.name)&&ne==He.userConcept){Je=!0;const Ut=yield $e.createProject({title:me});Ce=null===(W=Ut?.data)||void 0===W?void 0:W.projectId,Pe=yield(0,it.GetTheConceptLocal)(Ce)}}else ne=He.userConcept;let Fe;if(!Je){const pt={[dt.boomFolderComposition]:{name:me,parent:He.userConcept!=ne?ne:""}};Pe=yield J.CreateTheCompositionLocal(pt),Ce=Pe.id;const Ut=yield(0,it.GetTheConcept)(ne||He.userConcept);yield J.CreateConnection(Ut,Pe,"the_boom_folder_s_contain");const Zt=yield J.CreateConnection(Ut,Pe,"the_boom_folder_s_folder");Nt.push(Zt),Ve[Pe.id.toString()]={id:Pe.id,data:pt},Fe=J.commitTransaction()}let nt={id:Ce,name:me,parent:ne||""};R.globalFolders.push(nt),re=re.filter(pt=>pt.name!=me&&pt.parent!=oe),Y&&(yield ie(Y)),null!=Fe&&(yield Fe);const wt=yield(0,it.GetTheConceptLocal)(Pe.id);return wt>0&&(nt.id=wt.id),$t(nt,"create"),Y&&setTimeout(()=>q(this,void 0,void 0,function*(){yield Le(void 0,Y)}),50),wt||void 0}catch(oe){console.error("Error in creating folder",oe),J.rollbackTransaction()}})}function Bt(me,ne){var Y,X,Q;return q(this,void 0,void 0,function*(){try{let W=me.parent;if(ee||(yield Le()),!me)return;W=W?parseInt(W):st.config.userConcept;let J=Nt.filter(oe=>oe.ofTheConceptId==W&&oe.toTheConceptId==me.id);for(let oe=0;oe<J.length;oe++){const ge=J[oe];yield(0,it.DeleteConnectionById)(ge.id)}if((yield(0,it.GetTheConcept)(me.id)).userId==st.config.userId&&(yield(0,it.DeleteConceptById)(me.id)),yield it.SyncData.SyncDataOnline(),R.globalFolders=R.globalFolders.filter(oe=>oe.id!=me.id),$t(me,"delete"),ne){const oe=ne.querySelector(`li[data-id="${me.id}"]`);0==(null===(X=null===(Y=oe?.querySelector(":scope > ul"))||void 0===Y?void 0:Y.children)||void 0===X?void 0:X.length)&&(oe?.querySelector(`${U.myprefix}toggler`),null===(Q=oe?.querySelector(":scope > ul"))||void 0===Q||Q.remove()),oe?.remove()}return!0}catch(W){console.error("Error in deleting folder",W)}})}function Yt(me){var ne,Y,X,Q;if(R.currentFolderId){let W=me.querySelector(`[data-id="${R.currentFolderId}"]`);for(;W?.closest("li");){null===(X=null===(Y=null===(ne=W?.closest("li"))||void 0===ne?void 0:ne.querySelector(":scope > ul"))||void 0===Y?void 0:Y.classList)||void 0===X||X.add(`${U.myprefix}active`);const J=W.getAttribute("data-id");J&&(Xe=[...Xe,J]),W=(null===(Q=W.parentElement)||void 0===Q?void 0:Q.closest("li"))||null}}}function on(me){var ne,Y,X;let Q={};return!(null===(ne=me?.data)||void 0===ne)&&ne[dt.boomFolderComposition]&&(Q={id:me.id,name:null===(X=null===(Y=me?.data)||void 0===Y?void 0:Y[dt.boomFolderComposition])||void 0===X?void 0:X.name}),Q}function un(me,ne,Y){var X;return q(this,void 0,void 0,function*(){let Q;it.Logger.logfunction("handleAddSharedWithMeFolder",[me]),ne?Q=(0,Ye.getRenderTreeSidebarOption)(ne):Y&&(Q=(0,Ye.getCurrentTreeParams)(Y)),(null===(X=Q?.params)||void 0===X?void 0:X.sharedFolder)&&(Ve[1]={id:1,data:{[dt.boomFolderComposition]:{name:"Shared With Me",parent:""}}},Nt.push({id:1,ofTheConceptId:me,toTheConceptId:1,userId:0,mainKey:0,orderId:1e3,typeId:100201749,accessId:0}))})}function hn(me){return new Promise(ne=>setTimeout(ne,me))}R.createNestedTreeAndAddToDOM=ie,R.folderToggler=ve,R.addEventListenerToCheckboxElement=he,R.nestedInsertFolderTree=xe,R.getAllFolders=Le,R.handleFolderRightOption=Ze,R.insertFolderListItem=Se,R.updateSelectedFolders=function(me){R.selectedFolders=me||[]},R.setCurrentFolderId=function(me,ne){var Y,X;if(R.currentFolderId!=me&&(R.currentFolderId=me,ne)){const Q=(0,Ye.getShadowRoot)(ne);let W=Q?.querySelectorAll("[data-id]");W?.forEach(J=>{var oe,ge;"li"==J.tagName.toLowerCase()&&(null===(ge=null===(oe=J.querySelector(":scope > label"))||void 0===oe?void 0:oe.classList)||void 0===ge||ge.remove(`${U.myprefix}current_folder`))}),R.currentFolderId&&(null===(X=null===(Y=Q?.querySelector(`[data-id="${R.currentFolderId}"]`))||void 0===Y?void 0:Y.querySelector(":scope > label"))||void 0===X||X.classList.add(`${U.myprefix}current_folder`),Q&&Yt(Q))}},R.createFolder=Kt,R.deleteFolder=Bt,R.getPathToFolder=function(me){var ne,Y,X;return q(this,void 0,void 0,function*(){try{if(!me||me==st.config.userConcept)return[];ee||(yield Le());let Q=me,W=[];const J={id:1,name:"Shared With Me"};if(1==me||"1"==me.toString())return[J];for(;$;)yield hn(500);for(;st.config.userConcept&&Q&&Q!=st.config.userConcept;){let oe=R.globalFolders.find(ge=>ge.id==Q);oe&&W.push({id:oe.id,name:oe.name}),Q=oe?.parent}if(W.length>0){const oe=le.find(ge=>"the_user_s_read_access"==ge.characterValue);Nt.find(ge=>ge.ofTheConceptId==st.config.userConcept&&ge.toTheConceptId==W?.[W.length-1].id&&ge.typeId==oe?.id)&&W.push(J)}if(0==W.length){const oe=yield(0,it.GetLink)(st.config.userConcept,"read_access_s",100,1),ge=oe.map(He=>He.id);if(ge.includes(me)){const He=oe.find(Fe=>Fe.id=me);return[J,{id:He.id,name:null===(Y=null===(ne=He?.data)||void 0===ne?void 0:ne.boomFolder)||void 0===Y?void 0:Y.name}]}const Ce=on(yield(0,it.GetCompositionWithId)(me));if(!Ce?.id)return[];W.push({id:Ce?.id,name:Ce?.name});let Pe=me,Je=0;for(;Pe&&Je<10;){Je++;const He=yield(0,it.GetLink)(Pe,"console_folder_by");if(null!==(X=He?.[0])&&void 0!==X&&X.id){const Fe=on(He[0]);if(Fe.id&&Fe.name&&W.push({id:Fe?.id,name:Fe?.name}),Pe=Fe?.id,ge.includes(Pe))break}else Pe=void 0}W.push(J)}return W.reverse()}catch(Q){console.error("Error in getting path to folder",Q)}})},R.handleAddSharedWithMeFolder=un},156:function(vt,R,ot){var je=this&&this.__createBinding||(Object.create?function(Ye,Xe,Ve,Nt){void 0===Nt&&(Nt=Ve);var se=Object.getOwnPropertyDescriptor(Xe,Ve);se&&!("get"in se?!Xe.__esModule:se.writable||se.configurable)||(se={enumerable:!0,get:function(){return Xe[Ve]}}),Object.defineProperty(Ye,Nt,se)}:function(Ye,Xe,Ve,Nt){void 0===Nt&&(Nt=Ve),Ye[Nt]=Xe[Ve]}),Wt=this&&this.__setModuleDefault||(Object.create?function(Ye,Xe){Object.defineProperty(Ye,"default",{enumerable:!0,value:Xe})}:function(Ye,Xe){Ye.default=Xe}),pe=this&&this.__importStar||function(Ye){if(Ye&&Ye.__esModule)return Ye;var Xe={};if(null!=Ye)for(var Ve in Ye)"default"!==Ve&&Object.prototype.hasOwnProperty.call(Ye,Ve)&&je(Xe,Ye,Ve);return Wt(Xe,Ye),Xe},q=this&&this.__awaiter||function(Ye,Xe,Ve,Nt){return new(Ve||(Ve=Promise))(function(se,$){function ee(ie){try{le(Nt.next(ie))}catch(ve){$(ve)}}function re(ie){try{le(Nt.throw(ie))}catch(ve){$(ve)}}function le(ie){var ve;ie.done?se(ie.value):(ve=ie.value,ve instanceof Ve?ve:new Ve(function(he){he(ve)})).then(ee,re)}le((Nt=Nt.apply(Ye,Xe||[])).next())})};Object.defineProperty(R,"__esModule",{value:!0}),R.FolderTreeModule=R.hasInitialized=R.globalFolders=R.selectedFolders=void 0;const $e=pe(ot(793)),U=ot(777);var st=ot(26);Object.defineProperty(R,"selectedFolders",{enumerable:!0,get:function(){return st.selectedFolders}});var dt=ot(26);Object.defineProperty(R,"globalFolders",{enumerable:!0,get:function(){return dt.globalFolders}}),R.hasInitialized=!1,R.default=function(Ye){return q(this,void 0,void 0,function*(){$e.setConfiguration({userToken:Ye.token,userId:Ye.userId,userConcept:Ye.userConcept,apiUrl:Ye.apiUrl,aiUrl:Ye.aiUrl,nodeUrl:Ye.nodeUrl,icons:Ye?.icons||{}}),R.hasInitialized||(yield(0,U.init)(Ye.apiUrl,Ye.aiUrl,Ye.token,Ye.nodeUrl.replace("/api/v1",""),!1,"Boomconsole_FMS",Ye.enableSW,Ye.flags,Ye.parameters)),R.hasInitialized=!0})};const it=pe(ot(356));R.FolderTreeModule=it,console.debug(it)},215:function(vt,R,ot){var je=this&&this.__createBinding||(Object.create?function(st,dt,it,Ye){void 0===Ye&&(Ye=it);var Xe=Object.getOwnPropertyDescriptor(dt,it);Xe&&!("get"in Xe?!dt.__esModule:Xe.writable||Xe.configurable)||(Xe={enumerable:!0,get:function(){return dt[it]}}),Object.defineProperty(st,Ye,Xe)}:function(st,dt,it,Ye){void 0===Ye&&(Ye=it),st[Ye]=dt[it]}),Wt=this&&this.__setModuleDefault||(Object.create?function(st,dt){Object.defineProperty(st,"default",{enumerable:!0,value:dt})}:function(st,dt){st.default=dt}),pe=this&&this.__importStar||function(st){if(st&&st.__esModule)return st;var dt={};if(null!=st)for(var it in st)"default"!==it&&Object.prototype.hasOwnProperty.call(st,it)&&je(dt,st,it);return Wt(dt,st),dt},q=this&&this.__awaiter||function(st,dt,it,Ye){return new(it||(it=Promise))(function(Xe,Ve){function Nt(ee){try{$(Ye.next(ee))}catch(re){Ve(re)}}function se(ee){try{$(Ye.throw(ee))}catch(re){Ve(re)}}function $(ee){var re;ee.done?Xe(ee.value):(re=ee.value,re instanceof it?re:new it(function(le){le(re)})).then(Nt,se)}$((Ye=Ye.apply(st,dt||[])).next())})};Object.defineProperty(R,"__esModule",{value:!0}),R.recursiveSearchNestedLinks=R.createLink=R.getUser=R.createProject=R.createFolder=R.getFolders=R.getToken=void 0;const $e=pe(ot(793));function U(){return $e.config.userToken}R.getToken=U,R.getFolders=function(){return q(this,void 0,void 0,function*(){const st=U(),dt=`${$e.config.nodeUrl}/folders`;console.log("what start");const it=yield fetch(dt,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+st}});return console.log(it," yay yar res"),it.json()})},R.createFolder=function(st,dt){return q(this,void 0,void 0,function*(){const it=U();return st=`${$e.config.nodeUrl}/folders`,yield(yield fetch(st,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+it},body:JSON.stringify(dt)})).json()})},R.createProject=function(st){return q(this,void 0,void 0,function*(){const dt=U();let it=`${$e.config.nodeUrl}/projects`;return yield(yield fetch(it,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+dt},body:JSON.stringify(st)})).json()})},R.getUser=function(){return{theUserId:$e.config.userId,token:$e.config.userToken,userConcept:$e.config.userConcept}},R.createLink=function(st,dt,it){return q(this,void 0,void 0,function*(){const Ye=yield U();return(yield Ye)?yield(yield fetch(`${$e.config.apiUrl}/api/Connection/create-link?composition1=${st}&composition2=${dt}&linker=${it}&both=true`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:`bearer ${Ye}`}})).json():[]})},R.recursiveSearchNestedLinks=function(st){return q(this,void 0,void 0,function*(){const dt=yield U();return(yield dt)?yield(yield fetch(`${$e.config.apiUrl}/api/Connection/recursivesearch`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:`bearer ${dt}`},body:JSON.stringify(st)})).json():[]})}},356:function(vt,R,ot){var je=this&&this.__createBinding||(Object.create?function($,ee,re,le){void 0===le&&(le=re);var ie=Object.getOwnPropertyDescriptor(ee,re);ie&&!("get"in ie?!ee.__esModule:ie.writable||ie.configurable)||(ie={enumerable:!0,get:function(){return ee[re]}}),Object.defineProperty($,le,ie)}:function($,ee,re,le){void 0===le&&(le=re),$[le]=ee[re]}),Wt=this&&this.__setModuleDefault||(Object.create?function($,ee){Object.defineProperty($,"default",{enumerable:!0,value:ee})}:function($,ee){$.default=ee}),pe=this&&this.__importStar||function($){if($&&$.__esModule)return $;var ee={};if(null!=$)for(var re in $)"default"!==re&&Object.prototype.hasOwnProperty.call($,re)&&je(ee,$,re);return Wt(ee,$),ee},q=this&&this.__awaiter||function($,ee,re,le){return new(re||(re=Promise))(function(ie,ve){function he(Ze){try{Le(le.next(Ze))}catch(ct){ve(ct)}}function xe(Ze){try{Le(le.throw(Ze))}catch(ct){ve(ct)}}function Le(Ze){var ct;Ze.done?ie(Ze.value):(ct=Ze.value,ct instanceof re?ct:new re(function(Se){Se(ct)})).then(he,xe)}Le((le=le.apply($,ee||[])).next())})};Object.defineProperty(R,"__esModule",{value:!0}),R.getRenderTreeSidebarOption=R.removeShadowRoot=R.setShadowRoot=R.getCurrentTreeParams=R.getShadowRoot=R.updateSelectedFolders=R.removeRenderedTreeSidebar=R.renderTreeSidebar=R.shadowRoot=R.deleteFolder=R.getPathToFolder=R.createFolder=R.setCurrentFolderId=R.currentFolderId=R.getAllFolders=R.globalFolders=R.selectedFolders=void 0;const $e=ot(793),U=pe(ot(26)),st=pe(ot(687));var dt=ot(26);Object.defineProperty(R,"selectedFolders",{enumerable:!0,get:function(){return dt.selectedFolders}}),Object.defineProperty(R,"globalFolders",{enumerable:!0,get:function(){return dt.globalFolders}}),Object.defineProperty(R,"getAllFolders",{enumerable:!0,get:function(){return dt.getAllFolders}}),Object.defineProperty(R,"currentFolderId",{enumerable:!0,get:function(){return dt.currentFolderId}}),Object.defineProperty(R,"setCurrentFolderId",{enumerable:!0,get:function(){return dt.setCurrentFolderId}}),Object.defineProperty(R,"createFolder",{enumerable:!0,get:function(){return dt.createFolder}}),Object.defineProperty(R,"getPathToFolder",{enumerable:!0,get:function(){return dt.getPathToFolder}}),Object.defineProperty(R,"deleteFolder",{enumerable:!0,get:function(){return dt.deleteFolder}});let it=[];function Ye($,ee=!1){var re,le,ie;return q(this,void 0,void 0,function*(){try{const ve=it.find(Le=>Le.key==$.sidebarQuerySelector);ve?it=it.map(Le=>Le.key==$.sidebarQuerySelector?{params:$,showHeader:ee,key:ve.key}:Le):it.push({params:$,showHeader:ee,key:$.sidebarQuerySelector});const he=Nt($.sidebarQuerySelector);if(!he)return;null===(re=he?.querySelector(`.${$e.myprefix}boom_sidebar`))||void 0===re||re.remove(),he.innerHTML=yield st.sideBarHTML(!!$.uploadFn),function(Le){var Ze,ct;const Se=document.createElement("style");Se.textContent=`\n        /* Reset styles for shadow DOM */\n        /* .${$e.myprefix}boom_sidebar { */\n          /* all: unset; */\n         *:not(svg path) {\n          all: revert;\n        }\n    \n        /* Styles specific to the shadow root */\n        .${$e.myprefix}boom_sidebar {\n            width: 100%;\n            color: black;\n            font-family: sans-serif;\n        }\n        /* Other styles */\n    `,Le.prepend(Se),Le.getElementById(`${$e.myprefix}generic_boomconsole_style`)&&(null===(Ze=Le.getElementById(`${$e.myprefix}generic_boomconsole_style`))||void 0===Ze||Ze.remove());let rt=document.createElement("style");rt.id=$e.myprefix+"generic_boomconsole_style",rt.textContent=st.generic_boomconsole_style($e.config.icons),Le.prepend(rt),Le.getElementById(`${$e.myprefix}dialog_styles`)&&(null===(ct=Le.getElementById(`${$e.myprefix}dialog_styles`))||void 0===ct||ct.remove());let gt=document.createElement("style");gt.id=$e.myprefix+"dialog_styles",gt.textContent=st.dialog_styles($e.config.icons),Le.prepend(gt)}(he),console.log("FolderMS creating tree with old data"),U.createNestedTreeAndAddToDOM(he),yield U.getAllFolders($.sidebarQuerySelector);let xe=U.globalFolders;if(console.log("FolderMS get all folders fetched and completed"),!(xe?.length>0)){const Le=he.querySelector(`#${$e.myprefix}loader`);return null===(ie=Le?.classList)||void 0===ie||ie.add(`${$e.myprefix}hide`),document.createElement("p").append("You have not created folders yet!"),xe}{let Le=he?.querySelector(`.${$e.myprefix}boom_sidebar`);Le&&(Le.style.width="100%");const Ze=he.querySelector(`#${$e.myprefix}loader`);null===(le=Ze?.classList)||void 0===le||le.add(`${$e.myprefix}hide`);let ct=he.querySelector(`#${$e.myprefix}boom_sidebar_header`);ee&&ct&&(ct.style.display="flex");const Se=he.getElementById(`${$e.myprefix}upload_icon`);Se&&$.uploadFn&&Se.addEventListener("click",rt=>{$.uploadFn&&$.uploadFn(rt)})}}catch(ve){console.error("Error occured during folder rendering",ve)}})}function Xe($,ee=[]){var re,le,ie,ve;return q(this,void 0,void 0,function*(){try{const he=se($);null!==(re=he?.params)&&void 0!==re&&re.sidebarQuerySelector?null===(ie=document.querySelector(`${null===(le=he?.params)||void 0===le?void 0:le.sidebarQuerySelector} .${$e.myprefix}boom_sidebar`))||void 0===ie||ie.remove():null===(ve=document.querySelector(`.${$e.myprefix}boom_sidebar`))||void 0===ve||ve.remove(),U.updateSelectedFolders(ee||[])}catch(he){console.error("Error occured during folder removal",he)}})}R.renderTreeSidebar=Ye,R.removeRenderedTreeSidebar=Xe,R.updateSelectedFolders=function($,ee,re=!0){var le;return q(this,void 0,void 0,function*(){try{yield U.updateSelectedFolders(ee||[]);const ie=se($);re&&(yield Xe($,ee||[]),null!==(le=ie?.params)&&void 0!==le&&le.sidebarQuerySelector&&(yield Ye(ie.params,ie.showHeader)))}catch(ie){console.error("Error occured during category update",ie)}})};let Ve=[];function Nt($){let ee=document.querySelector($);if(!ee)return;const re=Ve.find(ie=>ie.domSelector==$);if(re&&ee.shadowRoot)return re.shadowRoot;Ve=Ve.filter(ie=>ie.domSelector!=$);let le={domSelector:$,shadowRoot:ee.attachShadow({mode:"open"})};return Ve.push(le),le.shadowRoot}function se($){return it?.find(ee=>ee.key==$)}R.getShadowRoot=function($){const ee=Ve.find(re=>re.domSelector==$);if(ee)return ee.shadowRoot},R.getCurrentTreeParams=function($){const ee=Ve.find(re=>re.shadowRoot==$);if(ee)return se(ee.domSelector)},R.setShadowRoot=Nt,R.removeShadowRoot=function($){const ee=document.querySelector($);ee&&(ee.innerHTML=""),Ve=Ve.filter(re=>re.domSelector!=$)},R.getRenderTreeSidebarOption=se},687:function(vt,R,ot){var je=this&&this.__awaiter||function($e,U,st,dt){return new(st||(st=Promise))(function(it,Ye){function Xe(se){try{Nt(dt.next(se))}catch($){Ye($)}}function Ve(se){try{Nt(dt.throw(se))}catch($){Ye($)}}function Nt(se){var $;se.done?it(se.value):($=se.value,$ instanceof st?$:new st(function(ee){ee($)})).then(Xe,Ve)}Nt((dt=dt.apply($e,U||[])).next())})};Object.defineProperty(R,"__esModule",{value:!0}),R.dialog_styles=R.generic_boomconsole_style=R.sideBarHTML=R.boom_theme=void 0;const Wt=ot(215),pe=ot(793),q="https://boomconcole.com/freeschema/dfe603bd-7cd0-403a-9941-d379e5acd5e8.png";R.boom_theme="light",R.sideBarHTML=($e=!1)=>je(void 0,void 0,void 0,function*(){return yield(0,Wt.getUser)(),`\n  <div class="${pe.myprefix}boom_sidebar">\n      <div id="${pe.myprefix}boom_sidebar_header" class="${pe.myprefix}boom_sidebar_header">\n          <h3>Folders</h3>\n          ${$e?`<span id="${pe.myprefix}upload_icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M260-160q-91 0-155.5-63T40-377q0-78 47-139t123-78q25-92 100-149t170-57q117 0 198.5 81.5T760-520q69 8 114.5 59.5T920-340q0 75-52.5 127.5T740-160H520q-33 0-56.5-23.5T440-240v-206l-64 62-56-56 160-160 160 160-56 56-64-62v206h220q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-80q0-83-58.5-141.5T480-720q-83 0-141.5 58.5T280-520h-20q-58 0-99 41t-41 99q0 58 41 99t99 41h100v80H260Zm220-280Z"/></svg></span>`:""}\n      </div>\n      <div class="${pe.myprefix}sidebar_body" data-id=""> \n          <div class="${pe.myprefix}loader" id="${pe.myprefix}loader"></div>  \n          <ul id="${pe.myprefix}category_list_tree"></ul>\n      </div>\n  </div>\n  `}),R.generic_boomconsole_style=($e={})=>`\n  .${pe.myprefix}root_folder {\n    font-weight: 700;\n  }\n  .${pe.myprefix}current_folder {\n    font-weight: 700 !important;\n    font-size: 14px;\n  }\n  #${pe.myprefix}boom_dialog label,\n  #${pe.myprefix}root_folder{\n    font-size: 14px;\n    cursor: pointer;\n  }\n  a.${pe.myprefix}btn_plus {\n    padding: 0;\n    position: relative;\n    left: 5px;\n    cursor: pointer;\n    background: #aaa;\n    display: inline-block;\n    width: 20px;\n    height: 20px;\n    color: #fff;\n    text-align: center;\n    line-height: 18px;\n    border-radius: 20px;\n    margin-right: 10px;\n    text-decoration: none;\n    display: inline-flex;\n    /* align-items: center; */\n    justify-content: center;\n    font-weight: 500;\n    font-size: 16px\n  }\n  a.${pe.myprefix}btn_plus:hover{\n    background: #555;\n  }\n  .${pe.myprefix}folder_checkbox {\n    opacity: 1 !important; \n    position: relative !important; \n    width: 14px; \n    height: 14px; \n    border-radius: 2px; \n    -webkit-appearance: checkbox;\n    color-scheme: only light;\n  }\n  #${pe.myprefix}category_list_tree li,\n  .${pe.myprefix}root_folder {\n    text-align: start;\n    cursor: pointer;\n    background: url(${$e?.folderIcon?$e.folderIcon:q}) 16px 3px no-repeat;\n    background-size: 16px auto !important;\n    padding-left: 35px !important;\n    position: relative !important;\n    text-wrap: nowrap !important;\n    font-size: 13px;\n    line-height: 24px;\n  }\n  .${pe.myprefix}root_folder,\n  li.${pe.myprefix}has_submenu:has(> ul.${pe.myprefix}active) {\n    background: url(${$e?.openIcon?$e.openIcon:"https://boomconcole.com/freeschema/60491cf1-2a5b-46b6-9aea-c1bd45e081ab.png"}) 16px 3px no-repeat !important;\n    background-size: 16px auto !important;\n  }\n  #${pe.myprefix}category_list_tree li label{\n    display: inline-block !important;\n    width: auto !important;\n    cursor: pointer;\n    font-weight: 500;\n  }\n  .${pe.myprefix}clickable_folder_icon_placeholder {\n    height: 16px;\n    width: 16px;\n    position: absolute;\n    left: 16px;\n    top: 3px;\n  }\n  .${pe.myprefix}is_virtual > label::before {\n    background: url('http://localhost:4200/assets/app-icons/open-folder.png') 16px 3px no-repeat;\n    content: "";\n    background: mediumvioletred;\n    width: 5px;\n    height: 5px;\n    z-index: 1000;\n    position: absolute;\n    border-radius: 50%;\n    top: 3px;\n    left: 30px;\n  }\n  .${pe.myprefix}is_virtual a.btn_plus {\n    display: none\n  }\n  #${pe.myprefix}small_close_button,\n  #${pe.myprefix}new_category_button{\n    background: #777;\n    color: #fff;\n    cursor: pointer;\n    border: none;\n    padding: 4px 10px;\n    margin-left: 10px;\n    font-size: 14px;\n    width: auto;\n    display: none;\n  }\n  #${pe.myprefix}new_category_button{\n    background: #333;\n    margin: 0;\n  }\n  #${pe.myprefix}new_category_wrapper{\n    margin: 5px 0;\n    cursor: pointer;\n    background: url(${$e?.folderIcon?$e.folderIcon:q}) 16px 3px no-repeat;\n    background-size: 16px auto;\n    padding-left: 40px;\n    text-wrap: nowrap;\n    position: relative;\n    left: -15px;\n  }\n\n  /* New Folder CSS right click */\n  #${pe.myprefix}folder_actions {\n    position: fixed;\n    z-index: 999999;\n    font-size: 14px;\n    line-height: 16px;\n  }\n  #${pe.myprefix}folder_actions a {\n    display: block;\n    background: white;\n    color: black;\n    padding: 10px 15px;\n    border: 1px solid lightgray;\n    text-wrap: nowrap;\n    cursor: pointer;\n  }\n  .${pe.myprefix}dragover {\n    background-color: rgba(0,0,0, 0.1);\n    display: block;\n    position: relative;\n    transition: all 0.4s;\n    height: 40px;\n    width: 10px;\n    margin-top: -20px;\n  }\n  #${pe.myprefix}upload_icon {\n    width: 25px;\n    cursor: pointer;\n  }\n  #${pe.myprefix}upload_icon svg {\n    fill: white;\n  }\n  `,R.dialog_styles=($e={})=>(console.log("icons",$e),`\n  .${pe.myprefix}boom_sidebar{\n    font-family: Arial, Helvetica, sans-serif;\n    width: 40%;\n    position: relative;\n    margin-right: 20px;\n  }\n  .${pe.myprefix}sidebar_body{\n      /* max-height: 400px; */\n      overflow: auto;\n      padding: 12px 0;\n      min-height: 250px;\n      position: relative;\n      z-index: 3;\n      line-height: 22px;\n  }\n  .${pe.myprefix}boom_sidebar ul{\n    margin: 0;\n    padding: 0;\n    list-style: none;\n  }\n  .${pe.myprefix}submenuLevel.${pe.myprefix}active {\n    position: relative;\n    left: -15px\n  }\n  .${pe.myprefix}boom_dialog  *{\n    color: #333;\n    box-sizing: border-box;\n  }\n  .${pe.myprefix}boom-field{\n    margin: 20px 0;\n  }\n  .${pe.myprefix}boom-field select,\n  .${pe.myprefix}boom-field input,\n  .${pe.myprefix}boom-field textarea{\n    width: 100%;\n    background: #fff;\n  }\n  .${pe.myprefix}field_input,\n  .${pe.myprefix}field_select{\n    width: 100%;\n    font-size: 14px;\n    // margin: 0 0 5px;\n    border: 1px solid #aaa;\n    padding: 5px;\n    background-color: white;\n    display: block;\n    min-width: 150px;\n    color: black;\n  }\n  .${pe.myprefix}boom-field textarea{\n    min-height: 130px;\n  }\n  #${pe.myprefix}boom_dialog .${pe.myprefix}boom_question {\n    margin-bottom: 10px;\n    border-bottom: 1px solid #ccc;\n    padding: 20px 0;   \n  }\n  .${pe.myprefix}boom_answer{\n    height: 400px;\n    overflow: auto;\n    position: relative;\n  }\n  .${pe.myprefix}boom-field select,\n  .${pe.myprefix}boom-field input,\n  .${pe.myprefix}boom-field textarea{\n      box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;\n      min-width: 250px;\n      border: 1px solid #ccc;\n      border-radius: 5px;\n      padding: 12px;\n  }\n  #${pe.myprefix}closeButton {\n    background: #aaa;\n      padding: 8px 20px;\n      border-radius: 5px;\n      margin: 10px 20px 0 0;\n      color: #fff;\n  }\n  #${pe.myprefix}redirect_button,button[${pe.myprefix}submit_dialog],\n  button[${pe.myprefix}redirect_button],\n  button[${pe.myprefix}submit_boom_the_chat_dialog]\n  .${pe.myprefix}boom_button{\n    background-color: initial;\n    background-image: linear-gradient(-180deg, #FF7E31, #E62C03);\n    border-radius: 6px;\n    box-shadow: rgba(0, 0, 0, 0.1) 0 2px 4px;\n    color: #FFFFFF;\n    cursor: pointer;\n    display: inline-block;\n    padding: 8px 20px;\n    pointer-events: auto;\n    position: relative;\n    text-align: center;\n    touch-action: manipulation;\n    user-select: none;\n    -webkit-user-select: none;\n    white-space: nowrap;\n    z-index: 9;\n    border: 0;\n    transition: box-shadow .2s;\n  }\n  #${pe.myprefix}redirect_button,button[${pe.myprefix}submit_dialog]:hover,\n  button[${pe.myprefix}submit_boom_the_chat_dialog]:hover,   button[${pe.myprefix}redirect_button]:hover {\n    box-shadow: rgba(253, 76, 0, 0.5) 0 3px 8px;\n  }\n  \n  #${pe.myprefix}boom_dialog::backdrop{\n    background: rgba(0,0,0,0.7);\n  }\n  \n  .${pe.myprefix}success_message {\n      padding: 20px;\n      color: green;\n      background: rgba(255,255,255,0.94);\n      left: 0;\n      z-index: 999;\n      top: 0;\n      width: 100%;\n      text-align: center;\n      position: fixed;\n      font-size: 30px;\n      text-transform: capitalize;\n      height: 100%;\n      padding: 50px 0;\n  }\n  \n  #${pe.myprefix}dialog_form{\n    position: relative;\n    padding: 0px 20px 20px;\n  }\n  #${pe.myprefix}category_results{\n    display: none;\n    box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;\n    position: absolute;\n    list-style: none;\n      left: 0;\n      width: 100%;\n      top: 57px;\n      border-radius: 5px;\n      z-index: 100;\n      margin: 10px 0;\n      background: #fff;\n      padding: 0;\n  }\n  #${pe.myprefix}category_results.show{\n    display: block;\n  }\n  #${pe.myprefix}category_results li a{\n    cursor: pointer;\n      display: block;\n      padding: 12px 20px;\n      border-bottom: 1px solid #eee;\n  }\n  #${pe.myprefix}category_results li a:hover{\n    background: #f3f3f3;\n  }\n  .${pe.myprefix}boom_sidebar_header{\n    color:white;\n    background: linear-gradient(132deg, rgb(36, 37, 38) 0%, rgb(65, 80, 95) 100%);\n    padding: 10px 30px;\n    position: sticky;\n    top: 0;\n    z-index: 10;\n    display: none;\n    align-items: center;\n    justify-content: space-between;\n  }\n  .${pe.myprefix}boom_sidebar_header h3 {\n      margin: 0px;\n      color: white;\n      font-weight: bold;\n      font-size: 16px;\n  }\n  .${pe.myprefix}boom_category {\n    position: relative;\n  }\n  .${pe.myprefix}boom_the_chat{\n    border-width: 1px;\n    padding: 0.5rem 0.75rem;\n    font-family: inherit;\n    font-weight: inherit;\n  }\n  .${pe.myprefix}loader {\n    border: 5px solid #f3f3f3; /* Light grey */\n    border-top: 5px solid #E62C03; /* pink */\n    border-radius: 50%;\n    width: 40px;\n    height: 40px;\n    animation: ${pe.myprefix}spin 2s linear infinite;\n    z-index: 12;\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n  }\n  \n  @keyframes ${pe.myprefix}spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  .${pe.myprefix}hide{\n    display:none;\n  }\n  .${pe.myprefix}submenuLevel{\n    display: none;\n    list-style: none;\n  }\n  .${pe.myprefix}has_submenu {\n    user-select: none; /* Prevent text selection */\n  }\n  #${pe.myprefix}category_list_tree input[type="checkbox"]{\n    margin: 0px 7px 5px 3px;\n  }\n  \n    .${pe.myprefix}category_list_tree input[type="checkbox"]{\n      margin: 3px;\n      position: relative !important;\n      opacity: 1 !important;\n      pointer-events: auto;\n    }\n  \n  .${pe.myprefix}has_submenu::before {\n    content: '';\n    color: black;\n    display: inline-block;\n    margin-right: 6px;\n  }\n  \n  .${pe.myprefix}has_submenu_down::before {\n    transform: rotate(90deg);\n  }\n  .${pe.myprefix}active {\n    display: block;\n  }\n  #${pe.myprefix}category_list_tree{\n    position: relative;\n    margin-left: 20px;  \n    padding-left: 0px;\n    list-style: none;\n  }\n  \n  /* #${pe.myprefix}category_list_tree li {\n    cursor: pointer;\n    background: url(${$e?.folderIcon?$e.folderIcon:q}) 16px 3px no-repeat !important;\n    background-size: 16px auto !important;\n    padding-left: 35px !important;\n    position: relative !important;\n    text-wrap: nowrap !important;\n  } */\n  #${pe.myprefix}category_list_tree li:before{\n    background: #000;\n    content: "";\n    width: 17px;\n    height: 2px;\n    position: absolute;\n    left: 0;\n    top: 9px;\n    z-index: 99\n  }\n  #${pe.myprefix}category_list_tree li:after{\n    background: #000;\n    content: "";\n    width: 2px;\n    position: absolute;\n    left: 0;\n    top: 0;\n    height: 100%;\n    z-index: 99\n  }\n  #${pe.myprefix}category_list_tree li:last-child:after{\n    height: 10px;\n  }\n  .${pe.myprefix}toggler {\n    background: url(${$e?.nextIcon?$e.nextIcon:"https://boomconcole.com/freeschema/d122f7dd-b0ec-409a-8131-d90a6c2b146a.png"}) left top no-repeat;\n      background-size: 100% auto;\n      display: block;\n      width: 18px;\n      height: 18px;\n      background-color: #fff;\n      position: absolute;\n      left: -9px;\n      top: 1px;\n      border-radius: 50%;\n      z-index: 100;\n      cursor: pointer;\n  }\n  #${pe.myprefix}create_category{\n    cursor: pointer;\n      position: absolute;\n      right: 0;\n      top: 10px;\n      padding: 5px 14px;\n      background: #333;\n      color: #fff;\n      border-radius: 20px;\n  }\n  #${pe.myprefix}create_category span{\n    color: #fff;\n  }\n  .${pe.myprefix}toggler:has(+ .${pe.myprefix}active){\n    transform: rotate(90deg);\n  }\n  .${pe.myprefix}boom_form{\n    margin: 0 8px 2px;\n    border: 1px solid #ccc\n  }\n  #${pe.myprefix}new_category_button{\n    background: #333;\n    color: #fff;\n    cursor: pointer;\n    border: none;\n    padding: 4px 10px;\n    \n  }\n  .${pe.myprefix}field_error{\n    font-size: 14px;\n    color:red;\n  }\n  .${pe.myprefix}field_success{\n    font-size: 14px;\n    color:green;\n  }\n  \n  /*\n  Theme: Dark\n  */\n  .${pe.myprefix}boom_dialog.${R.boom_theme}{\n    background: linear-gradient(\n      132deg,\n      rgb(90, 115, 139) 0%,\n      rgb(66, 73, 76) 100%\n    );\n    color: #f5f5f5;\n    border: rgb(90, 115, 139);\n  }\n  .${pe.myprefix}boom_dialog.${R.boom_theme} *{\n    color: #f5f5f5;\n  }\n  .${pe.myprefix}boom_dialog.${R.boom_theme} input,\n  .${pe.myprefix}boom_dialog.${R.boom_theme} select{\n    color: #555;\n  }\n  \n  .${pe.myprefix}preview{\n    border: 1px solid #666;\n    border-radius: 5px;\n    padding: 10px;\n    max-height: 250px;\n    overflow-y: auto;\n    margin: 20px 0;\n  }\n  .${pe.myprefix}preview h3{\n    font-size: 20px;\n    margin: 0 0 8px;\n  }\n  `)},726:(vt,R)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.boomFolderComposition=R.captureBoomGPTComposition=void 0,R.captureBoomGPTComposition="boomgpt",R.boomFolderComposition="boomFolder"},777:(vt,R,ot)=>{ot.r(R),ot.d(R,{ADMIN:()=>$e,ALLID:()=>U,AccessTracker:()=>st,AddGhostConcept:()=>dt,Anomaly:()=>it,BaseUrl:()=>Ye,BinaryTree:()=>Xe,BuildWidgetFromId:()=>Ve,BuilderStatefulWidget:()=>Nt,Composition:()=>se,CompositionBinaryTree:()=>$,CompositionNode:()=>ee,Concept:()=>re,ConceptsData:()=>le,Connection:()=>ie,ConnectionData:()=>ve,CreateComposition:()=>he,CreateConnection:()=>xe,CreateConnectionBetweenEntityLocal:()=>Le,CreateConnectionBetweenTwoConcepts:()=>Ze,CreateConnectionBetweenTwoConceptsGeneral:()=>ct,CreateConnectionBetweenTwoConceptsLocal:()=>Se,CreateData:()=>rt,CreateDefaultConcept:()=>gt,CreateDefaultLConcept:()=>Ft,CreateSession:()=>$t,CreateSessionVisit:()=>Kt,CreateTheCompositionLocal:()=>Bt,CreateTheCompositionWithCache:()=>Yt,CreateTheConnection:()=>on,CreateTheConnectionGeneral:()=>un,CreateTheConnectionLocal:()=>hn,DATAID:()=>me,DATAIDDATE:()=>ne,DelayFunctionExecution:()=>Y,DeleteConceptById:()=>X,DeleteConceptLocal:()=>Q,DeleteConnectionById:()=>W,DeleteConnectionByType:()=>J,DeleteUser:()=>oe,DependencyObserver:()=>ge,FilterSearch:()=>Ce,FormatFromConnections:()=>Pe,FormatFromConnectionsAltered:()=>Je,FreeschemaQuery:()=>He,FreeschemaQueryApi:()=>Fe,GetAllConnectionsOfComposition:()=>nt,GetAllConnectionsOfCompositionBulk:()=>wt,GetAllTheConnectionsByTypeAndOfTheConcept:()=>pt,GetComposition:()=>Ut,GetCompositionBulk:()=>Zt,GetCompositionBulkWithDataId:()=>Rt,GetCompositionFromConnectionsWithDataId:()=>jt,GetCompositionFromConnectionsWithDataIdFromConnections:()=>Pt,GetCompositionFromConnectionsWithDataIdInObject:()=>Xt,GetCompositionFromConnectionsWithDataIdIndex:()=>wn,GetCompositionFromConnectionsWithIndex:()=>Fo,GetCompositionFromConnectionsWithIndexFromConnections:()=>ii,GetCompositionFromMemoryWithConnections:()=>ri,GetCompositionList:()=>Pa,GetCompositionListAll:()=>Wa,GetCompositionListAllWithId:()=>Va,GetCompositionListListener:()=>$a,GetCompositionListLocal:()=>ja,GetCompositionListLocalWithId:()=>Ha,GetCompositionListWithId:()=>qa,GetCompositionListWithIdUpdated:()=>Ja,GetCompositionListener:()=>za,GetCompositionLocal:()=>Za,GetCompositionLocalWithId:()=>Qa,GetCompositionWithAllIds:()=>Ka,GetCompositionWithCache:()=>Ya,GetCompositionWithDataIdBulk:()=>Xa,GetCompositionWithDataIdWithCache:()=>ec,GetCompositionWithId:()=>tc,GetCompositionWithIdAndDateFromMemory:()=>nc,GetConceptBulk:()=>oc,GetConceptByCharacter:()=>ic,GetConceptByCharacterAndCategoryLocal:()=>rc,GetConceptByCharacterAndType:()=>ac,GetConnectionBetweenTwoConceptsLinker:()=>cc,GetConnectionBulk:()=>sc,GetConnectionById:()=>lc,GetConnectionDataPrefetch:()=>dc,GetConnectionOfTheConcept:()=>uc,GetLink:()=>hc,GetLinkListListener:()=>pc,GetLinkListener:()=>fc,GetLinkRaw:()=>yc,GetLinkerConnectionFromConcepts:()=>gc,GetLinkerConnectionToConcepts:()=>vc,GetRelation:()=>mc,GetRelationLocal:()=>Cc,GetRelationRaw:()=>_c,GetTheConcept:()=>Tc,GetTheConceptLocal:()=>wc,GetUserGhostId:()=>Ic,JUSTDATA:()=>kc,LConcept:()=>bc,LConnection:()=>Ac,LISTNORMAL:()=>Lc,LocalConceptsData:()=>Nc,LocalSyncData:()=>Sc,LocalTransaction:()=>xc,Logger:()=>Fc,LoginToBackend:()=>Ec,MakeTheInstanceConcept:()=>Bc,MakeTheInstanceConceptLocal:()=>Dc,MakeTheTimestamp:()=>Gc,MakeTheTypeConceptApi:()=>Uc,MakeTheTypeConceptLocal:()=>Rc,NORMAL:()=>Oc,PRIVATE:()=>Mc,PUBLIC:()=>Pc,PatcherStructure:()=>Wc,Prototype:()=>Vc,RAW:()=>$c,RecursiveSearchApi:()=>jc,RecursiveSearchApiNewRawFullLinker:()=>Hc,RecursiveSearchApiRaw:()=>qc,RecursiveSearchApiRawFullLinker:()=>Jc,RecursiveSearchApiWithInternalConnections:()=>zc,RecursiveSearchListener:()=>Zc,SchemaQuery:()=>Qc,SchemaQueryListener:()=>Kc,SearchAllConcepts:()=>Yc,SearchLinkInternal:()=>Xc,SearchLinkInternalAll:()=>es,SearchLinkMultipleAll:()=>ts,SearchLinkMultipleAllObservable:()=>ns,SearchLinkMultipleApi:()=>os,SearchQuery:()=>is,SearchStructure:()=>rs,SearchWithLinker:()=>as,SearchWithTypeAndLinker:()=>cs,SearchWithTypeAndLinkerApi:()=>ss,Selector:()=>ls,SessionData:()=>ds,Signin:()=>us,Signup:()=>hs,SignupEntity:()=>ps,SplitStrings:()=>fs,StatefulWidget:()=>ys,SyncData:()=>gs,TrashTheConcept:()=>vs,UpdateComposition:()=>ms,UpdateCompositionLocal:()=>Cs,UserBinaryTree:()=>_s,Validator:()=>Ts,ViewInternalData:()=>ws,ViewInternalDataApi:()=>Is,WidgetTree:()=>ks,convertFromConceptToLConcept:()=>bs,convertFromLConceptToConcept:()=>As,convertWidgetTreeToWidget:()=>Ls,convertWidgetTreeToWidgetWithWrapper:()=>Ns,createFormFieldData:()=>Ss,createPrototypeLocal:()=>xs,dispatchIdEvent:()=>Fs,getFromDatabaseWithType:()=>Es,getObjectsFromIndexDb:()=>Bs,getWidgetBulkFromId:()=>Ds,getWidgetFromId:()=>Gs,handleServiceWorkerException:()=>Us,hasActivatedSW:()=>Rs,init:()=>Os,recursiveFetch:()=>Ms,recursiveFetchNew:()=>Ps,removeAllChildren:()=>Ws,renderLatestWidget:()=>Vs,renderPage:()=>$s,renderWidget:()=>js,searchLinkMultipleListener:()=>Hs,sendEmail:()=>qs,sendMessage:()=>Js,serviceWorker:()=>zs,setHasActivatedSW:()=>Zs,storeToDatabase:()=>Qs,subscribedListeners:()=>Ks,unwrapContainers:()=>Ys,updateAccessToken:()=>Xs,uploadAttachment:()=>el,uploadFile:()=>tl,uploadImage:()=>nl,validDocumentFormats:()=>ol,validImageFormats:()=>il});var je={1735:(Re,ce,_)=>{_.d(ce,{J:()=>A});var B,M=_(1834),c=_(3278),f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};class A{static incrementConcept(a){try{a&&(this.conceptsData[a]=(this.conceptsData[a]||0)+1)}catch{console.error("Failed on increment concept")}}static incrementConnection(a){try{a&&(this.connectionsData[a]=(this.connectionsData[a]||0)+1)}catch{console.error("Failed on increment connection")}}static getTopConcepts(a){return Object.entries(this.conceptsData).map(([r,d])=>[parseInt(r),d]).sort((r,d)=>d[1]-r[1]).slice(0,a)}static getTopConnections(a){return Object.entries(this.connectionsData).map(([r,d])=>[parseInt(r),d]).sort((r,d)=>d[1]-r[1]).slice(0,a)}static saveDataToLocalStorage(){localStorage?.setItem(this.accessData,JSON.stringify({concepts:this.conceptsData,connections:this.connectionsData}))}static loadDataFromLocalStorage(){const a=null==localStorage?void 0:localStorage.getItem(this.accessData);if(a){const r=JSON.parse(a);this.conceptsData=r.concepts||{},this.connectionsData=r.connections||{}}}static sendToServer(){return f(this,void 0,void 0,function*(){try{yield this.syncToServer()}catch{console.error("Failed to process Access Tracker Sync with Server")}})}static syncToServer(){return f(this,void 0,void 0,function*(){try{if(!Object.keys(this.conceptsData).length&&!Object.keys(this.connectionsData).length)return;const a=c.b.BearerAccessToken;if(!a)return;const r=this.conceptsData&&Object.keys(this.conceptsData).length>0?this.conceptsData:{},d=this.connectionsData&&Object.keys(this.connectionsData).length>0?this.connectionsData:{},h=yield fetch(M.BaseUrl.PostPrefetchConceptConnections(),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({concepts:r,connections:d})});if(!h.ok)throw new Error("Failed to sync data to the server.");yield h.json(),this.conceptsData={},this.connectionsData={},this.setNextSyncTime()}catch(a){console.error("Sync error:",a)}})}static setNextSyncTime(){this.nextSyncTime=Date.now()+this.SYNC_INTERVAL_MS}static startAutoSync(){setInterval(()=>{const a=Date.now();this.nextSyncTime&&a>=this.nextSyncTime&&this.syncNow().catch(console.error)},6e4)}static syncNow(){return f(this,void 0,void 0,function*(){try{this.activateStatus?yield this.syncToServer():console.warn("Access Tracker inactive.")}catch{console.error("Error on sync access tracker")}})}static GetSuggestedConcepts(a){return f(this,void 0,void 0,function*(){try{const r=c.b.BearerAccessToken,d=new URL(M.BaseUrl.GetSuggestedConcepts());void 0!==a&&d.searchParams.append("top",a.toString());const h=yield fetch(d.toString(),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!h.ok){const T=yield h.text();throw new Error(`Failed to load concepts: ${h.status} ${h.statusText}. Details: ${T}`)}const C=(yield h.json())||[];return yield this.addConceptToBinaryTree(C.data),C}catch(r){throw r instanceof Error?(console.error("Error fetching suggested concepts:",r.message),new Error("Unable to fetch suggested concepts. Please try again later.")):(console.error("An unexpected error occurred:",r),new Error("An unexpected error occurred while fetching suggested concepts."))}})}static GetSuggestedConnections(a){return f(this,void 0,void 0,function*(){try{const r=c.b.BearerAccessToken,d=new URL(M.BaseUrl.GetSuggestedConnections());void 0!==a&&d.searchParams.append("top",a.toString());const h=yield fetch(d.toString(),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!h.ok){const T=yield h.text();throw new Error(`Failed to load connections: ${h.status} ${h.statusText}. Details: ${T}`)}const C=(yield h.json())||[];return yield this.addConnectionToBinaryTree(C.data),C}catch(r){throw r instanceof Error?(console.error("Error fetching suggested Connections:",r.message),new Error("Unable to fetch suggested connections. Please try again later.")):(console.error("An unexpected error occurred:",r),new Error("An unexpected error occurred while fetching suggested Connections."))}})}static addConceptToBinaryTree(a){return f(this,void 0,void 0,function*(){try{a.forEach(r=>{M.ConceptsData.AddConcept(r)})}catch{console.error("Error on adding Concepts Data into tree")}})}static addConnectionToBinaryTree(a){return f(this,void 0,void 0,function*(){try{a.forEach(r=>{M.ConnectionData.AddConnection(r)})}catch{console.error("Error on adding Connections Data into tree")}})}}B=A,A.conceptsData={},A.connectionsData={},A.SYNC_INTERVAL_MS=12e4,A.nextSyncTime=Date.now(),A.activateStatus=!1,A.accessData="Access Data",B.startAutoSync()},1167:(Re,ce,_)=>{_.d(ce,{Y:()=>N});var B=_(9581),M=_(3518),c=_(1834),f=_(1863),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};function N(a){return A(this,void 0,void 0,function*(){const r=c.Logger.logfunction("CreateTheConceptApi",a);let d=(0,c.CreateDefaultConcept)();try{var h=(0,M.Xr)();const C=yield fetch(B.B.CreateTheConceptUrl(),{method:"POST",headers:h,body:JSON.stringify(a)});if(!C.ok)throw(0,f.ry)(C),new Error(`Error! status: ${C.status}`);return d=yield C.json(),c.Logger.logUpdate(r),d}catch(C){C instanceof Error?console.log("Create the concept api error message: ",C.message):console.log("Create the concept api unexpected error: ",C),(0,f.Mb)(C,B.B.CreateTheConceptUrl()),(0,f.ey)(r,"CreateTheConceptApi",C)}})}},2:(Re,ce,_)=>{_.d(ce,{s:()=>r});var B=_(8286),M=_(9581),c=_(1412),f=_(3518),A=_(1863),N=_(1834),a=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};function r(h){var C=arguments;return a(this,void 0,void 0,function*(){const T=N.Logger.logfunction("GetAllConnectionsOfComposition",C);var b=[];if(0==(b=yield B.d.GetConnectionsOfConcept(h)).length)b=yield d(h);else{var m=yield d(h);(0,c.e)(m,b),b=m}return N.Logger.logUpdate(T),b})}function d(h){var C=arguments;return a(this,void 0,void 0,function*(){const T=N.Logger.logfunction("GetAllConnectionsOfCompositionOnline",C);var b=[];try{(0,f.Xr)("application/json");const y=new Headers,s=new FormData;s.append("composition_id",h.toString());const p=yield fetch(M.B.GetAllConnectionsOfCompositionUrl(),{method:"POST",headers:y,body:s});if(console.log("this is getting connection from online",M.B.GetAllConnectionsOfCompositionUrl(),h),!p.ok)throw(0,A.ry)(p),new Error(`Error! status: ${p.status}`);const I=yield p.json();for(var m=0;m<I.length;m++)B.d.AddConnection(I[m]),b.push(I[m]);return N.Logger.logUpdate(T),b}catch(y){y instanceof Error?console.log("Get all connection of composition error : ",y.message):console.log("Get all connection of composition error : ",y),(0,A.Mb)(y,M.B.GetAllConnectionsOfCompositionUrl()),(0,A.ey)(T,"GetAllConnectionsOfCompositionOnline",y)}})}},8642:(Re,ce,_)=>{_.d(ce,{Y:()=>h});var B=_(8286),M=_(9581),c=_(4364),f=_(5284),A=_(1412),N=_(3518),a=_(1863),r=_(1834),d=function(C,T,b,m){return new(b||(b=Promise))(function(y,s){function p(w){try{x(m.next(w))}catch(F){s(F)}}function I(w){try{x(m.throw(w))}catch(F){s(F)}}function x(w){var F;w.done?y(w.value):(F=w.value,F instanceof b?F:new b(function(E){E(F)})).then(p,I)}x((m=m.apply(C,T||[])).next())})};function h(){var C=arguments;return d(this,arguments,void 0,function*(T=[]){const b=r.Logger.logfunction("GetAllConnectionsOfCompositionBulk",C)||{};if(r.serviceWorker){b.serviceWorker=!0;try{const p=yield(0,r.sendMessage)("GetAllConnectionsOfCompositionBulk",{composition_ids:T});return r.Logger.logUpdate(b),p.data}catch(p){console.error("GetAllConnectionsOfCompositionBulk sw error: ",p),(0,a.ey)(b,"GetAllConnectionsOfCompositionBulk",p),(0,r.handleServiceWorkerException)(p)}}var m=[];if(T.length<=0)return m;var y=yield(0,f.B)(T),s=yield function(){var p=arguments;return d(this,arguments,void 0,function*(I=[]){const x=r.Logger.logfunction("GetAllConnectionsOfCompositionOnline",p);var w=[];try{var F=(0,N.Xr)();const D=yield fetch(M.B.GetAllConnectionsOfCompositionBulkUrl(),{method:"POST",headers:F,body:JSON.stringify(I)});if(D.ok){const G=yield D.json();for(var E=0;E<G.length;E++)B.d.AddConnection(G[E]),w.push(G[E])}else console.log("Get all connections of composition bulk error message: ","Cannot get response"),(0,a.ry)(D);return r.Logger.logUpdate(x),w}catch(D){D instanceof Error?console.log("Get all connections of composition bulk error message: ",D.message):console.log("Get all connections of composition bulk unexpected error: ",D),(0,a.Mb)(D,M.B.GetAllConnectionsOfCompositionBulkUrl()),(0,a.ey)(x,"GetAllConnectionsOfCompositionOnline",D)}})}(T);return(0,A.e)(m=s,y),yield(0,c.s)(m),r.Logger.logUpdate(b),m})}},2803:(Re,ce,_)=>{_.d(ce,{x:()=>N});var B=_(8286),M=_(9581),c=_(1863),f=_(1834),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};function N(a,r,d){var h=arguments;return A(this,void 0,void 0,function*(){const C=f.Logger.logfunction("GetCompositionConnectionsBetweenTwoConcepts",h)||{};var T=[];try{if(f.serviceWorker){C.serviceWorker=!0;try{const s=yield(0,f.sendMessage)("GetCompositionConnectionsBetweenTwoConcepts",{ofConceptId:a,toConcept:r,mainKey:d});return f.Logger.logUpdate(C),s.data}catch(s){console.error("GetCompositionConnectionsBetweenTwoConcepts sw error: ",s),(0,c.ey)(C,"GetCompositionConnectionsBetweenTwoConcepts",s),(0,f.handleServiceWorkerException)(s)}}var b=new FormData;b.append("ofConceptId",a.toString()),b.append("mainKey",d.toString()),b.append("toConceptId",r.toString());const y=yield fetch(M.B.GetCompositionConnectionBetweenTwoConceptsUrl(),{method:"POST",body:b,redirect:"follow"});if(y.ok){const s=yield y.json();for(var m=0;m<s.length;m++)B.d.AddConnection(s[m]),T.push(s[m]);f.Logger.logUpdate(C)}else console.log("Get composition connection between two concepts",y.status),(0,c.ry)(y)}catch(y){y instanceof Error?console.log("Get composition connection between two concepts error message: ",y.message):console.log("Get composition connection between two concepts unexpected error: ",y),(0,c.Mb)(y,M.B.GetCompositionConnectionBetweenTwoConceptsUrl()),(0,c.ey)(C,"GetCompositionConnectionsBetweenTwoConcepts",y)}return T})}},7139:(Re,ce,_)=>{_.d(ce,{r:()=>r});var B=_(9639),M=_(9581),c=_(1834),f=_(1863),A=_(1596),N=_(3278),a=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};function r(d){var h=arguments;return a(this,void 0,void 0,function*(){const C=c.Logger.logfunction("GetConcept",h)||{};let T=(0,c.CreateDefaultConcept)();const b=new FormData;b.append("id",d.toString());try{if(c.serviceWorker){C.serviceWorker=!0;try{const s=yield(0,c.sendMessage)("GetConcept",{id:d});return c.Logger.logUpdate(C),s.data}catch(s){console.error("GetConcept sw error: ",s),(0,f.ey)(C,"GetConcept",s),(0,c.handleServiceWorkerException)(s)}}if(0==d||null==d||null==d)return T;var m=yield B.I.GetConcept(d);let y=B.I.GetNpc(d);if(0!=m.id||y)return c.Logger.logUpdate(C),m;{let s;const p={method:"POST",body:b,headers:{Authorization:"Bearer "+N.b.BearerAccessToken}};try{console.log("this is the url",M.B.GetConceptUrl()),s=yield fetch(M.B.GetConceptUrl(),p)}catch{s=yield(0,A.g)(p,"/api/getConcept")}return yield function(I,x,w,F){return a(this,void 0,void 0,function*(){return I.ok?(x=yield I.json()).id>0?B.I.AddConcept(x):B.I.AddNpc(F):(console.log("Get the concept error",I.status),(0,f.ry)(I)),c.Logger.logUpdate(w),x})}(s,T,C,d)}}catch(y){y instanceof Error?console.log("Get the concept error message: ",y.message):console.log("Get the concept unexpected error: ",y),(0,f.Mb)(y,M.B.GetConceptUrl()),(0,f.ey)(C,"GetConcept",y)}})}},1239:(Re,ce,_)=>{_.d(ce,{I:()=>d,r:()=>r});var B=_(9639),M=_(9581),c=_(3518),f=_(1863),A=_(1834),N=_(1596),a=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};function r(h){return a(this,void 0,void 0,function*(){const C=A.Logger.logfunction("GetConceptBulk",[h.length])||{};let T=[],b=((new Date).getTime(),performance.now()),m=Array.from(new Set(h));try{if(A.serviceWorker){C.serviceWorker=!0;try{const y=yield(0,A.sendMessage)("GetConceptBulk",{passedConcepts:h});return A.Logger.logUpdate(C),y.data}catch(y){console.error("GetConceptBulk sw error: ",y),(0,f.ey)(C,"GetConceptBulk",y),(0,A.handleServiceWorkerException)(y)}}if(m.length>0){let y=[];for(let s=0;s<m.length;s++)if(!B.I.GetNpc(m[s])){let p=yield B.I.GetConcept(m[s]);0==p.id?y.push(m[s]):T.push(p)}if(0==y.length)return A.Logger.logfunction(C),T;{let s;const p={method:"POST",headers:(0,c.Xr)(),body:JSON.stringify(y)};try{s=yield fetch(M.B.GetConceptBulkUrl(),p)}catch{s=yield(0,N.g)(p,"/api/get_concept_bulk")}yield function(I,x,w,F,E){return a(this,void 0,void 0,function*(){if(I.ok){let D=yield I.json();if(D.length>0)for(let G=0;G<D.length;G++){let Z=D[G];B.I.AddConcept(Z),w.push(Z)}console.log("added the concepts"),A.Logger.logUpdate(F)}else console.log("Get Concept Bulk error",I.status),A.Logger.logError(E,"unknown","read","unknown",void 0,I.status,I,"GetConceptBulk",[x],"unknown",void 0),(0,f.ry)(I)})}(s,h,T,C,b)}}}catch(y){y instanceof Error?console.log("Get Concept Bulk  error message: ",y.message):console.log("Get Concept Bulk  unexpected error: ",y),A.Logger.logError(b,"unknown","read","unknown",void 0,500,y,"GetConceptBulk",[h],"unknown",void 0),(0,f.Mb)(y,M.B.GetConceptBulkUrl()),(0,f.ey)(C,"GetConceptBulk",y)}return T})}function d(h){return a(this,void 0,void 0,function*(){const C=[];if(h.length>0){const T={"Content-Type":"application/json"};try{const b=yield fetch(M.B.GetConceptBulkUrl(),{method:"POST",headers:T,body:JSON.stringify(h)});if(b.ok){const m=yield b.json();if(m.length>0)for(let y=0;y<m.length;y++){const s=m[y];C.push(s),B.I.AddConcept(s)}}else console.log("bulk concept getter api error: ",b.status),(0,f.ry)(b)}catch(b){b instanceof Error?console.log("bulk concept getter api error: ",b.message):console.log("bulk concept getter api error: ",b),(0,f.Mb)(b,M.B.GetConceptBulkUrl())}}return C})}},4402:(Re,ce,_)=>{_.d(ce,{A:()=>r});var B=_(9639),M=_(9581),c=_(3518),f=_(1863),A=_(1834),N=_(7876),a=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};function r(d,h){var C=arguments;return a(this,void 0,void 0,function*(){const T=A.Logger.logfunction("GetConceptByCharacterAndType",C);try{if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetConceptByCharacterAndType",{characterValue:d,typeId:h})).data}catch(p){console.error("GetConceptByCharacterAndType sw error: ",p),(0,A.handleServiceWorkerException)(p)}let s=yield B.I.GetConceptByCharacterAndTypeLocal(d,h);if(null==s||0==s.id){var b={character_value:`${d}`,type_id:h},m=JSON.stringify(b),y=(0,c.Xr)();const p=yield fetch(M.B.GetConceptByCharacterAndTypeUrl(),{method:"POST",headers:y,body:m});p.ok?(s=yield p.json(),(0,N.K)(s).then(x=>{B.I.AddConcept(s)})):((0,f.ry)(p),console.log("This is the concept by type and character error",p.status))}return A.Logger.logUpdate(T),s}catch(s){s instanceof Error?console.log(" This is the concept by type and character error message: ",s.message):console.log(" This is the concept by type and character unexpected error: ",s),(0,f.Mb)(s,M.B.GetConceptByCharacterAndTypeUrl()),(0,f.ey)(T,"GetConceptByCharacterAndType",s)}})}},8146:(Re,ce,_)=>{_.d(ce,{Y:()=>a});var B=_(9639),M=_(9581),c=_(1834),f=_(1863),A=_(7876),N=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function a(r){var d=arguments;return N(this,void 0,void 0,function*(){const h=c.Logger.logfunction("GetConceptByCharacterValue",d);let C=(0,c.CreateDefaultConcept)();try{const T=new FormData;T.append("character_value",r);const b=yield fetch(M.B.GetConceptByCharacterValueUrl(),{method:"POST",body:T});b.ok?(C=yield b.json(),C.id>0&&(0,A.K)(C).then(m=>{B.I.AddConcept(C)}),c.Logger.logUpdate(h)):((0,f.ry)(b),console.log("Error in Getting concept by character value Error",b.status))}catch(T){T instanceof Error?console.log("Error in Getting concept by character value error message: ",T):console.log("Error in Getting concept by character value unexpected error: ",T),(0,f.Mb)(T,M.B.GetConceptByCharacterValueUrl()),(0,f.ey)(h,"GetConceptByCharacterValue",T)}return C})}},7467:(Re,ce,_)=>{_.d(ce,{j:()=>d});var B=_(8286),M=_(9581),c=_(4364),f=_(3518),A=_(1863),N=_(1834),a=_(1596),r=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};function d(){return r(this,arguments,void 0,function*(h=[]){const C=N.Logger.logfunction("GetConnectionBulk",h.length)||{};let T=[];try{if(N.serviceWorker){C.serviceWorker=!0;try{const b=yield(0,N.sendMessage)("GetConnectionBulk",{connectionIds:h});return N.Logger.logUpdate(C),b.data}catch(b){console.error("GetConnectionBulk sw error: ",b),(0,A.ey)(C,"GetConnectionBulk",b),(0,N.handleServiceWorkerException)(b)}}if(h.length>0){let b=[];for(let m=0;m<h.length;m++)if(!B.d.GetNpConn(h[m])){let y=yield B.d.GetConnection(h[m]);0==y.id?b.push(h[m]):T.push(y)}if(0==b.length)return N.Logger.logUpdate(C),T;{let m;const y={method:"POST",headers:(0,f.Xr)(),body:JSON.stringify(b)};try{m=yield fetch(M.B.GetConnectionBulkUrl(),y)}catch{m=yield(0,a.g)(y,"/api/get_connection_bulk")}yield function(s,p,I){return r(this,void 0,void 0,function*(){if(s.ok){const x=yield s.json();if(x.length>0)for(let w=0;w<x.length;w++){let F=x[w];p.push(F),B.d.AddConnection(F)}}else(0,A.ey)(I,"GetConnectionBulk",s.status),(0,A.ry)(s),console.log("Get Connection Bulk error",s.status)})}(m,T,C),N.Logger.logUpdate(C)}}}catch(b){b instanceof Error?console.log("Get Connection Bulk error message: ",b):console.log("Get Connection Bulk unexpected error: ",b),(0,A.ey)(C,"GetConnectionBulk",b),(0,A.Mb)(b,M.B.GetConnectionBulkUrl())}return yield(0,c.s)(T),T})}},2832:(Re,ce,_)=>{_.d(ce,{j:()=>N});var B=_(1834),M=_(9581),c=_(1863),f=_(3518),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};function N(a){var r=arguments;return A(this,arguments,void 0,function*(d,h=""){const C=B.Logger.logfunction("SearchLinkMultipleApi",r);let T=performance.now();var b=(0,f.ab)("application/json",h);const m=M.B.SearchLinkMultipleAllApiUrl(),y=JSON.stringify(d);try{const s=yield fetch(m,{method:"POST",headers:b,body:y});if(s.ok){let p=yield s.json();return B.Logger.logUpdate(C),p}return(0,c.ry)(s),console.log("This is the searching multiple error",s.status),B.Logger.logError(T,"unknown","search","unknown",void 0,s.status,s,"SearchLinkMultipleApi",[d,h],"unknown",void 0),[]}catch(s){console.log("This is the searching multiple error",s),B.Logger.logError(T,"unknown","search","unknown",void 0,500,s,"SearchLinkMultipleApi",[d,h],"unknown",void 0),(0,c.Mb)(s,m),(0,c.ey)(C,"SearchLinkMultipleApi",s)}})}},3130:(Re,ce,_)=>{_.d(ce,{BG:()=>N,SL:()=>a,XZ:()=>A,ZJ:()=>c,iw:()=>f,y0:()=>M,yv:()=>B});const B=1,M=2,c=3,f=4,A=5,N=6,a=7},9635:(Re,ce,_)=>{_.d(ce,{x:()=>B});const B=new BroadcastChannel("Freeschema_mftsccs_browser_channel")},9581:(Re,ce,_)=>{_.d(ce,{B:()=>B});class B{static setRandomizer(c){console.log("set randomizer",c),this.BASE_RANDOMIZER=c}static getRandomizer(){return this.BASE_RANDOMIZER}static GetConceptUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/getConcept":this.NODE_CACHE_URL+"/api/getConcept"}static GetConnectionUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get-connection-by-id":this.NODE_CACHE_URL+"/api/get-connection-by-id"}static GetConceptBulkUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get_concept_bulk":this.NODE_CACHE_URL+"/api/get_concept_bulk"}static GetConnectionBulkUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get_connection_bulk":this.NODE_CACHE_URL+"/api/get_connection_bulk"}static GetAllConceptsOfUserUrl(){return this.BASE_URL+"/api/get_all_concepts_of_user"}static GetAllConnectionsOfUserUrl(){return this.BASE_URL+"/api/get_all_connections_of_user"}static GetAllConnectionsOfCompositionUrl(){return this.BASE_URL+"/api/get_all_connections_of_composition"}static GetAllConnectionsOfCompositionBulkUrl(){return this.BASE_URL+"/api/get_all_connections_of_composition_bulk"}static GetConceptByCharacterValueUrl(){return this.BASE_URL+"/api/get_concept_by_character_value"}static GetConceptByCharacterAndTypeUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_type"}static GetConceptByCharacterAndCategoryUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_category"}static GetConceptByCharacterAndCategoryDirectUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_category_direct"}static GetCharacterByCharacterUrl(){return this.BASE_URL+"/api/get_character_by_character"}static GetAllConceptsByTypeUrl(){return this.BASE_URL+"/api/get_all_concepts_by_type"}static GetAllConnectionsOfConceptUrl(){return this.BASE_URL+"/api/get-link-connections"}static GetAllConnectionsToConceptUrl(){return this.BASE_URL+"/api/get-link-reverse-connections"}static GetAllAiData(){return this.BASE_URL+"/api/get-preloaded-concepts"}static getMyCacheServer(){return this.NODE_URL+"/api/v1/cache-server"}static PostPrefetchConceptConnections(){return this.NODE_URL+"/api/v1/access-tracker/sync-access-tracker"}static GetSuggestedConcepts(){return this.NODE_URL+"/api/v1/access-tracker/list-concepts-file"}static GetSuggestedConnections(){return this.NODE_URL+"/api/v1/access-tracker/list-connections-file"}static PostLogger(){return this.LOG_SERVER+"/api/logger"}static GetAllPrefetchConnectionsUrl(){return this.BASE_URL+"/api/get_all_connections_of_user?inpage=500"}static GetAllLinkerConnectionOfConceptUrl(){return this.BASE_URL+"/api/get-all-linkers-from-concept"}static GetAllLinkerConnectionToConceptUrl(){return this.BASE_URL+"/api/get-all-linkers-to-concept"}static DeleteConceptUrl(){return this.BASE_URL+"/api/delete_concept"}static DeleteUserUrl(){return this.BASE_URL+"/api/deleteuser"}static RecursiveSearchUrl(){return this.BASE_URL+"/api/recursivesearch-concept-connection"}static SearchLinkMultipleAllApiUrl(){return this.BASE_URL+"/api/Connection/search-link-multiple-all-ccs"}static MakeTheNameInBackendUrl(){return this.BASE_URL+"/api/make-name-from-frontend"}static SearchAllTypeWithLinker(c=!0){return c?this.BASE_URL+"/api/search-all-with-linker-ccs":this.BASE_URL+"/api-search-compositions-internal-clean-ccs"}static LoginUrl(){return this.BASE_URL+"/api/auth/login"}static SignupUrl(){return this.BASE_URL+"/api/auth/signup"}static GetCompositionConnectionBetweenTwoConceptsUrl(){return this.BASE_URL+"/api/get-composition-connection-between-two-concepts"}static SearchCompositionsUrl(){return this.BASE_URL+"/api/search-compositions"}static SearchLinkMultipleAll(){return this.BASE_URL+"/api/Connection/search-link-multiple-all"}static CreateSessionId(){return this.BASE_URL+"/api/create-session-id-remote"}static CreateSessionVisitUrl(){return this.BASE_URL+"/api/create-remote-session-visit"}static ViewInternalDataUrl(){return this.BASE_URL+"/api/view-api-internal-data-ccs-id-bulk"}static SearchInternalWithAuthenticatedCcsUrl(){return this.BASE_URL+"/api/search-composition-internal-authenticated-ccs"}static SearchInternalWithCcsUrl(){return this.BASE_URL+"/api-search-compositions-internal-clean-ccs"}static CreateGhostConceptApiUrl(){return B.NODE_URL+"/api/v1/local-concepts"}static CreateGhostConnectionApiUrl(){return B.NODE_URL+"/api/v1/local-connections"}static GetRealConceptById(){return B.NODE_URL+"/api/v1/local-concepts-translate"}static GetReservedIdUrl(){return this.BASE_URL+"/api/get_reserved_ids"}static GetReservedConnectionIdUrl(){return this.BASE_URL+"/api/get_reserved_connection_ids"}static CreateTheTextDataUrl(){return this.BASE_URL+"/api/create_text_data"}static CreateTheCharacterDataUrl(){return this.BASE_URL+"/api/create_character_data"}static CreateTheConceptUrl(){return this.BASE_URL+"/api/create_the_concept"}static CreateTheConnectionUrl(){return this.BASE_URL+"/api/create_the_connection"}static CreateTheConnectionNewUrl(){return this.BASE_URL+"/api/create_the_connection_new"}static MakeTheTypeConceptUrl(){return this.BASE_URL+"/api/make_the_type_concept"}static DeleteTheConnectionUrl(){return this.BASE_URL+"/api/delete_connection"}static FreeschemaQueryUrl(){return this.BASE_URL+"/api/freeschema-query"}static uploadImageUrl(){return this.BASE_URL+"/api/Image/UploadImage"}static uploadFileUrl(){return this.BASE_URL+"/api/Image/UploadFile"}static sendMail(){return this.BASE_URL+"/api/sendmail"}static sendBulkMail(){return this.BASE_URL+"/api/sendmail/bulk"}static getWidgetData(){return this.BASE_URL+"/api/get-widget"}static getLatestWidgetData(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get-latest-widget":this.NODE_CACHE_URL+"/api/get-latest-widget"}static getConnectionsByTypes(){return this.BASE_URL+"/api/get-connection-by-types"}static CreatePrototypeUrl(){return this.BASE_URL+"/api/create-prototype"}}B.BASE_URL="https://localhost:7053/",B.NODE_CACHE_URL="",B.AI_URL="https://ai.freeschema.com",B.MQTT_URL="192.168.1.249",B.NODE_URL="http://localhost:5001",B.LOG_SERVER="https://logdev.freeschema.com",B.BASE_APPLICATION="",B.FLAGS={logApplication:!1,logPackage:!1,accessTracker:!1,isTest:!1},B.BASE_RANDOMIZER=999},6963:(Re,ce,_)=>{_.d(ce,{f:()=>f});var B=_(205),M=_(6731),c=function(A,N,a,r){return new(a||(a=Promise))(function(d,h){function C(m){try{b(r.next(m))}catch(y){h(y)}}function T(m){try{b(r.throw(m))}catch(y){h(y)}}function b(m){var y;m.done?d(m.value):(y=m.value,y instanceof a?y:new a(function(s){s(y)})).then(C,T)}b((r=r.apply(A,N||[])).next())})};let f=(()=>{class A{static waitForDataToLoad(){return c(this,void 0,void 0,function*(){return new Promise((a,r)=>{this.checkFlag(a),setTimeout(()=>{r("not")},25e3)})})}static checkFlag(a){if(B.B.isCharacterLoaded)return a("done");setTimeout(A.checkFlag,1e3,a)}static addNodeToTree(a){return c(this,void 0,void 0,function*(){return null==this.characterRoot?(this.characterRoot=a,this.characterRoot):(this.characterRoot=this.characterRoot.addCharacterNode(a,this.characterRoot,this.characterRoot.height),this.characterRoot)})}static removeNodeByCharacter(a,r){return c(this,void 0,void 0,function*(){this.characterRoot&&this.characterRoot.removeNodeWithVariants(this.characterRoot,a,r)})}static countNumberOfNodes(){return this.characterRoot?this.characterRoot.countNodeBelow(this.characterRoot):0}static addConceptToTree(a){if(""!=a.characterValue){var r=new M.b(a.characterValue,a,null,null);this.addNodeToTree(r)}}static getNodeFromTree(a){return this.characterRoot?this.characterRoot.getCharacterFromNode(a,this.characterRoot):this.characterRoot}static getNodeFromTreeUpdated(a){return this.characterRoot?this.characterRoot.getCharacterFromNode(a,this.characterRoot):this.characterRoot}static getCharacterAndTypeFromTree(a,r){return c(this,void 0,void 0,function*(){return this.characterRoot?this.characterRoot.getFromNodeWithCharacterAndType(a,r,this.characterRoot):this.characterRoot})}static getCharacterAndCategoryFromTree(a,r){return c(this,void 0,void 0,function*(){return this.characterRoot?this.characterRoot.getFromNodeWithCharacterAndCategory(a,r,this.characterRoot):this.characterRoot})}static removeConceptCharacter(a){this.characterRoot&&(this.characterRoot=this.characterRoot.removeNode(this.characterRoot,a))}}return A.characterRoot=null,A})()},2202:(Re,ce,_)=>{_.d(ce,{W:()=>N});var B=_(6963),M=_(6731),c=_(205),f=_(1834),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};let N=(()=>{class a{static addNodeToTree(d){if(null==this.root)return this.root=d,this.root;this.root=this.root.addNode(d,this.root,this.root.height)}static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((d,h)=>{this.checkFlag(d),setTimeout(()=>{h("not")},25e3)})})}static checkFlag(d){if(c.B.isDataLoaded)return d("done");setTimeout(a.checkFlag,1e3,d)}static addConceptToTree(d){let h=new M.b(d.id,d,null,null),C=new M.b(d.characterValue,d,null,null);B.f.addNodeToTree(C),this.addNodeToTree(h)}static getNodeFromTree(d){return A(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(d,this.root):null})}static removeNodeFromTree(d){return A(this,void 0,void 0,function*(){if(this.root){let h=new Event(`${d}`);console.log("this is the fired event after delete",h),(0,f.dispatchIdEvent)(d),this.root=this.root.removeNode(this.root,d)}})}static getConceptListFromIds(d,h,C){return A(this,void 0,void 0,function*(){this.root&&this.root.checkIfIdsInNode(this.root,d,h,C)})}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}return a.root=null,a})()},5457:(Re,ce,_)=>{_.d(ce,{c:()=>N});var B=_(1834),M=_(7282),c=_(205);class f{constructor(r,d){this.value=[],this.height=1,this.key=r,this.value.push(d),this.leftNode=null,this.rightNode=null,this.currentNode=null}addType(r,d,h){var C,T,b,m;if(null==r)return(0,B.dispatchIdEvent)(d,{detail:h}),new f(d,h);if(d<r.key)r.leftNode=this.addType(r.leftNode,d,h);else{if(!(d>r.key))return r.value.includes(h)||((0,B.dispatchIdEvent)(d,{detail:h}),r.value.push(h)),r;r.rightNode=this.addType(r.rightNode,d,h)}r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1;const y=this.getBalanceFactor(r);return y>1&&d<(null===(C=r.leftNode)||void 0===C?void 0:C.key)?this.rightRotate(r):y<-1&&d>(null===(T=r.rightNode)||void 0===T?void 0:T.key)?this.leftRotate(r):y>1&&d>(null===(b=r.leftNode)||void 0===b?void 0:b.key)?(r.leftNode=this.leftRotate(r.leftNode),this.rightRotate(r)):y<-1&&d<(null===(m=r.rightNode)||void 0===m?void 0:m.key)?(r.rightNode=this.rightRotate(r.rightNode),this.leftRotate(r)):r}rightRotate(r){if(r){let d=r.leftNode;if(d)return r.leftNode=d.rightNode,d.rightNode=r,r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,d.height=Math.max(this.getHeight(d.leftNode),this.getHeight(d.rightNode))+1,d}return r}leftRotate(r){if(r){let d=r.rightNode;if(d){let h=d.leftNode;return d.leftNode=r,r.rightNode=h,r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,d.height=Math.max(this.getHeight(d.leftNode),this.getHeight(r.rightNode))+1,d}}return r}getHeight(r){return r?r.height:0}getBalanceFactor(r){return null==r?0:this.getHeight(r.leftNode)-this.getHeight(r.rightNode)}getFromNode(r,d){return d&&(r==d.key?d:r<d.key?this.getFromNode(r,d.leftNode):r>d.key?this.getFromNode(r,d.rightNode):d)}removeNodeWithVariants(r,d,h){if(null==r)return r;if(r.key>d)return r.leftNode=this.removeNodeWithVariants(r.leftNode,d,h),r;if(r.key<d)return r.rightNode=this.removeNodeWithVariants(r.rightNode,d,h),r;if(r.value.length>0)for(let C=0;C<r.value.length;C++)if(h==r.value[C])return r.value.splice(C,1),r;if(null==r.leftNode){let C=r.rightNode;return r=null,C}if(null==r.rightNode){let C=r.leftNode;return r=null,C}{let C=this.inOrderSuccessor(r.rightNode);return r.value=C.value,r.key=C.key,r.currentNode=C.currentNode,r.rightNode=this.removeNodeWithVariants(r.rightNode,C.key,h),r}}countNodeBelow(r){return null==r?0:1+this.countNodeBelow(r.leftNode)+this.countNodeBelow(r.rightNode)}inOrderSuccessor(r){for(;null!=r.leftNode;)r=r.leftNode;return r}}var A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};class N{static addType(r){return A(this,void 0,void 0,function*(){return null==this.root?(this.root=r,new CustomEvent(`${r.key}`,{detail:r.value[0]}),(0,B.dispatchIdEvent)(r.key,{detail:r.value[0]}),this.root):(this.root=this.root.addType(this.root,r.key,r.value[0]),this.root)})}static addConceptToTree(r){if(0!=r.typeId){let d=new f(r.typeId,r.id);this.addType(d)}}static removeTypeConcept(r,d){this.root&&(this.root=this.root.removeNodeWithVariants(this.root,r,d))}static getNodeFromTreeNew(r){return this.root?this.root.getFromNode(r,this.root):this.root}static getTypeVariantsFromTreeNew(r){return A(this,void 0,void 0,function*(){let d=this.getNodeFromTreeNew(r),h=[],C=[];if(d){h=d.value;for(let T=0;T<h.length;T++){let b=!1;for(let m=0;m<C.length;m++)C[m].id==h[T]&&(b=!0);b||C.push(yield(0,B.GetTheConcept)(h[T]))}}return C})}static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((r,d)=>{this.checkFlag(r),setTimeout(()=>{d("not")},25e3)})})}static checkFlag(r){if(c.B.isTypeLoaded)return r("done");setTimeout(N.checkFlag,1e3,r)}static getTypeVariantsFromTreeWithUserIdNew(r,d){return A(this,void 0,void 0,function*(){let h=[],C=yield this.getTypeVariantsFromTreeNew(r);console.log("these are all the concepts",C);for(let T=0;T<C.length;T++)C[T].userId==d&&h.push(C[T]);return h})}static getTypeVariantsWithCharacterValueNew(r,d){return A(this,void 0,void 0,function*(){let h=yield this.getTypeVariantsFromTreeNew(d);console.log("this is all the concepts for character",h);let C=(0,M.o)();for(let T=0;T<h.length;T++)h[T].characterValue==r&&(C=h[T]);return C})}static countNumberOfNodes(){return this.typeRoot?this.typeRoot.countNodeBelow(this.typeRoot):0}}N.typeRoot=null,N.root=null},2615:(Re,ce,_)=>{_.d(ce,{j:()=>M});var B=_(1834);class M{constructor(f,A,N,a,r,d,h,C=!1,T,b,m){this.count=0,this.typeCharacter="",this.referent=null,this.isComposition=!1,this.isTemp=!1,this.isSynced=!1,this.applicationId=B.BaseUrl.getRandomizer(),this.x=0,this.y=0,this.id=f,this.userId=A,this.typeId=N,this.ghostId=f,this.categoryId=a,this.referentId=r,this.characterValue=`${d}`,this.accessId=h,this.typeCharacter=m,this.type=null,this.isNew=C,this.entryTimeStamp=T,this.updatedTimeStamp=b}getType(){console.log(this.typeId)}}},9639:(Re,ce,_)=>{_.d(ce,{I:()=>r});var B=_(3655),M=_(2202),c=_(6963),f=_(5457),A=_(7282),N=_(1834),a=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};class r{constructor(){this.name="conceptsArray"}static CheckContains(h){for(var C=!1,T=0;T<this.conceptsArray.length;T++)this.conceptsArray[T].id==h.id&&(C=!0);return C}static AddNpc(h){this.NPC.includes(h)||(this.NPC.length>10&&(this.NPC=[]),this.NPC.push(h))}static GetNpc(h){return!!this.NPC.includes(h)}static AddConceptToStorage(h){h.id>0&&(0,B.kH)("concept",h)}static GetConceptBulkData(h,C,T){return a(this,void 0,void 0,function*(){yield M.W.getConceptListFromIds(h,C,T)})}static AddConcept(h){if(N.serviceWorker)try{(0,N.sendMessage)("ConceptsData__AddConcept",{concept:h})}catch(C){console.error("Concept Data, Add Concpet sw error: ",C),(0,N.handleServiceWorkerException)(C)}h.id>0&&(M.W.addConceptToTree(h),f.c.addConceptToTree(h))}static AddConceptToMemory(h){h.id>0&&(M.W.addConceptToTree(h),f.c.addConceptToTree(h))}static AddConceptTemporary(h){var C=this.CheckContains(h);this.conceptDictionary[h.id]=h,C&&this.RemoveConcept(h),this.conceptsArray.push(h)}static RemoveConcept(h){for(var C=0;C<this.conceptsArray.length;C++)this.conceptsArray[C].id==h.id&&this.conceptsArray.splice(C,1);(0,B.wh)("concept",h.id)}static GetConcept(h){return a(this,void 0,void 0,function*(){if(N.serviceWorker)try{return(yield(0,N.sendMessage)("ConceptsData__GetConcept",{id:h})).data}catch(m){console.error("Concept Data, Get Concpet sw error: ",m),(0,N.handleServiceWorkerException)(m)}if(0==h||null==h||null==h)return(0,A.o)();var C=(0,A.o)(),T=yield M.W.getNodeFromTree(h);if(T?.value){var b=T.value;b&&(C=b)}return C})}static GetConceptByCharacter(h){return a(this,void 0,void 0,function*(){var C=(0,A.o)(),T=c.f.getNodeFromTree(h);return T&&(C=T.value),C})}static GetConceptByCharacterUpdated(h){return a(this,void 0,void 0,function*(){var C=(0,A.o)(),T=c.f.getNodeFromTree(h);return T&&(C=T.value),C})}static GetConceptByCharacterAndTypeLocal(h,C){return a(this,void 0,void 0,function*(){return(0,A.o)(),yield f.c.getTypeVariantsWithCharacterValueNew(h,C)})}static GetConceptByCharacterAndCategoryLocal(h,C){return a(this,void 0,void 0,function*(){var T=(0,A.o)(),b=yield c.f.getCharacterAndCategoryFromTree(h,C);return b&&(T=b.value),T})}static GetConceptsByTypeId(h){let C=[];for(var T=0;T<this.conceptsArray.length;T++)this.conceptsArray[T].typeId==h&&C.push(this.conceptsArray[T]);return C}static GetConceptsByTypeIdAndUser(h,C){var T=arguments;return a(this,void 0,void 0,function*(){if(N.Logger.logfunction("ConceptsData.GetConceptsByTypeIdAndUser",T),N.serviceWorker)try{return(yield(0,N.sendMessage)("ConceptsData__GetConceptsByTypeIdAndUser",{typeId:h,userId:C})).data}catch(m){console.error("Concept Data, Get Concpet sw error:",m),(0,N.handleServiceWorkerException)(m)}let b=[];return b=yield f.c.getTypeVariantsFromTreeWithUserIdNew(h,C),b})}static GetBinaryCharacterTree(){return c.f.characterRoot}getName(){return this.name}}r.conceptsArray=[],r.NPC=[],r.conceptDictionary=[]},2155:(Re,ce,_)=>{_.d(ce,{N:()=>c});var B=_(7282),M=_(9581);class c{constructor(A=0,N,a,r,d,h,C){this.count=0,this.isTemp=!1,this.toUpdate=!1,this.applicationId=M.B.getRandomizer(),this.type=(0,B.o)(),this.ofConcept=(0,B.o)(),this.toConcept=(0,B.o)(),this.id=A,this.ofTheConceptId=N,this.toTheConceptId=a,this.userId=r,this.typeId=d,this.ghostId=A,this.orderId=h,this.accessId=C,this.entryTimeStamp=new Date,this.terminationDateTime=new Date,this.localSyncTime=new Date,this.typeCharacter=""}}},5239:(Re,ce,_)=>{_.d(ce,{O:()=>A});var B=_(205),M=_(1834);class c{constructor(a,r,d,h){this.leftNode=null,this.rightNode=null,this.variants=[],this.height=1,this.key=a,this.value=r,this.leftNode=d,this.rightNode=h,this.currentNode=null}addCurrentNode(a,r){return null==r?r=a:(a.value.typeId!=r.value.typeId&&(r.currentNode=this.addCurrentNode(a,r.currentNode)),r)}addCurrentNodeType(a,r){if(null==r)return a;let d=!1;a.value.id==r.value.id&&(d=!0);for(let h=0;h<r.variants.length;h++)r.variants[h].value.id==a.value.id&&(d=!0);return d||r.variants.push(a),r}getMax(a,r){return a>r?a:r}addNode(a,r,d){if(null==r)return(0,M.dispatchIdEvent)(a.value.ofTheConceptId),a;let C=r.rightNode;if(a.key<r.key)r.leftNode=this.addNode(a,r.leftNode,d);else{if(!(a.key>r.key))return r;r.rightNode=this.addNode(a,C,d)}r.height=1+this.getMax(this.getHeight(r.leftNode),this.getHeight(r.rightNode));let T=this.getBalanceFactor(r);if(T>1&&r.leftNode){if(this.getBalanceFactor(r.leftNode)>=0)return this.rightRotate(r);if(this.getBalanceFactor(r.leftNode)<0)return r.leftNode=this.leftRotate(r.leftNode),this.rightRotate(r)}if(T<-1&&r.rightNode){if(this.getBalanceFactor(r.rightNode)<=0)return this.leftRotate(r);if(this.getBalanceFactor(r.rightNode)>0)return r.rightNode=this.rightRotate(r.rightNode),this.leftRotate(r)}return r}addTypeNode(a,r,d){if(0!=a.value.typeId){if(null==r)return a;let C=r.rightNode;if(r.key>a.key)r.leftNode=this.addTypeNode(a,r.leftNode,d);else{if(!(r.key<a.key))return r.key==a.key&&0!=r.key&&r.addCurrentNodeType(a,r),r;r.rightNode=this.addTypeNode(a,C,d)}r.height=1+this.getMax(this.getHeight(r.leftNode),this.getHeight(r.rightNode));let T=this.getBalanceFactor(r);if(T>1&&r.leftNode){if(a.key<r.leftNode.key)return this.rightRotate(r);if(a.key>r.leftNode.key)return r.leftNode=this.leftRotate(r.leftNode),this.rightRotate(r)}if(T<-1&&r.rightNode){if(a.key>r.rightNode.key)return this.leftRotate(r);if(a.key<r.rightNode.key)return r.rightNode=this.rightRotate(r.rightNode),this.leftRotate(r)}}return r}rightRotate(a){if(a){let r=a.leftNode;if(r)return a.leftNode=r.rightNode,r.rightNode=a,a.height=this.getMax(this.getHeight(a.leftNode),this.getHeight(a.rightNode))+1,r.height=this.getMax(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,r;throw console.log("this is the error in right rotation",a,r),new Error("Cannot perform right rotation: left node is null.")}return a}leftRotate(a){if(a){let r=a.rightNode;if(r){let d=r.leftNode;return r.leftNode=a,a.rightNode=d,a.height=this.getMax(this.getHeight(a.leftNode),this.getHeight(a.rightNode))+1,r.height=this.getMax(this.getHeight(r.leftNode),this.getHeight(a.rightNode))+1,r}throw console.log("this is the error in left rotation",a,r),new Error("Cannot perform left rotation: right node is null.")}return a}getHeight(a){return a?a.height:0}getBalanceFactor(a){return null==a?0:this.getHeight(a.leftNode)-this.getHeight(a.rightNode)}getFromNode(a,r){try{if(r)return a==r.key?(r.value.count?r.value.count++:r.value.count=1,r):a<r.key?this.getFromNode(a,r.leftNode):a>r.key?this.getFromNode(a,r.rightNode):r}catch{console.log("this is the exception",a,r,r?.leftNode,r?.rightNode)}return r}getCharacterFromNode(a,r){return r&&(a==r.key?r:a<r.key?this.getCharacterFromNode(a,r.leftNode):a>r.key?this.getCharacterFromNode(a,r.rightNode):r)}checkIfIdsInNode(a,r,d,h){if(a){if(r.includes(a.key)){d.push(a.value);let C=r.indexOf(a.key);r.splice(C,1)}a.leftNode&&this.checkIfIdsInNode(a.leftNode,r,d,h),a.rightNode&&this.checkIfIdsInNode(a.rightNode,r,d,h)}}traverse(a){let r=0;return a&&(r+=1,a?.leftNode&&(r+=this.traverse(a.leftNode)),a.rightNode&&(r+=this.traverse(a.rightNode))),r}removeNode(a,r){if(null==a)return a;if(a.key>r)return a.leftNode=this.removeNode(a.leftNode,r),a;if(a.key<r)return a.rightNode=this.removeNode(a.rightNode,r),a;if(new Event(`${a.value.ofTheConceptId}`),(0,M.dispatchIdEvent)(a.value.ofTheConceptId),null==a.leftNode){let d=a.rightNode;return a=null,d}if(null==a.rightNode){let d=a.leftNode;return a=null,d}{let d=this.inOrderSuccessor(a.rightNode);return a.value=d.value,a.key=d.key,a.variants=d.variants,a.currentNode=d.currentNode,a.rightNode=this.removeNode(a.rightNode,d.key),a}}removeNodeWithVariants(a,r,d){if(null==a)return a;if(a.key>r)return a.leftNode=this.removeNodeWithVariants(a.leftNode,r,d),a;if(a.key<r)return a.rightNode=this.removeNodeWithVariants(a.rightNode,r,d),a;if(a.variants.length>0)if(a.value.id==d){let h=a.variants[0];if(h)return a.value=h.value,a.key=h.key,a.currentNode=h.currentNode,a.variants.splice(0,1),a}else for(let h=0;h<a.variants.length;h++)if(d==a.variants[h].value.id)return a.variants.splice(h,1),a;if(null==a.leftNode){let h=a.rightNode;return a=null,h}if(null==a.rightNode){let h=a.leftNode;return a=null,h}{let h=this.inOrderSuccessor(a.rightNode);return a.value=h.value,a.key=h.key,a.variants=h.variants,a.currentNode=h.currentNode,a.rightNode=this.removeNodeWithVariants(a.rightNode,h.key,d),a}}inOrderSuccessor(a){for(;null!=a.leftNode;)a=a.leftNode;return a}}var f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};let A=(()=>{class N{static addNodeToTree(r){try{if(null==this.connectionroot)return this.connectionroot=r,this.connectionroot;this.connectionroot=this.connectionroot.addNode(r,this.connectionroot,this.connectionroot.height)}catch(d){throw console.log("This is the error in making the tree",d),d}}static addConnectionToTree(r){let d=new c(r.id,r,null,null);this.addNodeToTree(d)}static traverse(){var r;return null===(r=this.connectionroot)||void 0===r?void 0:r.traverse(this.connectionroot)}static waitForDataToLoad(){return f(this,void 0,void 0,function*(){return new Promise((r,d)=>{this.checkFlag(r),setTimeout(()=>{d("not")},25e3)})})}static checkFlag(r){if(B.B.isConnectionLoaded)return r("done");setTimeout(N.checkFlag,1e3,r)}static removeNodeFromTree(r){return f(this,void 0,void 0,function*(){this.connectionroot&&(this.connectionroot=this.connectionroot.removeNode(this.connectionroot,r))})}static getNodeFromTree(r){return f(this,void 0,void 0,function*(){try{return this.connectionroot?this.connectionroot.getFromNode(r,this.connectionroot):this.connectionroot}catch{console.log("this is the getNodeFromTree",r,this.connectionroot)}})}static getConnectionListFromIds(r,d,h){return f(this,void 0,void 0,function*(){this.connectionroot&&this.connectionroot.checkIfIdsInNode(this.connectionroot,r,d,h)})}}return N.connectionroot=null,N})()},991:(Re,ce,_)=>{_.d(ce,{H:()=>A});var B=_(1834),M=_(3996);class c extends M.i{constructor(a,r,d,h){super(a,r,d,h),this.key="",this.value=[],this.height=1,this.key=a,this.value=r,this.leftNode=d,this.rightNode=h}addNode(a,r,d){if(null==r)return a;let C=r.rightNode;if(r.key>a.key)r.leftNode=this.addNode(a,r.leftNode,d);else{if(!(r.key<a.key))return r;r.rightNode=this.addNode(a,C,d)}r.height=1+Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode));let T=this.getBalanceFactor(r);if(T>1&&r.leftNode){if(this.getBalanceFactor(r.leftNode)>=0)return this.rightRotate(r);if(this.getBalanceFactor(r.leftNode)<0)return r.leftNode=this.leftRotate(r.leftNode),this.rightRotate(r)}if(T<-1&&r.rightNode){if(this.getBalanceFactor(r.rightNode)<=0)return this.leftRotate(r);if(this.getBalanceFactor(r.rightNode)>0)return r.rightNode=this.rightRotate(r.rightNode),this.leftRotate(r)}return r}}var f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};let A=(()=>{class N{static CreateCompositionKey(r,d){return r}static GetConnectionByOfTheConceptAndTypeId(r,d){let h=this.CreateCompositionKey(r,d);if(this.node){let C=this.node.getFromNode(h,this.node);if(C)return C.value}return null}static addConnection(r){if(r.id>0){let d=this.CreateCompositionKey(r.ofTheConceptId,r.typeId);if(this.node){let h=this.node.getFromNode(d,this.node);if(h){let C=h?.value;0==C.length&&(h.value=[]),C.includes(r.id)||C.push(r.id)}else{let C=[];C.push(r.id);let T=new c(d,C,null,null);this.addNodeToTree(T)}}else{let h=[];h.push(r.id);let C=new c(d,h,null,null);this.addNodeToTree(C)}new Event(`${d}`)}else console.log("cannot insert key id with  n 0 to the connection tree",r)}static addNodeToTree(r){return f(this,void 0,void 0,function*(){return null==this.node?(this.node=r,console.log("this is type dispatch in connection",r),(0,B.dispatchIdEvent)(r.key),this.node):(this.node=this.node.addNode(r,this.node,this.node.height),this.node)})}static removeNodeFromTree(r){return f(this,void 0,void 0,function*(){this.node&&(this.node=this.node.removeNode(this.node,r))})}}return N.node=null,N})()},3996:(Re,ce,_)=>{_.d(ce,{i:()=>B});class B{constructor(c,f,A,N){this.key="",this.value=[],this.height=1,this.key=c,this.value=f,this.leftNode=A,this.rightNode=N}getFromNode(c,f){return f&&(c==f.key?f:c<f.key?this.getFromNode(c,f.leftNode):c>f.key?this.getFromNode(c,f.rightNode):f)}rightRotate(c){if(c){let f=c.leftNode;if(f)return c.leftNode=f.rightNode,f.rightNode=c,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode))+1,f}return c}leftRotate(c){if(c){let f=c.rightNode;if(f){let A=f.leftNode;return f.leftNode=c,c.rightNode=A,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(c.rightNode))+1,f}}return c}getHeight(c){return c?c.height:0}getBalanceFactor(c){return null==c?0:this.getHeight(c.leftNode)-this.getHeight(c.rightNode)}removeNode(c,f){if(null==c)return c;if(c.key>f)return c.leftNode=this.removeNode(c.leftNode,f),c;if(c.key<f)return c.rightNode=this.removeNode(c.rightNode,f),c;if(null==c.leftNode){let A=c.rightNode;return c=null,A}if(null==c.rightNode){let A=c.leftNode;return c=null,A}{let A=this.inOrderSuccessor(c.rightNode);return c.value=A.value,c.key=A.key,c.variants=A.variants,c.currentNode=A.currentNode,c.rightNode=this.removeNode(c.rightNode,A.key),c}}inOrderSuccessor(c){for(;null!=c.leftNode;)c=c.leftNode;return c}}},8286:(Re,ce,_)=>{_.d(ce,{d:()=>T});var B=_(1735),M=_(1834),c=_(3655),f=_(1863),A=_(2155),N=_(5239),a=_(991),r=_(3996);class d extends r.i{constructor(m,y,s,p){super(m,y,s,p),this.key="",this.value=[],this.height=1,this.key=m,this.value=y,this.leftNode=s,this.rightNode=p}addNode(m,y,s){if(null==y)return m;let I=y.rightNode;if(y.key>m.key)y.leftNode=this.addNode(m,y.leftNode,s);else{if(!(y.key<m.key))return y;y.rightNode=this.addNode(m,I,s)}y.height=1+Math.max(this.getHeight(y.leftNode),this.getHeight(y.rightNode));let x=this.getBalanceFactor(y);if(x>1&&y.leftNode){if(m.key<y.leftNode.key)return this.rightRotate(y);if(m.key>y.leftNode.key)return y.leftNode=this.leftRotate(y.leftNode),this.rightRotate(y)}if(x<-1&&y.rightNode){if(m.key>y.rightNode.key)return this.leftRotate(y);if(m.key<y.rightNode.key)return y.rightNode=this.rightRotate(y.rightNode),this.leftRotate(y)}return y}}let h=(()=>{class b{static CreateCompositionKey(y){return y}static addNodeToTree(y){return s=this,I=function*(){return null==this.connectionTypeRoot?(this.connectionTypeRoot=y,this.connectionTypeRoot):(this.connectionTypeRoot=this.connectionTypeRoot.addNode(y,this.connectionTypeRoot,this.connectionTypeRoot.height),this.connectionTypeRoot)},new((p=void 0)||(p=Promise))(function(x,w){function F(G){try{D(I.next(G))}catch(Z){w(Z)}}function E(G){try{D(I.throw(G))}catch(Z){w(Z)}}function D(G){var Z;G.done?x(G.value):(Z=G.value,Z instanceof p?Z:new p(function(V){V(Z)})).then(F,E)}D((I=I.apply(s,[])).next())});var s,p,I}static addConnectionToTree(y){if(y.id>0){let s=this.CreateCompositionKey(y.typeId);if(this.connectionTypeRoot){let p=this.connectionTypeRoot.getFromNode(s,this.connectionTypeRoot);if(p){let I=p?.value;0==I.length&&(p.value=[]),I.includes(y.id)||I.push(y.id)}else{let I=[];I.push(y.id);let x=new d(s,I,null,null);this.addNodeToTree(x)}}else{let p=[];p.push(y.id);let I=new d(s,p,null,null);this.addNodeToTree(I)}}else console.log("cannot insert key id with  n 0 to the connection tree",y)}static GetConnectionByOfTheConceptAndTypeId(y,s){let p=this.CreateCompositionKey(s);if(this.connectionTypeRoot){let I=this.connectionTypeRoot.getFromNode(p,this.connectionTypeRoot);if(I)return I.value}return null}}return b.connectionTypeRoot=null,b})();var C=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})};class T{constructor(){this.name="Connection Array"}static CheckContains(m){let y=!1;for(let s=0;s<this.connectionArray.length;s++)this.connectionArray[s].id==m.id&&(y=!0);return y}static AddConnectionToStorage(m){(0,c.kH)("connection",m)}static AddNpConn(m){this.deletedConnections.includes(m)||this.deletedConnections.push(m)}static GetNpConn(m){return!!this.deletedConnections.includes(m)}static AddConnection(m){try{N.O.addConnectionToTree(m),h.addConnectionToTree(m),a.H.addConnection(m)}catch(y){throw console.log("this is the error in making the connection"),y}}static AddConnectionToMemory(m){m.isTemp||(N.O.addConnectionToTree(m),h.addConnectionToTree(m),a.H.addConnection(m))}static AddToDictionary(m){this.connectionDictionary[m.id]=m}static RemoveConnection(m){0!=m.id&&((0,c.wh)("connection",m.id),N.O.removeNodeFromTree(m.id),a.H.removeNodeFromTree(m.id))}static GetConnectionTypeOfTree(){}static GetConnectionByOfTheConceptAndType(m,y){return C(this,void 0,void 0,function*(){try{if(M.serviceWorker)try{return(yield(0,M.sendMessage)("ConnectionData__GetConnectionByOfTheConceptAndType",{ofTheConceptId:m,typeId:y})).data}catch(s){console.error("GetConnectionByOfTheConceptAndType sw error: ",s),(0,M.handleServiceWorkerException)(s)}return a.H.GetConnectionByOfTheConceptAndTypeId(m,y)||[]}catch(s){return console.log("this is the error in GetConnectionByOfTheConceptAndType",s),[]}})}static GetConnectionByOfType(m,y){const s=M.Logger.logfunction("ConnectionData.GetConnectionByOfType",arguments);let p=h.GetConnectionByOfTheConceptAndTypeId(m,y);return p?(M.Logger.logUpdate(s),p):(M.Logger.logUpdate(s),[])}static GetConnectionTree(){return N.O.connectionroot}static GetConnectionTypeTree(){return h.connectionTypeRoot}static GetConnectionBulkData(m,y,s){return C(this,void 0,void 0,function*(){yield N.O.getConnectionListFromIds(m,y,s)})}static GetConnection(m){return C(this,void 0,void 0,function*(){B.J.incrementConnection(m);let y=new A.N(0,0,0,0,0,0,0);try{if(M.serviceWorker)try{return(yield(0,M.sendMessage)("ConnectionData__GetConnection",{id:m})).data}catch(p){console.error("GetConnection sw error: ",p),(0,M.handleServiceWorkerException)(p)}let s=yield N.O.getNodeFromTree(m);if(s?.value){let p=s.value;p&&(y=p)}return y}catch(s){return console.log("this is the error in GetConnection",s),y}})}static GetConnectionsOfCompositionLocal(m){var y=arguments;return C(this,void 0,void 0,function*(){const s=M.Logger.logfunction("ConnectionData.GetConnectionsOfCompositionLocal",y)||{};let p=[];try{if(M.serviceWorker){s.serviceWorker=!0;try{const x=yield(0,M.sendMessage)("ConnectionData__GetConnectionsOfCompositionLocal",{id:m});return M.Logger.logUpdate(s),x.data}catch(x){console.error("GetConnectionsOfCompositionLocal sw error: ",x),(0,f.ey)(s,"GetConnectionsOfCompositionLocal",x),(0,M.handleServiceWorkerException)(x)}}let I=[];I=T.GetConnectionByOfType(m,m);for(let x=0;x<I.length;x++){let w=yield N.O.getNodeFromTree(I[x]);w&&p.push(w.value),M.Logger.logUpdate(s)}}catch(I){console.log("this is the error GetConnectionsOfCompositionLocal",m,p),(0,f.ey)(s,"ConnectionData.GetConnectionsOfCompositionLocal",I)}return p})}static GetConnectionsOfConcept(m){return C(this,void 0,void 0,function*(){let y=[],s=[];try{if(M.serviceWorker)try{return(yield(0,M.sendMessage)("ConnectionData__GetConnectionsOfConcept",{id:m})).data}catch(p){console.error("GetConnectionsOfConcept sw error: ",p),(0,M.handleServiceWorkerException)(p)}y=yield T.GetConnectionByOfTheConceptAndType(m,m);for(let p=0;p<y.length;p++){let I=yield N.O.getNodeFromTree(y[p]);I&&s.push(I.value)}return s}catch(p){return console.log("this is the error in GetConnectionsOfConcept",p),s}})}getName(){return this.name}}T.deletedConnections=[],T.connectionArray=[],T.connectionDictionary=[]},205:(Re,ce,_)=>{_.d(ce,{B:()=>B});class B{}B.isTypeLoaded=!1,B.isCharacterLoaded=!1,B.isDataLoaded=!1,B.isLocalDataLoaded=!1,B.isLocalCharacterLoaded=!1,B.isLocalTypeLoaded=!1,B.isConnectionLoaded=!1,B.isConnectionTypeLoaded=!1,B.isLocalConnectionLoaded=!1},2515:(Re,ce,_)=>{_.d(ce,{x:()=>B});class B{constructor(c,f,A,N){this.variants=[],this.height=1,this.key=c,this.value=f,this.leftNode=A,this.rightNode=N,this.currentNode=null}addCurrentNode(c,f){return null==f?f=c:(c.value.typeId!=f.value.typeId&&(f.currentNode=this.addCurrentNode(c,f.currentNode)),f)}addCurrentNodeType(c,f){if(null==f)return c;var A=!1;for(let N=0;N<f.variants.length;N++)f.variants[N].value.id==c.value.id&&(A=!0);return A||f.variants.push(c),f}addNode(c,f,A){if(null==f)return c;var a=f.rightNode;if(f.key>c.key)f.leftNode=this.addNode(c,f.leftNode,A);else{if(!(f.key<c.key))return f;f.rightNode=this.addNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}return f}addCharacterNode(c,f,A){if(""!=c.value.characterValue){if(null==f)return c;var a=f.rightNode;if(f.key>c.key)f.leftNode=this.addCharacterNode(c,f.leftNode,A);else{if(!(f.key<c.key))return f.key==c.key&&""!=f.key&&f.value.id!=c.value.id&&f.addCurrentNodeType(c,f),f;f.rightNode=this.addCharacterNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}addTypeNode(c,f,A){if(0!=c.value.typeId){if(null==f)return c;var a=f.rightNode;if(f.key>c.key)f.leftNode=this.addTypeNode(c,f.leftNode,A);else{if(!(f.key<c.key))return f.key==c.key&&0!=f.key&&f.value.id!=c.value.id&&f.addCurrentNodeType(c,f),f;f.rightNode=this.addTypeNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}rightRotate(c){if(c){let f=c.leftNode;if(f)return c.leftNode=f.rightNode,f.rightNode=c,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode))+1,f}return c}leftRotate(c){if(c){let f=c.rightNode;if(f){let A=f.leftNode;return f.leftNode=c,c.rightNode=A,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(c.rightNode))+1,f}}return c}getHeight(c){return c?c.height:0}getBalanceFactor(c){return null==c?0:this.getHeight(c.leftNode)-this.getHeight(c.rightNode)}getFromNode(c,f){return f&&(c==f.key?f:c<f.key?this.getFromNode(c,f.leftNode):c>f.key?this.getFromNode(c,f.rightNode):f)}updateNodeSyncStatus(c,f,A){if(A){if(c==A.key){let N=A.value;return N.isSynced=f,A.value=N,A}return c<A.key?this.updateNodeSyncStatus(c,f,A.leftNode):c>A.key?this.updateNodeSyncStatus(c,f,A.rightNode):A}return A}getCharacterFromNode(c,f){return f&&(c==f.key?f:c<f.key?this.getCharacterFromNode(c,f.leftNode):c>f.key?this.getCharacterFromNode(c,f.rightNode):f)}getFromNodeWithCharacterAndType(c,f,A){if(c=`${c}`,A){if(c==A.key){if(c==A.value.characterValue&&f==A.value.typeId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.typeId==f)return A.variants[N]}else{if(c<A.key)return this.getFromNodeWithCharacterAndType(c,f,A.leftNode);if(c>A.key)return this.getFromNodeWithCharacterAndType(c,f,A.rightNode)}return null}return A}getFromNodeWithCharacterAndCategory(c,f,A){if(c=`${c}`,A){if(c==A.key){if(c==A.value.characterValue&&f==A.value.categoryId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.categoryId==f)return A.variants[N]}else{if(c<A.key)return this.getFromNodeWithCharacterAndCategory(c,f,A.leftNode);if(c>A.key)return this.getFromNodeWithCharacterAndCategory(c,f,A.rightNode)}return null}return A}removeNode(c,f){if(null==c)return c;if(c.key>f)return c.leftNode=this.removeNode(c.leftNode,f),c;if(c.key<f)return c.rightNode=this.removeNode(c.rightNode,f),c;if(null==c.leftNode){let N=c.rightNode;return c=null,N}if(null==c.rightNode){let N=c.leftNode;return c=null,N}var A=this.inOrderSuccessor(c.rightNode);return c.value=A.value,c.key=A.key,c.variants=A.variants,c.currentNode=A.currentNode,c.rightNode=this.removeNode(c.rightNode,A.key),c}removeNodeWithVariants(c,f,A){if(null==c)return c;if(c.key>f)return c.leftNode=this.removeNodeWithVariants(c.leftNode,f,A),c;if(c.key<f)return c.rightNode=this.removeNodeWithVariants(c.rightNode,f,A),c;if(c.variants.length>0)if(c.value.id==A){var N=c.variants[0];if(N)return c.value=N.value,c.key=N.key,c.currentNode=N.currentNode,c.variants.splice(0,1),c}else for(let r=0;r<c.variants.length;r++)if(A==c.variants[r].value.id)return c.variants.splice(r,1),c;if(null==c.leftNode){let r=c.rightNode;return c=null,r}if(null==c.rightNode){let r=c.leftNode;return c=null,r}var a=this.inOrderSuccessor(c.rightNode);return c.value=a.value,c.key=a.key,c.variants=a.variants,c.currentNode=a.currentNode,c.rightNode=this.removeNodeWithVariants(c.rightNode,a.key,A),c}countNodeBelow(c){return null==c?0:1+this.countNodeBelow(c.leftNode)+this.countNodeBelow(c.rightNode)}inOrderSuccessor(c){for(;null!=c.leftNode;)c=c.leftNode;return c}}},9736:(Re,ce,_)=>{_.d(ce,{v:()=>p});var B=_(205),M=_(2515),c=function(I,x,w,F){return new(w||(w=Promise))(function(E,D){function G(z){try{V(F.next(z))}catch(P){D(P)}}function Z(z){try{V(F.throw(z))}catch(P){D(P)}}function V(z){var P;z.done?E(z.value):(P=z.value,P instanceof w?P:new w(function(H){H(P)})).then(G,Z)}V((F=F.apply(I,x||[])).next())})};let f=(()=>{class I{static addNodeToTree(w){if(null==this.root)return this.root=w,this.root;this.root=this.root.addNode(w,this.root,this.root.height)}static addConceptToTree(w){var F=new M.x(w.id,w,null,null);new M.x(w.characterValue,w,null,null),this.addNodeToTree(F)}static waitForDataToLoad(){return c(this,void 0,void 0,function*(){return new Promise((w,F)=>{this.checkFlag(w),setTimeout(()=>{F("not")},25e3)})})}static checkFlag(w){if(B.B.isLocalDataLoaded)return w("done");setTimeout(I.checkFlag,1e3,w)}static getNodeFromTree(w){return c(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(w,this.root):null})}static getCharacterAndTypeFromTree(w,F){return this.root?this.root.getFromNodeWithCharacterAndType(w,F,this.root):this.root}static updateSyncStatus(w){return this.root?this.root.updateNodeSyncStatus(w,!0,this.root):this.root}static removeNodeFromTree(w){return c(this,void 0,void 0,function*(){this.root&&(this.root=this.root.removeNode(this.root,w))})}}return I.root=null,I})();var A=function(I,x,w,F){return new(w||(w=Promise))(function(E,D){function G(z){try{V(F.next(z))}catch(P){D(P)}}function Z(z){try{V(F.throw(z))}catch(P){D(P)}}function V(z){var P;z.done?E(z.value):(P=z.value,P instanceof w?P:new w(function(H){H(P)})).then(G,Z)}V((F=F.apply(I,x||[])).next())})};let N=(()=>{class I{static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((w,F)=>{this.checkFlag(w),setTimeout(()=>{F("not")},25e3)})})}static checkFlag(w){if(B.B.isLocalCharacterLoaded)return w("done");setTimeout(I.checkFlag,1e3,w)}static addNodeToTree(w){return A(this,void 0,void 0,function*(){return null==this.LocalCharacterRoot?(this.LocalCharacterRoot=w,this.LocalCharacterRoot):(this.LocalCharacterRoot=this.LocalCharacterRoot.addCharacterNode(w,this.LocalCharacterRoot,this.LocalCharacterRoot.height),this.LocalCharacterRoot)})}static addConceptToTree(w){if(""!=w.characterValue){var F=new M.x(w.characterValue,w,null,null);this.addNodeToTree(F)}}static getNodeFromTree(w){return this.LocalCharacterRoot?this.LocalCharacterRoot.getCharacterFromNode(w,this.LocalCharacterRoot):this.LocalCharacterRoot}static getCharacterAndTypeFromTree(w,F){return A(this,void 0,void 0,function*(){return this.LocalCharacterRoot?this.LocalCharacterRoot.getFromNodeWithCharacterAndType(w,F,this.LocalCharacterRoot):this.LocalCharacterRoot})}static getCharacterAndCategoryFromTree(w,F){return A(this,void 0,void 0,function*(){return this.LocalCharacterRoot?this.LocalCharacterRoot.getFromNodeWithCharacterAndCategory(w,F,this.LocalCharacterRoot):this.LocalCharacterRoot})}static removeConceptType(w,F){this.LocalCharacterRoot&&(this.LocalCharacterRoot=this.LocalCharacterRoot.removeNodeWithVariants(this.LocalCharacterRoot,w,F))}}return I.LocalCharacterRoot=null,I})();var a=function(I,x,w,F){return new(w||(w=Promise))(function(E,D){function G(z){try{V(F.next(z))}catch(P){D(P)}}function Z(z){try{V(F.throw(z))}catch(P){D(P)}}function V(z){var P;z.done?E(z.value):(P=z.value,P instanceof w?P:new w(function(H){H(P)})).then(G,Z)}V((F=F.apply(I,x||[])).next())})};let r=(()=>{class I{static addNodeToTree(w){return a(this,void 0,void 0,function*(){return null==this.LocalTypeRoot?(this.LocalTypeRoot=w,this.LocalTypeRoot):(this.LocalTypeRoot=this.LocalTypeRoot.addTypeNode(w,this.LocalTypeRoot,this.LocalTypeRoot.height),this.LocalTypeRoot)})}static addConceptToTree(w){if(0!=w.typeId){var F=new M.x(w.typeId,w,null,null);this.addNodeToTree(F)}}static removeConceptType(w,F){this.LocalTypeRoot&&(this.LocalTypeRoot=this.LocalTypeRoot.removeNodeWithVariants(this.LocalTypeRoot,w,F))}static getNodeFromTree(w){return this.LocalTypeRoot?this.LocalTypeRoot.getFromNode(w,this.LocalTypeRoot):this.LocalTypeRoot}static getTypeVariantsFromTree(w){var F=this.getNodeFromTree(w),E=[];if(F){E.push(F?.value);for(let D=0;D<F.variants.length;D++)E.push(F.variants[D].value);return E}}static waitForDataToLoad(){return a(this,void 0,void 0,function*(){return new Promise((w,F)=>{this.checkFlag(w),setTimeout(()=>{F("not")},25e3)})})}static checkFlag(w){if(B.B.isLocalTypeLoaded)return w("done");setTimeout(I.checkFlag,1e3,w)}static getTypeVariantsFromTreeWithUserId(w,F){return a(this,void 0,void 0,function*(){var E=[],D=this.getNodeFromTree(w);if(D){console.log("this is the node to type",D),D.value.userId!=F&&999!=D.value.userId||E.push(D?.value);for(let G=0;G<D.variants.length;G++)D.variants[G].value.userId!=F&&999!=D.value.userId||E.push(D.variants[G].value)}return E})}}return I.LocalTypeRoot=null,I})();var d=_(6416),h=_(9639),C=_(7820),T=_(4864),b=_(628),m=_(1834),y=_(3278),s=function(I,x,w,F){return new(w||(w=Promise))(function(E,D){function G(z){try{V(F.next(z))}catch(P){D(P)}}function Z(z){try{V(F.throw(z))}catch(P){D(P)}}function V(z){var P;z.done?E(z.value):(P=z.value,P instanceof w?P:new w(function(H){H(P)})).then(G,Z)}V((F=F.apply(I,x||[])).next())})};let p=(()=>{class I{constructor(){this.name="conceptsArray"}static AddConcept(w){0!=w.id&&(f.addConceptToTree(w),N.addConceptToTree(w),r.addConceptToTree(w),this.localconceptsArray.push(w))}static AddPermanentConcept(w){0!=w.id&&(f.removeNodeFromTree(w.ghostId),N.removeConceptType(w.characterValue,w.ghostId),r.removeConceptType(w.typeId,w.ghostId),C.G.addConceptToTree(w),h.I.AddConcept(w),(0,m.AddGhostConcept)(w,w.userId,y.b.sessionId))}static RemoveConcept(w){return s(this,void 0,void 0,function*(){try{0!=w.id&&(f.removeNodeFromTree(w.ghostId),N.removeConceptType(w.characterValue,w.ghostId),r.removeConceptType(w.typeId,w.ghostId))}catch(F){throw F}})}static RemoveConceptById(w){return s(this,void 0,void 0,function*(){try{let F=yield I.GetConcept(w);0!=F.id&&(f.removeNodeFromTree(w),N.removeConceptType(F.characterValue,F.ghostId),r.removeConceptType(F.typeId,F.ghostId),b.H.RemoveConcept(F))}catch(F){throw F}})}static AddConceptToMemory(w){0!=w.id&&(f.addConceptToTree(w),N.addConceptToTree(w),r.addConceptToTree(w))}static GetConcept(w){return s(this,void 0,void 0,function*(){var F=(0,d.u)(),E=yield f.getNodeFromTree(w);if(E?.value){var D=E.value;D&&(F=D)}return F})}static UpdateConceptSyncStatus(w){return s(this,void 0,void 0,function*(){f.updateSyncStatus(w)})}static GetConceptByGhostId(w){return s(this,void 0,void 0,function*(){var F=(0,d.u)(),E=yield C.G.getNodeFromTree(w);if(E?.value){var D=E.value;D&&(F=D)}return F})}static GetConceptByCharacter(w){return s(this,void 0,void 0,function*(){var F=(0,d.u)(),E=N.getNodeFromTree(w);return E&&(F=E.value),F})}static GetConceptByCharacterAndTypeLocal(w,F){return s(this,void 0,void 0,function*(){var E=(0,d.u)(),D=yield N.getCharacterAndTypeFromTree(w,F);return D&&(E=D.value),E})}static GetConceptByCharacterAndCategoryLocal(w,F){return s(this,void 0,void 0,function*(){var E=(0,d.u)(),D=yield N.getCharacterAndCategoryFromTree(w,F);return D&&(E=D.value),E})}static GetConceptsByTypeId(w){let F=[];for(var E=0;E<this.localconceptsArray.length;E++)this.localconceptsArray[E].typeId==w&&F.push(this.localconceptsArray[E]);return F}static GetConceptsByTypeIdAndUser(w,F){return s(this,void 0,void 0,function*(){let E=[];return E=yield r.getTypeVariantsFromTreeWithUserId(w,F),E})}static ClearData(){return s(this,void 0,void 0,function*(){this.localconceptsArray=[],T.G.connectionArray=[]})}getName(){return this.name}}return I.localconceptsArray=[],I})()},4864:(Re,ce,_)=>{_.d(ce,{G:()=>N});var B=_(2155),M=_(8286),c=_(205),f=_(628),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};class N{constructor(){this.name="Connection Array"}static CheckContains(r){for(var d=!1,h=0;h<this.connectionArray.length;h++)this.connectionArray[h].id==r.id&&(d=!0);return d}static AddConnection(r){this.CheckContains(r)&&this.RemoveConnection(r),this.connectionArray.push(r)}static AddConnectionToMemory(r){this.CheckContains(r)&&this.RemoveConnection(r),this.connectionArray.push(r)}static AddToDictionary(r){this.connectionDictionary[r.id]=r}static RemoveConnection(r){for(var d=0;d<this.connectionArray.length;d++)this.connectionArray[d].id==r.id&&this.connectionArray.splice(d,1)}static RemoveConnectionById(r){for(var d=0;d<this.connectionArray.length;d++)this.connectionArray[d].id==r&&this.connectionArray.splice(d,1);f.H.RemoveConnectionById(r)}static AddPermanentConnection(r){r.id>0&&M.d.AddConnection(function(d){let h=new B.N(0,0,0,0,0,0,0);return h.ofTheConceptId=d.ofTheConceptId,h.toTheConceptId=d.toTheConceptId,h.typeId=d.typeId,h.orderId=d.orderId,h.id=d.id,h}(r))}static GetConnection(r){var d;d=null;for(var h=0;h<this.connectionArray.length;h++)this.connectionArray[h].id==r&&(d=this.connectionArray[h]);return d}static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((r,d)=>{this.checkFlag(r),setTimeout(()=>{d("not")},25e3)})})}static checkFlag(r){if(c.B.isLocalConnectionLoaded)return r("done");setTimeout(N.checkFlag,1e3,r)}static GetConnectionsOfCompositionLocal(r){return A(this,void 0,void 0,function*(){var d=[];try{for(var h=0;h<this.connectionArray.length;h++)this.connectionArray[h].typeId==r&&d.push(this.connectionArray[h]);return d}catch{return d}})}static GetConnectionOfCompositionAndTypeLocal(r,d){return A(this,void 0,void 0,function*(){var h=[];try{for(var C=0;C<this.connectionArray.length;C++)this.connectionArray[C].typeId==r&&this.connectionArray[C].ofTheConceptId==d&&h.push(this.connectionArray[C]);return h}catch{return h}})}getName(){return this.name}}N.connectionArray=[],N.connectionDictionary=[]},7820:(Re,ce,_)=>{_.d(ce,{G:()=>f});var B=_(205),M=_(2515),c=function(A,N,a,r){return new(a||(a=Promise))(function(d,h){function C(m){try{b(r.next(m))}catch(y){h(y)}}function T(m){try{b(r.throw(m))}catch(y){h(y)}}function b(m){var y;m.done?d(m.value):(y=m.value,y instanceof a?y:new a(function(s){s(y)})).then(C,T)}b((r=r.apply(A,N||[])).next())})};let f=(()=>{class A{static addNodeToTree(a){if(null==this.root)return this.root=a,this.root;this.root=this.root.addNode(a,this.root,this.root.height)}static addConceptToTree(a){var r=new M.x(a.ghostId,a,null,null);this.addNodeToTree(r)}static waitForDataToLoad(){return c(this,void 0,void 0,function*(){return new Promise((a,r)=>{this.checkFlag(a),setTimeout(()=>{r("not")},25e3)})})}static checkFlag(a){if(B.B.isLocalDataLoaded)return a("done");setTimeout(A.checkFlag,1e3,a)}static getNodeFromTree(a){return c(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(a,this.root):null})}static removeNodeFromTree(a){return c(this,void 0,void 0,function*(){this.root&&(this.root=this.root.removeNode(this.root,a))})}}return A.root=null,A})()},5257:(Re,ce,_)=>{_.d(ce,{R:()=>f});var B=_(9003),M=_(3075),c=function(A,N,a,r){return new(a||(a=Promise))(function(d,h){function C(m){try{b(r.next(m))}catch(y){h(y)}}function T(m){try{b(r.throw(m))}catch(y){h(y)}}function b(m){var y;m.done?d(m.value):(y=m.value,y instanceof a?y:new a(function(s){s(y)})).then(C,T)}b((r=r.apply(A,N||[])).next())})};class f{static AddConceptId(N){this.localId=N.value,(0,B.kH)("localid",N)}static getConceptId(){return c(this,void 0,void 0,function*(){try{if(this.localId){if(this.ReservedLocalId.length<5){yield(0,M.EO)().then(()=>{let a=this.localId;for(let r=1;r<10;r++){let d=this.localId-r;this.ReservedLocalId.push(d),a=d}this.AddConceptId({id:0,value:a})}).catch(a=>(console.log(" getid: cannot get the id from indexdb"),-Math.floor(1e8*Math.random())));let N=this.ReservedLocalId[0];return this.ReservedLocalId.shift(),N}{let N=this.ReservedLocalId[0];return this.ReservedLocalId.shift(),N}}return yield(0,M.EO)().then(()=>{let N=this.localId;for(let a=1;a<10;a++){let r=this.localId-a;this.ReservedLocalId.push(r),N=r}this.AddConceptId({id:0,value:N})}),this.getConceptId()}catch(N){return console.log(" getid: this is the eror in concept",N),-Math.floor(1e8*Math.random())}})}static AddConnectionId(N){this.localConnectionId=N.value}static getConnectionId(){return c(this,void 0,void 0,function*(){try{if(this.localConnectionId){if(this.ReservedConnectionId.length<5){yield(0,M.xd)().then(()=>{let a=this.localConnectionId;for(let r=1;r<10;r++){let d=this.localConnectionId-r;this.ReservedConnectionId.push(d),a=d}}).catch(a=>(console.log("this is the new event",a),-Math.floor(1e8*Math.random())));let N=this.ReservedConnectionId[0];return this.ReservedConnectionId.shift(),N}{let N=this.ReservedConnectionId[0];return this.ReservedConnectionId.shift(),N}}return yield(0,M.xd)().then(()=>{let N=this.localConnectionId;for(let a=1;a<10;a++){let r=this.localConnectionId-a;this.ReservedConnectionId.push(r),N=r}this.AddConnectionId({id:1,value:N})}),this.getConnectionId()}catch{return-Math.floor(1e8*Math.random())}})}}f.ReservedLocalId=[],f.ReservedConnectionId=[]},628:(Re,ce,_)=>{_.d(ce,{H:()=>b});var B=_(9581),M=_(3278),c=_(1834),f=_(1863),A=function(m,y,s,p){return new(s||(s=Promise))(function(I,x){function w(D){try{E(p.next(D))}catch(G){x(G)}}function F(D){try{E(p.throw(D))}catch(G){x(G)}}function E(D){var G;D.done?I(D.value):(G=D.value,G instanceof s?G:new s(function(Z){Z(G)})).then(w,F)}E((p=p.apply(m,y||[])).next())})};const N=(m,y)=>A(void 0,void 0,void 0,function*(){let s={concepts:[],connections:[]};try{const p=new Headers;let I={concepts:m,connections:y};p.set("Content-Type","application/json"),p.set("Authorization","Bearer "+M.b.BearerAccessToken),p.set("Accept","application/json"),p.set("Randomizer",B.B.getRandomizer().toString());const x=yield fetch(B.B.CreateGhostConceptApiUrl(),{method:"POST",headers:p,body:JSON.stringify(I)});if(!x.ok)throw(0,f.ry)(x),new Error(`Error! status: ${x.status}`);const w=yield x.json();return s.concepts=w.concepts,s.connections=w.connections,s}catch(p){throw p instanceof Error?console.log("Create the concept api error message: ",p.message):console.log("Create the concept api unexpected error: ",p),p}});function a(m,y){const s=[];for(let p=0;p<m.length;p+=y){const I=m.slice(p,p+y);s.push(I)}return s}const r=(...m)=>A(void 0,[...m],void 0,function*(y=[]){return yield Promise.all(y.map(s=>{let p=JSON.parse(JSON.stringify(s));return delete p.type,delete p.ofConcept,delete p.toConcept,p}))});var d=_(9003),h=_(9736),C=_(4864),T=function(m,y,s,p){return new(s||(s=Promise))(function(I,x){function w(D){try{E(p.next(D))}catch(G){x(G)}}function F(D){try{E(p.throw(D))}catch(G){x(G)}}function E(D){var G;D.done?I(D.value):(G=D.value,G instanceof s?G:new s(function(Z){Z(G)})).then(w,F)}E((p=p.apply(m,y||[])).next())})};class b{static CheckContains(y){for(var s=!1,p=0;p<this.conceptsSyncArray.length;p++)this.conceptsSyncArray[p].id==y.id&&(s=!0);return s}static SyncDataDelete(y){for(var s=0;s<this.conceptsSyncArray.length;s++)y==this.conceptsSyncArray[s].id&&this.conceptsSyncArray.splice(s,1);for(s=0;s<this.connectionSyncArray.length;s++)this.connectionSyncArray[s].ofTheConceptId!=y&&this.connectionSyncArray[s].toTheConceptId!=y&&this.connectionSyncArray[s].typeId!=y||this.connectionSyncArray.splice(s,1)}static CheckContainsConnection(y){for(var s=!1,p=0;p<this.connectionSyncArray.length;p++)this.connectionSyncArray[p].id==y.id&&(s=!0);return s}static AddConcept(y){try{let s=!1;0!=b.CheckIfTheConceptIdExists(y.id,this.conceptsSyncArray).id&&(s=!0),s||this.conceptsSyncArray.push(y)}catch(s){throw s}}static RemoveConcept(y){for(var s=0;s<this.conceptsSyncArray.length;s++)this.conceptsSyncArray[s].id==y.id&&this.conceptsSyncArray.splice(s,1)}static SyncDataOnline(y,s){return T(this,void 0,void 0,function*(){let p=performance.now();console.log("syncing...",y,s,"aa: ",this.conceptsSyncArray,this.connectionSyncArray,!!c.serviceWorker),setTimeout(()=>{console.log("syncing...",y,s,"aa: ",this.conceptsSyncArray,this.connectionSyncArray,!!c.serviceWorker)},5e3);try{if(c.serviceWorker)try{return(yield(0,c.sendMessage)("LocalSyncData__SyncDataOnline",{transactionId:y})).data}catch(G){console.error("LocalSyncData__SyncDataOnline sw error: ",G),(0,c.handleServiceWorkerException)(G)}let I=[],x=[];if(y&&this.transactionCollections.some(G=>G.id==y)){const G=this.transactionCollections.find(Z=>Z.id==y);if(this.transactionCollections=this.transactionCollections.filter(Z=>Z.id!=y),this.transactionCollections=this.transactionCollections.filter(Z=>new Date(Z.createdDate).getTime()>(new Date).getTime()-6048e5),!G)return;I=G.data.concepts.slice(),x=G.data.connections.slice()}else Array.isArray(s?.concepts)&&Array.isArray(s?.connections)?(console.log("this is the concepts and connections array",s?.concepts,s?.connections),I=s.concepts.slice(),x=s.connections.slice(),console.log("this is the concepts and connections array",I,x),this.conceptsSyncArray=this.conceptsSyncArray.filter(G=>{const Z=s.concepts.some(V=>G.id==V.id||G.ghostId==V.ghostId);return Z||console.warn(`Concept not found in sync array: ${G.id||G.ghostId}`),Z}),this.connectionSyncArray=this.connectionSyncArray.filter(G=>{const Z=s.connections.some(V=>G.id==V.id||G.ghostId==V.ghostId);return Z||console.warn(`Connection not found in sync array: ${G.id||G.ghostId}`),Z})):(console.warn("Syncing this way has been Depreceted in service worker."),console.info("Only if serive worker is not running"),I=this.conceptsSyncArray.slice()||[],x=this.connectionSyncArray.slice()||[],this.connectionSyncArray=[],this.conceptsSyncArray=[]);let w=[];for(let G=0;G<I.length;G++)w.push(I[G]),yield h.v.UpdateConceptSyncStatus(I[G].id);yield this.UpdateConceptListToIncludeRelatedConcepts(x,w);let F=yield function(G,Z){return A(this,void 0,void 0,function*(){const V=c.Logger.logfunction("CreateTheGhostConceptApi",[G.length,Z.length]);try{let P={concepts:[],connections:[]};const H=yield r(G),te=yield r(Z);if(G.length+Z.length<=2e3){const be=yield N(H,te);return Array.isArray(be?.concepts)&&(P.concepts=[...P.concepts,...be.concepts]),Array.isArray(be?.connections)&&(P.connections=[...P.connections,...be.connections]),c.Logger.logUpdate(V),P}const ye=a(H,1e3),de=a(te,1e3),we=[],fe=[];for(let be=0;be<ye.length;be++)we.push(N(ye[be],[]));const _e=yield Promise.all(we);for(let be=0;be<_e.length;be++){const ue=_e[be];Array.isArray(ue?.concepts)&&(P.concepts=[...P.concepts,...ue.concepts]),Array.isArray(ue?.connections)&&(P.connections=[...P.connections,...ue.connections])}for(let be=0;be<de.length;be++)fe.push(N([],de[be]));const De=yield Promise.all(fe);for(let be=0;be<De.length;be++){const ue=De[be];Array.isArray(ue?.concepts)&&(P.concepts=[...P.concepts,...ue.concepts]),Array.isArray(ue?.connections)&&(P.connections=[...P.connections,...ue.connections])}return c.Logger.logUpdate(V),P}catch(z){throw console.log(z),(0,f.ey)(V,"CreateTheGhostConceptApi",z),z}})}(w,x),E=F.concepts,D=F.connections;for(let G=0;G<E.length;G++)h.v.AddPermanentConcept(E[G]);for(let G=0;G<D.length;G++)C.G.AddPermanentConnection(D[G]);return I}catch(I){throw c.Logger.logError(p,"unknown",void 0,"unknown",void 0,500,I,"SyncDataOnline",[],"unknown",void 0),I}})}static ConvertGhostIdsInConnections(y){var s,p,I;for(let x=0;x<y.length;x++){let w=y[x].ofTheConceptId,F=y[x].toTheConceptId,E=y[x].typeId,D=null!==(s=b.ghostIdMap.get(w))&&void 0!==s?s:w,G=null!==(p=b.ghostIdMap.get(F))&&void 0!==p?p:F,Z=null!==(I=b.ghostIdMap.get(E))&&void 0!==I?I:E;y[x].ofTheConceptId=D,y[x].toTheConceptId=G,y[x].typeId=Z}}static UpdateConceptListToIncludeRelatedConcepts(y,s){return T(this,void 0,void 0,function*(){for(let p=0;p<y.length;p++){let I=y[p].ofTheConceptId,x=y[p].toTheConceptId,w=y[p].typeId;if(I<0){let F=this.CheckIfTheConceptIdExists(I,s);0==F.id&&(F=yield h.v.GetConceptByGhostId(I),0!=F.id?F.id!=F.ghostId&&(y[p].ofTheConceptId=F.id):(F=yield h.v.GetConcept(I),this.AddConceptIfDoesNotExist(F,s)))}if(x<0){let F=this.CheckIfTheConceptIdExists(x,s);0==F.id&&(F=yield h.v.GetConceptByGhostId(x),0!=F.id?F.id!=F.ghostId&&(y[p].toTheConceptId=F.id):(F=yield h.v.GetConcept(x),this.AddConceptIfDoesNotExist(F,s)))}if(w<0){let F=this.CheckIfTheConceptIdExists(w,s);0==F.id&&(F=yield h.v.GetConceptByGhostId(w),0!=F.id?F.id!=F.ghostId&&(y[p].typeId=F.id):(F=yield h.v.GetConcept(w),this.AddConceptIfDoesNotExist(F,s)))}}})}static AddConceptIfDoesNotExist(y,s=[]){let p=!1;for(let I=0;I<s.length;I++)y.ghostId==s[I].ghostId&&(p=!0);p||s.push(y)}static CheckIfTheConceptIdExists(y,s=[]){let p=(0,c.CreateDefaultLConcept)();for(let I=0;I<s.length;I++)y!=s[I].ghostId&&y!=s[I].id||(p=s[I]);return p}static AddConnection(y){this.connectionSyncArray.push(y)}static RemoveConnection(y){for(var s=0;s<this.connectionSyncArray.length;s++)this.connectionSyncArray[s].id==y.id&&this.connectionSyncArray.splice(s,1)}static RemoveConnectionById(y){for(var s=0;s<this.connectionSyncArray.length;s++)this.connectionSyncArray[s].id==y&&this.connectionSyncArray.splice(s,1)}static syncDataLocalDb(){return T(this,void 0,void 0,function*(){if(this.conceptsSyncArray.length>0){for(let y=0;y<this.conceptsSyncArray.length;y++)(0,d.kH)("localconcept",this.conceptsSyncArray[y]);this.conceptsSyncArray=[]}if(this.connectionSyncArray.length>0){for(let y=0;y<this.connectionSyncArray.length;y++)(0,d.kH)("localconnection",this.connectionSyncArray[y]);this.connectionSyncArray=[]}return"done"})}static initializeTransaction(y){return T(this,void 0,void 0,function*(){try{if(c.serviceWorker)try{return(yield(0,c.sendMessage)("LocalSyncData__initializeTransaction",{transactionId:y})).data}catch(s){console.error("LocalSyncData__initializeTransaction sw error: ",s),(0,c.handleServiceWorkerException)(s)}if(this.transactionCollections.some(s=>s.id==y))return;this.transactionCollections.push({id:y,data:{concepts:[],connections:[]},createdDate:(new Date).toISOString()})}catch(s){console.log("error in initializeTransaction",s)}})}static markTransactionActions(y,s){return T(this,void 0,void 0,function*(){try{if(c.serviceWorker)try{return(yield(0,c.sendMessage)("LocalSyncData__markTransactionActions",{transactionId:y,actions:s})).data}catch(p){console.error("LocalSyncData__markTransactionActions sw error: ",p),(0,c.handleServiceWorkerException)(p)}this.transactionCollections=this.transactionCollections.map(p=>p.id==y?Object.assign(Object.assign({},p),{data:JSON.parse(JSON.stringify(s))}):p),this.conceptsSyncArray=this.conceptsSyncArray.filter(p=>!s.concepts.some(I=>I.id==p.id||I.ghostId==p.id)),this.connectionSyncArray=this.connectionSyncArray.filter(p=>!s.connections.some(I=>I.id==p.id||I.ghostId==p.id))}catch(p){console.log("error in markTransactionActions",p)}})}static rollbackTransaction(y,s){return T(this,void 0,void 0,function*(){try{if(c.serviceWorker)try{return(yield(0,c.sendMessage)("LocalSyncData__rollbackTransaction",{transactionId:y,actions:s})).data}catch(p){console.error("LocalSyncData__rollbackTransaction sw error: ",p),(0,c.handleServiceWorkerException)(p)}if(this.transactionCollections.some(p=>p.id==y))return;this.transactionCollections=this.transactionCollections.filter(p=>p.id!=y)}catch(p){console.log("LocalSyncData, roll",p)}})}}b.conceptsSyncArray=[],b.connectionSyncArray=[],b.ghostIdMap=new Map,b.transactionCollections=[]},6731:(Re,ce,_)=>{_.d(ce,{b:()=>B});class B{constructor(c,f,A,N){this.variants=[],this.height=1,this.key=c,this.value=f,this.leftNode=A,this.rightNode=N,this.currentNode=null}addCurrentNode(c,f){return null==f?f=c:(c.value.typeId!=f.value.typeId&&(f.currentNode=this.addCurrentNode(c,f.currentNode)),f)}addCurrentNodeType(c,f){if(null==f)return c;let A=!1;for(let N=0;N<f.variants.length;N++)f.variants[N].value.id==c.value.id&&(A=!0);return A||f.variants.push(c),f}addNode(c,f,A){if(null==f)return c;let a=f.rightNode;if(f.key>c.key)f.leftNode=this.addNode(c,f.leftNode,A);else{if(!(f.key<c.key))return f;f.rightNode=this.addNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}return f}checkIfIdsInNode(c,f,A,N){if(c){if(f.includes(c.key)){A.push(c.value);let a=f.indexOf(c.key);f.splice(a,1)}c.leftNode&&this.checkIfIdsInNode(c.leftNode,f,A,N),c.rightNode&&this.checkIfIdsInNode(c.rightNode,f,A,N)}}addCharacterNode(c,f,A){if(""!=c.value.characterValue){if(null==f)return c;let a=f.rightNode;if(f.key>c.key)f.leftNode=this.addCharacterNode(c,f.leftNode,A);else{if(!(f.key<c.key))return f.key==c.key&&""!=f.key&&f.value.id!=c.value.id&&f.addCurrentNodeType(c,f),f;f.rightNode=this.addCharacterNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}addTypeNode(c,f,A){if(0!=c.value.typeId){if(null==f)return console.log("adding the type node to the tree",c),c;let a=f.rightNode;if(f.key>c.key)f.leftNode=this.addTypeNode(c,f.leftNode,A);else{if(!(f.key<c.key))return console.log("adding the type node to the tree down",c),f.key==c.key&&0!=f.key&&f.value.id!=c.value.id&&f.addCurrentNodeType(c,f),console.log("adding the type node to the tree last",f),f;f.rightNode=this.addTypeNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}rightRotate(c){if(c){let f=c.leftNode;if(f)return c.leftNode=f.rightNode,f.rightNode=c,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode))+1,f}return c}leftRotate(c){if(c){let f=c.rightNode;if(f){let A=f.leftNode;return f.leftNode=c,c.rightNode=A,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(c.rightNode))+1,f}}return c}getHeight(c){return c?c.height:0}getBalanceFactor(c){return null==c?0:this.getHeight(c.leftNode)-this.getHeight(c.rightNode)}getFromNode(c,f){return f&&(c==f.key?f:c<f.key?this.getFromNode(c,f.leftNode):c>f.key?this.getFromNode(c,f.rightNode):f)}getCharacterFromNode(c,f){return f&&(c==f.key?f:c<f.key?this.getCharacterFromNode(c,f.leftNode):c>f.key?this.getCharacterFromNode(c,f.rightNode):f)}getCharacterFromNodeUpdated(c,f){var A;return f&&(c==f.key||51==(null===(A=f.value)||void 0===A?void 0:A.typeId)?f:c<f.key?this.getCharacterFromNode(c,f.leftNode):c>f.key?this.getCharacterFromNode(c,f.rightNode):f)}getFromNodeWithCharacterAndType(c,f,A){if(c=`${c}`,A){if(c==A.key){if(c==A.value.characterValue&&f==A.value.typeId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.typeId==f)return A.variants[N]}else{if(c<A.key)return this.getFromNodeWithCharacterAndType(c,f,A.leftNode);if(c>A.key)return this.getFromNodeWithCharacterAndType(c,f,A.rightNode)}return null}return A}getFromNodeWithCharacterAndCategory(c,f,A){if(c=`${c}`,A){if(c==A.key){if(c==A.value.characterValue&&f==A.value.categoryId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.categoryId==f)return A.variants[N]}else{if(c<A.key)return this.getFromNodeWithCharacterAndCategory(c,f,A.leftNode);if(c>A.key)return this.getFromNodeWithCharacterAndCategory(c,f,A.rightNode)}return null}return A}removeNode(c,f){if(null==c)return c;if(c.key>f)return c.leftNode=this.removeNode(c.leftNode,f),c;if(c.key<f)return c.rightNode=this.removeNode(c.rightNode,f),c;if(null==c.leftNode){let A=c.rightNode;return c=null,A}if(null==c.rightNode){let A=c.leftNode;return c=null,A}{let A=this.inOrderSuccessor(c.rightNode);return c.value=A.value,c.key=A.key,c.variants=A.variants,c.currentNode=A.currentNode,c.rightNode=this.removeNode(c.rightNode,A.key),c}}removeNodeWithVariants(c,f,A){if(null==c)return c;if(c.key>f)return c.leftNode=this.removeNodeWithVariants(c.leftNode,f,A),c;if(c.key<f)return c.rightNode=this.removeNodeWithVariants(c.rightNode,f,A),c;if(c.variants.length>0)if(c.value.id==A){let N=c.variants[0];if(N)return c.value=N.value,c.key=N.key,c.currentNode=N.currentNode,c.variants.splice(0,1),c}else for(let N=0;N<c.variants.length;N++)if(A==c.variants[N].value.id)return c.variants.splice(N,1),c;if(null==c.leftNode){let N=c.rightNode;return c=null,N}if(null==c.rightNode){let N=c.leftNode;return c=null,N}{let N=this.inOrderSuccessor(c.rightNode);return c.value=N.value,c.key=N.key,c.variants=N.variants,c.currentNode=N.currentNode,c.rightNode=this.removeNodeWithVariants(c.rightNode,N.key,A),c}}countNodeBelow(c){return null==c?0:1+this.countNodeBelow(c.leftNode)+this.countNodeBelow(c.rightNode)}inOrderSuccessor(c){for(;null!=c.leftNode;)c=c.leftNode;return c}}},5976:(Re,ce,_)=>{_.d(ce,{p:()=>a,B:()=>N});var B=_(9581),M=_(3518),c=_(1863),f=_(1834),A=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};let N=(()=>{class r{static getId(){return A(this,void 0,void 0,function*(){this.ids.length<5&&(yield function(){var C,T,b,m=arguments;return C=this,b=function*(){const y=f.Logger.logfunction("GetReservedIds",m);try{let s=(0,M.Xr)("application/x-www-form-urlencoded");const p=yield fetch(B.B.GetReservedIdUrl(),{method:"GET",headers:s});if(!p.ok)throw(0,c.ry)(p),new Error(`Error! status: ${p.status}`);const I=yield p.json();for(let x=0;x<I.length;x++)r.AddId(I[x]);f.Logger.logUpdate(y)}catch(s){s instanceof Error?console.log("get reserved ids error message: ",s.message):console.log("get reserved ids  unexpected error: ",s),(0,c.Mb)(s,B.B.GetReservedIdUrl()),(0,c.ey)(y,"GetReservedIds",s)}},new((T=void 0)||(T=Promise))(function(y,s){function p(w){try{x(b.next(w))}catch(F){s(F)}}function I(w){try{x(b.throw(w))}catch(F){s(F)}}function x(w){var F;w.done?y(w.value):(F=w.value,F instanceof T?F:new T(function(E){E(F)})).then(p,I)}x((b=b.apply(C,[])).next())})}());var h=this.ids[0];return this.ids.shift(),h})}static AddId(h){this.ids.includes(h)||this.ids.push(h)}}return r.ids=[],r})(),a=(()=>{class r{static getId(){return A(this,void 0,void 0,function*(){this.connectionIds.length<5&&(yield function(){var C,T,b,m=arguments;return C=this,b=function*(){const y=f.Logger.logfunction("GetReservedConnectionIds",m);try{let s=(0,M.Xr)("application/x-www-form-urlencoded");const p=yield fetch(B.B.GetReservedConnectionIdUrl(),{method:"GET",headers:s});if(!p.ok)throw(0,c.ry)(p),new Error(`Error! status: ${p.status}`);const I=yield p.json();for(let x=0;x<I.length;x++)r.AddId(I[x]);f.Logger.logUpdate(y)}catch(s){s instanceof Error?console.log("get reserved connection ids error message: ",s.message):console.log("get reserved connection ids  unexpected error: ",s),(0,c.Mb)(s,B.B.GetReservedConnectionIdUrl()),(0,c.ey)(y,"GetReservedConnectionIds",s)}},new((T=void 0)||(T=Promise))(function(y,s){function p(w){try{x(b.next(w))}catch(F){s(F)}}function I(w){try{x(b.throw(w))}catch(F){s(F)}}function x(w){var F;w.done?y(w.value):(F=w.value,F instanceof T?F:new T(function(E){E(F)})).then(p,I)}x((b=b.apply(C,[])).next())})}());var h=this.connectionIds[0];return this.connectionIds.shift(),h})}static AddId(h){this.connectionIds.includes(h)||this.connectionIds.push(h)}}return r.connectionIds=[],r})()},7273:(Re,ce,_)=>{_.d(ce,{z:()=>M});var B=_(9581);class M{constructor(f,A,N,a){this.url=B.B.BASE_URL,this.message=f,this.ok=A,this.status=N,this.data=a}getMessage(){return this.message}setMessage(f){return this.message=f,this}getStatus(){return this.status}setStatus(f){return this.status=f,this}getData(){return this.data}setData(f){return this.data=f,this}getOk(){return this.ok}setOk(f){return this.ok=f,this}getUrl(){return this.url}setUrl(f){return this.url=f,this}}},3278:(Re,ce,_)=>{_.d(ce,{b:()=>B});class B{}B.BearerAccessToken="",B.sessionId=998},2299:(Re,ce,_)=>{_.d(ce,{B:()=>B});class B{constructor(c){this.id=1,this.isOnlineSync=!1,this.isOnlineSync=c}}},442:(Re,ce,_)=>{_.d(ce,{Y:()=>d});var B=_(1167),M=_(2155),c=_(9581),f=_(3518),A=_(1863),N=_(9639),a=_(8286),r=_(1834);class d{static CheckContains(C){for(var T=!1,b=0;b<this.conceptsSyncArray.length;b++)this.conceptsSyncArray[b].id==C.id&&(T=!0);return T}static SyncDataDelete(C){for(var T=0;T<this.conceptsSyncArray.length;T++)C==this.conceptsSyncArray[T].id&&this.conceptsSyncArray.splice(T,1);for(T=0;T<this.connectionSyncArray.length;T++)this.connectionSyncArray[T].ofTheConceptId!=C&&this.connectionSyncArray[T].toTheConceptId!=C&&this.connectionSyncArray[T].typeId!=C||this.connectionSyncArray.splice(T,1)}static CheckContainsConnection(C){for(var T=!1,b=0;b<this.connectionSyncArray.length;b++)this.connectionSyncArray[b].id==C.id&&(T=!0);return T}static AddConcept(C){this.conceptsSyncArray.push(C)}static RemoveConcept(C){for(var T=0;T<this.conceptsSyncArray.length;T++)this.conceptsSyncArray[T].id==C.id&&this.conceptsSyncArray.splice(T,1)}static AddConnection(C){this.connectionSyncArray.push(C)}static RemoveConnection(C){for(var T=0;T<this.connectionSyncArray.length;T++)this.connectionSyncArray[T].id==C.id&&this.connectionSyncArray.splice(T,1)}static SyncDataOnline(){return C=this,b=function*(){if(r.serviceWorker)try{return(yield(0,r.sendMessage)("SyncData__SyncDataOnline",{})).data}catch(m){console.error("SyncData__SyncDataOnline sw error: ",m),(0,r.handleServiceWorkerException)(m)}for(let m=0;m<this.conceptsSyncArray.length;m++)N.I.AddConcept(this.conceptsSyncArray[m]);for(let m=0;m<this.connectionSyncArray.length;m++)a.d.AddConnection(this.connectionSyncArray[m]);if(this.conceptsSyncArray.length>0){let m=this.conceptsSyncArray.slice();this.conceptsSyncArray=[],(0,B.Y)(m)}if(this.connectionSyncArray.length>0){let m=this.connectionSyncArray.slice();this.connectionSyncArray=[],yield function(y){return s=this,I=function*(){let x=new M.N(0,0,0,0,0,0,0);try{var w=(0,f.Xr)(),F=JSON.stringify(y);const E=yield fetch(c.B.CreateTheConnectionUrl(),{method:"POST",headers:w,body:F});return E.ok?yield E.json():(console.log("Create the connection error message: ",E.status),(0,A.ry)(E)),x}catch(E){throw E instanceof Error?console.log("Create the connection error message: ",E.message):console.log(" Create the connection unexpected error: ",E),E}},new((p=void 0)||(p=Promise))(function(x,w){function F(G){try{D(I.next(G))}catch(Z){w(Z)}}function E(G){try{D(I.throw(G))}catch(Z){w(Z)}}function D(G){var Z;G.done?x(G.value):(Z=G.value,Z instanceof p?Z:new p(function(V){V(Z)})).then(F,E)}D((I=I.apply(s,[])).next())});var s,p,I}(m)}return"done"},new((T=void 0)||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(C,[])).next())});var C,T,b}}d.conceptsSyncArray=[],d.connectionSyncArray=[]},9003:(Re,ce,_)=>{_.d(ce,{S5:()=>a,kH:()=>d,qI:()=>N});var B=_(1863),M=_(1834),c=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};let f=10;class A{}function N(h){const C=M.Logger.logfunction("openDatabase",arguments);return new Promise(function(T,b){A.db&&(M.Logger.logUpdate(C),T(A.db));let m=M.BaseUrl.BASE_URL+"_FreeSchemaLocal"+M.BaseUrl.BASE_APPLICATION;const y=indexedDB.open(m,f);y.onupgradeneeded=s=>{var p=s.target.result,I="localconcept",x="localconnection",w="localid";console.log("this is the version upgrade",f),p.objectStoreNames.contains(I)&&p.deleteObjectStore(I),p.objectStoreNames.contains(x)&&p.deleteObjectStore(x),p.objectStoreNames.contains(w)&&p.deleteObjectStore(w),p.objectStoreNames.contains(I)||(p.createObjectStore(I,{keyPath:"id"}).transaction.oncomplete=F=>{}),p.objectStoreNames.contains(x)||(p.createObjectStore(x,{keyPath:"id"}).transaction.oncomplete=F=>{}),p.objectStoreNames.contains(w)||(p.createObjectStore(w,{keyPath:"id"}).transaction.oncomplete=F=>{r(w,{id:0,value:-100}),r(w,{id:1,value:-200}),r(w,{id:3,value:M.BaseUrl.getRandomizer()})}),T(p)},y.onerror=s=>{console.error("Why didn't you allow my web app to use IndexedDB?!",s),indexedDB.deleteDatabase(m),N(h),(0,B.ey)(C,"openDatabase",s),b(s)},y.onsuccess=function(s){A.db=s.target.result,M.Logger.logUpdate(C),T(A.db)}})}function a(h){var C=arguments;return c(this,void 0,void 0,function*(){const T=M.Logger.logfunction("getObjectsFromLocalIndexDb",C);return new Promise(function(b,m){N(h).then(y=>{var s=[],p=y.transaction(h,"readwrite").objectStore(h).getAll();p.onsuccess=()=>{const I=p.result;for(var x=0;x<I.length;x++)s.push(I[x]);M.Logger.logUpdate(T),b(s)}}).catch(y=>{let s={status:400,ok:!1,message:"Cannot get objects from database because you cannot open the Local database",data:y};(0,B.ey)(T,"getObjectsFromLocalIndexDb",s),m(s)})})})}function r(h,C){const T=M.Logger.logfunction("storeToDatabase",[h,"localindexdb"]);return new Promise(function(b,m){N(h).then(y=>{const s=y.transaction(h,"readwrite").objectStore(h).add(C);s.onsuccess=p=>{M.Logger.logUpdate(T),b(C)},s.onerror=p=>{let I={status:400,ok:!1,message:"Cannot store to the Local database "+h,data:p,body:C};(0,B.ey)(T,"storeToDatabase",I),m(I)}}).catch(y=>{let s={status:400,ok:!1,message:"Cannot store to database because you cannot open the Local database",data:y};(0,B.ey)(T,"storeToDatabase",s),m(s)})})}function d(h,C){const T=M.Logger.logfunction("UpdateToDatabase",arguments);return new Promise(function(b,m){N(h).then(y=>{const s=y.transaction(h,"readwrite").objectStore(h).put(C);s.onsuccess=p=>{M.Logger.logUpdate(T),b(C)},s.onerror=p=>{let I={status:400,ok:!1,message:"Cannot Update to the Local database"+h,data:p,body:C};(0,B.ey)(T,"UpdateToDatabase",I),m(I)}}).catch(y=>{let s={status:400,ok:!1,message:"Cannot update to database because you cannot open the Local database",data:y};(0,B.ey)(T,"UpdateToDatabase",s),m(s)})})}},3655:(Re,ce,_)=>{_.d(ce,{El:()=>h,b8:()=>d,kH:()=>r,qI:()=>a,wh:()=>C});var B=_(2299),M=_(9581),c=_(1834),f=_(1863);let A=10;class N{}function a(T){const b=c.Logger.logfunction("openDatabase",[T,"indexdb"]);return new Promise(function(m,y){N.db&&(c.Logger.logUpdate(b),m(N.db));let s=M.B.BASE_URL+"_FreeSchema"+M.B.BASE_APPLICATION;const p=indexedDB.open(s,A);console.log("this is the update version",A,p),p.onupgradeneeded=I=>{let x=I.target.result,w="concept",F="connection",E="settings";console.log("this is the version update for index",A),x.objectStoreNames.contains(w)&&x.deleteObjectStore(w),x.objectStoreNames.contains(F)&&x.deleteObjectStore(F),x.objectStoreNames.contains(E)&&x.deleteObjectStore(E),x.objectStoreNames.contains(w)||(x.createObjectStore(w,{keyPath:"id"}).transaction.oncomplete=D=>{}),x.objectStoreNames.contains(F)||(x.createObjectStore(F,{keyPath:"id"}).transaction.oncomplete=D=>{}),x.objectStoreNames.contains(E)||(x.createObjectStore(E,{keyPath:"id"}).transaction.oncomplete=D=>{}),c.Logger.logUpdate(b),m(x)},p.onerror=I=>{console.error("Why didn't you allow my web app to use IndexedDB?!",I),indexedDB.deleteDatabase(s),a(T),(0,f.ey)(b,"openDatabase",I),y(I)},p.onsuccess=function(I){N.db=I.target.result,c.Logger.logUpdate(b),m(N.db)}})}function r(T,b){const m=c.Logger.logfunction("UpdateToDatabase",[T,"indexdb"]);return new Promise(function(y,s){a(T).then(p=>{const I=p.transaction(T,"readwrite").objectStore(T).put(b);I.onsuccess=x=>{c.Logger.logUpdate(m),y(b)},I.onerror=x=>{let w={status:400,ok:!1,message:"Cannot Update to the database"+T,data:x,body:b};(0,f.ey)(m,"UpdateToDatabase",w),s(w)}}).catch(p=>{let I={status:400,ok:!1,message:"Cannot update to database because you cannot open the database",data:p};(0,f.ey)(m,"UpdateToDatabase",I),s(I)})})}function d(){const T=c.Logger.logfunction("GetLastSettingsFromDatabase",["indexdb"]);return new Promise(function(b,m){let y="settings";a(y).then(s=>{let p=s.transaction(y,"readwrite").objectStore(y).getAll();p.onsuccess=()=>{let I=new B.B(!1),x=p.result;for(let w=0;w<x.length;w++)I=x[w];c.Logger.logUpdate(T),b(I)},p.onerror=I=>{(0,f.ey)(T,"GetLastSettingsFromDatabase",I),m(I)}}).catch(s=>{let p={status:400,ok:!1,message:"Cannot get last object from database because you cannot open the database",data:s};(0,f.ey)(T,"GetLastSettingsFromDatabase",p),m(p)})})}function h(T){const b=c.Logger.logfunction("AiUpdateFlag",["indexdb"]);return new Promise(function(m,y){let s="settings";a(s).then(p=>{const I=p.transaction(s,"readwrite").objectStore(s).put(T);I.onsuccess=x=>{c.Logger.logUpdate(b),m(T)},I.onerror=x=>{let w={status:400,ok:!1,message:"Cannot update AI flag",data:x,body:T};(0,f.ey)(b,"AiUpdateFlag",w),y(w)}}).catch(p=>{let I={status:400,ok:!1,message:"Cannot update AI flag because you cannot open the database",data:p};(0,f.ey)(b,"AiUpdateFlag",I),y(I)})})}function C(T,b){const m=c.Logger.logfunction("removeFromDatabase",[T,"indexdb"]);return new Promise(function(y,s){a(T).then(p=>{const I=p.transaction(T,"readwrite").objectStore(T).delete(Number(b));I.onsuccess=function(x){c.Logger.logUpdate(m),y(b)},I.onerror=x=>{let w={status:400,ok:!1,message:"Cannot remove from the database"+T,data:x};(0,f.ey)(m,"removeFromDatabase",w),s(w)}}).catch(p=>{let I={status:400,ok:!1,message:"Cannot remove from the database because you cannot open the database",data:p,body:b};(0,f.ey)(m,"removeFromDatabase",I),s(I)})})}},4485:(Re,ce,_)=>{function B(A=[],N){var a,r;let d=[],h=null===(a=N.type)||void 0===a?void 0:a.characterValue;if(h?.startsWith("the_")||(h="the_"+h),Array.isArray(A))for(let C=0;C<A.length;C++){let T=null===(r=A[C].type)||void 0===r?void 0:r.characterValue;T?.startsWith("the_")||(T="the_"+T),N.typeId!=A[C].typeId&&h!=T||d.push(A[C])}return d}function M(A=[],N){let a=[],r=N.typeCharacter;if(r?.startsWith("the_")||(r="the_"+r),Array.isArray(A))for(let d=0;d<A.length;d++){let h=A[d].typeCharacter;h?.startsWith("the_")||(h="the_"+h),N.typeId!=A[d].typeId&&r!=h||a.push(A[d])}return a}function c(A=[],N){let a=[];if(Array.isArray(A)){const r=A.find(h=>h.toTheConceptId==N);r&&a.push(r);const d=A.find(h=>h.ofTheConceptId==N);d&&a.push(d)}return a}function f(A=[],N){let a=[];if(Array.isArray(A)){const r=A.find(h=>h.toTheConceptId==N);r&&a.push(r);const d=A.find(h=>h.ofTheConceptId==N);d&&a.push(d)}return a}_.d(ce,{gt:()=>f,nm:()=>M,vo:()=>B,wS:()=>c}),_(2155),_(7282)},9934:(Re,ce,_)=>{function B(M,c){return-1===M.indexOf(c)&&M.push(c),M}_.d(ce,{A:()=>B})},9700:(Re,ce,_)=>{_.d(ce,{R:()=>r,V:()=>a});var B,M=_(1834),c=_(3278),f=_(1863),A=_(3518),N=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};class a{static startAutoSync(){this.autoSyncInterval?console.warn("Auto-sync is already running."):(this.nextSyncTime=Date.now()+this.SYNC_INTERVAL_MS,setInterval(()=>{const h=Date.now();this.nextSyncTime&&h>=this.nextSyncTime&&(this.nextSyncTime=h+this.SYNC_INTERVAL_MS,this.sendPackageLogsToServer(),this.sendApplicationLogsToServer())},3e4))}static stopAutoSync(){null!==this.autoSyncInterval&&(clearInterval(this.autoSyncInterval),this.autoSyncInterval=null,this.nextSyncTime=null)}static setLogLevel(h){this.logLevel=h}static shouldLog(h){return this.LOG_LEVELS.indexOf(h)>=this.LOG_LEVELS.indexOf(this.logLevel)}static formatLogData(h,C,T){const b=Object.assign({timestamp:(new Date).toISOString(),level:h,message:C},T);return this.packageLogsData.push(b),"ERROR"==h&&(this.sendPackageLogsToServer(),this.sendApplicationLogsToServer()),b}static log(h,C,T){if(this.logPackageActivationStatus)try{this.formatLogData(h,C,T||null)}catch(b){console.error("Error on Logger Log : ",b)}}static logUpdate(h){var C;try{if(!this.logPackageActivationStatus)return{};if(!h)return{};const T=Date.now();h.startTime=null!==(C=h.startTime)&&void 0!==C?C:T,h.responseTime=T-h.startTime+" ms",1==!h.serviceWorker&&(h.serviceWorker=!1)}catch(T){(0,f.ey)(h,"Logger.logUpdate",T)}}static logfunction(h,...C){if(!this.logPackageActivationStatus)return{};const T=Date.now();let b=C;const m=M.BaseUrl.getRandomizer();return this.formatLogData("INFO","function called",{startTime:T,functionName:h,functionParameters:b,requestFrom:M.BaseUrl.BASE_APPLICATION,sessionId:c.b.sessionId,applicationId:m})}static logError(h,C,T,b,m,y,s,p,I,x,w){try{const F=r("SessionId"),E={startTime:h,userId:C,operationType:T,requestFrom:b,requestIP:m,responseStatus:y,responseTime:`${(performance.now()-h).toFixed(3)}ms`,responseSize:s?`${JSON.stringify(s).length}`:"0",sessionId:F?.toString(),functionName:p,functionParameters:I,userAgent:x,conceptsUsed:w};this.formatLogData("ERROR",`Information logged for ${p}`,E)}catch{console.error("Error on logError")}}static logApplication(h,C,T){if(this.logApplicationActivationStatus)try{const b={timestamp:(new Date).toISOString(),level:h,message:C,data:T||null};this.applicationLogsData.push(b)}catch(b){console.error("Failed to log application activity:",b)}}static sendApplicationLogsToServer(){return N(this,void 0,void 0,function*(){const h=this.applicationLogsData;try{if(0===h.length)return;this.applicationLogsData=[];const C=50;let T=(0,A.Xr)(),b=0;for(;0!=h.length;){const m=h.slice(0,C),y=yield fetch(M.BaseUrl.PostLogger(),{method:"POST",headers:T,body:JSON.stringify({logType:this.appLogs,logData:m})});y.ok||(yield y.text()),h.splice(0,C),b+=C,b++}}catch{}})}static sendPackageLogsToServer(){return N(this,void 0,void 0,function*(){const h=this.packageLogsData;try{if(0===h.length)return;this.packageLogsData=[];const C=300;let T=0;for(;0!=h.length;){const b=h.slice(0,C);let m=(0,A.Xr)();const y=yield fetch(M.BaseUrl.PostLogger(),{method:"POST",headers:m,body:JSON.stringify({logType:this.mftsccsBrowser,logData:b})});if(!y.ok)return void(yield y.text());h.splice(0,C),T++}}catch{}})}static saveLogToLocalStorage(h,C){try{if(void 0===typeof localStorage)return void console.warn("Local Storage type undefined");{const T=JSON.parse((null==localStorage?void 0:localStorage.getItem(h))||"[]");T.push(C),localStorage?.setItem(h,JSON.stringify(T))}}catch{console.error("Error on saving log in localstorage"),this.log("ERROR","Error while saving log in local storage")}}static clearLogsFromLocalStorage(h){void 0!==typeof localStorage?localStorage?.removeItem(h):console.warn("localStorage is not available")}}function r(d){try{let h=d+"=",C=decodeURIComponent(document.cookie).split(";");for(let T=0;T<C.length;T++){let b=C[T];for(;" "==b.charAt(0);)b=b.substring(1);if(0==b.indexOf(h))return b.substring(h.length,b.length)}return""}catch{return console.error("Error on getcookie"),""}}B=a,a.logLevel="INFO",a.packageLogsData=[],a.applicationLogsData=[],a.LOG_LEVELS=["DEBUG","INFO","WARNING","ERROR"],a.SYNC_INTERVAL_MS=6e4,a.nextSyncTime=null,a.appLogs="app",a.mftsccsBrowser="mftsccs",a.logApplicationActivationStatus=!1,a.logPackageActivationStatus=!1,a.autoSyncInterval=null,B.startAutoSync()},1412:(Re,ce,_)=>{function B(M=[],c=[]){}_.d(ce,{e:()=>B})},5898:(Re,ce,_)=>{_.d(ce,{w:()=>A,V:()=>N});var B=_(7139),M=_(1834);class c{constructor(){this.conceptId=0,this.connectionTypeId=0,this.connectionType="",this.count=0}}var f=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function A(r=[]){let d=[];if(r.length>0)for(let h=0;h<r.length;h++){let C=a(r[h]);d.push(C)}return d}function N(r){var d=arguments;return f(this,void 0,void 0,function*(){const h=M.Logger.logfunction("GetConnectionTypeForCount",d);let C={};for(let T=0;T<r.length;T++){let b=yield(0,B.r)(r[T].connectionTypeId);r[T].connectionType=b.characterValue,C[r[T].conceptId]=r[T]}return M.Logger.logUpdate(h),C})}function a(r){const d=r.split("_");if(3===d.length){let h=new c;return h.conceptId=Number(d[0]),h.connectionTypeId=Number(d[1]),h.count=Number(d[2]),h}throw new Error("Input string must contain exactly three parts separated by underscores.")}},1863:(Re,ce,_)=>{_.d(ce,{ER:()=>f,Mb:()=>A,ey:()=>N,ry:()=>c});var B=_(1834),M=_(7273);function c(a){if(B.Logger.log("ERROR",a.statusText,{code:a.status,data:a.statusText}),401==a.status||406==a.status){let r=new M.z(a.statusText,!1,a.status,"");throw r.setUrl(a.url),r}if(500==a.status){let r=new M.z(a.statusText,!1,a.status,"");throw r.setUrl(a.url),r}}function f(a,r={}){if(B.Logger.log("ERROR",r.statusText,{code:a.status,data:a.status}),401==a.status||406==a.status){let d=new M.z(r.statusText,!1,a.status,"");throw d.setUrl(a.url),d}if(500==a.status){let d=new M.z(r.statusText,!1,a.status,"");throw d.setUrl(a.url),d}}function A(a,r=""){if(B.Logger.log("ERROR",a.message,{code:a.status,data:a.stack}),a.status){let d=new M.z(a.message,!1,a.status,a.stack);throw d.setUrl(r),d}{let d=new M.z(a.message,!1,500,a.stack);throw d.setUrl(r),d}}function N(a,r,d){var h;try{if(!a)return void console.error(`Error in ${r}: logData is undefined`);const C=Date.now();a.startTime=null!==(h=a.startTime)&&void 0!==h?h:C,a.responseTime=C-a.startTime+" ms",a.level="ERROR",a.errorMessage=d?.message||"Unknown error occurred",console.error(`Error in function ${r}:`,d)}catch(C){console.error("Failed to handle package function error:",C)}}},176:(Re,ce,_)=>{_.d(ce,{F4:()=>f,P6:()=>N,dp:()=>A});var B=_(2155),M=_(7282),c=_(6416);function f(a){var r,d;const h=(0,c.u)();return h.id=a.id,h.ghostId=a.ghostId,h.userId=a.userId,h.accessId=a.accessId,h.categoryId=a.categoryId,h.characterValue=a.characterValue,h.entryTimeStamp=a.entryTimeStamp,h.typeId=a.typeId,h.type=a.type,h.isTemp=!1,h.typeCharacter=null!==(d=null===(r=a?.type)||void 0===r?void 0:r.characterValue)&&void 0!==d?d:"",h}function A(a){const r=(0,M.o)();return r.id=a.id,r.ghostId=a.ghostId,r.userId=a.userId,r.accessId=a.accessId,r.entryTimeStamp=a.entryTimeStamp,r.typeId=a.typeId,r.categoryId=a.categoryId,r}function N(a){const r=new B.N(0,0,0,0,0,0,0);return r.id=a.id,r.ghostId=a.ghostId,r.accessId=a.accessId,r.ofTheConceptId=a.ofTheConceptId,r.toTheConceptId=a.toTheConceptId,r.entryTimeStamp=a.entryTimeStamp,r.typeId=a.typeId,r.isTemp=!1,r}},5020:(Re,ce,_)=>{_.d(ce,{A:()=>A});var B=_(1834),M=_(9639),c=_(205),f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function A(){return f(this,void 0,void 0,function*(){try{let N=[];if(Array.isArray(N))for(let a=0;a<N.length;a++)M.I.AddConceptToMemory(N[a]);c.B.isDataLoaded=!0,c.B.isCharacterLoaded=!0,c.B.isTypeLoaded=!0}catch(N){throw yield(0,B.DelayFunctionExecution)(2e3,A()),{message:"Cannot create Binary Tree Concept",ok:!1,status:400,data:N}}})}},7282:(Re,ce,_)=>{_.d(ce,{o:()=>M});var B=_(2615);function M(){return new B.j(0,0,0,0,0,"0",0,!1,new Date,new Date,"0")}},1218:(Re,ce,_)=>{_.d(ce,{A:()=>N});var B=_(1834),M=_(7282),c=_(1666),f=_(8407),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};function N(a){return A(this,arguments,void 0,function*(r,d=null,h=null,C=null,T=null,b=null,m=null){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("CreateTheComposition",{json:r,ofTheConceptId:d,ofTheConceptUserId:h,mainKey:C,userId:T,accessId:b,sessionInformationId:m})).data}catch(w){console.error("CreateTheComposition sw error: ",w),(0,B.handleServiceWorkerException)(w)}let y=T??999,s=b??4,p=m??999,I=C??0,x=(0,M.o)();for(const w in r)if("string"!=typeof r[w]&&"number"!=typeof r[w])if(null==d&&null==h){let F=I,E=yield(0,f.A)(w,"",!0,y,s,p);x=E,F=E.id,I=E.id,yield N(r[w],E.id,E.userId,F,T,b,m)}else{let F=d??999,E=h??999,D=I,G=yield(0,f.A)(w,"",!0,y,s,p);x=G,yield(0,c.q)(F,E,G.id,D),yield N(r[w],G.id,G.userId,D,T,b,m)}else{let F=d??999,E=h??10267,D=I,G=yield(0,f.A)(w,r[w].toString(),!1,y,s,p);yield(0,c.q)(F,E,G.id,D)}return x})}},2212:(Re,ce,_)=>{_.d(ce,{Ay:()=>a,N:()=>r});var B=_(1167),M=_(2615),c=_(5976),f=_(442),A=_(1834),N=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};function a(d,h,C,T,b,m,y){return N(this,void 0,void 0,function*(){let s=yield c.B.getId(),x=new M.j(s,h,T,C,b,d,m,!0,new Date,new Date,y);return x.isTemp=!1,f.Y.AddConcept(x),x})}function r(d,h,C,T,b,m,y){return N(this,void 0,void 0,function*(){let s=yield c.B.getId(),x=new M.j(s,h,T,C,b,d,m,!1,new Date,new Date,y);return A.ConceptsData.AddConcept(x),(0,B.Y)([x]),x})}},1666:(Re,ce,_)=>{_.d(ce,{q:()=>f});var B=_(2155),M=_(442),c=_(1863);function f(A,N,a,r){var h=new B.N(0,A,a,N,r,1,4);if(A==a)return h.ofTheConceptId=0,h.toTheConceptId=1,h;try{h.isTemp=!0,h.id=Math.floor(1e8*Math.random()),M.Y.AddConnection(h)}catch(C){(0,c.Mb)(C)}return h}},1838:(Re,ce,_)=>{_.d(ce,{m:()=>d});var B=_(1834),M=_(9581),c=_(1863),f=_(3518),A=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})},N=_(5239),a=_(4864),r=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};function d(h){var C=arguments;return r(this,void 0,void 0,function*(){const T=B.Logger.logfunction("DeleteConnectionById",C);if(B.serviceWorker)try{return(yield(0,B.sendMessage)("DeleteConnectionById",{id:h})).data}catch(b){console.error("DeleteConnectionById sw error: ",b),(0,B.handleServiceWorkerException)(b)}h>0?(yield function(b){var m=arguments;return A(this,void 0,void 0,function*(){const y=B.Logger.logfunction("DeleteTheConnection",m);let s=!1;try{const p=new FormData;p.append("id",b.toString());let I=(0,f.BZ)();const x=yield fetch(M.B.DeleteTheConnectionUrl(),{method:"POST",headers:I,body:p,redirect:"follow"});B.Logger.logUpdate(y),x.ok?s=(yield x.json()).success:(console.log("Delete connection error status: ",x.status),(0,c.ry)(x)),s&&B.ConnectionData.AddNpConn(b)}catch(p){p instanceof Error?console.log("Delete connection error message: ",p.message):console.log("Delete connection unexpected error: ",p),(0,c.Mb)(p,M.B.DeleteTheConnectionUrl()),(0,c.ey)(y,"DeleteTheConnection",p)}return s})}(h),N.O.removeNodeFromTree(h)):a.G.RemoveConnectionById(h),B.Logger.logUpdate(T)})}},4364:(Re,ce,_)=>{_.d(ce,{s:()=>f});var B=_(1239),M=_(1834),c=function(A,N,a,r){return new(a||(a=Promise))(function(d,h){function C(m){try{b(r.next(m))}catch(y){h(y)}}function T(m){try{b(r.throw(m))}catch(y){h(y)}}function b(m){var y;m.done?d(m.value):(y=m.value,y instanceof a?y:new a(function(s){s(y)})).then(C,T)}b((r=r.apply(A,N||[])).next())})};function f(){return c(this,arguments,void 0,function*(A=[]){const N=M.Logger.logfunction("FindConceptsFromConnections",[A.length]);let a=[];if(A.length>0){for(let r=0;r<A.length;r++)a.includes(A[r].ofTheConceptId)||a.push(A[r].ofTheConceptId),a.includes(A[r].toTheConceptId)||a.push(A[r].toTheConceptId),a.includes(A[r].typeId)||a.push(A[r].typeId);yield(0,B.r)(a)}M.Logger.logUpdate(N)})}},5284:(Re,ce,_)=>{_.d(ce,{B:()=>A});var B=_(1834),M=_(8286),c=_(1863),f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function A(){return f(this,arguments,void 0,function*(N=[]){const a=B.Logger.logfunction("FindConnectionsOfCompositionsBulkInMemory",[N.length])||{};let r=[];try{if(B.serviceWorker){a.serviceWorker=!0;try{const d=yield(0,B.sendMessage)("FindConnectionsOfCompositionsBulkInMemory",{composition_ids:N});return B.Logger.logUpdate(a),d.data}catch(d){console.error("FindConnectionsOfCompositionsBulkInMemory sw error: ",d),(0,c.ey)(a,"FindConnectionsOfCompositionsBulkInMemory",d),(0,B.handleServiceWorkerException)(d)}}for(let d=0;d<N.length;d++){let h=yield M.d.GetConnectionsOfConcept(N[d]);r.push(...h)}return B.Logger.logUpdate(a),r}catch(d){return console.error("FindConnectionsOfCompositionsBulkInMemory error: ",d),(0,c.ey)(a,"FindConnectionsOfCompositionsBulkInMemory",d),r}})}},8939:(Re,ce,_)=>{_.d(ce,{$N:()=>x,$V:()=>h,Ez:()=>w,JA:()=>p,Mb:()=>b,Nj:()=>T,PT:()=>I,RW:()=>s,XI:()=>y,ay:()=>d,hL:()=>r,kx:()=>m,re:()=>C,yz:()=>F,zN:()=>G});var B=_(7139),M=_(2),c=_(9639),f=_(8286),A=_(1834),N=_(1863),a=function(V,z,P,H){return new(P||(P=Promise))(function(te,ye){function de(_e){try{fe(H.next(_e))}catch(De){ye(De)}}function we(_e){try{fe(H.throw(_e))}catch(De){ye(De)}}function fe(_e){var De;_e.done?te(_e.value):(De=_e.value,De instanceof P?De:new P(function(be){be(De)})).then(de,we)}fe((H=H.apply(V,z||[])).next())})};function r(V){return a(this,void 0,void 0,function*(){let z={connectionList:[],compositionList:[]};try{if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionById",{id:V})).data}catch(H){console.error("GetCompositionById error sw: ",H),(0,A.handleServiceWorkerException)(H)}let P=yield(0,M.s)(V);z.connectionList=P;for(let H=0;H<z.connectionList.length;H++)z.compositionList.includes(z.connectionList[H].ofTheConceptId)||z.compositionList.push(z.connectionList[H].ofTheConceptId);return z}catch(P){return console.error("GetCompositionById error: ",P),z}})}function d(V,z,P){return a(this,void 0,void 0,function*(){var H,te;let ye={},de=yield c.I.GetConcept(V);0==de.id&&null!=V&&null!=V&&(de=yield(0,B.r)(V));let we=yield G(V,z,P);return ye[null!==(te=null===(H=de?.type)||void 0===H?void 0:H.characterValue)&&void 0!==te?te:""]=we,ye})}function h(V,z,P){return a(this,void 0,void 0,function*(){var H,te;let ye={},de=yield c.I.GetConcept(V);0==de.id&&null!=V&&null!=V&&(de=yield(0,B.r)(V));let we=yield G(V,z,P);ye[null!==(te=null===(H=de?.type)||void 0===H?void 0:H.characterValue)&&void 0!==te?te:""]=we;let fe={};return fe.created_at=de.entryTimeStamp,fe.data=ye,fe.id=V,fe})}function C(V,z,P){return a(this,void 0,void 0,function*(){var H,te;let ye={},de=yield c.I.GetConcept(V);0==de.id&&null!=V&&null!=V&&(de=yield(0,B.r)(V));let we=yield D(de,z,P);return ye[null!==(te=null===(H=de?.type)||void 0===H?void 0:H.characterValue)&&void 0!==te?te:""]=we,ye})}function T(V){return a(this,void 0,void 0,function*(){var z,P;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetComposition",{id:V})).data}catch(fe){console.error("GetComposition error sw: ",fe),(0,A.handleServiceWorkerException)(fe)}let H=[],te={};H=yield(0,M.s)(V);let ye=[];for(let fe=0;fe<H.length;fe++)ye.includes(H[fe].ofTheConceptId)||ye.push(H[fe].ofTheConceptId);let de=yield c.I.GetConcept(V);0==de.id&&null!=V&&null!=V&&(de=yield(0,B.r)(V));let we=yield G(V,H,ye);return te[null!==(P=null===(z=de?.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:""]=we,te})}function b(V){return a(this,void 0,void 0,function*(){var z,P;let H=[],te={};H=yield(0,M.s)(V);let ye=[];for(let fe=0;fe<H.length;fe++)ye.includes(H[fe].ofTheConceptId)||ye.push(H[fe].ofTheConceptId);let de=yield c.I.GetConcept(V);0==de.id&&null!=V&&null!=V&&(de=yield(0,B.r)(V));let we=yield Z(V,H,ye);return te[null!==(P=null===(z=de?.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:""]=we,te})}function m(V){return a(this,void 0,void 0,function*(){var z,P;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionFromMemory",{id:V})).data}catch(fe){console.error("GetCompositionFromMemory error sw: ",fe),(0,A.handleServiceWorkerException)(fe)}let H=[],te={};H=yield f.d.GetConnectionsOfCompositionLocal(V);let ye=[];for(let fe=0;fe<H.length;fe++)ye.includes(H[fe].ofTheConceptId)||ye.push(H[fe].ofTheConceptId);let de=yield c.I.GetConcept(V);0==de.id&&null!=V&&null!=V&&(de=yield(0,B.r)(V));let we=yield E(de,H,ye);return te[null!==(P=null===(z=de?.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:""]=we,te})}function y(V){return a(this,void 0,void 0,function*(){var z,P;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionFromMemoryNormal",{id:V})).data}catch(fe){console.error("GetCompositionFromMemoryNormal error sw: ",fe),(0,A.handleServiceWorkerException)(fe)}let H=[],te={};H=yield f.d.GetConnectionsOfCompositionLocal(V);let ye=[];for(let fe=0;fe<H.length;fe++)ye.includes(H[fe].ofTheConceptId)||ye.push(H[fe].ofTheConceptId);let de=yield c.I.GetConcept(V);0==de.id&&null!=V&&null!=V&&(de=yield(0,B.r)(V));let we=yield D(de,H,ye);return te[null!==(P=null===(z=de?.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:""]=we,te})}function s(V){var z=arguments;return a(this,void 0,void 0,function*(){var P,H;const te=A.Logger.logfunction("GetCompositionWithIdFromMemory",z)||{};if(A.serviceWorker){te.serviceWorker=!0;try{const fe=yield(0,A.sendMessage)("GetCompositionWithIdFromMemory",{id:V});return A.Logger.logUpdate(te),fe.data}catch(fe){console.error("GetCompositionWithIdFromMemory error sw: ",fe),(0,N.ey)(te,"GetCompositionWithIdFromMemory",fe),(0,A.handleServiceWorkerException)(fe)}}let ye={},de=[],we={};try{de=yield f.d.GetConnectionsOfCompositionLocal(V);let fe=[];for(let be=0;be<de.length;be++)fe.includes(de[be].ofTheConceptId)||fe.push(de[be].ofTheConceptId);let _e=yield c.I.GetConcept(V);0==_e.id&&null!=V&&null!=V&&(_e=yield(0,B.r)(V));let De=yield E(_e,de,fe);we[null!==(H=null===(P=_e?.type)||void 0===P?void 0:P.characterValue)&&void 0!==H?H:""]=De,ye.created_at=_e.entryTimeStamp,ye.data=we,ye.id=V}catch(fe){console.log("this is the exception in GetCompositionWithIdFromMemory",V),(0,N.ey)(te,"GetCompositionWithIdFromMemory",fe)}return A.Logger.logUpdate(te),ye})}function p(V,z){var P=arguments;return a(this,void 0,void 0,function*(){var H,te;const ye=A.Logger.logfunction("GetCompositionFromMemoryWithConnections",P)||{};if(A.serviceWorker){ye.serviceWorker=!0;try{const be=yield(0,A.sendMessage)("GetCompositionFromMemoryWithConnections",{id:V,connectionList:z});return A.Logger.logUpdate(ye),be.data}catch(be){console.error("GetCompositionFromMemoryWithConnections error sw: ",be),(0,N.ey)(ye,"GetCompositionFromMemoryWithConnections",be),(0,A.handleServiceWorkerException)(be)}}let de={},we=[];for(let be=0;be<z.length;be++)we.includes(z[be].ofTheConceptId)||we.push(z[be].ofTheConceptId);let fe=yield c.I.GetConcept(V);0==fe.id&&null!=V&&null!=V&&(fe=yield(0,B.r)(V));let _e=yield E(fe,z,we);de[null!==(te=null===(H=fe?.type)||void 0===H?void 0:H.characterValue)&&void 0!==te?te:""]=_e;let De={};return De.created_at=fe.entryTimeStamp,De.data=de,De.id=V,A.Logger.logUpdate(ye),De})}function I(V,z){return a(this,void 0,void 0,function*(){var P,H;const te=A.Logger.logfunction("GetCompositionWithIdFromMemoryFromConnection",[V])||{};if(A.serviceWorker){te.serviceWorker=!0;try{const De=yield(0,A.sendMessage)("GetCompositionWithIdFromMemory",{id:V});return A.Logger.logUpdate(te),De.data}catch(De){console.error("GetCompositionWithIdFromMemory error sw: ",De),(0,N.ey)(te,"GetCompositionWithIdFromMemoryFromConnection",De),(0,A.handleServiceWorkerException)(De)}}let ye={},de=[];for(let De=0;De<z.length;De++)de.includes(z[De].ofTheConceptId)||de.push(z[De].ofTheConceptId);let we=yield c.I.GetConcept(V);0==we.id&&null!=V&&null!=V&&(we=yield(0,B.r)(V));let fe=yield E(we,z,de);ye[null!==(H=null===(P=we?.type)||void 0===P?void 0:P.characterValue)&&void 0!==H?H:""]=fe;let _e={};return _e.created_at=we.entryTimeStamp,_e.data=ye,_e.id=V,A.Logger.logUpdate(te),_e})}function x(V){return a(this,void 0,void 0,function*(){if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionWithIdFromMemoryNew",{id:V})).data}catch(fe){console.error("GetCompositionWithIdFromMemoryNew error sw: ",fe),(0,A.handleServiceWorkerException)(fe)}let P=[],H={};P=yield f.d.GetConnectionsOfCompositionLocal(V);let te=[];for(let fe=0;fe<P.length;fe++)te.includes(P[fe].ofTheConceptId)||te.push(P[fe].ofTheConceptId);let ye=yield c.I.GetConcept(V);0==ye.id&&null!=V&&null!=V&&(console.log("this concept you cannot find ",V),ye=yield(0,B.r)(V)),(new Date).getTime();let de=yield function(fe,_e,De){return a(this,arguments,void 0,function*(be,ue,ke,Ae=[]){var Oe,ht,lt,Me,Ne,at,Lt,At;let Ue={},ft=be.id,Qe=((new Date).getTime(),null!==(ht=null===(Oe=be?.type)||void 0===Oe?void 0:Oe.characterValue)&&void 0!==ht?ht:"");if(!ke.includes(ft))return{[Qe]:be?.characterValue};if(Ae.includes(ft))return"";Ae.push(ft);for(let We=0;We<ue.length;We++){let bt=yield(0,A.GetTheConcept)(ue[We].ofTheConceptId),Ee=yield(0,A.GetTheConcept)(ue[We].toTheConceptId);ue[We].ofConcept=bt,ue[We].toConcept=Ee;let Ke=bt.id,et=(null!==(Me=null===(lt=Ee?.type)||void 0===lt?void 0:lt.characterValue)&&void 0!==Me?Me:"").replace("the_","");null!=Ue[Ke]&&null!=Ue[Ke]||(Ue[Ke]={}),Ue[Ke][et]=Ee.characterValue}let ze={};for(let We=0;We<ue.length;We++){let bt=ue[We].ofConcept,Ee=ue[We].toConcept,Ke=null!==(at=null===(Ne=bt?.type)||void 0===Ne?void 0:Ne.characterValue)&&void 0!==at?at:"",et=(null!==(At=null===(Lt=Ee?.type)||void 0===Lt?void 0:Lt.characterValue)&&void 0!==At?At:"").replace("the_","");null!=ze[bt.id]&&null!=ze[bt.id]||(ze[bt.id]={});let mt=ze[bt.id];null!=mt[Ke]&&null!=mt[Ke]||(mt[Ke]={}),mt[Ke][et]=null!=Ue[ue[We].ofTheConceptId]&&null!=Ue[ue[We].toTheConceptId]?Ue[Ee.id]:Ee.characterValue}return ze[be.id]})}(ye,P,te);H=de;let we={};return we.created_at=ye.entryTimeStamp,we.data=H,we.id=V,we})}function w(V){return a(this,void 0,void 0,function*(){var z,P;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionWithIdAndDateFromMemory",{id:V})).data}catch(_e){console.error("GetCompositionWithIdAndDateFromMemory error sw: ",_e),(0,A.handleServiceWorkerException)(_e)}let H=[],te={};H=yield f.d.GetConnectionsOfCompositionLocal(V);let ye=[];for(let _e=0;_e<H.length;_e++)ye.includes(H[_e].ofTheConceptId)||ye.push(H[_e].ofTheConceptId);let de=yield c.I.GetConcept(V);0==de.id&&null!=V&&null!=V&&(de=yield(0,B.r)(V));let we=yield G(V,H,ye);te[null!==(P=null===(z=de?.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:""]=we;let fe={};return fe.data=te,fe.id=V,fe.created_at=de.entryTimeStamp,fe})}function F(V){var z=arguments;return a(this,void 0,void 0,function*(){var P,H;const te=A.Logger.logfunction("GetCompositionWithId",z)||{};if(A.serviceWorker){te.serviceWorker=!0;try{const be=yield(0,A.sendMessage)("GetCompositionWithId",{id:V});return A.Logger.logUpdate(te),be.data}catch(be){console.error("GetCompositionWithId error sw: ",be),(0,N.ey)(te,"GetCompositionWithId",be),(0,A.handleServiceWorkerException)(be)}}let ye=[],de={};ye=yield(0,M.s)(V);let we=[];for(let be=0;be<ye.length;be++)we.includes(ye[be].ofTheConceptId)||we.push(ye[be].ofTheConceptId);let fe=yield c.I.GetConcept(V);0==fe.id&&null!=V&&null!=V&&(fe=yield(0,B.r)(V));let _e=yield G(V,ye,we);de[null!==(H=null===(P=fe?.type)||void 0===P?void 0:P.characterValue)&&void 0!==H?H:""]=_e;let De={};return De.data=de,De.id=V,A.Logger.logUpdate(te),De})}function E(V,z,P){return a(this,arguments,void 0,function*(H,te,ye,de=[]){var fe,_e;let De={},be=[],ue=H.id;if(!ye.includes(ue))return H?.characterValue;if(de.includes(ue))return"";de.push(ue);for(let ke=0;ke<te.length;ke++)if(te[ke].ofTheConceptId==ue)if(ue!=te[ke].toTheConceptId){let Ae=te[ke].toTheConceptId,Oe=yield c.I.GetConcept(Ae);if(null!=Oe&&0!=Oe.id||null==Ae||null==Ae||(Oe=yield(0,B.r)(Ae)),0!=Oe.id&&null==Oe?.type){let Me=Oe.typeId,Ne=yield c.I.GetConcept(Me);Oe.type=Ne,null==Ne&&null!=Me&&null!=Me&&(Ne=yield(0,B.r)(Me),Oe.type=Ne)}let lt=(null!==(_e=null===(fe=Oe?.type)||void 0===fe?void 0:fe.characterValue)&&void 0!==_e?_e:"").replace("the_","");if(isNaN(Number(lt))){if(lt){const Me=yield E(Oe,te,ye,de);De[lt]=Me}}else{const Me=yield E(Oe,te,ye,de);be[lt]=Me,De=be}}else console.log("this is the faulty connection ",te[ke]);return De})}function D(V,z,P){return a(this,arguments,void 0,function*(H,te,ye,de=[]){var fe,_e;const De=A.Logger.logfunction("recursiveFetchConceptNormal",[H]);(new Date).getTime();let be={},ue=[],ke=H.id;if(be.id=ke,!ye.includes(ke))return H?.characterValue;if(de.includes(ke))return"";de.push(ke);for(let Ae=0;Ae<te.length;Ae++)if(te[Ae].ofTheConceptId==ke)if(ke!=te[Ae].toTheConceptId){let Oe=te[Ae].toTheConceptId,ht=yield c.I.GetConcept(Oe);if(null!=ht&&0!=ht.id||null==Oe||null==Oe||(ht=yield(0,B.r)(Oe)),0!=ht.id&&null==ht?.type){let Ne=ht.typeId,at=yield c.I.GetConcept(Ne);ht.type=at,null==at&&null!=Ne&&null!=Ne&&(at=yield(0,B.r)(Ne),ht.type=at)}let Me=(null!==(_e=null===(fe=ht?.type)||void 0===fe?void 0:fe.characterValue)&&void 0!==_e?_e:"").replace("the_","");if(isNaN(Number(Me))){if(Me){const Ne=yield E(ht,te,ye,de);be[Me]=Ne}}else{const Ne=yield E(ht,te,ye,de);ue[Me]=Ne,be=ue}}else console.log("this is the faulty connection ",te[Ae]);return A.Logger.logUpdate(De),be})}function G(V,z,P){return a(this,arguments,void 0,function*(H,te,ye,de=[]){var fe,_e;let De={},be=[];if(0==H)return null;let ue=yield c.I.GetConcept(H);if(null!=ue&&0!=ue.id||null==H||null==H||(ue=yield(0,B.r)(H)),0!=ue.id&&null==ue.type){let ke=ue.typeId,Ae=yield c.I.GetConcept(ke);ue.type=Ae,null==Ae&&null!=ke&&null!=ke&&(Ae=yield(0,B.r)(ke),ue.type=Ae)}if(!ye.includes(H))return ue?.characterValue;if(de.includes(H))return"";de.push(H);for(let ke=0;ke<te.length;ke++)if((new Date).getTime(),te[ke].ofTheConceptId==H)if(H!=te[ke].toTheConceptId){let Ae=te[ke].toTheConceptId,Oe=yield c.I.GetConcept(Ae);if(null!=Oe&&0!=Oe.id||null==Ae||null==Ae||(Oe=yield(0,B.r)(Ae)),0!=Oe.id&&null==Oe?.type){let Me=Oe.typeId,Ne=yield c.I.GetConcept(Me);Oe.type=Ne,null==Ne&&null!=Me&&null!=Me&&(Ne=yield(0,B.r)(Me),Oe.type=Ne)}let lt=(null!==(_e=null===(fe=Oe?.type)||void 0===fe?void 0:fe.characterValue)&&void 0!==_e?_e:"").replace("the_","");if(isNaN(Number(lt))){if(lt){const Me=yield G(Ae,te,ye,de);De[lt]=Me}}else{const Me=yield G(Ae,te,ye,de);be[lt]=Me,De=be}}else console.log("this is the faulty connection ",te[ke]);return De})}function Z(V,z,P){return a(this,arguments,void 0,function*(H,te,ye,de=[]){var fe,_e;let De={},be=[];if(0==H)return null;let ue=yield c.I.GetConcept(H);if(null!=ue&&0!=ue.id||null==H||null==H||(ue=yield(0,B.r)(H)),0!=ue.id&&null==ue.type){let ke=ue.typeId,Ae=yield c.I.GetConcept(ke);ue.type=Ae,null==Ae&&null!=ke&&null!=ke&&(Ae=yield(0,B.r)(ke),ue.type=Ae)}if(!ye.includes(H))return ue?.characterValue;if(de.includes(H))return"";de.push(H),De.id=H;for(let ke=0;ke<te.length;ke++)if(te[ke].ofTheConceptId==H){let Ae=te[ke].toTheConceptId,Oe=yield c.I.GetConcept(Ae);if(null!=Oe&&0!=Oe.id||null==Ae||null==Ae||(Oe=yield(0,B.r)(Ae)),Oe&&null==Oe?.type){let Me=Oe.typeId,Ne=yield c.I.GetConcept(Me);Oe.type=Ne,null==Ne&&null!=Me&&null!=Me&&(Ne=yield(0,B.r)(Me),Oe.type=Ne)}let lt=(null!==(_e=null===(fe=Oe?.type)||void 0===fe?void 0:fe.characterValue)&&void 0!==_e?_e:"").replace("the_","");if(isNaN(Number(lt))){if(lt){const Me=yield Z(Ae,te,ye);De[lt]=Me}}else{const Me=yield Z(Ae,te,ye);be[lt]=Me,De=be}}return De})}},6687:(Re,ce,_)=>{_.d(ce,{D:()=>x,MT:()=>I,Nt:()=>T,QL:()=>y,as:()=>b,cw:()=>d,dF:()=>r,hG:()=>m,km:()=>C,nr:()=>p,p8:()=>h,rv:()=>s});var B=_(8642),M=_(7467),c=_(1834),f=_(1863),A=_(5284),N=_(8939),a=function(w,F,E,D){return new(E||(E=Promise))(function(G,Z){function V(H){try{P(D.next(H))}catch(te){Z(te)}}function z(H){try{P(D.throw(H))}catch(te){Z(te)}}function P(H){var te;H.done?G(H.value):(te=H.value,te instanceof E?te:new E(function(ye){ye(te)})).then(V,z)}P((D=D.apply(w,F||[])).next())})};function r(){return a(this,arguments,void 0,function*(w=[]){yield(0,B.Y)(w);let F=[];for(let E=0;E<w.length;E++){let D=yield(0,N.kx)(w[E]);F.push(D)}return F})}function d(){return a(this,arguments,void 0,function*(w=[]){yield(0,B.Y)(w);let F=[];for(let E=0;E<w.length;E++){let D=yield(0,N.RW)(w[E]);F.push(D)}return F})}function h(){return a(this,arguments,void 0,function*(w=[],F=[]){const E=c.Logger.logfunction("GetCompositionFromConnectionsWithDataId",[w])||{};if(c.serviceWorker){E.serviceWorker=!0;try{const G=yield(0,c.sendMessage)("GetCompositionFromConnectionsWithDataId",{conceptIds:w,connectionIds:F});return c.Logger.logUpdate(E),G.data}catch(G){console.error("GetCompositionFromConnectionsWithDataId error sw: ",G),(0,f.ey)(E,"GetCompositionFromConnectionsWithDataId",G),(0,c.handleServiceWorkerException)(G)}}let D=[];for(let G=0;G<w.length;G++){let Z=yield(0,N.RW)(w[G]);D.push(Z)}return c.Logger.logUpdate(E),D})}function C(){var w=arguments;return a(this,arguments,void 0,function*(F=[],E=[]){const D=c.Logger.logfunction("GetCompositionFromConnectionsWithDataIdFromConnections",w)||{};if(c.serviceWorker){D.serviceWorker=!0;try{const V=yield(0,c.sendMessage)("GetCompositionFromConnectionsWithDataIdFromConnections",{conceptIds:F,connectionIds:E});return c.Logger.logUpdate(D),V.data}catch(V){console.error("GetCompositionFromConnectionsWithDataIdFromConnections error sw: ",V),(0,f.ey)(D,"GetCompositionFromConnectionsWithDataIdFromConnections",V),(0,c.handleServiceWorkerException)(V)}}let G=yield(0,M.j)(E),Z=[];for(let V=0;V<F.length;V++){let z=yield(0,N.PT)(F[V],G);Z.push(z)}return c.Logger.logUpdate(D),Z})}function T(){var w=arguments;return a(this,arguments,void 0,function*(F=[],E=[]){const D=c.Logger.logfunction("GetCompositionFromConnectionsWithDataIdIndex",w)||{};if(c.serviceWorker){D.serviceWorker=!0;try{const Z=yield(0,c.sendMessage)("GetCompositionFromConnectionsWithDataIdIndex",{conceptIds:F,connectionIds:E});return c.Logger.logUpdate(D),Z.data}catch(Z){console.error("GetCompositionFromConnectionsWithDataIdIndex error sw: ",Z),(0,f.ey)(D,"GetCompositionFromConnectionsWithDataIdIndex",Z),(0,c.handleServiceWorkerException)(Z)}}yield(0,M.j)(E),yield(0,A.B)(F);let G={};for(let Z=0;Z<F.length;Z++){let V=yield(0,N.RW)(F[Z]);G[F[Z]]=V}return c.Logger.logUpdate(D),G})}function b(){return a(this,arguments,void 0,function*(w=[],F=[]){yield(0,M.j)(F),yield(0,A.B)(w);let E={};for(let D=0;D<w.length;D++){let G=yield(0,N.kx)(w[D]);E[w[D]]=G}return E})}function m(){return a(this,arguments,void 0,function*(w=[],F=[]){if(c.serviceWorker)try{return(yield(0,c.sendMessage)("GetCompositionFromConnectionsWithIndexFromConnections",{conceptIds:w,connectionIds:F})).data}catch(G){console.error("GetCompositionFromConnectionsWithIndexFromConnections error sw: ",G),(0,c.handleServiceWorkerException)(G)}let E=yield(0,M.j)(F),D=[];for(let G=0;G<w.length;G++){let Z=yield(0,N.JA)(w[G],E);D[w[G]]=Z}return D})}function y(w){var F=arguments;return a(this,void 0,void 0,function*(){const E=c.Logger.logfunction("GetConnectionDataPrefetch",F)||{};if(c.serviceWorker){E.serviceWorker=!0;try{const P=yield(0,c.sendMessage)("GetConnectionDataPrefetch",{connectionIds:w});return c.Logger.logUpdate(E),P.data}catch(P){console.error("GetConnectionDataPrefetch error sw: ",P),(0,f.ey)(E,"GetConnectionDataPrefetch",P),(0,c.handleServiceWorkerException)(P)}}let D=[],G=[],Z={};for(let P=0;P<w.length;P++){let H=yield c.ConnectionData.GetConnection(w[P]);0==H.id?D.push(w[P]):G.push(H)}for(let P=0;P<D.length;P++)Z[w[P]]=!1;let V=[],z=yield(0,M.j)(D);G=[...G,...z];for(let P=0;P<G.length;P++)V.push(G[P].ofTheConceptId),V.push(G[P].toTheConceptId),V.push(G[P].typeId);return yield(0,c.GetConceptBulk)(V),c.Logger.logUpdate(E),G})}function s(){var w=arguments;return a(this,arguments,void 0,function*(F=[],E=[]){const D=c.Logger.logfunction("GetCompositionFromConnectionsWithDataIdInObject",w);yield(0,M.j)(E);let G={};for(let Z=0;Z<F.length;Z++){let V=yield(0,N.RW)(F[Z]);G[F[Z]]=V}return c.Logger.logUpdate(D),G})}function p(){return a(this,arguments,void 0,function*(w=[],F=[]){yield(0,M.j)(F);let E={};for(let D=0;D<w.length;D++){let G=yield(0,N.$N)(w[D]);E[w[D]]=G}return E})}function I(){return a(this,arguments,void 0,function*(w=[],F=[]){yield(0,M.j)(F);let E={};for(let D=0;D<w.length;D++){let G=yield(0,N.kx)(w[D]);E[w[D]]=G}return E})}function x(){return a(this,arguments,void 0,function*(w=[],F=[]){yield(0,M.j)(F);let E={};for(let D=0;D<w.length;D++){let G=yield(0,N.XI)(w[D]);E[w[D]]=G,console.log("this is the normal data",w[D],G)}return E})}},2013:(Re,ce,_)=>{_.d(ce,{A:()=>N,w:()=>a});var B=_(8146),M=_(1834),c=_(9639),f=_(1863),A=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function N(r){var d=arguments;return A(this,void 0,void 0,function*(){const h=M.Logger.logfunction("GetConceptByCharacter",d)||{};if(M.serviceWorker){h.serviceWorker=!0;try{const b=yield(0,M.sendMessage)("GetConceptByCharacter",{characterValue:r});return M.Logger.logUpdate(h),b.data}catch(b){console.error("GetConceptByCharacter sw error: ",b),(0,f.ey)(h,"GetConceptByCharacter",b),(0,M.handleServiceWorkerException)(b)}}let C=yield c.I.GetConceptByCharacter(r);return null!=C&&0!=C?.id||!`${r}`||(yield(0,B.Y)(r),C=yield c.I.GetConceptByCharacterAndTypeLocal(r,51),0==C.id&&(C=yield c.I.GetConceptByCharacter(r))),M.Logger.logUpdate(h),C})}function a(r){var d=arguments;return A(this,void 0,void 0,function*(){const h=M.Logger.logfunction("GetConceptByCharacterUpdated",d)||{};if(M.serviceWorker){h.serviceWorker=!0;try{const b=yield(0,M.sendMessage)("GetConceptByCharacterUpdated",{characterValue:r});return M.Logger.logUpdate(h),b.data}catch(b){console.error("GetConceptByCharacterUpdated error sw: ",b),(0,f.ey)(h,"GetConceptByCharacterUpdated",b),(0,M.handleServiceWorkerException)(b)}}let C=yield c.I.GetConceptByCharacter(r);return null!=C&&0!=C?.id||!`${r}`||(yield(0,B.Y)(r),C=yield c.I.GetConceptByCharacter(r)),M.Logger.logUpdate(h),C})}},7887:(Re,ce,_)=>{_.d(ce,{a:()=>f,p:()=>A});var B=_(8286),M=_(4864),c=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function f(){return c(this,void 0,void 0,function*(){try{let N=[];if(Array.isArray(N))for(let a=0;a<N.length;a++)B.d.AddConnectionToMemory(N[a])}catch(N){throw{message:"Cannot create Connection Binary Tree Concept",ok:!1,status:400,data:N}}})}function A(){return c(this,void 0,void 0,function*(){try{let N=[];if(Array.isArray(N))for(let a=0;a<N.length;a++)M.G.AddConnectionToMemory(N[a])}catch(N){throw{message:"Cannot create Local Connection Binary Tree Concept",ok:!1,status:400,data:N}}})}},7876:(Re,ce,_)=>{_.d(ce,{A:()=>r,K:()=>d});var B=_(1735),M=_(7139),c=_(1834),f=_(9639),A=_(7282),N=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};const a=new Map;function r(h){return N(this,arguments,void 0,function*(C,T=999){let b=performance.now();if(B.J.activateStatus)try{B.J.incrementConcept(C)}catch{console.error("Error adding connection in access tracker"),c.Logger.log("ERROR","Error Adding Connection")}if(c.serviceWorker)try{return(yield(0,c.sendMessage)("GetTheConcept",{id:C,userId:T})).data}catch(s){console.error("GetTheConcept sw error: ",s),(0,c.handleServiceWorkerException)(s)}let m=(0,A.o)();if(a.has(C))return a.get(C)||m;const y=(()=>N(this,void 0,void 0,function*(){try{if(C<0)return yield c.LocalConceptsData.GetConceptByGhostId(C);if(m=yield f.I.GetConcept(C),(null==m||0==m.id)&&null!=C&&null!=C&&(m=yield(0,M.r)(C)),0!=m.id&&null==m.type&&null==(yield f.I.GetConcept(m.typeId))&&null!=m.typeId&&null!=m.typeId){let s=yield(0,M.r)(m.typeId);m.type=s}return m}catch(s){throw console.error("this is the error in the getting concept",s),c.Logger.logError(b,T,"read","unknown",void 0,500,s,"GetTheConcept",[C,T],"unknown",void 0),s}finally{a.delete(C)}}))();return a.set(C,y),y})}function d(h){return N(this,void 0,void 0,function*(){if(c.serviceWorker)try{return(yield(0,c.sendMessage)("AddTypeConcept",{concept:h})).data}catch(C){console.error("AddTypeConcept sw error: ",C),(0,c.handleServiceWorkerException)(C)}if(null==h.type){let C=yield f.I.GetConcept(h.typeId);if(0==C.id&&0!=h.typeId&&999!=h.typeId){let T=yield(0,M.r)(h.typeId);h.type=T}else h.type=C}})}},7869:(Re,ce,_)=>{_.d(ce,{_:()=>b,A:()=>T});var B=_(9581),M=_(9639),c=_(1863),f=_(3518),A=_(1834),N=function(m,y,s,p){return new(s||(s=Promise))(function(I,x){function w(D){try{E(p.next(D))}catch(G){x(G)}}function F(D){try{E(p.throw(D))}catch(G){x(G)}}function E(D){var G;D.done?I(D.value):(G=D.value,G instanceof s?G:new s(function(Z){Z(G)})).then(w,F)}E((p=p.apply(m,y||[])).next())})},a=_(2299);class r{}r.isUpdated=!1,r.isOnlineSync=!1;var d=_(3655),h=_(9003),C=function(m,y,s,p){return new(s||(s=Promise))(function(I,x){function w(D){try{E(p.next(D))}catch(G){x(G)}}function F(D){try{E(p.throw(D))}catch(G){x(G)}}function E(D){var G;D.done?I(D.value):(G=D.value,G instanceof s?G:new s(function(Z){Z(G)})).then(w,F)}E((p=p.apply(m,y||[])).next())})};function T(){return C(this,arguments,void 0,function*(m=!0){try{if(yield(0,d.qI)("concepts"),yield(0,h.qI)("concepts"),m){if((yield(0,d.b8)()).isOnlineSync)return!0;yield function(){return N(this,void 0,void 0,function*(){const y=A.Logger.logfunction("GetAiData");try{const I=(new Date).getTime();var s=(0,f.ab)("application/x-www-form-urlencoded");const x=yield fetch(B.B.GetAllAiData(),{method:"GET",headers:s});x.ok||(console.log("Ai Error Message: ","Cannot get response"),(0,c.ry)(x));const w=yield x.json();for(var p=0;p<w.length;p++)M.I.AddConcept(w[p]);b();let F=(new Date).getTime()-I;console.log("The time taken is ",F),A.Logger.logUpdate(y)}catch(I){I instanceof Error?console.log("Ai Error Message: ",I.message):console.log("Ai Error Message: ",I),(0,c.Mb)(I,B.B.GetAllAiData())}})}()}return!0}catch(y){return console.log({message:"cannot initlize the AI system",ok:!1,status:400,data:y}),!0}})}function b(){return C(this,void 0,void 0,function*(){r.isOnlineSync=!0;var m=new a.B(r.isOnlineSync);(0,d.El)(m)})}},8095:(Re,ce,_)=>{_.d(ce,{h:()=>A});var B=_(1834),M=_(9700),c=_(1863),f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function A(N,a,r){var d=arguments;return f(this,arguments,void 0,function*(h,C,T,b=!1,m={concepts:[],connections:[]}){var y,s,p,I,x,w;const F=M.V.logfunction("CreateConnectionBetweenTwoConceptsLocal",d)||{};let E=performance.now();try{if(B.serviceWorker){F.serviceWorker=!0;try{const z=yield(0,B.sendMessage)("CreateConnectionBetweenTwoConceptsLocal",{ofTheConcept:h,toTheConcept:C,linker:T,both:b,actions:m});return!(null===(s=null===(y=z?.actions)||void 0===y?void 0:y.concepts)||void 0===s)&&s.length&&(m.concepts=JSON.parse(JSON.stringify(z.actions.concepts))),!(null===(I=null===(p=z?.actions)||void 0===p?void 0:p.connections)||void 0===I)&&I.length&&(m.connections=JSON.parse(JSON.stringify(z.actions.connections))),M.V.logUpdate(F),z.data}catch(z){console.error("CreateConnectionBetweenTwoConceptsLocal sw error: ",z),(0,c.ey)(F,"CreateConnectionBetweenTwoConceptsLocal",z),(0,B.handleServiceWorkerException)(z)}}if(b){let z=(null===(x=C.type)||void 0===x?void 0:x.characterValue)+"_s_"+T+"_by";var D=yield(0,B.MakeTheInstanceConceptLocal)("connection",z,!1,999,999,999,0,m);yield(0,B.CreateTheConnectionLocal)(C.id,h.id,D.id,1e3,void 0,void 0,m)}let Z=(null===(w=h.type)||void 0===w?void 0:w.characterValue)+"_s_"+T+"_s";var G=yield(0,B.MakeTheInstanceConceptLocal)("connection",Z,!1,999,999,999,void 0,m);let V=yield(0,B.CreateTheConnectionLocal)(h.id,C.id,G.id,1e3,void 0,void 0,m);return M.V.logUpdate(F),V}catch(Z){throw M.V.logError(E,h.userId,"create",void 0,void 0,500,Z,"CreateConnectionBetweenTwoConceptsLocal",[h,C,T,b],void 0,void 0),(0,c.ey)(F,"CreateConnectionBetweenTwoConceptsLocal",Z),Z}})}},6416:(Re,ce,_)=>{_.d(ce,{u:()=>M});var B=_(2615);function M(){return new B.j(0,0,0,0,0,"0",0,!1,new Date,new Date,"0")}},3075:(Re,ce,_)=>{_.d(ce,{Ay:()=>r,EO:()=>d,xd:()=>h});var B=_(205),M=_(9736),c=_(5257),f=_(9003),A=_(1834),N=_(1863),a=function(C,T,b,m){return new(b||(b=Promise))(function(y,s){function p(w){try{x(m.next(w))}catch(F){s(F)}}function I(w){try{x(m.throw(w))}catch(F){s(F)}}function x(w){var F;w.done?y(w.value):(F=w.value,F instanceof b?F:new b(function(E){E(F)})).then(p,I)}x((m=m.apply(C,T||[])).next())})};function r(){return a(this,void 0,void 0,function*(){const C=A.Logger.logfunction("CreateLocalBinaryTreeFromIndexDb");try{let T=[];if(Array.isArray(T))for(let b=0;b<T.length;b++)M.v.AddConceptToMemory(T[b]);B.B.isLocalDataLoaded=!0,B.B.isLocalTypeLoaded=!0,B.B.isLocalCharacterLoaded=!0,A.Logger.logUpdate(C)}catch(T){yield(0,A.DelayFunctionExecution)(2e3,r());let b={message:"Cannot create local binary tree from index db",data:T,ok:!1,status:400};throw(0,N.ey)(C,"CreateLocalBinaryTreeFromIndexDb",T),b}})}function d(){return a(this,void 0,void 0,function*(){var C;const T=A.Logger.logfunction("PopulateTheLocalConceptsToMemory");try{yield null===(C=navigator.locks)||void 0===C?void 0:C.request("dblock",b=>a(this,void 0,void 0,function*(){let m=yield(0,f.S5)("localid");if(Array.isArray(m)&&m[0]){let y=m[0].value;if(y)c.R.AddConceptId(m[0]),yield(0,f.kH)("localid",{id:0,value:y-10});else{y=-Math.floor(1e8*Math.random());let p={id:0,value:y-10};c.R.AddConceptId({id:0,value:y}),yield(0,f.kH)("localid",p)}}})),A.Logger.logUpdate(T)}catch(b){let m={message:"Cannot populate Local Ids from the Index Db",data:b,ok:!1,status:400};throw(0,N.ey)(T,"PopulateTheLocalConceptsToMemory",b),m}})}function h(){return a(this,void 0,void 0,function*(){var C;const T=A.Logger.logfunction("PopulateTheLocalConnectionToMemory");try{yield null===(C=navigator.locks)||void 0===C?void 0:C.request("dblock",b=>a(this,void 0,void 0,function*(){let m=yield(0,f.S5)("localid");if(Array.isArray(m)&&m[1]){let y=m[1].value;if(y)c.R.AddConnectionId(m[1]),yield(0,f.kH)("localid",{id:1,value:y-10});else{y=-Math.floor(1e8*Math.random());let p={id:0,value:y-10};c.R.AddConnectionId({id:0,value:y}),yield(0,f.kH)("localid",p)}}})),A.Logger.logUpdate(T)}catch(b){let m={message:"Cannot populate Local Ids from the Index Db",data:b,ok:!1,status:400};throw(0,N.ey)(T,"PopulateTheLocalConnectionToMemory",b),m}})}},999:(Re,ce,_)=>{_.d(ce,{R:()=>a});var B=_(1834),M=_(1863),c=_(6416),f=_(4711),A=_(5868),N=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function a(r){return N(this,arguments,void 0,function*(d,h=null,C=null,T=null,b=null,m=null,y=null,s=!1,p={concepts:[],connections:[]}){var I,x,w,F;const E=B.Logger.logfunction("CreateTheCompositionLocal")||{};if(B.serviceWorker){E.serviceWorker=!0;try{const P=yield(0,B.sendMessage)("CreateTheCompositionLocal",{json:d,ofTheConceptId:h,ofTheConceptUserId:C,mainKey:T,userId:b,accessId:m,sessionInformationId:y,actions:p});return!(null===(x=null===(I=P?.actions)||void 0===I?void 0:I.concepts)||void 0===x)&&x.length&&(p.concepts=JSON.parse(JSON.stringify(P.actions.concepts))),!(null===(F=null===(w=P?.actions)||void 0===w?void 0:w.connections)||void 0===F)&&F.length&&(p.connections=JSON.parse(JSON.stringify(P.actions.connections))),B.Logger.logUpdate(E),P.data}catch(P){console.error("CreateTheCompositionLocal error sw: ",P),(0,M.ey)(E,"CreateTheCompositionLocal",P),(0,B.handleServiceWorkerException)(P)}}let D=b??999,G=m??999,Z=y??999,V=T??0,z=(0,c.u)();for(const P in d)if("string"!=typeof d[P]&&"number"!=typeof d[P])if(null==h&&null==C){let H=V,te=yield(0,A.k)(P,"",!0,D,G,Z,void 0,p);z=te,H=te.id,V=te.id,yield a(d[P],te.id,te.userId,H,b,m,y,void 0,p)}else{let H=h??999,te=V,ye=yield(0,A.k)(P,"",!0,D,G,Z,void 0,p);yield(0,f.F)(H,ye.id,te,void 0,void 0,void 0,p),yield a(d[P],ye.id,ye.userId,te,b,m,y,void 0,p)}else{let H=h??999,te=V,ye=yield(0,A.k)(P,d[P].toString(),!1,D,G,Z,void 0,p);yield(0,f.F)(H,ye.id,te,void 0,void 0,void 0,p)}return B.Logger.logUpdate(E),z})}},3077:(Re,ce,_)=>{_.d(ce,{A:()=>a});var B=_(1834),M=_(2615),c=_(9736),f=_(5257),A=_(9700),N=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function a(r,d,h,C,T,b){return N(this,arguments,void 0,function*(m,y,s,p,I,x,w=!1,F=0,E={concepts:[],connections:[]}){var D,G,Z,V;let z=performance.now();try{if(B.serviceWorker)try{const we=yield(0,B.sendMessage)("CreateTheConceptLocal",{referent:m,typecharacter:y,userId:s,categoryId:p,typeId:I,accessId:x,isComposition:w,referentId:F});return!(null===(G=null===(D=we?.actions)||void 0===D?void 0:D.concepts)||void 0===G)&&G.length&&(E.concepts=JSON.parse(JSON.stringify(we.actions.concepts))),!(null===(V=null===(Z=we?.actions)||void 0===Z?void 0:Z.connections)||void 0===V)&&V.length&&(E.connections=JSON.parse(JSON.stringify(we.actions.connections))),we.data}catch(we){console.error("CreateTheConceptLocal error sw: ",we),(0,B.handleServiceWorkerException)(we)}let P=yield f.R.getConceptId(),H=!0,te=new Date,ye=new Date;if("the"==m)return new M.j(1,999,5,5,F,m,x,H,te,ye,y);let de=new M.j(P,s,I,p,F,m,x,H,te,ye,y);return de.isTemp=!0,de.isComposition=w,c.v.AddConcept(de),E.concepts.push(de),de}catch(P){throw A.V.logError(z,s,"create","unknown","unknown",500,void 0,"createTheConceptLocal",[m,y,s,p,I,x,w],void 0),P}})}},4711:(Re,ce,_)=>{_.d(ce,{F:()=>a,d:()=>r});var B=_(2155),M=_(4864),c=_(5257),f=_(9700),A=_(1834),N=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};function a(d,h,C){return N(this,arguments,void 0,function*(T,b,m,y=1,s="",p=999,I={concepts:[],connections:[]}){var x,w,F,E;let D=performance.now();if(A.serviceWorker)try{const G=yield(0,A.sendMessage)("CreateTheConnectionLocal",{ofTheConceptId:T,toTheConceptId:b,typeId:m,orderId:y,typeString:s,userId:p,actions:I});return!(null===(w=null===(x=G?.actions)||void 0===x?void 0:x.concepts)||void 0===w)&&w.length&&(I.concepts=JSON.parse(JSON.stringify(G.actions.concepts))),!(null===(E=null===(F=G?.actions)||void 0===F?void 0:F.connections)||void 0===E)&&E.length&&(I.connections=JSON.parse(JSON.stringify(G.actions.connections))),G.data}catch(G){console.log("CreateTheConnectionLocal error sw: ",G),(0,A.handleServiceWorkerException)(G)}try{let G=4,Z=yield c.R.getConnectionId(),V=0,z=0,P=0;V=T,z=b,P=m;let H=new B.N(0,0,0,0,0,0,0);return T!=b&&(H=new B.N(Z,V,z,p,m,y,G),H.isTemp=!0,H.typeCharacter=s,A.LocalSyncData.AddConnection(H),M.G.AddConnection(H),I.connections.push(H)),H}catch(G){throw f.V.logError(D,p,"create","Unknown","Unknown",500,void 0,"CreateTheConnectionLocal",[T,b,m,y,s,p],"UnknownUserAgent",[]),G}})}function r(d,h,C){return N(this,arguments,void 0,function*(T,b,m,y={concepts:[],connections:[]}){var s,p,I,x;if(A.serviceWorker)try{const E=yield(0,A.sendMessage)("CreateConnection",{ofTheConcept:T,toTheConcept:b,connectionTypeString:m,actions:y});return!(null===(p=null===(s=E?.actions)||void 0===s?void 0:s.concepts)||void 0===p)&&p.length&&(y.concepts=JSON.parse(JSON.stringify(E.actions.concepts))),!(null===(x=null===(I=E?.actions)||void 0===I?void 0:I.connections)||void 0===x)&&x.length&&(y.connections=JSON.parse(JSON.stringify(E.actions.connections))),E.data}catch(E){console.log("CreateConnection error sw: ",E),(0,A.handleServiceWorkerException)(E)}let w=yield(0,A.MakeTheTypeConceptLocal)(m,999,999,999),F=T.userId;return yield a(T.id,b.id,w.id,1e3,m,F,y)})}},8064:(Re,ce,_)=>{_.d(ce,{$I:()=>A,Ay:()=>f});var B=_(9736),M=(_(9581),_(3518),_(1834));_(1863);var c=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function f(N){return c(this,void 0,void 0,function*(){return yield B.v.GetConceptByCharacterAndTypeLocal(N,51)})}function A(N){return c(this,void 0,void 0,function*(){if(M.serviceWorker)try{return(yield(0,M.sendMessage)("GetConceptByCharacterAndCategoryLocal",{character:N})).data}catch(d){console.error("GetConceptByCharacterAndCategoryLocal error sw: ",d),(0,M.handleServiceWorkerException)(d)}let a=(0,M.CreateDefaultLConcept)();if("the"==N)return a.id=1,a.typeId=5,a.characterValue="the",a;let r=(0,M.SplitStrings)(N);if(r.length>1){let d=1,h=yield A(r[0]);0!=h.id&&(d=h.id),a=yield function(C,T){return c(this,void 0,void 0,function*(){return B.v.GetConceptByCharacterAndCategoryLocal(C,T)})}(N,d)}else r[0]==N&&(a=yield f(N));return a})}},1213:(Re,ce,_)=>{_.d(ce,{f:()=>N});var B=_(9736),M=_(7820),c=_(1834),f=_(176),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};function N(a){return A(this,void 0,void 0,function*(){let r=performance.now();try{if(c.serviceWorker)try{return(yield(0,c.sendMessage)("GetTheConceptLocal",{id:a})).data}catch(h){console.error("GetTheConceptLocal error sw: ",h),(0,c.handleServiceWorkerException)(h)}let d=(0,c.CreateDefaultLConcept)();if(a<0){if(d=yield B.v.GetConcept(a),0==d.id){let h=yield M.G.getNodeFromTree(a);if(h?.value){let C=h.value;C&&(d=C)}}}else{let h=yield(0,c.GetTheConcept)(a);d=(0,f.F4)(h)}return d}catch(d){throw c.Logger.logError(r,"unknown","read","unknown",void 0,200,void 0,"GetTheConceptLocal",[a],"unknown",void 0),d}})}},9975:(Re,ce,_)=>{_.d(ce,{A:()=>A});var B=_(1834),M=_(9736),c=_(3077),f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function A(N,a,r,d,h){return f(this,arguments,void 0,function*(C,T,b,m,y,s={concepts:[],connections:[]}){var p,I,x,w;if(B.serviceWorker)try{const D=yield(0,B.sendMessage)("MakeTheConceptLocal",{referent:C,typeCharacter:T,userId:b,categoryId:m,typeId:y,actions:s});return!(null===(I=null===(p=D?.actions)||void 0===p?void 0:p.concepts)||void 0===I)&&I.length&&(s.concepts=JSON.parse(JSON.stringify(D.actions.concepts))),!(null===(w=null===(x=D?.actions)||void 0===x?void 0:x.connections)||void 0===w)&&w.length&&(s.connections=JSON.parse(JSON.stringify(D.actions.connections))),D.data}catch(D){console.error("MakeTheConceptLocal error sw: ",D),(0,B.handleServiceWorkerException)(D)}let F=yield M.v.GetConceptByCharacterAndTypeLocal(C,y),E=F;return"the"==T&&(m=1),0==E.id&&(F=yield(0,c.A)(C,T,b,m,y,4,void 0,null,s),E=F),E})}},5868:(Re,ce,_)=>{_.d(ce,{k:()=>a});var B=_(3077),M=_(8357),c=_(9736),f=_(1834),A=_(1863),N=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function a(r,d){var h=arguments;return N(this,arguments,void 0,function*(C,T,b=!1,m,y,s=999,p=0,I={concepts:[],connections:[]}){var x,w,F,E;const D=f.Logger.logfunction("MakeTheInstanceConceptLocal",h)||{};if(f.serviceWorker){D.serviceWorker=!0;try{const G=yield(0,f.sendMessage)("MakeTheInstanceConceptLocal",{type:C,referent:T,composition:b,userId:m,accessId:y,sessionInformationId:s,referentId:p,actions:I});return!(null===(w=null===(x=G?.actions)||void 0===x?void 0:x.concepts)||void 0===w)&&w.length&&(I.concepts=JSON.parse(JSON.stringify(G.actions.concepts))),!(null===(E=null===(F=G?.actions)||void 0===F?void 0:F.connections)||void 0===E)&&E.length&&(I.connections=JSON.parse(JSON.stringify(G.actions.connections))),f.Logger.logUpdate(D),G.data}catch(G){console.error("MakeTheInstanceConceptLocal error sw: ",G),(0,A.ey)(D,"MakeTheInstanceConceptLocal",G),(0,f.handleServiceWorkerException)(G)}}try{let G,Z,V=999,z=4,P=m,H=4,te="",ye=T.length;if(te=C.startsWith("the_")?C:"the_"+C,b)G=yield(0,M.$)(C,V,m,m,I),Z=yield(0,B.A)(T,C,m,z,G.id,H,!0,p,I);else if(ye>255)G=yield(0,M.$)(te,V,P,m,I),Z=yield(0,B.A)(T,te,m,z,G.id,H,void 0,void 0,I);else{G=yield(0,M.$)(te,V,P,m,I);let de=yield c.v.GetConceptByCharacterAndTypeLocal(T,G.id);Z=de,0==de.id&&0==de.userId&&(Z=yield(0,B.A)(T,te,m,z,G.id,H,void 0,void 0,I))}return Z.type=G,f.LocalSyncData.AddConcept(Z),I.concepts.push(Z),f.Logger.logUpdate(D),Z}catch(G){throw(0,A.ey)(D,"MakeTheInstanceConceptLocal",G),G}})}},8357:(Re,ce,_)=>{_.d(ce,{$:()=>r});var B=_(3077),M=_(8064),c=_(6467),f=_(9975),A=_(1834),N=_(1863),a=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};function r(d,h,C,T){var b=arguments;return a(this,arguments,void 0,function*(m,y,s,p,I={concepts:[],connections:[]}){var x,w,F,E;const D=A.Logger.logfunction("MakeTheTypeConceptLocal",b)||{};if(A.serviceWorker){D.serviceWorker=!0;try{const Z=yield(0,A.sendMessage)("MakeTheTypeConceptLocal",{typeString:m,sessionId:y,sessionUserId:s,userId:p,actions:I});return!(null===(w=null===(x=Z?.actions)||void 0===x?void 0:x.concepts)||void 0===w)&&w.length&&(I.concepts=JSON.parse(JSON.stringify(Z.actions.concepts))),!(null===(E=null===(F=Z?.actions)||void 0===F?void 0:F.connections)||void 0===E)&&E.length&&(I.connections=JSON.parse(JSON.stringify(Z.actions.connections))),A.Logger.logUpdate(D),Z.data}catch(Z){console.error("MakeTheTypeConceptLocal error sw: ",Z),(0,N.ey)(D,"MakeTheTypeConceptLocal",Z),(0,A.handleServiceWorkerException)(Z)}}let G=yield(0,M.$I)(m);if(G&&(0==G.id||0==G.userId)){let Z=(0,c.f)(m);if(Z[0]==m)G=yield(0,f.A)(m,"the",p,1,51,I);else{let V=yield r(Z[0],y,s,p,I),z=yield r(Z[1],y,s,p,I);G=yield(0,B.A)(m,Z[1],p,V.id,z.id,4,void 0,null,I)}}return A.Logger.logUpdate(D),G})}},3729:(Re,ce,_)=>{_.d(ce,{D:()=>C});var B=_(9934),M=_(4485),c=_(2),f=_(7876),A=_(1838),N=_(999),a=_(5868),r=_(1834),d=_(176),h=function(T,b,m,y){return new(m||(m=Promise))(function(s,p){function I(F){try{w(y.next(F))}catch(E){p(E)}}function x(F){try{w(y.throw(F))}catch(E){p(E)}}function w(F){var E;F.done?s(F.value):(E=F.value,E instanceof m?E:new m(function(D){D(E)})).then(I,x)}w((y=y.apply(T,b||[])).next())})};function C(T){return h(this,arguments,void 0,function*(b,m={concepts:[],connections:[]}){var y,s,p,I;if(performance.now(),r.serviceWorker)try{const _e=yield(0,r.sendMessage)("UpdateCompositionLocal",{patcherStructure:b,actions:m});return!(null===(s=null===(y=_e?.actions)||void 0===y?void 0:y.concepts)||void 0===s)&&s.length&&(m.concepts=JSON.parse(JSON.stringify(_e.actions.concepts))),!(null===(I=null===(p=_e?.actions)||void 0===p?void 0:p.connections)||void 0===I)&&I.length&&(m.connections=JSON.parse(JSON.stringify(_e.actions.connections))),_e.data}catch(_e){console.error("UpdateCompositionLocal error sw: ",_e),(0,r.handleServiceWorkerException)(_e)}const x=b.userId,w=b.sessionId,F=b.accessId;let E=[];const D=[];let G=(0,r.CreateDefaultLConcept)(),Z=(0,r.CreateDefaultLConcept)();const V=[],z=b.compositionId,P=b.ofTheCompositionId;let H=[],te=yield(0,c.s)(z);for(let _e=0;_e<te.length;_e++)E.push((0,d.P6)(te[_e]));const ye=[],de=[];let we=[];for(let _e=0;_e<E.length;_e++)(0,B.A)(de,E[_e].ofTheConceptId),(0,B.A)(ye,E[_e].ofTheConceptId),(0,B.A)(ye,E[_e].toTheConceptId),we.push(E[_e].ofTheConceptId);for(let _e=0;_e<ye.length;_e++){const De=yield(0,f.A)(ye[_e]);z==ye[_e]&&(G=(0,d.F4)(De)),P==ye[_e]&&(Z=(0,d.F4)(De)),D.push((0,d.F4)(De))}const fe=b.patchObject;for(const _e in fe){let De=(0,r.CreateDefaultLConcept)();const be=fe[_e];let ue=G;Z.id>0&&(ue=Z),Array.isArray(be)||"object"==typeof be?(De=yield(0,a.k)(_e,"",!0,G.userId,4,999,void 0,m),yield(0,N.R)(fe[_e],De.id,De.userId,G.id,G.userId,4,999,void 0,m)):De=yield(0,a.k)(_e,be,!1,x,F,w,void 0,m);const ke=(0,M.nm)(D,De);for(let Ae=0;Ae<ke.length;Ae++)if(ke[Ae].id>0){const Oe=(0,M.gt)(E,ke[Ae].id);H=H.concat(Oe),V.push(ke[Ae])}yield(0,r.CreateTheConnectionLocal)(ue.id,De.id,G.id,2,void 0,void 0,m),D.push(De)}for(let _e=0;_e<H.length;_e++)yield(0,A.m)(H[_e].id);yield r.LocalSyncData.SyncDataOnline(void 0,m)})}},8407:(Re,ce,_)=>{_.d(ce,{A:()=>T});var B=_(9581),M=_(3518),c=_(1863),f=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})},A=_(4402),N=_(1834),a=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})};class r{constructor(m,y,s,p,I,x,w,F,E,D){this.id=0,this.userId=m,this.data=y,this.securityId=s,this.securityUserId=p,this.accessId=I,this.accessUserId=x,this.sessionId=w,this.sessionUserId=F,this.entryTimestamp=E,this.isNew=D}}var d=_(7282),h=_(2212),C=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})};function T(b,m){var y=arguments;return C(this,arguments,void 0,function*(s,p,I=!1,x,w=4,F=999,E=0){const D=N.Logger.logfunction("MakeTheInstanceConcept",y)||{};if(N.serviceWorker){D.serviceWorker=!0;try{const we=yield(0,N.sendMessage)("MakeTheInstanceConcept",{type:s,referent:p,composition:I,userId:x,passedAccessId:w,passedSessionId:F,referentId:E});return N.Logger.logUpdate(D),we.data}catch(we){console.error("MakeTheInstanceConcept sw error: ",we),(0,c.ey)(D,"MakeTheInstanceConcept",we),(0,N.handleServiceWorkerException)(we)}}let G,Z=F,V=x,z=x,P=w,H=x,te="",ye=p.length,de=(0,d.o)();if(te=s.startsWith("the_")?s:"the_"+s,I)de=yield(0,N.MakeTheTypeConceptApi)(s,x),G=yield(0,h.Ay)(p,x,4,de.id,E,P,s);else if(ye>255)de=yield(0,N.MakeTheTypeConceptApi)(te,x),G=yield(0,h.Ay)(p,x,4,de.id,E,P,te),function(we){f(this,void 0,void 0,function*(){try{var fe=(0,M.Xr)();const _e=yield fetch(B.B.CreateTheTextDataUrl(),{method:"POST",headers:fe,body:JSON.stringify(we)});if(!_e.ok)throw(0,c.ry)(_e),new Error(`Error! status: ${_e.status}`);return yield _e.json()}catch(_e){throw _e instanceof Error?console.log("Create the text error message: ",_e.message):console.log("Create the text unexpected error: ",_e),_e}})}(new r(x,p,999,V,P,H,Z,z,Date.now().toString(),!0));else{de=yield(0,N.MakeTheTypeConceptApi)(te,x);let we=yield(0,A.A)(p,de.id);G=we,0==we.id&&0==we.userId&&(G=yield(0,h.N)(p,x,4,de.id,12,P,te),function(fe,_e,De,be){var ue=arguments;a(this,void 0,void 0,function*(){const ke=N.Logger.logfunction("MakeTheNameInBackend",ue);try{let Ae={newConceptId:fe,referent:_e,typeId:De,typeUserId:be},Oe=(0,M.Xr)(),ht=JSON.stringify(Ae);const lt=yield fetch(B.B.MakeTheNameInBackendUrl(),{method:"POST",headers:Oe,body:ht});N.Logger.logUpdate(ke),lt.ok||(0,c.ry)(lt)}catch(Ae){Ae instanceof Error?console.log("make the name in backend error message: ",Ae.message):console.log("make the name in backend unexpected error: ",Ae),(0,c.Mb)(Ae,B.B.MakeTheNameInBackendUrl()),(0,c.ey)(ke,"MakeTheNameInBackend",Ae)}})}(G.id,`${p}`,de.id,x))}return G.type=de,N.Logger.logUpdate(D),G})}},5312:(Re,ce,_)=>{_.d(ce,{NK:()=>h,Ve:()=>C,cf:()=>r,vw:()=>T,y8:()=>d});var B=_(2832),M=_(3130),c=_(1834),f=_(1863),A=_(6687),N=_(7106),a=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})};function r(b){var m=arguments;return a(this,arguments,void 0,function*(y,s="",p=null,I=M.y0){var x,w,F,E,D,G,Z,V;const z=c.Logger.logfunction("SearchLinkMultipleAll",m)||{};try{try{if(c.serviceWorker){z.serviceWorker=!0;const De=yield(0,c.sendMessage)("SearchLinkMultipleAll",{searchQuery:y,token:s,caller:p,format:I});return c.Logger.logUpdate(z),De.data}}catch(De){console.error("SearchLinkMultipleAll error sw: ",De),(0,f.ey)(z,"SearchLinkMultipleAll",De),(0,c.handleServiceWorkerException)(De)}let P=[],H=[],te=[],ye=[],de=y[0].composition,we={},fe={};p?.isDataLoaded?(we.compositionIds=null===(x=p.conceptIds)||void 0===x?void 0:x.slice(),we.internalConnections=null===(w=p.internalConnections)||void 0===w?void 0:w.slice(),we.linkers=null===(F=p.linkers)||void 0===F?void 0:F.slice(),we.reverse=null===(E=p.reverse)||void 0===E?void 0:E.slice(),fe=we,P=fe.compositionIds,te=fe.internalConnections,H=fe.linkers,ye=fe.reverse):(we=yield(0,B.j)(y,s),p&&(p.conceptIds=null===(D=we.compositionIds)||void 0===D?void 0:D.slice(),p.internalConnections=null===(G=we.internalConnections)||void 0===G?void 0:G.slice(),p.linkers=null===(Z=we.linkers)||void 0===Z?void 0:Z.slice(),p.reverse=null===(V=we.reverse)||void 0===V?void 0:V.slice(),p.isDataLoaded=!0),fe=we,P=fe.compositionIds,te=fe.internalConnections,H=fe.linkers,ye=fe.reverse);let _e=yield function(De,be,ue,ke,Ae,Oe){return a(this,arguments,void 0,function*(ht,lt,Me,Ne,at,Lt,At=M.y0){try{let Ue,ft,Qe=yield(0,A.QL)(ht);return At==M.ZJ?(Ue=yield(0,A.MT)(lt,Me),ft=yield T(ht,Ue,at,Ne)):At==M.yv?(Ue=yield(0,A.D)(lt,Me),ft=yield T(ht,Ue,at,Ne)):100==At?(Ue=yield(0,A.nr)(lt,Me),ft=yield d(Qe,Ue,at,Ne)):At==M.SL?ft=yield(0,N._W)(ht,lt,Me,Lt.ofCompositions,Ne):(Ue=yield(0,A.rv)(lt,Me),ft=yield d(Qe,Ue,at,Ne)),ft}catch(Ue){return void console.log("Error Occured in build layer",Ue)}})}(H,P,te,ye,de,y[0],I);return c.Logger.logUpdate(z),_e}catch(P){throw console.log("this is the error in the search link multiple",P),(0,f.ey)(z,"SearchLinkMultipleAll",P),P}})}function d(b,m,y){return a(this,arguments,void 0,function*(s,p,I,x=[]){(new Date).getTime();let w={},F=[];for(let E=0;E<s.length;E++)F.push(s[E].toTheConceptId),F.push(s[E].ofTheConceptId),F.push(s[E].typeId);s.sort(function(E,D){return D.id-E.id});for(let E=0;E<s.length;E++){let D=!1;if(x.includes(s[E].id)&&(D=!0),1==D){if(p[s[E].ofTheConceptId]&&p[s[E].toTheConceptId]){let G=p[s[E].toTheConceptId],Z=yield(0,c.GetTheConcept)(s[E].typeId),V=G?.data,z=Object.keys(V)[0];try{let P=Z.characterValue+"_reverse";"string"==typeof V&&(V={}),Array.isArray(V[z][P])||("string"==typeof V[z]&&(V[z]={}),V[z][P]=[]),V[z][P].push(p[s[E].ofTheConceptId])}catch(P){console.log("this is error",P)}}}else if(p[s[E].ofTheConceptId]&&p[s[E].toTheConceptId]){let G=p[s[E].ofTheConceptId],Z=yield(0,c.GetTheConcept)(s[E].typeId),V=G?.data,z=Object.keys(V)[0];try{"string"==typeof V&&(V={}),Array.isArray(V[z][Z.characterValue])||("string"==typeof V[z]&&(V[z]={}),V[z][Z.characterValue]=[]),V[z][Z.characterValue].push(p[s[E].toTheConceptId])}catch(P){console.log("this is error",P)}}}return w=p[I],w})}function h(b,m,y){return a(this,arguments,void 0,function*(s,p,I,x=[]){let w=[],F=[];for(let E=0;E<s.length;E++)F.push(s[E].toTheConceptId),F.push(s[E].ofTheConceptId),F.push(s[E].typeId);s.sort(function(E,D){return D.id-E.id});for(let E=0;E<s.length;E++){let D=!1;if(x.includes(s[E].id)&&(D=!0),1==D){if(p[s[E].ofTheConceptId]&&p[s[E].toTheConceptId]){let G=p[s[E].toTheConceptId],Z=yield(0,c.GetTheConcept)(s[E].typeId),V=Object.keys(G)[0];try{let z=Z.characterValue+"_reverse";"string"==typeof G&&(G={}),Array.isArray(G[V][z])||("string"==typeof G[V]&&(G[V]={}),G[V][z]=[]),G[V][z].push(p[s[E].ofTheConceptId])}catch(z){console.log("this is error",z)}}}else if(p[s[E].ofTheConceptId]&&p[s[E].toTheConceptId]){let G=p[s[E].ofTheConceptId],Z=yield(0,c.GetTheConcept)(s[E].typeId),V=Object.keys(G)[0];try{"string"==typeof G&&(G={}),Array.isArray(G[V][Z.characterValue])||("string"==typeof G[V]&&(G[V]={}),G[V][Z.characterValue]=[]),G[V][Z.characterValue].push(p[s[E].toTheConceptId])}catch(z){console.log("this is error",z)}}}for(let E=0;E<I.length;E++){let D=p[I[E]];D&&w.push(D)}return w})}function C(b,m,y,s){return a(this,arguments,void 0,function*(p,I,x,w,F=[]){(new Date).getTime();let E=[],D=[];for(let G=0;G<p.length;G++)D.push(p[G].toTheConceptId),D.push(p[G].ofTheConceptId),D.push(p[G].typeId);p.sort(function(G,Z){return Z.id-G.id});for(let G=0;G<p.length;G++){let Z=!1;if(F.includes(p[G].id)&&(Z=!0),1==Z){if(I[p[G].ofTheConceptId]&&I[p[G].toTheConceptId]){let V=I[p[G].toTheConceptId],z=yield(0,c.GetTheConcept)(p[G].typeId),P=V?.data,H=Object.keys(P)[0];try{let te=z.characterValue+"_reverse";"string"==typeof P&&(P={}),Array.isArray(P[H][te])||("string"==typeof P[H]&&(P[H]={}),P[H][te]=[]),P[H][te].push(I[p[G].ofTheConceptId])}catch(te){console.log("this is error",te)}}}else if(I[p[G].ofTheConceptId]&&I[p[G].toTheConceptId]){let V=I[p[G].ofTheConceptId],z=yield(0,c.GetTheConcept)(p[G].typeId),P=V?.data,H=Object.keys(P)[0];try{"string"==typeof P&&(P={}),Array.isArray(P[H][z.characterValue])||("string"==typeof P[H]&&(P[H]={}),P[H][z.characterValue]=[]),P[H][z.characterValue].push(I[p[G].toTheConceptId])}catch(te){console.log("this is error",te)}}}for(let G=0;G<w.length;G++){let Z=I[w[G]];Z&&E.push(Z)}return E})}function T(b,m,y){return a(this,arguments,void 0,function*(s,p,I,x=[]){let w={},F=yield(0,c.GetConnectionBulk)(s),E=[];for(let D=0;D<F.length;D++)E.push(F[D].toTheConceptId),E.push(F[D].ofTheConceptId),E.push(F[D].typeId);yield(0,c.GetConceptBulk)(E),F.sort(function(D,G){return G.id-D.id});for(let D=0;D<F.length;D++){let G=!1;if(x.includes(F[D].id)&&(G=!0),1==G){if(p[F[D].ofTheConceptId]&&p[F[D].toTheConceptId]){let Z=p[F[D].toTheConceptId],V=yield(0,c.GetTheConcept)(F[D].typeId),z=Z,P=Object.keys(z)[0];try{let H=V.characterValue+"_reverse";"string"==typeof z&&(z={}),Array.isArray(z[P][H])||("string"==typeof z[P]&&(z[P]={}),z[P][H]=[]),z[P][H].push(p[F[D].ofTheConceptId])}catch(H){console.log("this is error",H)}}}else if(p[F[D].ofTheConceptId]&&p[F[D].toTheConceptId]){let Z=p[F[D].ofTheConceptId],V=yield(0,c.GetTheConcept)(F[D].typeId),z=Z,P=Object.keys(z)[0];try{"string"==typeof z&&(z={}),Array.isArray(z[P][V.characterValue])||("string"==typeof z[P]&&(z[P]={}),z[P][V.characterValue]=[]),z[P][V.characterValue].push(p[F[D].toTheConceptId])}catch(H){console.log("this is error",H)}}}return w=p[I],w})}},7106:(Re,ce,_)=>{_.d(ce,{zl:()=>m,b6:()=>p,e$:()=>x,y6:()=>I,yV:()=>y,_W:()=>s});var B=_(1834),M=_(6687);function c(w){return w.startsWith("the_")?w.slice(4):w}var f=function(w,F,E,D){return new(E||(E=Promise))(function(G,Z){function V(H){try{P(D.next(H))}catch(te){Z(te)}}function z(H){try{P(D.throw(H))}catch(te){Z(te)}}function P(H){var te;H.done?G(H.value):(te=H.value,te instanceof E?te:new E(function(ye){ye(te)})).then(V,z)}P((D=D.apply(w,F||[])).next())})};function A(w,F,E){return f(this,void 0,void 0,function*(){var D,G,Z,V,z,P,H,te;let ye=[];for(let de=0;de<w.length;de++)ye.push(w[de].toTheConceptId),ye.push(w[de].ofTheConceptId),ye.push(w[de].typeId);for(let de=0;de<w.length;de++){let we=!1;E.includes(w[de].id)&&(we=!0);let fe=yield(0,B.GetTheConcept)(w[de].ofTheConceptId),_e=yield(0,B.GetTheConcept)(w[de].toTheConceptId);if(1==we&&0!=fe.id&&0!=_e.id){let De,be=null!==(G=null===(D=_e.type)||void 0===D?void 0:D.characterValue)&&void 0!==G?G:"self";w[de].toTheConceptId in F?De=F[w[de].toTheConceptId]:(De={},De[be]={},F[w[de].toTheConceptId]=De);let ue=yield(0,B.GetTheConcept)(w[de].typeId);try{let ke=null!==(V=null===(Z=fe?.type)||void 0===Z?void 0:Z.characterValue)&&void 0!==V?V:"none",Ae=fe.characterValue;ue.characterValue.includes("_s_")&&(fe.id in F||(F[fe.id]={}),F[fe.id][ke]=Ae),F[_e.id]={}}catch(ke){console.log("this is error",ke)}}if(0!=fe.id&&0!=_e.id){let De,be=null!==(P=null===(z=fe.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:"self";w[de].ofTheConceptId in F?De=F[w[de].ofTheConceptId]:(De={},De[be]={},F[w[de].ofTheConceptId]=De);let ue=yield(0,B.GetTheConcept)(w[de].typeId);try{let ke=null!==(te=null===(H=_e?.type)||void 0===H?void 0:H.characterValue)&&void 0!==te?te:"none",Ae=_e.characterValue;ue.characterValue.includes("_s_")&&(_e.id in F||(F[_e.id]={}),F[_e.id][ke]=Ae),F[fe.id]={}}catch(ke){console.log("this is error",ke)}}}return F})}var N=_(5312),a=_(7876),r=function(w,F,E,D){return new(E||(E=Promise))(function(G,Z){function V(H){try{P(D.next(H))}catch(te){Z(te)}}function z(H){try{P(D.throw(H))}catch(te){Z(te)}}function P(H){var te;H.done?G(H.value):(te=H.value,te instanceof E?te:new E(function(ye){ye(te)})).then(V,z)}P((D=D.apply(w,F||[])).next())})};function d(w,F,E){if(w in F){let D=F[w];D&&(E[D.connectionType+"_count"]=D.count)}}var h=function(w,F,E,D){return new(E||(E=Promise))(function(G,Z){function V(H){try{P(D.next(H))}catch(te){Z(te)}}function z(H){try{P(D.throw(H))}catch(te){Z(te)}}function P(H){var te;H.done?G(H.value):(te=H.value,te instanceof E?te:new E(function(ye){ye(te)})).then(V,z)}P((D=D.apply(w,F||[])).next())})},C=_(5898);function T(w,F="DESC"){return w.sort("ASC"==F?function(E,D){return E.id-D.id}:function(E,D){return D.id-E.id}),w}var b=function(w,F,E,D){return new(E||(E=Promise))(function(G,Z){function V(H){try{P(D.next(H))}catch(te){Z(te)}}function z(H){try{P(D.throw(H))}catch(te){Z(te)}}function P(H){var te;H.done?G(H.value):(te=H.value,te instanceof E?te:new E(function(ye){ye(te)})).then(V,z)}P((D=D.apply(w,F||[])).next())})};function m(w,F){return b(this,arguments,void 0,function*(E,D,G=""){let Z=yield(0,B.SearchWithTypeAndLinkerApi)(E,D,G),V=Z.compositionIds,z=Z.internalConnections,P=Z.linkers,H=Z.reverse,te=Z.mainCompositionIds,ye=yield(0,M.QL)(P),de=yield(0,M.MT)(V,z);return yield(0,N.NK)(ye,de,te,H)})}function y(w,F,E,D,G){return b(this,void 0,void 0,function*(){let Z=yield(0,M.QL)(w),V=yield(0,M.rv)(F,E);return yield(0,N.Ve)(Z,V,F,D,G)})}function s(w,F,E,D,G){return b(this,void 0,void 0,function*(){let Z=yield(0,M.QL)(w),V=yield(0,M.D)(F,E);return yield(0,N.NK)(Z,V,D,G)})}function p(w,F,E,D,G){return b(this,void 0,void 0,function*(){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("formatConnections",{linkers:w,conceptIds:F,mainCompositionIds:E,reverse:D,countInfos:G})).data}catch(P){console.error("formatConnections error sw: ",P),(0,B.handleServiceWorkerException)(P)}let Z=yield(0,M.QL)(w);Z=T(Z);let V=[];return V=yield A(Z,V,D),V=yield function(P,H,te){return f(this,void 0,void 0,function*(){var ye,de,we,fe,_e,De,be,ue;let ke=[];for(let Ae=0;Ae<P.length;Ae++)ke.push(P[Ae].toTheConceptId),ke.push(P[Ae].ofTheConceptId),ke.push(P[Ae].typeId);P.sort(function(Ae,Oe){return Oe.id-Ae.id});for(let Ae=0;Ae<P.length;Ae++){let Oe=!1;te.includes(P[Ae].id)&&(Oe=!0);let ht=yield(0,B.GetTheConcept)(P[Ae].ofTheConceptId),lt=yield(0,B.GetTheConcept)(P[Ae].toTheConceptId);if(1==Oe&&0!=ht.id&&0!=lt.id){let Me,Ne=null!==(de=null===(ye=lt.type)||void 0===ye?void 0:ye.characterValue)&&void 0!==de?de:"self";P[Ae].toTheConceptId in H?(Me=H[P[Ae].toTheConceptId],Ne in Me||(Me[Ne]={})):(Me={},Me[Ne]={},H[P[Ae].toTheConceptId]=Me);let at=yield(0,B.GetTheConcept)(P[Ae].typeId);try{let Lt=null!==(fe=null===(we=ht?.type)||void 0===we?void 0:we.characterValue)&&void 0!==fe?fe:"none",At=ht.characterValue,Ue=at.characterValue;""==Ue&&(Ue=Lt,Ue=c(Ue));let ft={[Lt]:At},Qe=Ue+"_reverse";at.characterValue.includes("_s_")||("string"==typeof Me[Ne]&&(Me[Ne]={}),Me[Ne][Qe]=ft)}catch(Lt){console.log("this is error",Lt)}}if(0!=ht.id&&0!=lt.id){let Me,Ne=null!==(De=null===(_e=ht.type)||void 0===_e?void 0:_e.characterValue)&&void 0!==De?De:"self";P[Ae].ofTheConceptId in H?(Me=H[P[Ae].ofTheConceptId],Ne in Me||(Me[Ne]={})):(Me={},Me[Ne]={},H[P[Ae].ofTheConceptId]=Me);let at=yield(0,B.GetTheConcept)(P[Ae].typeId);try{let Lt=null!==(ue=null===(be=lt?.type)||void 0===be?void 0:be.characterValue)&&void 0!==ue?ue:"none",At=lt.characterValue,Ue=at.characterValue,ft=!1;""==Ue&&(Ue=Lt,Ue=c(Ue),ft=!0);let Qe={[Lt]:At};isNaN(Number(Ue))?at.characterValue.includes("_s_")||("string"==typeof Me[Ne]&&(Me[Ne]={}),Me[Ne][Ue]=ft?At:Qe):(Array.isArray(Me[Ne])||(Me[Ne]=[]),Me[Ne].push(At))}catch(Lt){console.log("this is error",Lt)}}}return H})}(Z,V,D),yield function(P,H,te,ye){return f(this,arguments,void 0,function*(de,we,fe,_e,De=[]){var be,ue,ke,Ae,Oe,ht;let lt=[],Me=[];for(let Ne=0;Ne<de.length;Ne++)Me.push(de[Ne].toTheConceptId),Me.push(de[Ne].ofTheConceptId),Me.push(de[Ne].typeId);de.sort(function(Ne,at){return at.id-Ne.id});for(let Ne=0;Ne<de.length;Ne++){let at=!1;De.includes(de[Ne].id)&&(at=!0);let Lt=yield(0,B.GetTheConcept)(de[Ne].ofTheConceptId),At=yield(0,B.GetTheConcept)(de[Ne].toTheConceptId);if(1==at&&0!=Lt.id&&0!=At.id&&At.id in we){let Ue,ft=null!==(ue=null===(be=At.type)||void 0===be?void 0:be.characterValue)&&void 0!==ue?ue:"self";de[Ne].toTheConceptId in we?Ue=we[de[Ne].toTheConceptId]:(Ue={},Ue[ft]={},we[de[Ne].toTheConceptId]=Ue);let Qe=yield(0,B.GetTheConcept)(de[Ne].typeId);try{let ze=Qe.characterValue+"_reverse",We=we[de[Ne].ofTheConceptId];We&&(Array.isArray(Ue[ft][ze])?Ue[ft][ze].push(We):Qe.characterValue.includes("_s_")?(Ue[ft][ze]=[],Ue[ft][ze].push(We)):Ue[ft][ze]=We)}catch(ze){console.log("this is error",ze)}}if(0!=Lt.id&&0!=At.id&&Lt.id in we){let Ue,ft=null!==(Ae=null===(ke=Lt.type)||void 0===ke?void 0:ke.characterValue)&&void 0!==Ae?Ae:"self";de[Ne].ofTheConceptId in we?(Ue=we[de[Ne].ofTheConceptId],"string"==typeof Ue[ft]&&(Ue[ft]={})):(Ue={},Ue[ft]={},we[de[Ne].ofTheConceptId]=Ue);let Qe=!1,ze=(yield(0,B.GetTheConcept)(de[Ne].typeId)).characterValue;""==ze&&(ze=At.characterValue,Qe=!0),""==ze&&(ze=null!==(ht=null===(Oe=At?.type)||void 0===Oe?void 0:Oe.characterValue)&&void 0!==ht?ht:"");try{let We=we[de[Ne].toTheConceptId];We&&(Array.isArray(Ue[ft])?Ue[ft].push(Qe?We[ze]:We):Array.isArray(Ue[ft][ze])?Ue[ft][ze].push(We):ze.includes("_s_")?(Ue[ft][ze]=[],Ue[ft][ze].push(Qe?We[ze]:We)):Ue[ft][ze]=Qe?We[ze]:We)}catch(We){console.log("this is error",We)}}}for(let Ne=0;Ne<fe.length;Ne++){let at=we[fe[Ne]];at?(at.id=fe[Ne],lt.push(at)):0!=(yield B.ConceptsData.GetConcept(fe[Ne])).id&&(at={},at.id=fe[Ne],lt.push(at))}return lt})}(Z,V,E,[],D)})}function I(w,F,E,D,G){return b(this,arguments,void 0,function*(Z,V,z,P,H,te="DESC"){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("formatConnectionsJustId",{linkers:Z,conceptIds:V,mainCompositionIds:z,reverse:P,countInfos:H,order:te})).data}catch(_e){console.error("formatConnectionsJustId error sw: ",_e),(0,B.handleServiceWorkerException)(_e)}let ye=yield(0,M.QL)(Z),de=yield(0,C.V)(H);ye=T(ye,te);let we=[];return we=yield A(ye,we,P),we=yield function(_e,De){return r(this,arguments,void 0,function*(be,ue,ke=[]){var Ae,Oe,ht,lt,Me,Ne,at,Lt;let At=[];for(let Ue=0;Ue<be.length;Ue++)At.push(be[Ue].toTheConceptId),At.push(be[Ue].ofTheConceptId),At.push(be[Ue].typeId);for(let Ue=0;Ue<be.length;Ue++){let ft=!1,Qe=yield(0,a.A)(be[Ue].ofTheConceptId),ze=yield(0,a.A)(be[Ue].toTheConceptId);if(ke.includes(be[Ue].id)&&(ft=!0),1==ft&&0!=Qe.id&&0!=ze.id){let We,bt=yield(0,a.A)(be[Ue].typeId),Ee=null!==(Oe=null===(Ae=ze.type)||void 0===Ae?void 0:Ae.characterValue)&&void 0!==Oe?Oe:"self";be[Ue].toTheConceptId in ue?(We=ue[be[Ue].toTheConceptId],Ee in We||(We[Ee]={})):(We={},We[Ee]={},ue[be[Ue].toTheConceptId]=We);try{let Ke=null!==(lt=null===(ht=Qe?.type)||void 0===ht?void 0:ht.characterValue)&&void 0!==lt?lt:"none",It=Qe.characterValue,et=bt.characterValue;""==et&&(et=Ke,et=c(et));let mt={id:Qe.id,[Ke]:It,created_on:be[Ue].entryTimeStamp},St=et+"_reverse";St.includes("_s_")||("string"==typeof We[Ee]&&(We[Ee]={}),We[Ee][St]=mt)}catch(Ke){console.log("this is error",Ke)}}if(0!=Qe.id&&0!=ze.id){let We,bt=yield(0,a.A)(be[Ue].typeId),Ee=null!==(Ne=null===(Me=Qe.type)||void 0===Me?void 0:Me.characterValue)&&void 0!==Ne?Ne:"self";be[Ue].ofTheConceptId in ue?(We=ue[be[Ue].ofTheConceptId],Ee in We||(We[Ee]={})):(We={},We[Ee]={},ue[be[Ue].ofTheConceptId]=We);try{let Ke=null!==(Lt=null===(at=ze?.type)||void 0===at?void 0:at.characterValue)&&void 0!==Lt?Lt:"none",It=ze.characterValue,et=bt.characterValue,mt=!1;""==et&&(et=Ke,et=c(et),mt=!0);let St={};St[Ke]={id:ze.id,data:It,created_on:be[Ue].entryTimeStamp},isNaN(Number(et))?et.includes("_s_")||("string"==typeof We[Ee]&&(We[Ee]={}),We[Ee][et]=mt?St[Ke]:St):(Array.isArray(We[Ee])||(We[Ee]=[]),We[Ee].push(St[Ke]))}catch(Ke){console.log("this is error",Ke)}}}return ue})}(ye,we,P),yield function(_e,De,be){return r(this,arguments,void 0,function*(ue,ke,Ae,Oe=[],ht){var lt,Me,Ne,at,Lt,At,Ue;(new Date).getTime();let ft=[],Qe=[];for(let ze=0;ze<ue.length;ze++)Qe.push(ue[ze].toTheConceptId),Qe.push(ue[ze].ofTheConceptId),Qe.push(ue[ze].typeId);for(let ze=0;ze<ue.length;ze++){let We=!1,bt=yield(0,a.A)(ue[ze].ofTheConceptId),Ee=yield(0,a.A)(ue[ze].toTheConceptId);if(Oe.includes(ue[ze].id)&&(We=!0),1==We&&0!=bt.id&&0!=Ee.id&&Ee.id in ke){let Ke,It=yield(0,a.A)(ue[ze].typeId),et=null!==(Me=null===(lt=Ee.type)||void 0===lt?void 0:lt.characterValue)&&void 0!==Me?Me:"self",mt=!1;ue[ze].toTheConceptId in ke&&(mt=!0),ue[ze].toTheConceptId in ke?(Ke=ke[ue[ze].toTheConceptId],"string"==typeof Ke[et]&&(Ke[et]={})):(Ke={},Ke[et]={},ke[ue[ze].toTheConceptId]=Ke);try{if(ke[ue[ze].ofTheConceptId]){let St=ke[ue[ze].ofTheConceptId];St&&(St.id=bt.id,St.created_on=bt.entryTimeStamp);let _t=It.characterValue+"_reverse";Array.isArray(Ke[et][_t])?Ke[et][_t].push(St):_t.includes("_s_")?(Ke[et][_t]=[],Ke[et][_t].push(St)):Ke[et][_t]=St}}catch(St){console.log("this is error",St)}}if(0!=bt.id&&0!=Ee.id&&bt.id in ke){let Ke,It=yield(0,a.A)(ue[ze].typeId),et=null!==(at=null===(Ne=bt.type)||void 0===Ne?void 0:Ne.characterValue)&&void 0!==at?at:"self",mt=!1;ue[ze].toTheConceptId in ke&&(mt=!0),ue[ze].ofTheConceptId in ke?(Ke=ke[ue[ze].ofTheConceptId],"string"==typeof Ke[et]&&(Ke[et]={})):(Ke={},Ke[et]={},ke[ue[ze].ofTheConceptId]=Ke),d(bt.id,ht,Ke);let St=!1,_t=It.characterValue;""==_t&&(_t=Ee.characterValue,St=!0),""==_t&&(_t=(null===(Lt=Ee?.type)||void 0===Lt?void 0:Lt.characterValue)||"");try{let cn=null!==(Ue=null===(At=Ee?.type)||void 0===At?void 0:At.characterValue)&&void 0!==Ue?Ue:"none",mn=ke[ue[ze].toTheConceptId];if(mn){let Vt={};Vt[cn]={data:mn[cn],id:Ee.id,created_on:ue[ze].entryTimeStamp},Array.isArray(Ke[et])?Ke[et].push(St?mn[_t]:mn):Array.isArray(Ke[et][_t])?Ke[et][_t].push(Vt):_t.includes("_s_")?(Ke[et][_t]=[],Ke[et][_t].push(St?Vt[cn]:Vt)):Ke[et][_t]=St?Vt[cn]:Vt,d(Ee.id,ht,Vt)}}catch(cn){console.log("this is error",cn)}}}for(let ze=0;ze<Ae.length;ze++){let We={};We=ke[Ae[ze]],We?We.id=Ae[ze]:0!=(yield B.ConceptsData.GetConcept(Ae[ze])).id&&(We={},We.id=Ae[ze]),ft.push(We)}return ft})}(ye,we,z,P,de)})}function x(w,F,E,D,G){return b(this,arguments,void 0,function*(Z,V,z,P,H,te="DESC"){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("formatConnectionsDataId",{linkers:Z,conceptIds:V,mainCompositionIds:z,reverse:P,countInfos:H,order:te})).data}catch(_e){console.error("GetConnectionDataPrefetch error sw: ",_e),(0,B.handleServiceWorkerException)(_e)}let ye=yield(0,M.QL)(Z),de=yield(0,C.V)(H);ye=T(ye,te);let we=[];return we=yield function(_e,De){var be=arguments;return h(this,arguments,void 0,function*(ue,ke,Ae=[]){var Oe,ht,lt,Me,Ne,at,Lt,At;const Ue=B.Logger.logfunction("FormatFunctionData",be);let ft=[];for(let Qe=0;Qe<ue.length;Qe++)ft.push(ue[Qe].toTheConceptId),ft.push(ue[Qe].ofTheConceptId),ft.push(ue[Qe].typeId);for(let Qe=0;Qe<ue.length;Qe++){let ze=!1,We=yield(0,B.GetTheConcept)(ue[Qe].ofTheConceptId),bt=yield(0,B.GetTheConcept)(ue[Qe].toTheConceptId);if(Ae.includes(ue[Qe].id)&&(ze=!0),1==ze&&0!=We.id&&0!=bt.id){let Ee,Ke=yield(0,B.GetTheConcept)(ue[Qe].typeId),It=null!==(ht=null===(Oe=bt.type)||void 0===Oe?void 0:Oe.characterValue)&&void 0!==ht?ht:"self";ue[Qe].toTheConceptId in ke?Ee=ke[ue[Qe].toTheConceptId]:(Ee={},Ee[It]={},ke[ue[Qe].toTheConceptId]=Ee);try{let et=null!==(Me=null===(lt=We?.type)||void 0===lt?void 0:lt.characterValue)&&void 0!==Me?Me:"none",mt=We.characterValue;(Ke.characterValue+"_reverse").includes("_s_")&&(We.id in ke||(ke[We.id]={}),ke[We.id][et]=mt),ke[bt.id]={}}catch(et){console.log("this is error",et)}}if(0!=We.id&&0!=bt.id){let Ee,Ke=yield(0,B.GetTheConcept)(ue[Qe].typeId),It=null!==(at=null===(Ne=We.type)||void 0===Ne?void 0:Ne.characterValue)&&void 0!==at?at:"self";ue[Qe].ofTheConceptId in ke?Ee=ke[ue[Qe].ofTheConceptId]:(Ee={},Ee[It]={},ke[ue[Qe].ofTheConceptId]=Ee);try{let et=null!==(At=null===(Lt=bt?.type)||void 0===Lt?void 0:Lt.characterValue)&&void 0!==At?At:"none",mt=bt.characterValue;Ke.characterValue.includes("_s_")&&(bt.id in ke||(ke[bt.id]={}),ke[bt.id][et]=mt),ke[We.id]={}}catch(et){console.log("this is error",et)}}}return B.Logger.logUpdate(Ue),ke})}(ye,we,P),we=yield function(_e,De){var be=arguments;return h(this,arguments,void 0,function*(ue,ke,Ae=[]){var Oe,ht,lt,Me,Ne,at,Lt,At;const Ue=B.Logger.logfunction("FormatFunctionDataForData",be);let ft=[];for(let Qe=0;Qe<ue.length;Qe++)ft.push(ue[Qe].toTheConceptId),ft.push(ue[Qe].ofTheConceptId),ft.push(ue[Qe].typeId);for(let Qe=0;Qe<ue.length;Qe++){let ze=!1,We=yield(0,B.GetTheConcept)(ue[Qe].ofTheConceptId),bt=yield(0,B.GetTheConcept)(ue[Qe].toTheConceptId);if(Ae.includes(ue[Qe].id)&&(ze=!0),1==ze&&0!=We.id&&0!=bt.id){let Ee,Ke=yield(0,B.GetTheConcept)(ue[Qe].typeId),It=null!==(ht=null===(Oe=bt.type)||void 0===Oe?void 0:Oe.characterValue)&&void 0!==ht?ht:"self";ue[Qe].toTheConceptId in ke?(Ee=ke[ue[Qe].toTheConceptId],It in Ee||(Ee[It]={})):(Ee={},Ee[It]={},ke[ue[Qe].toTheConceptId]=Ee);try{let et=null!==(Me=null===(lt=We?.type)||void 0===lt?void 0:lt.characterValue)&&void 0!==Me?Me:"none",mt=We.characterValue,St=Ke.characterValue;""==St&&(St=et,St=c(St));let _t={id:We.id,data:{[et]:mt}},cn=St+"_reverse";cn.includes("_s_")||("string"==typeof Ee[It]&&(Ee[It]={}),Ee[It][cn]=_t)}catch(et){console.log("this is error",et)}}if(0!=We.id&&0!=bt.id){let Ee,Ke=yield(0,B.GetTheConcept)(ue[Qe].typeId),It=null!==(at=null===(Ne=We.type)||void 0===Ne?void 0:Ne.characterValue)&&void 0!==at?at:"self";ue[Qe].ofTheConceptId in ke?(Ee=ke[ue[Qe].ofTheConceptId],It in Ee||(Ee[It]={})):(Ee={},Ee[It]={},ke[ue[Qe].ofTheConceptId]=Ee);try{let et=null!==(At=null===(Lt=bt?.type)||void 0===Lt?void 0:Lt.characterValue)&&void 0!==At?At:"none",mt=bt.characterValue,St=Ke.characterValue,_t=!1;""==St&&(St=et,St=c(St),_t=!0);let cn={id:bt.id,data:{[et]:mt}};isNaN(Number(St))?St.includes("_s_")||("string"==typeof Ee[It]&&(Ee[It]={}),Ee[It][St]=cn):(Array.isArray(Ee[It])||(Ee[It]=[]),Ee[It].push(cn))}catch(et){console.log("this is error",et)}}}return B.Logger.logUpdate(Ue),ke})}(ye,we,P),yield function(_e,De,be,ue){var ke=arguments;return h(this,arguments,void 0,function*(Ae,Oe,ht,lt,Me=[],Ne){var at,Lt,At,Ue,ft;const ze=B.Logger.logfunction("FormatFromConnectionsAlteredArrayExternal",ke);let We=[],bt=[];for(let Ee=0;Ee<Ae.length;Ee++)bt.push(Ae[Ee].toTheConceptId),bt.push(Ae[Ee].ofTheConceptId),bt.push(Ae[Ee].typeId);for(let Ee=0;Ee<Ae.length;Ee++){let Ke=!1,It=yield(0,B.GetTheConcept)(Ae[Ee].ofTheConceptId),et=yield(0,B.GetTheConcept)(Ae[Ee].toTheConceptId);if(Me.includes(Ae[Ee].id)&&(Ke=!0),1==Ke&&0!=It.id&&0!=et.id&&et.id in Oe){let mt,St=yield(0,B.GetTheConcept)(Ae[Ee].typeId),_t=null!==(Lt=null===(at=et.type)||void 0===at?void 0:at.characterValue)&&void 0!==Lt?Lt:"self",cn=!1;Ae[Ee].toTheConceptId in Oe&&(cn=!0),Ae[Ee].toTheConceptId in Oe?(mt=Oe[Ae[Ee].toTheConceptId],"string"==typeof mt[_t]&&(mt[_t]={})):(mt={},mt[_t]={},Oe[Ae[Ee].toTheConceptId]=mt);try{if(Oe[Ae[Ee].ofTheConceptId]){let mn={id:It.id,data:Oe[Ae[Ee].ofTheConceptId],created_on:Ae[Ee].entryTimeStamp},Vt=St.characterValue+"_reverse";Array.isArray(mt[_t][Vt])?mt[_t][Vt].push(mn):Vt.includes("_s_")?(mt[_t][Vt]=[],mt[_t][Vt].push(mn)):mt[_t][Vt]=mn}}catch(mn){console.log("this is error",mn)}}if(0!=It.id&&0!=et.id&&It.id in Oe){let mt,St=yield(0,B.GetTheConcept)(Ae[Ee].typeId),_t=null!==(Ue=null===(At=It.type)||void 0===At?void 0:At.characterValue)&&void 0!==Ue?Ue:"self",cn=!1;Ae[Ee].toTheConceptId in Oe&&(cn=!0),Ae[Ee].ofTheConceptId in Oe?(mt=Oe[Ae[Ee].ofTheConceptId],"string"==typeof mt[_t]&&(mt[_t]={})):(mt={},mt[_t]={},Oe[Ae[Ee].ofTheConceptId]=mt),d(It.id,Ne,mt);let mn=!0,Vt=St.characterValue;""==Vt&&(Vt=et.characterValue,mn=!0),""==Vt&&(Vt=(null===(ft=et?.type)||void 0===ft?void 0:ft.characterValue)||"");try{let Zn=Oe[Ae[Ee].toTheConceptId];if(Zn){let io={id:et.id,data:Oe[Ae[Ee].toTheConceptId],created_on:Ae[Ee].entryTimeStamp};Array.isArray(mt[_t])?mt[_t].push(Zn):Array.isArray(mt[_t][Vt])?mt[_t][St.characterValue].push(io):Vt.includes("_s_")?(mt[_t][Vt]=[],mt[_t][Vt].push(io)):mt[_t][Vt]=io,d(et.id,Ne,io)}}catch(Zn){console.log("this is error",Zn)}}}for(let Ee=0;Ee<lt.length;Ee++){let Ke={};Ke.id=lt[Ee];let It=yield(0,B.GetTheConcept)(Ke.id);Ke.data=Oe[lt[Ee]],Ke.created_on=It.entryTimeStamp,We.push(Ke)}return B.Logger.logUpdate(ze),We})}(ye,we,[],z,P,de)})}},3518:(Re,ce,_)=>{_.d(ce,{BZ:()=>f,Xr:()=>M,ab:()=>c});var B=_(3278);function M(A="application/json",N="application/json"){let a={};return a=""!=B.b.BearerAccessToken?{"Content-Type":A,Authorization:"Bearer "+B.b.BearerAccessToken,Accept:N}:{"Content-Type":A,Accept:N},a}function c(A="application/json",N="",a="application/json"){""==N&&(N=B.b.BearerAccessToken);let r={};return r=""!=N?{"Content-Type":A,Authorization:"Bearer "+N,Accept:a}:{"Content-Type":A,Accept:a},r}function f(){let A=B.b.BearerAccessToken;const N=new Headers;return N.append("Authorization","Bearer "+A),N}},6467:(Re,ce,_)=>{function B(M){const c=M.lastIndexOf("_");let f=[];return f=c>0?[M.substring(0,c),M.substring(c+1,M.length)]:[M],f}_.d(ce,{f:()=>B})},1596:(Re,ce,_)=>{_.d(ce,{g:()=>c});var B=_(1834),M=function(f,A,N,a){return new(N||(N=Promise))(function(r,d){function h(b){try{T(a.next(b))}catch(m){d(m)}}function C(b){try{T(a.throw(b))}catch(m){d(m)}}function T(b){var m;b.done?r(b.value):(m=b.value,m instanceof N?m:new N(function(y){y(m)})).then(h,C)}T((a=a.apply(f,A||[])).next())})};function c(f,A){return M(this,void 0,void 0,function*(){if(typeof self<"u"&&typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope)throw new Error("Cannot switch server from service worker");try{!function(){const N=B.BaseUrl.NODE_CACHE_URL;if(N===B.BaseUrl.BASE_URL)throw new Error("Base Server Down");let a=sessionStorage.getItem("cacheServers");a=JSON.parse(a);const r=a.indexOf(N);a.includes(N)&&-1!==r&&a.splice(r,1),sessionStorage.setItem("cacheServers",JSON.stringify(a)),B.BaseUrl.NODE_CACHE_URL=a.length?a[0]:B.BaseUrl.BASE_URL,navigator.serviceWorker&&navigator.serviceWorker.controller&&(0,B.sendMessage)("SESSION_DATA",{type:"SESSION_DATA",data:B.BaseUrl.NODE_CACHE_URL})}();try{return yield fetch(`${B.BaseUrl.NODE_CACHE_URL}${A}`,f)}catch{return yield c(f,A)}}catch(N){throw N}})}},4310:(Re,ce,_)=>{_.d(ce,{Cp:()=>h,ix:()=>T,qj:()=>C});var B=_(1834),M=_(1596),c=_(5898),f=_(1863),A=_(7106),N=_(3518),a=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})};const r=new Map,d=new Map;function h(b){var m=arguments;return a(this,void 0,void 0,function*(){B.Logger.logfunction("BuildWidgetFromId",m);try{if(B.serviceWorker)return(yield(0,B.sendMessage)("BuildWidgetFromId",{id:b})).data}catch(p){console.error("BuildWidgetFromId error sw: ",p),(0,B.handleServiceWorkerException)(p)}let y={};if(r.has(b))return r.get(b)||y;const s=(()=>a(this,void 0,void 0,function*(){try{let p=[],I=[],x=[],w=[],F="DESC",E=[],D={},G=(0,N.Xr)("application/json"),Z=B.BaseUrl.getWidgetData()+"?id="+b;const V=yield fetch(Z,{method:"GET",headers:G});if(!V.ok)return(0,f.ry)(V),console.log("This is the BuildWidgetFromId error",V.status),[];D=yield V.json(),p=D.conceptIds,I=D.linkers,x=D.reverse,w=D.mainCompositionIds,E=D.countinfo;let z=(0,c.w)(E);return y=yield(0,A.e$)(I,p,w,x,z,F),y}catch(p){throw console.log("this is the error in the build widget",p),p}finally{r.delete(b)}}))();return r.set(b,s),s})}function C(b){var m=arguments;return a(this,void 0,void 0,function*(){B.Logger.logfunction("BuildWidgetFromIdForLatest",m);try{if(B.serviceWorker)return(yield(0,B.sendMessage)("BuildWidgetFromIdForLatest",{id:b})).data}catch(p){console.error("BuildWidgetFromIdForLatest error sw: ",p),(0,B.handleServiceWorkerException)(p)}let y={};if(d.has(b))return d.get(b)||y;const s=(()=>a(this,void 0,void 0,function*(){try{let p,I=[],x=[],w=[],F=[],E="DESC",D=[],G={},Z=(0,N.Xr)("application/json");try{let z=B.BaseUrl.getLatestWidgetData()+"?id="+b;p=yield fetch(z,{method:"GET",headers:Z})}catch{p=yield(0,M.g)({method:"GET",headers:Z},"?id="+b)}if(!p.ok)return(0,f.ry)(p),console.log("This is the BuildWidgetFromId error",p.status),[];G=yield p.json(),I=G.conceptIds,x=G.linkers,w=G.reverse,F=G.mainCompositionIds,D=G.countinfo;let V=(0,c.w)(D);return y=yield(0,A.e$)(x,I,F,w,V,E),{data:y,mainId:G.mainId}}catch(p){throw console.log("this is the error in the build widget",p),p}finally{d.delete(b)}}))();return d.set(b,s),s})}function T(b,m){for(let y=0;y<b.length;y++)if(b[y].id==m)return b[y]}},4287:(Re,ce,_)=>{_.d(ce,{w:()=>f});var B=_(1834),M=_(3130),c=function(A,N,a,r){return new(a||(a=Promise))(function(d,h){function C(m){try{b(r.next(m))}catch(y){h(y)}}function T(m){try{b(r.throw(m))}catch(y){h(y)}}function b(m){var y;m.done?d(m.value):(y=m.value,y instanceof a?y:new a(function(s){s(y)})).then(C,T)}b((r=r.apply(A,N||[])).next())})};class f{constructor(){this.subscribers=[],this.mainConcept=0,this.compositionIds=[],this.conceptIds=[],this.internalConnections=[],this.reverse=[],this.linkers=[],this.newIds=[],this.dependency=[],this.isDataLoaded=!1,this.isUpdating=!1,this.fetched=!1,this.format=M.yv,this.eventHandlers={}}listenToEventType(N){if(this.eventHandlers[N])return;const a=r=>c(this,void 0,void 0,function*(){if(this.isUpdating)console.log("rejected this",N);else{this.isUpdating=!0;let d=this;setTimeout(function(){return c(this,void 0,void 0,function*(){let h=r;if(!d.compositionIds.includes(h?.detail)){d.compositionIds.unshift(h?.detail),d.listenToEvent(h?.detail);let C=h?.detail,T=yield B.ConnectionData.GetConnectionByOfTheConceptAndType(C,C);for(let b=0;b<T.length;b++)yield B.ConnectionData.GetConnection(T[b]).then(m=>{m.typeId==d.mainConcept?d.internalConnections.includes(m.id)||d.internalConnections.push(m.id):d.linkers.includes(m.id)||d.linkers.push(m.id),d.conceptIds.includes(m.toTheConceptId)||d.conceptIds.push(m.toTheConceptId),d.compositionIds.includes(m.ofTheConceptId)||d.compositionIds.push(m.ofTheConceptId)})}d.isUpdating=!1,yield d.bind(),d.notify()})},200)}});this.eventHandlers[N]=a,console.log("added listener",N),window.addEventListener(`${N}`,a)}listenToEvent(N){if(this.eventHandlers[N])return;const a=r=>c(this,void 0,void 0,function*(){if(this.isUpdating)console.log("rejected this",N);else{this.isUpdating=!0;let d=this;setTimeout(function(){return c(this,void 0,void 0,function*(){let h=yield B.ConnectionData.GetConnectionByOfTheConceptAndType(N,N);for(let C=0;C<h.length;C++)yield B.ConnectionData.GetConnection(h[C]).then(T=>{T.typeId==d.mainConcept?d.internalConnections.includes(T.id)||d.internalConnections.push(T.id):d.linkers.includes(T.id)||d.linkers.push(T.id),d.conceptIds.includes(T.toTheConceptId)||d.conceptIds.push(T.toTheConceptId),d.compositionIds.includes(T.ofTheConceptId)||(d.compositionIds.push(T.ofTheConceptId),d.newIds.includes(T.ofTheConceptId)||d.newIds.push(T.ofTheConceptId))});d.isUpdating=!1,yield d.bind(),d.notify()})},200)}});this.eventHandlers[N]=a,window.addEventListener(`${N}`,a)}removeListenToEvent(N){const a=this.eventHandlers[N];a&&(window.removeEventListener(`${N}`,a),delete this.eventHandlers[N])}listenToEventConnectionType(N,a){window.addEventListener(`${N}`,r=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let d=this;setTimeout(function(){return c(this,void 0,void 0,function*(){let h=yield B.ConnectionData.GetConnectionByOfTheConceptAndType(N,N);for(let C=0;C<h.length;C++)h.typeId==a&&(yield B.ConnectionData.GetConnection(h[C]).then(T=>{T.typeId==d.mainConcept?d.internalConnections.includes(T.id)||d.internalConnections.push(T.id):d.linkers.includes(T.id)||d.linkers.push(T.id),d.conceptIds.includes(T.toTheConceptId)||d.conceptIds.push(T.toTheConceptId),d.compositionIds.includes(T.ofTheConceptId)||d.compositionIds.push(T.ofTheConceptId)}));d.isUpdating=!1,yield d.bind(),d.notify()})},200)}})}bind(){return c(this,void 0,void 0,function*(){console.log("this is the old execute data")})}run(){return c(this,void 0,void 0,function*(){console.log("this is non subscriber data")})}update(){return c(this,void 0,void 0,function*(){this.isDataLoaded=!1,yield this.bind(),this.notify()})}subscribe(N){return c(this,void 0,void 0,function*(){return this.subscribers.push(N),console.log("again executing data"),yield this.bind(),N(this.data,this)})}execute(){return c(this,void 0,void 0,function*(){return yield this.run()})}unsubscribe(N){return this.subscribers.filter(a=>a!=N),this.subscribers.length}notify(){console.log("notifiers",this.subscribers),this.subscribers.map(N=>{console.log("notify"),N(this.data,this)})}}},5328:(Re,ce,_)=>{_.d(ce,{d:()=>a});var B=_(1834),M=_(3130),c=_(8939),f=_(4287),A=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};class N extends f.w{constructor(d,h,C,T,b){super(),this.connections=[],this.data=[],this.mainConcept=d,this.linker=h,this.inpage=C,this.page=T,this.format=b}bind(){return A(this,void 0,void 0,function*(){var d;if(!this.isDataLoaded){let T=yield(0,B.GetTheConcept)(this.mainConcept),b=(null===(d=T.type)||void 0===d?void 0:d.characterValue)+"_s_"+this.linker,m=yield(0,B.GetConceptByCharacterAndType)(b,16);if(m.id>0){let y=yield(0,B.GetConnectionOfTheConcept)(m.id,T.id,T.userId,this.inpage,this.page);this.connections=y;for(var h=[],C=0;C<this.connections.length;C++)h.push(this.connections[C].toTheConceptId),this.linkers.push(this.connections[C].id),this.listenToEvent(this.connections[C].toTheConceptId);yield(0,B.GetAllConnectionsOfCompositionBulk)(h)}this.isDataLoaded=!0,this.listenToEvent(this.mainConcept)}return yield this.build()})}build(){return A(this,void 0,void 0,function*(){this.data=[],this.connections=yield(0,B.GetConnectionBulk)(this.linkers);for(var d=0;d<this.connections.length;d++){let h=this.connections[d].toTheConceptId,C=yield(0,B.GetTheConcept)(h);if(console.log("this is the format",this.format),this.format==M.yv){let T=yield(0,c.RW)(C.id);this.data.push(T)}else if(this.format==M.ZJ){let T=yield(0,c.kx)(C.id);this.data.push(T)}else if(this.format==M.iw){let T=yield(0,B.GetCompositionWithIdAndDateFromMemory)(C.id);this.data.push(T)}else{let T=yield(0,B.GetCompositionWithIdAndDateFromMemory)(C.id);this.data.push(T)}}return this.data})}}function a(r,d,h,C,T=M.yv){return new N(r,d,h,C,T)}},1834:(Re,ce,_)=>{_.r(ce),_.d(ce,{ADMIN:()=>jr,ALLID:()=>Dt.BG,AccessTracker:()=>Eo.J,AddGhostConcept:()=>Br,Anomaly:()=>Jt,BaseUrl:()=>a.B,BinaryTree:()=>ci.W,BuildWidgetFromId:()=>Lo.Cp,BuilderStatefulWidget:()=>Ro,Composition:()=>Do,CompositionBinaryTree:()=>co,CompositionNode:()=>vi,Concept:()=>ta.j,ConceptsData:()=>N.I,Connection:()=>be.N,ConnectionData:()=>In.d,CreateComposition:()=>we.A,CreateConnection:()=>jn.d,CreateConnectionBetweenEntityLocal:()=>Gi,CreateConnectionBetweenTwoConcepts:()=>At,CreateConnectionBetweenTwoConceptsGeneral:()=>ft,CreateConnectionBetweenTwoConceptsLocal:()=>Ai.h,CreateData:()=>Yo,CreateDefaultConcept:()=>ke.o,CreateDefaultLConcept:()=>Ti.u,CreateSession:()=>Ar,CreateSessionVisit:()=>Lr,CreateTheCompositionLocal:()=>fe.R,CreateTheCompositionWithCache:()=>Go,CreateTheConnection:()=>Ke.q,CreateTheConnectionGeneral:()=>lt,CreateTheConnectionLocal:()=>jn.F,DATAID:()=>Dt.y0,DATAIDDATE:()=>Dt.iw,DelayFunctionExecution:()=>$r,DeleteConceptById:()=>si,DeleteConceptLocal:()=>Pr,DeleteConnectionById:()=>Me.m,DeleteConnectionByType:()=>ga,DeleteUser:()=>or,DependencyObserver:()=>to.w,FilterSearch:()=>zo,FormatFromConnections:()=>so.vw,FormatFromConnectionsAltered:()=>so.y8,FreeschemaQuery:()=>En,FreeschemaQueryApi:()=>Qo,GetAllConnectionsOfComposition:()=>de.s,GetAllConnectionsOfCompositionBulk:()=>T.Y,GetAllTheConnectionsByTypeAndOfTheConcept:()=>va,GetComposition:()=>m.Nj,GetCompositionBulk:()=>en.dF,GetCompositionBulkWithDataId:()=>en.cw,GetCompositionFromConnectionsWithDataId:()=>en.p8,GetCompositionFromConnectionsWithDataIdFromConnections:()=>en.km,GetCompositionFromConnectionsWithDataIdInObject:()=>en.rv,GetCompositionFromConnectionsWithDataIdIndex:()=>en.Nt,GetCompositionFromConnectionsWithIndex:()=>en.as,GetCompositionFromConnectionsWithIndexFromConnections:()=>en.hG,GetCompositionFromMemoryWithConnections:()=>m.JA,GetCompositionList:()=>I,GetCompositionListAll:()=>x,GetCompositionListAllWithId:()=>w,GetCompositionListListener:()=>Kr,GetCompositionListLocal:()=>te,GetCompositionListLocalWithId:()=>ye,GetCompositionListWithId:()=>F,GetCompositionListWithIdUpdated:()=>E,GetCompositionListener:()=>Zr,GetCompositionLocal:()=>V,GetCompositionLocalWithId:()=>z,GetCompositionWithAllIds:()=>m.Mb,GetCompositionWithCache:()=>wr,GetCompositionWithDataIdBulk:()=>kr,GetCompositionWithDataIdWithCache:()=>Ci,GetCompositionWithId:()=>m.yz,GetCompositionWithIdAndDateFromMemory:()=>m.Ez,GetConceptBulk:()=>Io.r,GetConceptByCharacter:()=>y.A,GetConceptByCharacterAndCategoryLocal:()=>s.$I,GetConceptByCharacterAndType:()=>It.A,GetConnectionBetweenTwoConceptsLinker:()=>Vr,GetConnectionBulk:()=>jo.j,GetConnectionById:()=>ar,GetConnectionDataPrefetch:()=>en.QL,GetConnectionOfTheConcept:()=>De,GetLink:()=>mt,GetLinkListListener:()=>ea,GetLinkListener:()=>Yr.d,GetLinkRaw:()=>St,GetLinkerConnectionFromConcepts:()=>er,GetLinkerConnectionToConcepts:()=>tr,GetRelation:()=>_i,GetRelationLocal:()=>Gr,GetRelationRaw:()=>xr,GetTheConcept:()=>Ne.A,GetTheConceptLocal:()=>Ii.f,GetUserGhostId:()=>Er,JUSTDATA:()=>Dt.ZJ,LConcept:()=>na,LConnection:()=>oa,LISTNORMAL:()=>Dt.SL,LocalConceptsData:()=>b.v,LocalSyncData:()=>bo.H,LocalTransaction:()=>Fi,Logger:()=>Te.V,LoginToBackend:()=>pr,MakeTheInstanceConcept:()=>at.A,MakeTheInstanceConceptLocal:()=>Qe.k,MakeTheTimestamp:()=>cr,MakeTheTypeConceptApi:()=>ro,MakeTheTypeConceptLocal:()=>_t.$,NORMAL:()=>Dt.yv,PRIVATE:()=>Hr,PUBLIC:()=>qr,PatcherStructure:()=>ia,Prototype:()=>xa,RAW:()=>Dt.XZ,RecursiveSearchApi:()=>sr,RecursiveSearchApiNewRawFullLinker:()=>ur,RecursiveSearchApiRaw:()=>li,RecursiveSearchApiRawFullLinker:()=>dr,RecursiveSearchApiWithInternalConnections:()=>lr,RecursiveSearchListener:()=>Xr,SchemaQuery:()=>Ca,SchemaQueryListener:()=>Oo,SearchAllConcepts:()=>Cr,SearchLinkInternal:()=>Or,SearchLinkInternalAll:()=>Mr,SearchLinkMultipleAll:()=>so.cf,SearchLinkMultipleAllObservable:()=>Ni,SearchLinkMultipleApi:()=>f.j,SearchQuery:()=>ao,SearchStructure:()=>aa,SearchWithLinker:()=>_r,SearchWithTypeAndLinker:()=>lo.zl,SearchWithTypeAndLinkerApi:()=>Li,Selector:()=>_a,SessionData:()=>ra,Signin:()=>gr,Signup:()=>fr,SignupEntity:()=>yr,SplitStrings:()=>A.f,StatefulWidget:()=>Zo,SyncData:()=>ue.Y,TrashTheConcept:()=>ir,UpdateComposition:()=>mr,UpdateCompositionLocal:()=>Dr.D,UserBinaryTree:()=>qo,Validator:()=>pa,ViewInternalData:()=>bi,ViewInternalDataApi:()=>ki,WidgetTree:()=>Di,convertFromConceptToLConcept:()=>Jo.F4,convertFromLConceptToConcept:()=>Jo.dp,convertWidgetTreeToWidget:()=>Ko,convertWidgetTreeToWidgetWithWrapper:()=>Oi,createFormFieldData:()=>fa,createPrototypeLocal:()=>Pi,dispatchIdEvent:()=>Ua,getFromDatabaseWithType:()=>bt,getObjectsFromIndexDb:()=>Ee,getWidgetBulkFromId:()=>Mo,getWidgetFromId:()=>ba,handleServiceWorkerException:()=>Ot,hasActivatedSW:()=>Vi,init:()=>Da,recursiveFetch:()=>m.zN,recursiveFetchNew:()=>ko,removeAllChildren:()=>Ui,renderLatestWidget:()=>Ia,renderPage:()=>wa,renderWidget:()=>Ri,searchLinkMultipleListener:()=>Jr,sendEmail:()=>ua,sendMessage:()=>Gt,serviceWorker:()=>Tt,setHasActivatedSW:()=>Ba,storeToDatabase:()=>We,subscribedListeners:()=>Wi,unwrapContainers:()=>Mi,updateAccessToken:()=>$i,uploadAttachment:()=>hr,uploadFile:()=>fi,uploadImage:()=>pi,validDocumentFormats:()=>hi,validImageFormats:()=>ui});var B={};_.r(B),_.d(B,{ADMIN:()=>jr,ALLID:()=>Dt.BG,AccessTracker:()=>Eo.J,AddGhostConcept:()=>Br,Anomaly:()=>Jt,BaseUrl:()=>a.B,BinaryTree:()=>ci.W,BuildWidgetFromId:()=>Lo.Cp,BuilderStatefulWidget:()=>Ro,Composition:()=>Do,CompositionBinaryTree:()=>co,CompositionNode:()=>vi,Concept:()=>ta.j,ConceptsData:()=>N.I,Connection:()=>be.N,ConnectionData:()=>In.d,CreateComposition:()=>we.A,CreateConnection:()=>jn.d,CreateConnectionBetweenEntityLocal:()=>Gi,CreateConnectionBetweenTwoConcepts:()=>At,CreateConnectionBetweenTwoConceptsGeneral:()=>ft,CreateConnectionBetweenTwoConceptsLocal:()=>Ai.h,CreateData:()=>Yo,CreateDefaultConcept:()=>ke.o,CreateDefaultLConcept:()=>Ti.u,CreateSession:()=>Ar,CreateSessionVisit:()=>Lr,CreateTheCompositionLocal:()=>fe.R,CreateTheCompositionWithCache:()=>Go,CreateTheConnection:()=>Ke.q,CreateTheConnectionGeneral:()=>lt,CreateTheConnectionLocal:()=>jn.F,DATAID:()=>Dt.y0,DATAIDDATE:()=>Dt.iw,DelayFunctionExecution:()=>$r,DeleteConceptById:()=>si,DeleteConceptLocal:()=>Pr,DeleteConnectionById:()=>Me.m,DeleteConnectionByType:()=>ga,DeleteUser:()=>or,DependencyObserver:()=>to.w,FilterSearch:()=>zo,FormatFromConnections:()=>so.vw,FormatFromConnectionsAltered:()=>so.y8,FreeschemaQuery:()=>En,FreeschemaQueryApi:()=>Qo,GetAllConnectionsOfComposition:()=>de.s,GetAllConnectionsOfCompositionBulk:()=>T.Y,GetAllTheConnectionsByTypeAndOfTheConcept:()=>va,GetComposition:()=>m.Nj,GetCompositionBulk:()=>en.dF,GetCompositionBulkWithDataId:()=>en.cw,GetCompositionFromConnectionsWithDataId:()=>en.p8,GetCompositionFromConnectionsWithDataIdFromConnections:()=>en.km,GetCompositionFromConnectionsWithDataIdInObject:()=>en.rv,GetCompositionFromConnectionsWithDataIdIndex:()=>en.Nt,GetCompositionFromConnectionsWithIndex:()=>en.as,GetCompositionFromConnectionsWithIndexFromConnections:()=>en.hG,GetCompositionFromMemoryWithConnections:()=>m.JA,GetCompositionList:()=>I,GetCompositionListAll:()=>x,GetCompositionListAllWithId:()=>w,GetCompositionListListener:()=>Kr,GetCompositionListLocal:()=>te,GetCompositionListLocalWithId:()=>ye,GetCompositionListWithId:()=>F,GetCompositionListWithIdUpdated:()=>E,GetCompositionListener:()=>Zr,GetCompositionLocal:()=>V,GetCompositionLocalWithId:()=>z,GetCompositionWithAllIds:()=>m.Mb,GetCompositionWithCache:()=>wr,GetCompositionWithDataIdBulk:()=>kr,GetCompositionWithDataIdWithCache:()=>Ci,GetCompositionWithId:()=>m.yz,GetCompositionWithIdAndDateFromMemory:()=>m.Ez,GetConceptBulk:()=>Io.r,GetConceptByCharacter:()=>y.A,GetConceptByCharacterAndCategoryLocal:()=>s.$I,GetConceptByCharacterAndType:()=>It.A,GetConnectionBetweenTwoConceptsLinker:()=>Vr,GetConnectionBulk:()=>jo.j,GetConnectionById:()=>ar,GetConnectionDataPrefetch:()=>en.QL,GetConnectionOfTheConcept:()=>De,GetLink:()=>mt,GetLinkListListener:()=>ea,GetLinkListener:()=>Yr.d,GetLinkRaw:()=>St,GetLinkerConnectionFromConcepts:()=>er,GetLinkerConnectionToConcepts:()=>tr,GetRelation:()=>_i,GetRelationLocal:()=>Gr,GetRelationRaw:()=>xr,GetTheConcept:()=>Ne.A,GetTheConceptLocal:()=>Ii.f,GetUserGhostId:()=>Er,JUSTDATA:()=>Dt.ZJ,LConcept:()=>na,LConnection:()=>oa,LISTNORMAL:()=>Dt.SL,LocalConceptsData:()=>b.v,LocalSyncData:()=>bo.H,LocalTransaction:()=>Fi,Logger:()=>Te.V,LoginToBackend:()=>pr,MakeTheInstanceConcept:()=>at.A,MakeTheInstanceConceptLocal:()=>Qe.k,MakeTheTimestamp:()=>cr,MakeTheTypeConceptApi:()=>ro,MakeTheTypeConceptLocal:()=>_t.$,NORMAL:()=>Dt.yv,PRIVATE:()=>Hr,PUBLIC:()=>qr,PatcherStructure:()=>ia,Prototype:()=>xa,RAW:()=>Dt.XZ,RecursiveSearchApi:()=>sr,RecursiveSearchApiNewRawFullLinker:()=>ur,RecursiveSearchApiRaw:()=>li,RecursiveSearchApiRawFullLinker:()=>dr,RecursiveSearchApiWithInternalConnections:()=>lr,RecursiveSearchListener:()=>Xr,SchemaQuery:()=>Ca,SchemaQueryListener:()=>Oo,SearchAllConcepts:()=>Cr,SearchLinkInternal:()=>Or,SearchLinkInternalAll:()=>Mr,SearchLinkMultipleAll:()=>so.cf,SearchLinkMultipleAllObservable:()=>Ni,SearchLinkMultipleApi:()=>f.j,SearchQuery:()=>ao,SearchStructure:()=>aa,SearchWithLinker:()=>_r,SearchWithTypeAndLinker:()=>lo.zl,SearchWithTypeAndLinkerApi:()=>Li,Selector:()=>_a,SessionData:()=>ra,Signin:()=>gr,Signup:()=>fr,SignupEntity:()=>yr,SplitStrings:()=>A.f,StatefulWidget:()=>Zo,SyncData:()=>ue.Y,TrashTheConcept:()=>ir,UpdateComposition:()=>mr,UpdateCompositionLocal:()=>Dr.D,UserBinaryTree:()=>qo,Validator:()=>pa,ViewInternalData:()=>bi,ViewInternalDataApi:()=>ki,WidgetTree:()=>Di,convertFromConceptToLConcept:()=>Jo.F4,convertFromLConceptToConcept:()=>Jo.dp,convertWidgetTreeToWidget:()=>Ko,convertWidgetTreeToWidgetWithWrapper:()=>Oi,createFormFieldData:()=>fa,createPrototypeLocal:()=>Pi,dispatchIdEvent:()=>Ua,getFromDatabaseWithType:()=>bt,getObjectsFromIndexDb:()=>Ee,getWidgetBulkFromId:()=>Mo,getWidgetFromId:()=>ba,handleServiceWorkerException:()=>Ot,hasActivatedSW:()=>Vi,init:()=>Da,recursiveFetch:()=>m.zN,recursiveFetchNew:()=>ko,removeAllChildren:()=>Ui,renderLatestWidget:()=>Ia,renderPage:()=>wa,renderWidget:()=>Ri,searchLinkMultipleListener:()=>Jr,sendEmail:()=>ua,sendMessage:()=>Gt,serviceWorker:()=>Tt,setHasActivatedSW:()=>Ba,storeToDatabase:()=>We,subscribedListeners:()=>Wi,unwrapContainers:()=>Mi,updateAccessToken:()=>$i,uploadAttachment:()=>hr,uploadFile:()=>fi,uploadImage:()=>pi,validDocumentFormats:()=>hi,validImageFormats:()=>ui});var M=_(5020),c=_(205),f=_(2832),A=_(6467),N=_(9639),a=_(9581),r=_(3518),d=_(1863),h=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function C(k,o){var e=arguments;return h(this,void 0,void 0,function*(){const t=Te.V.logfunction("GetAllConceptsByType",e);try{var l=new URLSearchParams;l.append("type",k),l.append("user_id",o.toString());var u=(0,r.Xr)("application/x-www-form-urlencoded");const L=yield fetch(a.B.GetAllConceptsByTypeUrl(),{method:"POST",headers:u,body:l});if(L.ok){const g=yield L.json();for(var v=0;v<g.length;v++)N.I.AddConcept(g[v])}else console.log("GetAllConceptsByType error",L.status),(0,d.ry)(L)}catch(L){L instanceof Error?console.log("GetAllConceptsByType error message: ",L.message):console.log("GetAllConceptsByType unexpected error: ",L),(0,d.Mb)(L,a.B.GetAllConceptsByTypeUrl()),(0,d.ey)(t,"GetAllConceptsByType",L)}})}var T=_(8642),b=_(9736),m=_(8939),y=_(2013),s=_(8064),p=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function I(k,o){var e=arguments;return p(this,arguments,void 0,function*(t,l,u=10,v=1){const L=Te.V.logfunction("GetCompositionList",e)||{};if(Tt){L.serviceWorker=!0;try{const n=yield Gt("GetCompositionList",{compositionName:t,userId:l,inpage:u,page:v});return Te.V.logUpdate(L),n.data}catch(n){console.error("GetCompositionList sw error: ",n),(0,d.ey)(L,"GetCompositionList",n),Ot(n)}}let g=yield(0,y.A)(t),i=[];if(g){yield C(t,l);let n=yield N.I.GetConceptsByTypeIdAndUser(g.id,l),S=u*(v-1),O=[];for(let K=S;K<S+u;K++)n[K]&&O.push(n[K].id);yield(0,T.Y)(O);for(let K=S;K<S+u;K++)if(n[K]){let j=yield(0,m.kx)(n[K].id);i.push(j)}}return Te.V.logUpdate(L),i})}function x(k,o){return p(this,arguments,void 0,function*(e,t,l=10,u=1){let v=te(e,t),L=I(e,t),g=[];return Promise.race([v,L]).then(i=>{console.log("Promise result",i),g.push(...i)}).catch(i=>{console.log("error in handling",i)}),L.then(i=>{console.log("This is the second promise result",i),g.push(...i)}),g})}function w(k,o){return p(this,arguments,void 0,function*(e,t,l=10,u=1){if(Tt)try{return(yield Gt("GetCompositionListAllWithId",{compositionName:e,userId:t,inpage:l,page:u})).data}catch(K){console.error("GetCompositionListAllWithId sw error: ",K),Ot(K)}let v=yield(0,s.Ay)(e),L=yield(0,y.A)(e),g=[],i=[],n=[],S=[];0!=v.id&&(i=yield b.v.GetConceptsByTypeIdAndUser(v.id,t)),0!=L.id&&(yield C(e,t),S=yield N.I.GetConceptsByTypeIdAndUser(L.id,t),g=S);for(let K=0;K<i.length;K++){let j=!1;for(let ae=0;ae<S.length;ae++)i[K].ghostId==S[ae].ghostId&&(j=!0);j||n.push(i[K])}console.log("This is the all list",n);let O=[];return O=yield function(K,j){return p(this,arguments,void 0,function*(ae,Ie,Ge=10,tt=1){let Be=[],ut=Ge*(tt-1),xt=[],Mt=Ie.length;for(let Ht=ut;Ht<ut+Ge-Mt;Ht++)ae[Ht]&&xt.push(ae[Ht].id);for(let Ht=0;Ht<Ie.length;Ht++){let Qt=yield z(Ie[Ht].id);Be.push(Qt)}yield(0,T.Y)(xt);for(let Ht=ut;Ht<ut+Ge-Mt;Ht++)if(ae[Ht]){let Qt=yield(0,m.RW)(ae[Ht].id);Be.push(Qt)}return Be})}(g,n,l,u),O})}function F(k,o){return p(this,arguments,void 0,function*(e,t,l=10,u=1){if(Tt)try{return(yield Gt("GetCompositionListWithId",{compositionName:e,userId:t,inpage:l,page:u})).data}catch(g){console.error("GetCompositionListWithId sw error: ",g),Ot(g)}let v=yield(0,y.A)(e),L=[];if(v){yield C(e,t);let g=yield N.I.GetConceptsByTypeIdAndUser(v.id,t),i=l*(u-1),n=[];for(let S=i;S<i+l;S++)g[S]&&n.push(g[S].id);yield(0,T.Y)(n);for(let S=i;S<i+l;S++)if(g[S]){let O=yield(0,m.RW)(g[S].id);L.push(O)}}return L})}function E(k,o){return p(this,arguments,void 0,function*(e,t,l=10,u=1){let v=yield(0,y.w)(e),L=[];if(v){yield C(e,t);let g=yield N.I.GetConceptsByTypeIdAndUser(v.id,t),i=l*(u-1),n=[];for(let S=i;S<i+l;S++)g[S]&&n.push(g[S].id);yield(0,T.Y)(n);for(let S=i;S<i+l;S++)if(g[S]){let O=yield(0,m.RW)(g[S].id);L.push(O)}}return L})}var D=_(4864),G=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},Z=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function V(k){return Z(this,void 0,void 0,function*(){var o,e;try{if(Tt)try{return(yield Gt("GetCompositionLocal",{id:k})).data}catch(g){console.error("GetCompositionLocal error sw: ",g),Ot(g)}let t=[],l={};t=yield D.G.GetConnectionsOfCompositionLocal(k);let u=[];for(let g=0;g<t.length;g++)u.includes(t[g].ofTheConceptId)||u.push(t[g].ofTheConceptId);let v=yield b.v.GetConcept(k);if(0==v.id){let g=yield function(i){var n=arguments;return G(this,void 0,void 0,function*(){const S=Te.V.logfunction("TranslateLocalToReal",n);let O=(0,ke.o)();try{var K=(0,r.ab)("application/x-www-form-urlencoded");const j=yield fetch(a.B.GetRealConceptById(),{method:"POST",headers:K,body:`id=${i}`});if(j.ok)return O=yield j.json(),O.id>0&&N.I.AddConcept(O),O;console.log("Error in Getting Translating concept Error",j.status),(0,d.ry)(j),Te.V.logUpdate(S)}catch(j){j instanceof Error?console.log("Error in Getting Translating concept error message: ",j):console.log("Error in Getting Translating concept unexpected error: ",j),(0,d.Mb)(j,a.B.GetRealConceptById()),(0,d.ey)(S,"TranslateLocalToReal",j)}return O})}(k);if(g.id>0)return yield(0,m.Nj)(g.id)}let L=yield P(k,t,u);return l[null!==(e=null===(o=v?.type)||void 0===o?void 0:o.characterValue)&&void 0!==e?e:"top"]=L,l}catch(t){throw t}})}function z(k){return Z(this,void 0,void 0,function*(){var o,e;try{if(Tt)try{return(yield Gt("GetCompositionLocalWithId",{id:k})).data}catch(g){console.error("GetCompositionLocalWithId error sw: ",g),Ot(g)}let t=[],l={},u={};t=yield D.G.GetConnectionsOfCompositionLocal(k);let v=[];for(let g=0;g<t.length;g++)v.includes(t[g].ofTheConceptId)||v.push(t[g].ofTheConceptId);let L=yield b.v.GetConcept(k);if(0!=L.id){let g=yield P(k,t,v);l[null!==(e=null===(o=L?.type)||void 0===o?void 0:o.characterValue)&&void 0!==e?e:"top"]=g}return u.data=l,u.id=k,u}catch(t){throw t}})}function P(k,o,e){return Z(this,arguments,void 0,function*(t,l,u,v=[]){var g,i;let n={},S=[],O=yield b.v.GetConcept(t);if(0!=O.id&&null==O.type){let K=O.typeId,j=yield b.v.GetConcept(K);O.type=j}if(!u.includes(t))return O?.characterValue;if(v.includes(t))return"";v.push(t);for(let K=0;K<l.length;K++)if(l[K].ofTheConceptId==t){let j=l[K].toTheConceptId,ae=yield b.v.GetConcept(j);if(0!=ae.id&&null==ae?.type){let tt=ae.typeId,Be=yield b.v.GetConcept(tt);ae.type=Be}let Ge=(null!==(i=null===(g=ae?.type)||void 0===g?void 0:g.characterValue)&&void 0!==i?i:"top").replace("the_","");if(isNaN(Number(Ge))){if(Ge){const tt=yield P(j,l,u);n[Ge]=tt}}else{const tt=yield P(j,l,u);S[Ge]=tt,n=S}}return n})}var H=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function te(k,o){return H(this,void 0,void 0,function*(){if(Tt)try{return(yield Gt("GetCompositionListLocal",{compositionName:k,userId:o})).data}catch(e){console.error("GetCompositionListLocal error sw: ",e),Ot(e)}try{let e=yield(0,s.Ay)(k),t=[];if(0!=e.id){let l=yield b.v.GetConceptsByTypeIdAndUser(e.id,o);for(let u=0;u<l.length;u++){let v=yield V(l[u].id);t.push(v)}}return t}catch(e){throw e}})}function ye(k,o){return H(this,void 0,void 0,function*(){if(Tt)try{return(yield Gt("GetCompositionListLocalWithId",{compositionName:k,userId:o})).data}catch(e){console.error("GetCompositionListLocalWithId error sw: ",e),Ot(e)}try{let e=yield(0,s.Ay)(k),t=[];if(0!=e.id){let l=yield b.v.GetConceptsByTypeIdAndUser(e.id,o);for(let u=0;u<l.length;u++){let v=yield z(l[u].id);t.push(v)}}return t}catch(e){throw e}})}var de=_(2),we=_(1218),fe=_(999),_e=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function De(k,o,e){var t=arguments;return _e(this,arguments,void 0,function*(l,u,v,L=10,g=1){const i=Te.V.logfunction("GetConnectionOfTheConcept",t)||{};let n=[];try{if(Tt){i.serviceWorker=!0;try{const j=yield Gt("GetConnectionOfTheConcept",{typeId:l,ofTheConceptId:u,userId:v,inpage:L,page:g});return Te.V.logUpdate(i),j.data}catch(j){console.error("GetConnectionOfTheConcept sw error: ",j),(0,d.ey)(i,"GetConnectionOfTheConcept",j),Ot(j)}}let S=new URLSearchParams;S.append("typeId",`${l}`),S.append("ofTheConceptId",`${u}`),S.append("userId",`${v}`),S.append("inpage",`${L}`),S.append("page",`${g}`);let O=(0,r.Xr)("application/x-www-form-urlencoded");const K=yield fetch(a.B.GetAllConnectionsOfConceptUrl(),{method:"POST",headers:O,body:S});return K.ok?n=yield K.json():((0,d.ey)(i,"GetConnectionOfTheConcept",K.status),(0,d.ry)(K),console.log("Get connection of concept error",K.status)),Te.V.logUpdate(i),n}catch(S){S instanceof Error?console.log("Get connection of concept  error message: ",S.message):console.log("Get connection of concept unexpected error: ",S),(0,d.Mb)(S,a.B.GetAllConnectionsOfConceptUrl()),(0,d.ey)(i,"GetConnectionOfTheConcept",S)}})}var be=_(2155),ue=_(442),ke=_(7282),Ae=_(5976),Oe=_(7273),ht=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function lt(k,o,e,t){return ht(this,arguments,void 0,function*(l,u,v,L,g=1,i=4){if(l>0&&v>0){var n=u,S=yield Ae.p.getId(),O=new be.N(S,l,v,n,L,g,i);return l==v?(O.ofTheConceptId=0,O.toTheConceptId=1,O):(O.toUpdate=!0,O.isTemp=!1,ue.Y.AddConnection(O),O)}throw new Oe.z("cannot create connection because id are negative ",!1,400,"")})}var Me=_(1838),Ne=_(7876),at=_(8407),Lt=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function At(k,o,e){return Lt(this,arguments,void 0,function*(t,l,u,v=!1,L=!1){var g,i;if(Tt)try{return(yield Gt("CreateConnectionBetweenTwoConcepts",{ofTheConcept:t,toTheConcept:l,linker:u,both:v,count:L})).data}catch(ae){console.error("CreateConnectionBetweenTwoConcepts sw error: ",ae),Ot(ae)}let n=t.userId;if(v){let ae=u+"_by",Ie=(null===(g=l.type)||void 0===g?void 0:g.characterValue)+"_s_"+ae;L&&(yield Ue(ae,l,n));let Ge=yield(0,at.A)("connection",Ie,!1,999,999,999),tt=new be.N(0,l.id,t.id,n,Ge.id,1e3,4);ue.Y.AddConnection(tt)}let S=u+"_s",O=(null===(i=t.type)||void 0===i?void 0:i.characterValue)+"_s_"+S;L&&(yield Ue(S,t,n));let K=yield(0,at.A)("connection",O,!1,999,999,999),j=new be.N(0,t.id,l.id,n,K.id,1e3,4);return ue.Y.AddConnection(j),j})}function Ue(k,o){return Lt(this,arguments,void 0,function*(e,t,l=null){var u;let v=t,L=l??t.userId,i=(null===(u=t.type)||void 0===u?void 0:u.characterValue)+"_s_"+e+"_count",n=yield(0,at.A)("connection",i,!1,L,4,999),S=yield De(n.id,t.id,L,10,1),O=[],K=(0,ke.o)();for(let ae=0;ae<S.length;ae++){let Ie=yield(0,Ne.A)(S[ae].toTheConceptId);O.push(Ie)}if(O.length<1)K=yield(0,at.A)("count","1",!1,L,4,999);else{let ae=O[0],Ie=0;try{Ie=Number(ae.characterValue)}catch{Ie=0}Ie+=1,K=yield(0,at.A)("count",Ie.toString(),!1,L,4,999);for(let Ge=0;Ge<S.length;Ge++)(0,Me.m)(S[Ge].id)}let j=new be.N(0,v.id,K.id,v.userId,n.id,1e3,4);yield ue.Y.AddConnection(j)})}function ft(k,o,e){return Lt(this,arguments,void 0,function*(t,l,u,v=!1,L=!1){var g,i;let n=t.userId;if(v){let j=u+"_by",ae=(null===(g=l.type)||void 0===g?void 0:g.characterValue)+"_s_"+j;L&&(yield Ue(j,l,n));let Ie=yield(0,at.A)("connection",ae,!1,999,999,999),Ge=new be.N(0,l.id,t.id,n,Ie.id,1e3,4);ue.Y.AddConnection(Ge)}let S=u+"_s",O=(null===(i=t.type)||void 0===i?void 0:i.characterValue)+"_s_"+S;L&&(yield Ue(S,t,n));let K=yield(0,at.A)("connection",O,!1,999,999,999);return yield lt(t.id,t.userId,l.id,K.id,1e3,4)})}var Qe=_(5868),ze=(_(3655),function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})});function We(k,o){const e=Te.V.logfunction("storeToDatabase",[k,"noindexdb"]);Te.V.logUpdate(e)}function bt(k,o,e){return ze(this,void 0,void 0,function*(){const t=Te.V.logfunction("getFromDatabaseWithType",[k,"noindexdb"]);Te.V.logUpdate(t)})}function Ee(k){return ze(this,void 0,void 0,function*(){const o=Te.V.logfunction("getObjectsFromIndexDb",[k,"noindexdb"]);Te.V.logUpdate(o)})}var Ke=_(1666),It=_(4402),et=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function mt(k,o){var e=arguments;return et(this,arguments,void 0,function*(t,l,u=10,v=1){var L;const g=Te.V.logfunction("GetLink",e)||{};if(Tt){g.serviceWorker=!0;try{const K=yield Gt("GetLink",{id:t,linker:l,inpage:u,page:v});return Te.V.logUpdate(g),K.data}catch(K){console.error("GetLink sw error: ",K),(0,d.ey)(g,"GetLink",K),Ot(K)}}let i=[],n=yield(0,Ne.A)(t),S=(null===(L=n.type)||void 0===L?void 0:L.characterValue)+"_s_"+l,O=yield(0,It.A)(S,16);if(O.id>0){let K=yield De(O.id,n.id,n.userId,u,v),j=[];for(let ae=0;ae<K.length;ae++)j.push(K[ae].toTheConceptId);yield(0,T.Y)(j);for(let ae=0;ae<K.length;ae++){let Ie=K[ae].toTheConceptId,Ge=yield(0,Ne.A)(Ie),tt=yield(0,m.Ez)(Ge.id);i.push(tt)}}return Te.V.logUpdate(g),i})}function St(k,o){var e=arguments;return et(this,arguments,void 0,function*(t,l,u=10,v=1){var L;const g=Te.V.logfunction("GetLinkRaw",e);let i=[],n=yield(0,Ne.A)(t),S=(null===(L=n.type)||void 0===L?void 0:L.characterValue)+"_s_"+l,O=yield(0,It.A)(S,16);if(O.id>0){let K=yield De(O.id,n.id,n.userId,u,v),j=[];for(let ae=0;ae<K.length;ae++)j.push(K[ae].toTheConceptId);for(let ae=0;ae<K.length;ae++){let Ie=K[ae].toTheConceptId,Ge=yield(0,Ne.A)(Ie);i.push(Ge)}}return Te.V.logUpdate(g),i})}var _t=_(8357),cn=_(8146),mn=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},Vt=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Zn(k){return Vt(this,void 0,void 0,function*(){const o=Te.V.logfunction("GetConceptByCharacterAndCategory",k);let e=(0,ke.o)();if("the"==k)return e.id=1,e.typeId=5,e.characterValue="the",e;let t=(0,A.f)(k);if(t.length>1){let l=1,u=yield Zn(t[0]);0!=u.id&&(l=u.id),e=yield function(v,L){var g=arguments;return Vt(this,void 0,void 0,function*(){const i=Te.V.logfunction("GetConceptByCharacterAndCategoryFromMemory",g);let n=yield N.I.GetConceptByCharacterAndCategoryLocal(v,L);return 0==n.id&&(n=yield function(S,O){var K=arguments;return mn(this,void 0,void 0,function*(){const j=Te.V.logfunction("GetConceptByCharacterAndCategoryDirectApi",K);let ae=(0,ke.o)();try{var Ie=(0,r.Xr)("application/x-www-form-urlencoded");const Ge=yield fetch(a.B.GetConceptByCharacterAndCategoryDirectUrl(),{method:"POST",headers:Ie,body:`character_value=${S}&category_id=${O}`});Ge.ok?(ae=yield Ge.json(),(0,Ne.K)(ae).then(()=>{N.I.AddConcept(ae)})):(console.log("This is the concept by category and character error",Ge.status),(0,d.ry)(Ge)),Te.V.logUpdate(j)}catch(Ge){Ge instanceof Error?console.log(" This is the concept by category and character error message: ",Ge.message):console.log(" This is the concept by category and character unexpected error: ",Ge),(0,d.Mb)(Ge,a.B.GetConceptByCharacterAndCategoryDirectUrl()),(0,d.ey)(j,"GetConceptByCharacterAndCategoryDirectApi",Ge)}return ae})}(v,L)),Te.V.logUpdate(i),n})}(k,l)}else t[0]==k&&(e=yield function(l){var u=arguments;return Vt(this,void 0,void 0,function*(){const v=Te.V.logfunction("GetConceptByCharacter",u);let L=yield N.I.GetConceptByCharacterAndTypeLocal(l,51);return 0==L.id&&(L=yield(0,cn.Y)(l)),Te.V.logUpdate(v),L})}(k));return Te.V.logUpdate(o),e})}var io=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};const $o=new Map;function ro(k,o){var e=arguments;return io(this,void 0,void 0,function*(){const t=Te.V.logfunction("MakeTheTypeConceptApi",e);let l=(0,ke.o)();if($o.has(k))return $o.get(k)||l;const u=(()=>io(this,void 0,void 0,function*(){try{if(l=yield Zn(k),0==l.id||4==l.typeId){let v=(0,r.Xr)("application/x-www-form-urlencoded");const L=yield fetch(a.B.MakeTheTypeConceptUrl(),{method:"POST",headers:v,body:`type=${k}`});if(!L.ok)throw(0,d.ry)(L),new Error(`Error! status: ${L.status}`);l=yield L.json(),Te.V.logUpdate(t)}}catch(v){v instanceof Error?console.log("Make The Type Concept Api error : ",v.message):console.log("Make The Type Concept Api error : ",v),(0,d.Mb)(v,a.B.MakeTheTypeConceptUrl()),(0,d.ey)(t,"MakeTheTypeConceptApi",v)}finally{$o.delete(k)}return l}))();return $o.set(k,u),u})}var rl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ai(k){var o=arguments;return rl(this,void 0,void 0,function*(){Te.V.logfunction("GetAllLinkerConnectionsFromTheConcept",o);var e=[];try{(new Date).getTime();var t=(0,r.Xr)("application/x-www-form-urlencoded");const v=yield fetch(a.B.GetAllLinkerConnectionOfConceptUrl()+`?conceptId=${k}`,{method:"GET",headers:t});if(v.ok){const L=yield v.json();for(var l=0;l<L.length;l++)e.push(L[l])}else console.log("Get all linker connection from the concepts error","cannot get respone"),(0,d.ry)(v)}catch(v){v instanceof Error?console.log("Get all linker connection from the concepts error: ",v.message):console.log("Get all linker connection from the concepts error(Unexpected): ",v),(0,d.Mb)(v,a.B.GetAllLinkerConnectionOfConceptUrl())}return e})}var al=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Yi(k){var o=arguments;return al(this,void 0,void 0,function*(){const e=Te.V.logfunction("GetAllLinkerConnectionsToTheConcept",o);var t=[];try{(new Date).getTime();var l=(0,r.Xr)("application/x-www-form-urlencoded");const L=yield fetch(a.B.GetAllLinkerConnectionToConceptUrl()+`?conceptId=${k}`,{method:"GET",headers:l});if(L.ok){const g=yield L.json();for(var u=0;u<g.length;u++)t.push(g[u]);Te.V.logUpdate(e)}else console.log("Get all linker connection To the concepts error","cannot get respone"),(0,d.ry)(L)}catch(L){L instanceof Error?console.log("Get all linker connection To the concepts error: ",L.message):console.log("Get all linker connection To the concepts error(Unexpected): ",L),(0,d.Mb)(L,a.B.GetAllLinkerConnectionToConceptUrl()),(0,d.ey)(e,"GetAllLinkerConnectionsToTheConcept",L)}return t})}var Xi=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function er(k){var o=arguments;return Xi(this,void 0,void 0,function*(){const e=Te.V.logfunction("GetLinkerConnectionFromConcepts",o);let t=yield ai(k);for(let l=0;l<t.length;l++){let u=t[l],v=u.typeId,L=yield(0,Ne.A)(v);u.type=L}return Te.V.logUpdate(e),t})}function tr(k){var o=arguments;return Xi(this,void 0,void 0,function*(){const e=Te.V.logfunction("GetLinkerConnectionToConcepts",o);let t=yield Yi(k);for(let l=0;l<t.length;l++){let u=t[l],v=u.typeId,L=yield(0,Ne.A)(v);u.type=L}return Te.V.logUpdate(e),t})}var cl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},sl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},ll=_(6963),ci=_(2202),dl=_(5457),ul=_(991),nr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function si(k){var o=arguments;return nr(this,void 0,void 0,function*(){const e=Te.V.logfunction("DeleteConceptById",o);if(Tt)try{return(yield Gt("DeleteConceptById",{id:k})).data}catch(v){console.error("DeleteConceptById sw error: ",v),Ot(v)}if(k>0){var t=yield N.I.GetConcept(k);if(t.id>0){var l=t.typeId,u=t.characterValue;yield dl.c.removeTypeConcept(l,k),yield ll.f.removeNodeByCharacter(u,k),yield function(v){var L=arguments;return sl(this,void 0,void 0,function*(){let g=!1;const i=Te.V.logfunction("DeleteTheConcept",L);try{const n=new FormData;n.append("id",v.toString());let S=(0,r.BZ)();const O=yield fetch(a.B.DeleteConceptUrl(),{method:"POST",headers:S,body:n});O.ok?g=(yield O.json()).success:(console.log("Delete concept error",O.status),(0,d.ry)(O)),g&&N.I.AddNpc(v),Te.V.logUpdate(i)}catch(n){n instanceof Error?console.log("Delete concept error message: ",n.message):console.log("Delete concept unexpected error: ",n),(0,d.Mb)(n,a.B.DeleteConceptUrl()),(0,d.ey)(i,"DeleteTheConcept",n)}return g})}(k),yield ci.W.removeNodeFromTree(k),yield ul.H.removeNodeFromTree(k)}}else b.v.RemoveConceptById(k);Te.V.logUpdate(e)})}function or(k){return nr(this,void 0,void 0,function*(){if(Tt)try{return(yield Gt("DeleteUser",{id:k})).data}catch(o){console.error("DeleteUser sw error: ",o),Ot(o)}k>0?function(o){var e=arguments;cl(this,void 0,void 0,function*(){const t=Te.V.logfunction("DeleteUserInBackend",e);try{var l=(0,r.ab)("application/json","");let u=a.B.DeleteUserUrl();u=u+"?conceptId="+o+"&apiKey=freeschema";const v=yield fetch(u,{method:"POST",headers:l});if(v.ok){let L=yield v.json(),g=Number(L.data);return console.log("this is the delete email concept",g),si(g),Te.V.logUpdate(t),g}throw(0,d.ry)(v),new Error(`Delete composition Error! status: ${v.status}`)}catch(u){u instanceof Error?console.log("Delete composition error message: ",u.message):console.log("Delete composition unexpected error: ",u),(0,d.Mb)(u,a.B.DeleteConceptUrl()),(0,d.ey)(t,"DeleteUserInBackend",u)}})}(k):b.v.RemoveConceptById(k)})}var hl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ir(k,o){return hl(this,void 0,void 0,function*(){try{const e=new Headers;e.append("Authorization","Bearer "+o);const t=new FormData;t.append("id",k.toString());const l=yield fetch(a.B.DeleteConceptUrl(),{method:"POST",body:t,headers:e});if(!l.ok)throw(0,d.ry)(l),new Error(`Delete composition Error! status: ${l.status}`)}catch(e){e instanceof Error?console.log("Delete composition error message: ",e.message):console.log("Delete composition unexpected error: ",e),(0,d.Mb)(e,a.B.DeleteConceptUrl())}})}var Eo=_(1735),In=_(8286),pl=_(1596),sn=_(3278),rr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},fl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ar(k){var o=arguments;return fl(this,void 0,void 0,function*(){const e=Te.V.logfunction("GetConnectionById",o);if(console.log("AccessTracker activation status from GetConnectionById"),!0===Eo.J.activateStatus)try{Eo.J.incrementConnection(k)}catch{console.error("Error adding connection in access tracker"),Te.V.log("ERROR","Error Adding Connection")}if(Tt)try{return(yield Gt("GetConnectionById",{id:k})).data}catch(l){console.error("GetConnectionById sw error: ",l),Ot(l)}let t=yield In.d.GetConnection(k);return null!=t&&0!=t.id||null==k||null==k||(t=yield function(l){var u=arguments;return rr(this,void 0,void 0,function*(){const v=Te.V.logfunction("GetConnection",u);let L=yield In.d.GetConnection(l);try{if(0!=L.id)return L;{const g=new FormData;g.append("id",l.toString());const i={method:"POST",headers:{Authorization:"Bearer "+sn.b.BearerAccessToken},body:g};let n;try{n=yield fetch(a.B.GetConnectionUrl(),i)}catch{n=yield(0,pl.g)(i,"/api/get-connection-by-id")}return yield function(S,O){return rr(this,void 0,void 0,function*(){S.ok?(O=yield S.json(),In.d.AddConnection(O)):((0,d.ry)(S),console.log("Get Connection Error",S.status))})}(n,L),Te.V.logUpdate(v),L}}catch(g){g instanceof Error?console.log("Get Connection error message: ",g.message):console.log("Get Connection unexpected error: ",g),(0,d.Mb)(g,a.B.GetConnectionUrl()),(0,d.ey)(v,"GetConnection",g)}})}(k)),Te.V.logUpdate(e),t})}var yl=_(2212),gl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},vl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function cr(k,o,e){return vl(this,arguments,void 0,function*(t,l,u,v=4,L=999){const g=Te.V.logfunction("MakeTheTimestamp")||{};if(Tt){g.serviceWorker=!0;try{const j=yield Gt("MakeTheTimestamp",{type:t,referent:l,userId:u,accessId:v,sessionInformationId:L});return Te.V.logUpdate(g),j.data}catch(j){console.error("MakeTheTimestamp sw error: ",j),(0,d.ey)(g,"MakeTheTimestamp",j),Ot(j)}}let i,n="",S=t.startsWith("the_"),O=(0,ke.o)();return n=S?t:"the_"+t,O=yield ro(n,u),i=yield function(j,ae,Ie,Ge,tt,Be,ut){return gl(this,void 0,void 0,function*(){let xt=yield(0,It.A)(j,Ge),Mt=xt;return 0==Mt.id&&(xt=yield(0,yl.Ay)(j,ae,4,Ge,0,Be,ut),Mt=xt),Mt})}(l,u,0,O.id,0,v,n),Te.V.logUpdate(g),i})}class ao{constructor(){this.composition=0,this.type="",this.linker="",this.inpage=10,this.page=1,this.listLinkers=[],this.fullLinkers=[],this.textSearch="",this.logic="or",this.reverse=!1,this.doFilter=!1,this.filterSearches=[],this.selectors=[],this.ofCompositions=[]}}var en=_(6687),Bo=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function sr(){var k=arguments;return Bo(this,arguments,void 0,function*(o=0,e=[],t="",l=[]){const u=Te.V.logfunction("RecursiveSearchApi",k)||{};let v=[];try{if(Tt){u.serviceWorker=!0;try{const S=yield Gt("RecursiveSearchApi",{composition:o,listLinkers:e,textSearch:t,fullLinkers:l});return Te.V.logUpdate(u),S.data}catch(S){console.error("RecursiveSearchApi sw error: ",S),(0,d.ey)(u,"RecursiveSearchApi",S),Ot(S)}}let L=new ao;L.composition=o,L.listLinkers=e,L.fullLinkers=l,L.textSearch=t;let g=JSON.stringify(L),i=(0,r.Xr)();const n=yield fetch(a.B.RecursiveSearchUrl(),{method:"POST",headers:i,body:g});if(n.ok){const S=yield n.json();let O=S.compositionIds,K=S.internalConnections;v=yield(0,en.p8)(O,K)}else console.log("recursive search error ",n.status),(0,d.ey)(u,"RecursiveSearchApi",n.status),(0,d.ry)(n);Te.V.logUpdate(u)}catch(L){L instanceof Error?console.log("recursive search error message: ",L.message):console.log("recursive search unexpected error: ",L),(0,d.ey)(u,"RecursiveSearchApi",L),(0,d.Mb)(L,a.B.RecursiveSearchUrl())}return v})}function lr(){var k=arguments;return Bo(this,arguments,void 0,function*(o=0,e=[],t=""){const l=Te.V.logfunction("RecursiveSearchApiWithInternalConnections",k)||{};let u=[];try{if(Tt){l.serviceWorker=!0;try{const n=yield Gt("RecursiveSearchApiWithInternalConnections",{composition:o,listLinkers:e,textSearch:t});return Te.V.logUpdate(l),n.data}catch(n){console.error("RecursiveSearchApiWithInternalConnections sw error: ",n),(0,d.ey)(l,"RecursiveSearchApiWithInternalConnections",n),Ot(n)}}let v=new ao;v.composition=o,v.listLinkers=e,v.textSearch=t;let L=JSON.stringify(v),g=(0,r.Xr)();const i=yield fetch(a.B.RecursiveSearchUrl(),{method:"POST",headers:g,body:L});if(i.ok){const n=yield i.json();let S=n.compositionIds,O=n.internalConnections;u=yield(0,en.km)(S,O),Te.V.logUpdate(l)}else console.log("recursive search error ",i.status),(0,d.ey)(l,"GetCompositionConnectionsBetweenTwoConcepts",i.status),(0,d.ry)(i)}catch(v){v instanceof Error?console.log("recursive search error message: ",v.message):console.log("recursive search unexpected error: ",v),(0,d.ey)(l,"GetCompositionConnectionsBetweenTwoConcepts",v),(0,d.Mb)(v,a.B.RecursiveSearchUrl())}return u})}function li(){var k=arguments;return Bo(this,arguments,void 0,function*(o=0,e=[],t="",l=[]){const u=Te.V.logfunction("RecursiveSearchApiRaw",k)||{};try{if(Tt){u.serviceWorker=!0;try{const n=yield Gt("RecursiveSearchApiRaw",{composition:o,listLinkers:e,textSearch:t,fullLinkers:l});return Te.V.logUpdate(u),n.data}catch(n){console.error("RecursiveSearchApiRaw sw error: ",n),(0,d.ey)(u,"RecursiveSearchApiRaw",n),Ot(n)}}let v=new ao;v.composition=o,v.listLinkers=e,v.textSearch=t,v.fullLinkers=l;let L=JSON.stringify(v),g=(0,r.Xr)();const i=yield fetch(a.B.RecursiveSearchUrl(),{method:"POST",headers:g,body:L});if(i.ok){const n=yield i.json();return Te.V.logUpdate(u),n}return console.log("recursive search error ",i.status),(0,d.ey)(u,"RecursiveSearchApiRaw",i.status),(0,d.ry)(i),Te.V.logUpdate(u),[]}catch(v){v instanceof Error?console.log("recursive search error message: ",v.message):console.log("recursive search unexpected error: ",v),(0,d.ey)(u,"RecursiveSearchApiRaw",v),(0,d.Mb)(v,a.B.RecursiveSearchUrl())}})}function dr(){var k=arguments;return Bo(this,arguments,void 0,function*(o=0,e=[],t=""){const l=Te.V.logfunction("RecursiveSearchApiRawFullLinker",k)||{};try{if(Tt){l.serviceWorker=!0;try{const i=yield Gt("RecursiveSearchApiRawFullLinker",{composition:o,fullLinkers:e,textSearch:t});return Te.V.logUpdate(l),i.data}catch(i){console.error("RecursiveSearchApiRawFullLinker sw error: ",i),(0,d.ey)(l,"RecursiveSearchApiRawFullLinker",i),Ot(i)}}let u=new ao;u.composition=o,u.fullLinkers=e,u.textSearch=t;let v=JSON.stringify(u),L=(0,r.Xr)();const g=yield fetch(a.B.RecursiveSearchUrl(),{method:"POST",headers:L,body:v});if(g.ok){const i=yield g.json();return Te.V.logUpdate(l),i}return console.log("recursive search error ",g.status),(0,d.ey)(l,"RecursiveSearchApiRawFullLinker",g.status),(0,d.ry)(g),Te.V.logUpdate(l),[]}catch(u){u instanceof Error?console.log("recursive search error message: ",u.message):console.log("recursive search unexpected error: ",u),(0,d.Mb)(u,a.B.RecursiveSearchUrl()),(0,d.ey)(l,"RecursiveSearchApiRawFullLinker",u)}})}function ur(){var k=arguments;return Bo(this,arguments,void 0,function*(o=0,e=[],t=""){const l=Te.V.logfunction("RecursiveSearchApiRawFullLinker",k)||{};try{if(Tt)try{l.serviceWorker=!0;const i=yield Gt("RecursiveSearchApiNewRawFullLinker",{composition:o,fullLinkers:e,textSearch:t});return Te.V.logUpdate(l),i.data}catch(i){console.error("RecursiveSearchApiNewRawFullLinker sw error: ",i),(0,d.ey)(l,"RecursiveSearchApiNewRawFullLinker",i),Ot(i)}let u=new ao;u.composition=o,u.fullLinkers=e,u.textSearch=t;let v=JSON.stringify(u),L=(0,r.Xr)();const g=yield fetch(a.B.RecursiveSearchUrl(),{method:"POST",headers:L,body:v});if(g.ok){const i=yield g.json();return Te.V.logUpdate(l),i}return console.log("recursive search error ",g.status),(0,d.ey)(l,"RecursiveSearchApiNewRawFullLinker",g.status),(0,d.ry)(g),Te.V.logUpdate(l),[]}catch(u){u instanceof Error?console.log("recursive search error message: ",u.message):console.log("recursive search unexpected error: ",u),(0,d.Mb)(u,a.B.RecursiveSearchUrl()),(0,d.ey)(l,"RecursiveSearchApiNewRawFullLinker",u)}})}var di=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};const ui=["image/jpeg","image/jpg","image/png","image/webp"],hi=["application/msword","application/vnd.ms-excel","application/vnd.ms-powerpoint","text/plain","application/pdf"];function hr(k,o){return di(this,void 0,void 0,function*(){const e=Te.V.logfunction("uploadAttachment");try{console.log("File Type",k.type);const t=new FormData;let l;if(hi.includes(k.type))t.append("file",k,k.name),l=yield fi(t,o);else{if(!ui.includes(k.type))return{message:"Invalid File Format",success:!1};t.append("image",k,k.name),l=yield pi(t,o)}return l?.data?(Te.V.logUpdate(e),{message:"Upload Success",success:!0,url:l.data}):{message:"File Upload Failed",success:!1}}catch(t){throw console.error(t),(0,d.ey)(e,"uploadAttachment",t),t}})}function pi(k){return di(this,arguments,void 0,function*(o,e=""){const t=Te.V.logfunction("uploadImage");try{const l=yield fetch(a.B.uploadImageUrl(),{method:"POST",body:o,headers:{Authorization:`Bearer ${e}`}});if(!l.ok){const u=l.headers.get("content-type");u&&u.includes("text/plain")&&console.info(l?.text());const v=yield l?.text();return console.error(`${l.status} ${v}`),Te.V.logUpdate(t),null}return yield l.json()}catch(l){return console.error(l),(0,d.ey)(t,"uploadImage",l),null}})}function fi(k){return di(this,arguments,void 0,function*(o,e=""){const t=Te.V.logfunction("uploadFile");try{const l=yield fetch(a.B.uploadFileUrl(),{method:"POST",body:o,headers:{Authorization:`Bearer ${e}`}});if(!l.ok){const u=l.headers.get("content-type");u&&u.includes("text/plain")&&console.info(l.text());const v=yield l.text();return console.error(`${l.status} ${v}`),null}return Te.V.logUpdate(t),yield l.json()}catch(l){return console.error(l),(0,d.ey)(t,"uploadFile",l),null}})}var Io=_(1239),jo=_(7467),ml=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function pr(k,o){var e=arguments;return ml(this,void 0,void 0,function*(){const t=Te.V.logfunction("LoginToBackend",e);try{let l={email:k,password:o},u=new Headers;u.append("Content-Type","application/json");let v=JSON.stringify(l);const L=yield fetch(a.B.LoginUrl(),{method:"POST",headers:u,body:v}),g=yield L.json();if(L.ok)return sn.b.BearerAccessToken=g.data.token,Te.V.logUpdate(t),g;console.log("Login tsccs error message: ",L.status),(0,d.ER)(L,g)}catch(l){l instanceof Error?console.log("Login tsccs error message: ",l.message):console.log(" Login tsccs  unexpected error: ",l),(0,d.Mb)(l,a.B.LoginUrl()),(0,d.ey)(t,"LoginToBackend",l)}})}var yi=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function fr(k){return yi(this,void 0,void 0,function*(){return yield function(){return yi(this,arguments,void 0,function*(e="",t={}){let l={message:"success",status:!1,statusCode:200,data:"cannot signup"};try{const u=yield fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(t)}),v=yield u.json();return u.ok?l={message:"success",status:!0,statusCode:200,data:v}:(0,d.ER)(u,v),l}catch(u){console.log("Signup Error: ",u),(0,d.Mb)(u,e)}})}(a.B.SignupUrl(),k)})}function yr(k){return yi(this,void 0,void 0,function*(){const o=a.B.NODE_URL,e=yield fetch(`${o}/api/v1/entity/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)});if(e.ok)return e.json();throw 404===e.status?new Error("404, Not found"):500===e.status?new Error("500, internal server error"):new Error(e.status)})}var Cl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function gr(k){return Cl(this,void 0,void 0,function*(){const o=JSON.stringify({email:k.email,password:k.password});let e={message:"success",status:!1,statusCode:200,data:""};const t=new Headers;t.append("Content-Type","application/json");const l=a.B.LoginUrl();try{const u=yield fetch(l,{method:"POST",headers:t,body:o,redirect:"follow"}),v=yield u.json();return u.ok?e={message:"success",status:!0,statusCode:200,data:v?.data}:(0,d.ER)(u,v),e}catch(u){console.log("Sign in api error",u),(0,d.Mb)(u,l)}})}var gi=_(9934),Ho=_(4485);function _l(k=[],o){Array.isArray(k)&&k.splice(k.findIndex(function(e){return e.id===o.id}),1)}function Tl(k=[],o){Array.isArray(k)&&k.splice(k.findIndex(function(e){return e.id===o.id}),1)}class vi{constructor(o,e,t,l){this.expiryTime=new Date(Date.now()+6e5),this.height=1,this.key=o,this.value=e,this.leftNode=t,this.rightNode=l}isValid(){const o=new Date(Date.now());return!(this.expiryTime<o&&(co.removeNodeFromTree(this.key),1))}saveToCache(o){this.value.cached=o}addNode(o,e,t){if(null==e)return o;const u=e.rightNode;if(e.key>o.key)e.leftNode=this.addNode(o,e.leftNode,t);else{if(!(e.key<o.key))return this.isValid(),o;e.rightNode=this.addNode(o,u,t)}e.height=1+Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode));const v=this.getBalanceFactor(e);if(v>1&&e.leftNode){if(o.key<e.leftNode.key)return this.rightRotate(e);if(o.key>e.leftNode.key)return e.leftNode=this.leftRotate(e.leftNode),this.rightRotate(e)}if(v<-1&&e.rightNode){if(o.key>e.rightNode.key)return this.leftRotate(e);if(o.key<e.rightNode.key)return e.rightNode=this.rightRotate(e.rightNode),this.leftRotate(e)}return this.isValid(),e}rightRotate(o){if(o){const e=o.leftNode;if(e)return o.leftNode=e.rightNode,e.rightNode=o,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,e}return o}leftRotate(o){if(o){const e=o.rightNode;if(e){const t=e.leftNode;return e.leftNode=o,o.rightNode=t,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(o.rightNode))+1,e}}return o}getHeight(o){return o?o.height:0}getBalanceFactor(o){return null==o?0:this.getHeight(o.leftNode)-this.getHeight(o.rightNode)}getFromNode(o,e){return e&&(o==e.key&&e.isValid()?e:o<e.key?this.getFromNode(o,e.leftNode):o>e.key?this.getFromNode(o,e.rightNode):e)}removeNode(o,e){if(null==o)return o;if(o.key>e)return o.leftNode=this.removeNode(o.leftNode,e),o;if(o.key<e)return o.rightNode=this.removeNode(o.rightNode,e),o;if(null==o.leftNode){const t=o.rightNode;return o=null,t}if(null==o.rightNode){const t=o.leftNode;return o=null,t}{const t=this.inOrderSuccessor(o.rightNode);return o.value=t.value,o.key=t.key,o.rightNode=this.removeNode(o.rightNode,t.key),o}}countNodeBelow(o){return null==o?0:1+this.countNodeBelow(o.leftNode)+this.countNodeBelow(o.rightNode)}inOrderSuccessor(o){for(;null!=o.leftNode;)o=o.leftNode;return o}}var vr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};let co=(()=>{class k{static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static addCompositionToTree(e){const t=new vi(e.id,e,null,null);this.addNodeToTree(t)}static getNodeFromTree(e){return vr(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(e,this.root):null})}static removeNodeFromTree(e){return vr(this,void 0,void 0,function*(){this.root&&(this.root=this.root.removeNode(this.root,e))})}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}return k.root=null,k})();var wl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ko(k,o,e,t){return wl(this,arguments,void 0,function*(l,u,v,L,g=[]){var i,n;let S={};const O=[];if(0==l)return"";let K=mi(v,l);if(null!=K&&0!=K.id||null==l||null==l||(K=yield(0,Ne.A)(l)),0!=K.id&&null==K.type){const j=K.typeId;let ae=mi(v,j);K.type=ae,null==ae&&null!=j&&null!=j&&(ae=yield(0,Ne.A)(j),K.type=ae)}if(!L.includes(l))return K?.characterValue;if(g.includes(l))return"";g.push(l);for(let j=0;j<u.length;j++)if(u[j].ofTheConceptId==l){const ae=u[j].toTheConceptId;if(L.includes(l)){let Ie=mi(v,ae);if(null!=Ie&&0!=Ie.id||null==ae||null==ae||(Ie=yield(0,Ne.A)(ae)),0!=Ie.id&&null==Ie?.type){const Be=Ie.typeId;let ut=yield N.I.GetConcept(Be);Ie.type=ut,null==ut&&null!=Be&&null!=Be&&(ut=yield(0,Ne.A)(Be),Ie.type=ut)}const tt=(null!==(n=null===(i=Ie?.type)||void 0===i?void 0:i.characterValue)&&void 0!==n?n:"").replace("the_","");if(isNaN(Number(tt))){if(tt){const Be=yield ko(ae,u,v,L,g);S[tt]=Be}}else{const Be=yield ko(ae,u,v,L,g);O[tt]=Be,S=O}}}return S})}function mi(k,o){let e=(0,ke.o)();for(let t=0;t<k.length;t++)if(o==k[t].id)return e=k[t],e;return e}class Do{constructor(){this.id=0,this.mainConcept=(0,ke.o)(),this.connections=[],this.concepts=[],this.subcompositions=[],this.cached={}}updateCache(){return o=this,t=function*(){if(0==this.mainConcept.id)for(let l=0;l<this.concepts.length;l++)this.concepts[l].id==this.id&&(this.mainConcept=this.concepts[l]);this.cached=yield ko(this.id,this.connections,this.concepts,this.subcompositions,[])},new((e=void 0)||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(o,[])).next())});var o,e,t}UpdateAcrossDistributedSystem(){var o,e;try{0!=this.id&&(e=null===(o=this.id)||void 0===o?void 0:o.toString(),a.B.MQTT_CONNECTION&&a.B.MQTT_CONNECTION.publish("compositionUpdate",e))}catch(t){console.log("Error while publishing message",t)}}isUpdating(){this.UpdateAcrossDistributedSystem()}GetDataCache(){var o,e,t;const l={};l[null!==(t=null===(e=null===(o=this.mainConcept)||void 0===o?void 0:o.type)||void 0===e?void 0:e.characterValue)&&void 0!==t?t:""]=this.cached;const u={};return u.data=l,u.id=this.id,u}}var Il=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Go(k){return Il(this,arguments,void 0,function*(o,e=null,t=null,l=null,u=null,v=null,L=null,g=null){const i=u??999,n=v??4,S=L??999;let O=l??0,K=(0,ke.o)();null==g&&(g=new Do);for(const j in o)if("object"==typeof o[j]||Array.isArray(o[j])){const ae=yield(0,at.A)(j,"",!0,i,n,S);if(null==e&&null==t){let Ie=O;K=ae,Ie=ae.id,O=ae.id,g.concepts.push(ae),g.id=ae.id,yield Go(o[j],ae.id,ae.userId,Ie,u,v,L,g)}else{const Ie=e??999,Ge=t??999,tt=O;K=ae,g.concepts.push(ae);const Be=yield(0,Ke.q)(Ie,Ge,ae.id,tt);g.connections.push(Be),yield Go(o[j],ae.id,ae.userId,tt,u,v,L,g)}null!=o[j]&&null!=o[j]&&g.subcompositions.push(ae.id)}else{const ae=e??999,Ie=t??999,Ge=O,tt=yield(0,at.A)(j,o[j],!1,i,n,S);g.concepts.push(tt);const Be=yield(0,Ke.q)(ae,Ie,tt.id,Ge);g.connections.push(Be)}return K})}var kl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function mr(k){return kl(this,void 0,void 0,function*(){const o=Te.V.logfunction("UpdateComposition")||{};if(Tt){o.serviceWorker=!0;try{const Be=yield Gt("UpdateComposition",{patcherStructure:k});return Te.V.logUpdate(o),Be.data}catch(Be){console.error("UpdateComposition sw error: ",Be),(0,d.ey)(o,"UpdateComposition",Be),Ot(Be)}}const e=k.userId,t=k.sessionId,l=k.accessId;let u=[];const v=[];let L=(0,ke.o)(),g=(0,ke.o)();const i=[];let n=k.compositionId;const S=k.ofTheCompositionId;let O=[];if(n<0){let Be=yield(0,Ne.A)(n,e);if(!(Be.id>0))return null;n=Be.id}u=yield(0,de.s)(n);const K=[],j=new Do,ae=[];j.id=n,j.isUpdating();let Ie=[];for(let Be=0;Be<u.length;Be++)(0,gi.A)(ae,u[Be].ofTheConceptId),(0,gi.A)(K,u[Be].ofTheConceptId),(0,gi.A)(K,u[Be].toTheConceptId),Ie.push(u[Be].ofTheConceptId);j.subcompositions=ae,j.connections=u;for(let Be=0;Be<K.length;Be++){const ut=yield(0,Ne.A)(K[Be]);n==K[Be]&&(L=ut),S==K[Be]&&(g=ut),v.push(ut)}const Ge=k.patchObject;for(const Be in Ge){let ut=(0,ke.o)();const xt=Ge[Be];let Mt=L;if(g.id>0&&(Mt=g),Array.isArray(xt)||"object"==typeof xt){ut=yield(0,at.A)(Be,"",!0,L.userId,4,999),j.subcompositions.push(ut.id);const Qt=(0,Ho.vo)(v,ut);for(let rn=0;rn<Qt.length;rn++)if(Qt[rn].id>0){const Bn=(0,Ho.wS)(j.connections,Qt[rn].id);O=O.concat(Bn),i.push(Qt[rn])}yield Go(Ge[Be],ut.id,ut.userId,L.id,L.userId,4,999,j)}else{ut=yield(0,at.A)(Be,xt,!1,e,l,t);const Qt=(0,Ho.vo)(v,ut);for(let rn=0;rn<Qt.length;rn++)if(Qt[rn].id>0){const Bn=(0,Ho.wS)(j.connections,Qt[rn].id);O=O.concat(Bn),i.push(Qt[rn])}}const Ht=(0,Ke.q)(Mt.id,Mt.userId,ut.id,L.id);v.push(ut),j.connections.push(Ht)}for(let Be=0;Be<O.length;Be++)Tl(j.connections,O[Be]),(0,Me.m)(O[Be].id);for(let Be=0;Be<i.length;Be++)_l(v,i[Be]);j.concepts=j.concepts.concat(v),j.mainConcept=L,j.id=L.id,yield j.updateCache(),co.addCompositionToTree(j),ue.Y.SyncDataOnline();let tt=j.GetDataCache();return Te.V.logUpdate(o),tt})}var bl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Cr(k,o,e,t){return bl(this,arguments,void 0,function*(l,u,v,L,g=10,i=1){var n=(0,r.ab)("application/x-www-form-urlencoded",L),S=new URLSearchParams;S.append("type",l),S.append("search",u),S.append("composition",v),S.append("inpage",g.toString()),S.append("page",i.toString());const O=a.B.SearchCompositionsUrl()+"?"+S.toString();try{const K=yield fetch(O,{method:"GET",headers:n});return K.ok?yield K.json():((0,d.ry)(K),[])}catch(K){console.log("This is the searching error",K),(0,d.Mb)(K,O)}})}var Al=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function _r(k){return Al(this,arguments,void 0,function*(o,e=""){var t=(0,r.ab)("application/json",e);const l=a.B.SearchLinkMultipleAll(),u=JSON.stringify(o);try{const v=yield fetch(l,{method:"POST",headers:t,body:u});return v.ok?yield v.json():(console.log("This is the searching error",v.status),(0,d.ry)(v),[])}catch(v){console.log("This is the searching error",v),(0,d.Mb)(v,l)}})}var Tr=_(7139),Uo=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function wr(k){return Uo(this,arguments,void 0,function*(o,e=[]){var t,l;let u=[];const v=[];let L={},g={};const i=yield co.getNodeFromTree(o),n=[];let S=yield N.I.GetConcept(o);if(0==S.id&&null!=o&&null!=o&&(S=yield(0,Tr.r)(o)),null==i){let O=[];O=e.length>0?Ir(o,e):yield(0,de.s)(o),u=O;for(let j=0;j<u.length;j++)n.includes(u[j].ofTheConceptId)||(n.push(u[j].ofTheConceptId),v.push(u[j].ofTheConceptId)),v.includes(u[j].toTheConceptId)||v.push(u[j].toTheConceptId);br(S,u,v,n);let K=[];g=yield(0,m.zN)(o,u,n,K),L[null!==(l=null===(t=S?.type)||void 0===t?void 0:t.characterValue)&&void 0!==l?l:""]=g}else g=i.value.GetDataCache(),L=g;return 0==S.id?"":L})}function Ir(k,o){const e=[];for(let t=0;t<o.length;t++)o[t].typeId==k&&e.push(o[t]);return e}function Ci(k){return Uo(this,arguments,void 0,function*(o,e=[]){var t,l;let u={},v=[];const L=[];let g;const i={},n=yield co.getNodeFromTree(o),S=[];let O=yield N.I.GetConcept(o);if(0==O.id&&null!=o&&null!=o&&(O=yield(0,Tr.r)(o)),null==n){let K=[];K=e.length>0?Ir(o,e):yield(0,de.s)(o),v=K;for(let j=0;j<v.length;j++)S.includes(v[j].ofTheConceptId)||(S.push(v[j].ofTheConceptId),L.push(v[j].ofTheConceptId)),L.includes(v[j].toTheConceptId)||L.push(v[j].toTheConceptId);br(O,v,L,S),g=yield(0,m.zN)(o,v,S),i[null!==(l=null===(t=O?.type)||void 0===t?void 0:t.characterValue)&&void 0!==l?l:""]=g,u.created_at=O.entryTimeStamp,u.data=i,u.id=o}else g=n.value.GetDataCache(),u=g;return 0==O.id?"":u})}function kr(k,o){return Uo(this,void 0,void 0,function*(){let e=[];const t=[];e=yield(0,jo.j)(o);for(let l=0;l<k.length;l++){const u=yield Ci(k[l],e);u&&t.push(u)}return t})}function br(k,o,e,t){return Uo(this,void 0,void 0,function*(){const l=new Do,u=yield function(L){return Uo(this,void 0,void 0,function*(){let g=[];const i=[];for(let n=0;n<L?.length;n++){const S=yield N.I.GetConcept(L[n]);0==S.id?i.push(L[n]):g.push(S)}return 0==i?.length||(g=yield(0,Io.I)(i)),g})}(e);l.connections=o,l.concepts=u,l.id=k.id,l.subcompositions=t,l.mainConcept=k;const v=yield ko(k.id,o,u,t,[]);l.cached=v,co.addCompositionToTree(l)})}var Ll=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Ar(k){return Ll(this,void 0,void 0,function*(){try{var o=(0,r.Xr)();const e=JSON.stringify(k),t=yield fetch(a.B.CreateSessionId(),{method:"POST",headers:o,body:e});return t.ok?t.json():(console.log("Creating session failed",yield t.json()),(0,d.ry)(t),null)}catch(e){console.log("Creating session failed",e),(0,d.Mb)(e,a.B.CreateSessionId())}})}var Nl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Lr(k,o){return Nl(this,void 0,void 0,function*(){try{var e=(0,r.Xr)("application/x-www-form-urlencoded");const t=new URLSearchParams;t.append("sessionId",k.toString()),t.append("url",o);const l=yield fetch(a.B.CreateSessionVisitUrl(),{method:"POST",headers:e,body:t});return l.ok?l.json():(console.log("Creating session url failed",yield l.json()),(0,d.ry)(l),null)}catch(t){console.log("Creating session url failed",t),(0,d.Mb)(t,a.B.CreateSessionVisitUrl())}})}var Sl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Nr(k,o,e){return Sl(this,arguments,void 0,function*(t,l,u,v=10,L=1){let g=[];try{var i=new URLSearchParams;i.append("typeId",`${t}`),i.append("toTheConceptId",`${l}`),i.append("userId",`${u}`),i.append("inpage",`${v}`),i.append("page",`${L}`);var n=(0,r.Xr)("application/x-www-form-urlencoded");const S=yield fetch(a.B.GetAllConnectionsToConceptUrl(),{method:"POST",headers:n,body:i});return S.ok?g=yield S.json():(console.log("Get connection of concept error",S.status),(0,d.ry)(S)),g}catch(S){throw S instanceof Error?console.log("Get connection of concept  error message: ",S.message):console.log("Get connection of concept unexpected error: ",S),S}})}var Sr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function _i(k,o){var e=arguments;return Sr(this,arguments,void 0,function*(t,l,u=10,v=1,L=!1){const g=Te.V.logfunction("GetRelation",e)||{};if(Tt){g.serviceWorker=!0;try{const j=yield Gt("GetRelation",{id:t,relation:l,inpage:u,page:v,reverse:L});return Te.V.logUpdate(g),j.data}catch(j){console.error("GetRelation error sw: ",j),(0,d.ey)(g,"GetRelation",j),Ot(j)}}let i=[],n=yield(0,Ne.A)(t),S=yield Zn(l),O=[];if(S.id>0)if(L){O=yield Nr(S.id,n.id,n.userId,u,v);let j=[];for(var K=0;K<O.length;K++)j.push(O[K].ofTheConceptId);yield(0,T.Y)(j);for(let ae=0;ae<O.length;ae++){let Ie=O[ae].ofTheConceptId,Ge=yield(0,Ne.A)(Ie),tt=yield(0,m.Ez)(Ge.id);i.push(tt)}}else{O=yield De(S.id,n.id,n.userId,u,v);let j=[];for(let ae=0;ae<O.length;ae++)j.push(O[ae].toTheConceptId);yield(0,T.Y)(j);for(let ae=0;ae<O.length;ae++){let Ie=O[ae].toTheConceptId,Ge=yield(0,Ne.A)(Ie),tt=yield(0,m.Ez)(Ge.id);i.push(tt)}}return Te.V.logUpdate(g),i})}function xr(k,o){var e=arguments;return Sr(this,arguments,void 0,function*(t,l,u=10,v=1,L=!1){const g=Te.V.logfunction("GetRelationRaw",e)||{};if(Tt){g.serviceWorker=!0;try{const ae=yield Gt("GetRelationRaw",{id:t,relation:l,inpage:u,page:v,reverse:L});return Te.V.logUpdate(g),ae.data}catch(ae){console.error("GetRelationRaw error sw: ",ae),(0,d.ey)(g,"GetRelationRaw",ae),Ot(ae)}}let i=[],n=yield(0,Ne.A)(t),S=yield Zn(l),O=[],K=[];if(S.id>0){if(L){O=yield Nr(S.id,n.id,n.userId,u,v);for(var j=0;j<O.length;j++)K.push(O[j].ofTheConceptId)}else{O=yield De(S.id,n.id,n.userId,u,v);for(let ae=0;ae<O.length;ae++)K.push(O[ae].toTheConceptId)}i=yield(0,Io.r)(K)}return Te.V.logUpdate(g),i})}var Ti=_(6416),jn=_(4711);class xl{constructor(o,e,t,l){this.value=[],this.height=1,this.key=o,this.value.push(e),this.leftNode=t,this.rightNode=l}addNode(o,e,t){if(null==e)return o;var u=e.rightNode;if(e.key>o.key)e.leftNode=this.addNode(o,e.leftNode,t);else{if(!(e.key<o.key))return e.value.push(...o.value),e;e.rightNode=this.addNode(o,u,t)}e.height=1+Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode));let v=this.getBalanceFactor(e);if(v>1&&e.leftNode){if(o.key<e.leftNode.key)return this.rightRotate(e);if(o.key>e.leftNode.key)return e.leftNode=this.leftRotate(e.leftNode),this.rightRotate(e)}if(v<-1&&e.rightNode){if(o.key>e.rightNode.key)return this.leftRotate(e);if(o.key<e.rightNode.key)return e.rightNode=this.rightRotate(e.rightNode),this.leftRotate(e)}return e}rightRotate(o){if(o){let e=o.leftNode;if(e)return o.leftNode=e.rightNode,e.rightNode=o,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,e}return o}leftRotate(o){if(o){let e=o.rightNode;if(e){let t=e.leftNode;return e.leftNode=o,o.rightNode=t,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(o.rightNode))+1,e}}return o}getHeight(o){return o?o.height:0}getBalanceFactor(o){return null==o?0:this.getHeight(o.leftNode)-this.getHeight(o.rightNode)}getFromNode(o,e){return e&&(o==e.key?e:o<e.key?this.getFromNode(o,e.leftNode):o>e.key?this.getFromNode(o,e.rightNode):e)}removeNode(o,e){if(null==o)return o;if(o.key>e)return o.leftNode=this.removeNode(o.leftNode,e),o;if(o.key<e)return o.rightNode=this.removeNode(o.rightNode,e),o;if(null==o.leftNode){let l=o.rightNode;return o=null,l}if(null==o.rightNode){let l=o.leftNode;return o=null,l}var t=this.inOrderSuccessor(o.rightNode);return o.value=t.value,o.key=t.key,o.rightNode=this.removeNode(o.rightNode,t.key),o}countNodeBelow(o){return null==o?0:1+this.countNodeBelow(o.leftNode)+this.countNodeBelow(o.rightNode)}inOrderSuccessor(o){for(;null!=o.leftNode;)o=o.leftNode;return o}}var wi=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};let qo=(()=>{class k{static compositeKey(e,t){return("0000"+e.toString(16).toUpperCase()).slice(-4)+("0000"+t.toString(16).toUpperCase()).slice(-4)}static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static waitForDataToLoad(){return wi(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.checkFlag(e),setTimeout(()=>{t("not")},25e3)})})}static checkFlag(e){if(c.B.isDataLoaded)return e("done");setTimeout(k.checkFlag,1e3,e)}static addConceptToTree(e,t,l=999){let u=this.compositeKey(t,l);var v=new xl(u,e,null,null);this.addNodeToTree(v)}static getNodeFromTree(e,t){return wi(this,void 0,void 0,function*(){let l=this.compositeKey(e,t);return this.root?this.root.getFromNode(l,this.root):null})}static removeNodeFromTree(e){return wi(this,arguments,void 0,function*(t,l=999){if(this.root){let u=this.compositeKey(t,l);this.root=this.root.removeNode(this.root,u)}})}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}return k.root=null,k})();var Fr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Er(k,o){return Fr(this,arguments,void 0,function*(e,t,l=999){let u=yield qo.getNodeFromTree(e,l),v=(0,Ti.u)();if(u)for(let L=0;L<u.value.length;L++){let g=u.value[L];g.ghostId==t&&(v=g)}return v})}function Br(k,o){return Fr(this,arguments,void 0,function*(e,t,l=999){qo.addConceptToTree(e,t,l)})}var so=_(5312),Ii=_(1213),Dr=_(3729),Fl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},El=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Gr(k,o,e){return El(this,void 0,void 0,function*(){try{if(Tt)try{return(yield Gt("GetRelationLocal",{id:k,relation:o,userId:e})).data}catch(v){console.error("GetRelationLocal error sw: ",v),Ot(v)}let t=yield(0,s.$I)(o),l=[];0!=t.id&&(l=yield function(v,L){return Fl(this,void 0,void 0,function*(){try{return yield D.G.GetConnectionOfCompositionAndTypeLocal(L,v)}catch(g){throw g}})}(k,t.id));let u=[];for(let v=0;v<l.length;v++){let L=yield V(l[v].toTheConceptId);u.push(L)}return u}catch(t){throw t}})}var Bl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ki(k){return Bl(this,void 0,void 0,function*(){let o=[];try{var e=(0,r.Xr)();const t=yield fetch(a.B.ViewInternalDataUrl(),{method:"POST",headers:e,body:JSON.stringify(k)});if(t.ok){let l=yield t.json(),u={};for(let v=0;v<l.length;v++){o=l[v].connections;let g=l[v].id;(0,Io.r)(l[v].concepts),u[g]=o}return u}return console.log("View Internal Data error",t.status),(0,d.ry)(t),o}catch(t){throw t instanceof Error?console.log(" This is the view internal data error message: ",t.message):console.log(" This is the view internal data unexpected error: ",t),t}})}var Dl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function bi(k){return Dl(this,void 0,void 0,function*(){var o;try{let e=yield ki(k),t=[];for(let l=0;l<k.length;l++){let u=k[l],v=e[u];if(u&&v){let L=[],g={};for(let n=0;n<v.length;n++)L.includes(v[n].ofTheConceptId)||L.push(v[n].ofTheConceptId);let i=yield(0,m.zN)(u,v,L);g.data=i,g.id=u,t.push(g)}else{let L={};L.id=u;let g=yield(0,Ne.A)(u),i={};g.type&&(i[null===(o=g?.type)||void 0===o?void 0:o.characterValue]=g.characterValue,L.data=i,t.push(L))}}return t}catch(e){throw e}})}var Jo=_(176),Ur=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},Rr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Or(k){return Rr(this,arguments,void 0,function*(o,e=""){try{let t=yield function(l){return Ur(this,arguments,void 0,function*(u,v=""){var L=(0,r.ab)("application/json",v);let g=a.B.SearchInternalWithAuthenticatedCcsUrl();g=g+"?composition="+u.composition+"&search="+u.search+"&internalComposition="+u.internalComposition+"&type="+u.type+"&inpage="+u.inpage+"&page="+u.page;try{const i=yield fetch(g,{method:"GET",headers:L});return i.ok?yield i.json():(console.log("This is the searching internal error",i.status),(0,d.ry)(i),[])}catch(i){console.log("This is the searching internal error",i),(0,d.Mb)(i,g)}})}(o,e);return yield bi(t)}catch(t){throw t}})}function Mr(k){return Rr(this,arguments,void 0,function*(o,e=""){try{return yield function(t){return Ur(this,void 0,void 0,function*(){var l=(0,r.ab)("application/json","");let u=a.B.SearchInternalWithCcsUrl();u=u+"?composition="+t.composition+"&search="+t.search+"&internalComposition="+t.internalComposition+"&type="+t.type+"&inpage="+t.inpage+"&page="+t.page;try{const v=yield fetch(u,{method:"GET",headers:l});return v.ok?yield v.json():(console.log("This is the searching internal error",v.status),(0,d.ry)(v),[])}catch(v){console.log("This is the searching internal error",v),(0,d.Mb)(v,u)}})}(o)}catch(t){throw t}})}var Ai=_(8095),Gl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Pr(k){return Gl(this,void 0,void 0,function*(){if(Tt)try{return(yield Gt("DeleteConceptLocal",{id:k})).data}catch(e){console.error("DeleteConceptLocal error sw: ",e),Ot(e)}let o=yield(0,Ii.f)(k);b.v.RemoveConcept(o)})}var Wr=_(2803),Ul=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Vr(k,o,e,t){return Ul(this,arguments,void 0,function*(l,u,v,L,g=!0){var i,n;const S=Te.V.logfunction("GetConnectionBetweenTwoConceptsLinker")||{};if(Tt){S.serviceWorker=!0;try{const j=yield Gt("GetConnectionBetweenTwoConceptsLinker",{ofTheConcept:l,toTheConcept:u,linker:v,fullLinker:L,forward:g});return Te.V.logUpdate(S),j.data}catch(j){console.error("GetConnectionBetweenTwoConceptsLinker sw error: ",j),(0,d.ey)(S,"GetConnectionBetweenTwoConceptsLinker",j),Ot(j)}}let O=(0,ke.o)();if(""!=v){let j="";j=g?(null===(i=l.type)||void 0===i?void 0:i.characterValue)+"_s_"+v+"_s":(null===(n=u.type)||void 0===n?void 0:n.characterValue)+"_s_"+v+"_by",O=yield(0,at.A)("connection",j,!1,999)}""!=L&&(O=yield ro(L,999));let K=[];return K=g?yield(0,Wr.x)(l.id,u.id,O.id):yield(0,Wr.x)(u.id,l.id,O.id),Te.V.logUpdate(S),K})}function $r(k,o){return new Promise((e,t)=>{setTimeout(()=>{e(o)},k)})}var Dt=_(3130);const jr=3,Hr=4,qr=5;var Rl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Li(k,o){return Rl(this,arguments,void 0,function*(e,t,l=""){let u=a.B.SearchAllTypeWithLinker(e.auth);var v=(0,r.ab)("application/json",l);u=u+"?search="+e.search+"&type="+e.type+"&inpage="+e.inpage+"&page="+e.page;const L=JSON.stringify(t);try{const g=yield fetch(u,{method:"POST",headers:v,body:L});return g.ok?yield g.json():((0,d.ry)(g),console.log("This is the searching multiple error",g.status),[])}catch(g){console.log("This is the searching SearchWithTypeAndLinker error",g),(0,d.Mb)(g,u)}})}var to=_(4287);class Ni extends to.w{constructor(o,e,t=Dt.y0){super(),this.searchQuery=[],this.format=Dt.y0,this.searchQuery=o,this.format=t}bind(){return o=this,t=function*(){return this.data=yield(0,so.cf)(this.searchQuery,"",this,this.format),this.mainConcept=this.searchQuery[0].composition,this.listenToEvent(this.mainConcept),console.log("this is the data",this.data),this.data},new((e=void 0)||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(o,[])).next())});var o,e,t}}function Jr(k,o,e=Dt.y0){return new Ni(k,o??"",e)}var zr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Ol extends to.w{constructor(o,e=Dt.ZJ){super(),this.id=o,this.format=e}bind(){return zr(this,void 0,void 0,function*(){if(!this.isDataLoaded){let o=yield(0,m.hL)(this.id);this.mainConcept=this.id,this.compositionIds=o.compositionList;let e=o.connectionList;for(let t=0;t<e.length;t++)this.internalConnections.push(e[t].id);this.isDataLoaded=!0,this.listenToEvent(this.mainConcept)}return yield this.build()})}build(){return zr(this,void 0,void 0,function*(){let o=[],e=this.internalConnections;for(let t=0;t<e.length;t++)o.push(yield In.d.GetConnection(e[t]));return this.data=this.format==Dt.ZJ?yield(0,m.ay)(this.mainConcept,o,this.compositionIds):this.format==Dt.y0?yield(0,m.$V)(this.mainConcept,o,this.compositionIds):this.format==Dt.yv?yield(0,m.re)(this.mainConcept,o,this.compositionIds):yield(0,m.ay)(this.mainConcept,o,this.compositionIds),this.data})}}function Zr(k,o=Dt.ZJ){return new Ol(k,o)}var Qr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Ml extends to.w{constructor(o,e,t,l,u){super(),this.data=[],this.startPage=0,this.compositionName=o,this.userId=e,this.inpage=t,this.page=l,this.format=u}bind(){return Qr(this,void 0,void 0,function*(){if(!this.isDataLoaded){var o=yield(0,y.A)(this.compositionName);if(o){yield C(this.compositionName,this.userId);let l=yield N.I.GetConceptsByTypeIdAndUser(o.id,this.userId);for(var e=this.inpage*(this.page-1),t=e;t<e+this.inpage;t++)l[t]&&this.compositionIds.push(l[t].id)}yield(0,T.Y)(this.compositionIds),this.isDataLoaded=!0,this.listenToEventType(o.id);for(let l=0;l<this.compositionIds.length;l++)this.listenToEvent(this.compositionIds[l])}return yield this.build()})}build(){return Qr(this,void 0,void 0,function*(){if(this.data=[],this.format==Dt.ZJ){for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,m.kx)(this.compositionIds[o]);this.data.push(e)}}else if(this.format==Dt.y0){for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,m.RW)(this.compositionIds[o]);this.data.push(e)}}else if(this.format==Dt.yv){for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,m.XI)(this.compositionIds[o]);this.data.push(e)}}else for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,m.kx)(this.compositionIds[o]);this.data.push(e)}return this.data})}}function Kr(k,o,e,t,l=Dt.ZJ){return new Ml(k,o,e,t,l)}var lo=_(7106),Yr=_(5328),Si=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Pl extends to.w{constructor(o,e,t="",l){super(),this.searchText="",this.connections=[],this.externalConnectionIds=[],this.data=[],this.mainConcept=o,this.searchLinkers=e,this.textSearch=t,l&&(this.format=l)}listenToEvent(o){window.addEventListener(`${o}`,e=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let t=this;setTimeout(function(){return Si(this,void 0,void 0,function*(){let l=yield In.d.GetConnectionByOfTheConceptAndType(o,o);for(let u=0;u<l.length;u++)yield In.d.GetConnection(l[u]).then(v=>{v.typeId==t.mainConcept?t.internalConnections.includes(v.id)||t.internalConnections.push(v.id):t.linkers.includes(v.id)||t.linkers.push(v.id),t.conceptIds.includes(v.toTheConceptId)||t.conceptIds.push(v.toTheConceptId),t.compositionIds.includes(v.ofTheConceptId)||t.compositionIds.push(v.ofTheConceptId),t.compositionIds.includes(v.toTheConceptId)||t.compositionIds.push(v.toTheConceptId)});t.isUpdating=!1,yield t.bind(),t.notify()})},200)}})}bind(){return Si(this,void 0,void 0,function*(){if(!this.isDataLoaded){this.isDataLoaded=!0;const o=yield li(this.mainConcept,this.searchLinkers,this.textSearch);this.compositionIds=o.compositionIds||[],this.internalConnections=o.internalConnections||[],this.externalConnectionIds=o.externalConnections||[],this.linkers=this.externalConnectionIds,this.connections=yield(0,jo.j)(this.externalConnectionIds);for(let e=0;e<this.compositionIds.length;e++)this.listenToEvent(this.compositionIds[e]);this.listenToEvent(this.mainConcept)}return yield this.build()})}build(){return Si(this,void 0,void 0,function*(){return this.externalConnectionIds=this.linkers,this.data=this.format&&this.format==Dt.XZ?{compositionIds:this.compositionIds,internalConnections:this.internalConnections,externalConnections:this.externalConnectionIds}:yield(0,en.p8)(this.compositionIds,this.internalConnections),this.data})}}function Xr(k,o,e="",t){return new Pl(k,o,e,t)}var xi=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Wl extends to.w{constructor(o,e,t,l=Dt.y0){super(),this.searchQuery=[],this.format=Dt.y0,this.mainCompositionIds=[],this.searchCharacter="",this.token="",this.searchStructure=o,this.searchQuery=e,this.searchQuery[0].type=o.composition,this.searchCharacter=o.composition,this.format=l,this.token=sn.b.BearerAccessToken}listenToEventType(o){window.addEventListener(`${o}`,e=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let t=this;setTimeout(function(){return xi(this,void 0,void 0,function*(){let l=e;t.mainCompositionIds.includes(l?.detail)||(t.mainCompositionIds.unshift(l?.detail),t.conceptIds.push(l?.detail),t.listenToEvent(l?.detail),In.d.GetConnectionsOfConcept(l?.detail).then(u=>{for(let v=0;v<u.length;v++)t.linkers.push(u[v].id)})),t.isUpdating=!1,yield t.bind(),t.notify()})},200)}})}bind(){return xi(this,void 0,void 0,function*(){if(!this.isDataLoaded){this.isDataLoaded=!0;var o=yield(0,y.A)(this.searchCharacter);let e=yield Li(this.searchStructure,this.searchQuery,this.token);this.conceptIds=e.compositionIds,this.internalConnections=e.internalConnections,this.linkers=e.linkers,this.reverse=e.reverse,this.mainCompositionIds=e.mainCompositionIds,this.listenToEventType(o.id);for(let t=0;t<this.mainCompositionIds.length;t++)this.listenToEvent(this.mainCompositionIds[t])}return yield this.build()})}build(){return xi(this,void 0,void 0,function*(){return yield(0,Io.r)(this.conceptIds),this.data=this.format==Dt.y0?yield(0,lo.yV)(this.linkers,this.conceptIds,this.internalConnections,this.mainCompositionIds,this.reverse):yield(0,lo._W)(this.linkers,this.conceptIds,this.internalConnections,this.mainCompositionIds,this.reverse),this.data})}}function ea(k,o,e,t=Dt.y0){return new Wl(k,o,e,t)}var ta=_(2615);class na{constructor(o,e,t,l,u,v,L,g=!1,i,n,S){this.structureType="lconcept",this.isComposition=!1,this.isTemp=!1,this.isSynced=!1,this.applicationId=a.B.getRandomizer(),this.id=o,this.userId=e,this.typeId=t,this.ghostId=o,this.categoryId=l,this.characterValue=v,this.accessId=u,this.type=null,this.isNew=g,this.typeCharacter=L,this.entryTimeStamp=i,this.updatedTimeStamp=n,this.isSynced=!1,this.referentId=S}getType(){console.log(this.typeId)}}class oa{constructor(o,e,t,l,u,v){this.isTemp=!1,this.applicationId=a.B.getRandomizer(),this.type=(0,ke.o)(),this.id=o,this.ofTheConceptId=e,this.toTheConceptId=t,this.typeId=l,this.ghostId=o,this.orderId=u,this.typeCharacter="",this.accessId=v,this.typeCharacter="",this.entryTimeStamp=new Date,this.terminationDateTime=new Date,this.localSyncTime=new Date}}class ia{constructor(){this.compositionId=0,this.userId=999,this.sessionId=999,this.accessId=4,this.ofTheCompositionId=0,this.patchObject={}}}class ra{constructor(){this.id="0",this.remote_address="",this.server_port="",this.server_address="",this.server_name="",this.server_software="",this.http_user_agent="",this.self="",this.port="",this.userId="",this.email=""}}var bo=_(628);class zo{constructor(){this.type="",this.search="",this.logicoperator="=",this.index=0,this.composition=!0,this.name="",this.operateon=""}}class aa{constructor(){this.type="",this.search="",this.composition="",this.internalComposition="",this.userId=999,this.inpage=10,this.page=1,this.auth=!0}}var ca=_(7887),sa=_(3075),Vl=_(7869),la=_(9635),Te=_(9700);class $l{static initialize(){try{console.warn("Initialized Application Monitoring for tracking errors..."),this.initGlobalErrorHandlers(),this.logCatchError(),this.logErrorEvent(),this.logUnhandledError(),this.logUserInteractions(),this.logNetworkRequests(),this.logRouteChanges(),this.logPerformanceMetrics(),this.logWebSocketEvents()}catch(o){console.error("Error during Application Monitoring initialization:",o)}}static initGlobalErrorHandlers(){try{if(console.log("this is the window",window),void 0===typeof window)return;const o=sn.b.sessionId||"unknown";window.onerror=(e,t,l,u,v)=>{const L={message:e,source:t,lineno:l,colno:u,stack:v?.stack||"undefined",requestFrom:a.B.BASE_APPLICATION,sessionId:o};Te.V.logApplication("ERROR","Runtime Error",L),Te.V.log("ERROR","Runtime Error",L)},window.onunhandledrejection=e=>{Te.V.logApplication("ERROR","Unhandled Promise Rejection",{message:e.reason?e.reason.message:e.reason,stack:e.reason?e.reason.stack:null,requestFrom:a.B.BASE_APPLICATION,sessionId:o}),Te.V.log("ERROR","Unhandled Promise Rejection",{message:e.reason?e.reason.message:e.reason,stack:e.reason?e.reason.stack:null,requestFrom:a.B.BASE_APPLICATION,sessionId:o})}}catch(o){console.warn("Failed to initialize global error handlers:",o)}}static logCatchError(){try{const o=console.error;console.log("Inside originalConsoleError...");const e=sn.b.sessionId||"unknown";console.error=function(...t){const l="Console Error",u={arguments:t.map(v=>da(v)),requestFrom:a.B.BASE_APPLICATION,sessionId:e};Te.V.logApplication("ERROR",l,u),Te.V.log("ERROR",l,u),o.apply(console,t)}}catch(o){console.warn("Failed to override console.error:",o)}}static logErrorEvent(){try{window.addEventListener("error",o=>{var e;console.log("Inside error event...");const t=sn.b.sessionId||"unknown",l={error:(null===(e=o.error)||void 0===e?void 0:e.message)||o.message,source:o.filename,line:o.lineno,column:o.colno,stack:o.error?da(o.error.stack):void 0,requestFrom:a.B.BASE_APPLICATION,sessionId:t},u="Unhandled Error";Te.V.logApplication("ERROR",u,l),Te.V.log("ERROR",u,l)})}catch(o){console.warn("Failed to add error event listener:",o)}}static logUnhandledError(){try{window.addEventListener("unhandledrejection",o=>{var e,t;console.log("Inside unhandledrejection...");const l=sn.b.sessionId||"unknown",u={reason:(null===(e=o.reason)||void 0===e?void 0:e.message)||String(o.reason),stack:(null===(t=o.reason)||void 0===t?void 0:t.stack)||"No stack trace available",requestFrom:a.B.BASE_APPLICATION,sessionId:l};Te.V.logApplication("ERROR","Unhandled Promise Rejection",u),Te.V.log("ERROR","Unhandled Promise Rejection",u)})}catch(o){console.warn("Failed to add unhandled rejection event listener:",o)}}static logUserInteractions(){document.addEventListener("click",o=>{var e;const t=sn.b.sessionId||"unknown",l=o.target,u={element:l.tagName,id:l.id,classes:l.className,text:null===(e=l.innerText)||void 0===e?void 0:e.slice(0,50),requestFrom:a.B.BASE_APPLICATION,sessionId:t};Te.V.logApplication("INFO","User Click",u)}),document.addEventListener("input",o=>{}),document.addEventListener("scroll",()=>{window})}static logNetworkRequests(){try{if(void 0===typeof window)return;const o=sn.b.sessionId||"unknown",e=window?.fetch;if(!e)throw new Error("Original fetch is not available.");const t=[a.B.PostLogger(),a.B.PostPrefetchConceptConnections()];window.fetch=(...l)=>{return u=this,L=function*(){const[g,i]=l,n=g instanceof Request?g.url:g instanceof URL?g.toString():g;if(t.includes(n))return console.log("Ignored URLs detected : ",n),e(...l);let S={request:{type:"REQUEST",message:"Network Request",method:i?.method||"GET",url:n,body:i?.body,requestFrom:a.B.BASE_APPLICATION,sessionId:o}};try{const O=yield e(...l);return S.response={type:"RESPONSE",message:"Network Response",url:n,status:O.status,requestFrom:a.B.BASE_APPLICATION,sessionId:o},O}catch(O){throw S.response={type:"ERROR",message:"Network Request Failed",url:n,error:O instanceof Error?O.message:String(O),requestFrom:a.B.BASE_APPLICATION,sessionId:o},Te.V.logApplication("ERROR","Failed Network Request",S),new Error(`Network request failed for ${n}: ${O.message}`)}},new((v=void 0)||(v=Promise))(function(g,i){function n(K){try{O(L.next(K))}catch(j){i(j)}}function S(K){try{O(L.throw(K))}catch(j){i(j)}}function O(K){var j;K.done?g(K.value):(j=K.value,j instanceof v?j:new v(function(ae){ae(j)})).then(n,S)}O((L=L.apply(u,[])).next())});var u,v,L}}catch(o){console.warn("Failed to override network requests:",o)}}static logPerformanceMetrics(){void 0!==typeof window&&window?.addEventListener("load",()=>{performance})}static logRouteChanges(){const o=history.pushState,e=sn.b.sessionId||"unknown";history.pushState=function(...t){var l;const u={url:null===(l=t[2])||void 0===l?void 0:l.toString(),requestFrom:a.B.BASE_APPLICATION,sessionId:e};return Te.V.logApplication("INFO","Route Change",u),o.apply(this,t)},window?.addEventListener("popstate",()=>{const t={url:location.href,requestFrom:a.B.BASE_APPLICATION,sessionId:e};Te.V.logApplication("INFO","Route Changed (Back/Forward)",t)})}static logWebSocketEvents(){if(void 0===typeof window)return;const o=sn.b.sessionId||"unknown",e=WebSocket;window.WebSocket=class extends e{constructor(t,l){super(t,l);const u={url:t.toString(),requestFrom:a.B.BASE_APPLICATION,sessionId:o};Te.V.logApplication("INFO","WebSocket Open",u),this.addEventListener("message",v=>{Te.V.logApplication("INFO","WebSocket Message",{url:t,data:v.data,requestFrom:a.B.BASE_APPLICATION,sessionId:o})}),this.addEventListener("error",v=>{const L={url:t,error:v instanceof Error?v.message:String(v),requestFrom:a.B.BASE_APPLICATION,sessionId:o};Te.V.logApplication("ERROR","WebSocket Error",L)}),this.addEventListener("close",()=>{Te.V.logApplication("INFO","WebSocket Closed",{url:t,requestFrom:a.B.BASE_APPLICATION,sessionId:o})})}}}}function da(k){try{return JSON.stringify(k,(o,e)=>e&&"object"==typeof e&&e instanceof Error?{message:e.message,stack:e.stack}:e)}catch{return"Error while serializing value"}}const ua=(k,o,...e)=>{return t=[k,o,...e],u=function*(v,L,g=!1){try{let i=a.B.sendMail();g&&(i=a.B.sendBulkMail());const n=yield fetch(i,{method:"POST",body:v instanceof FormData?v:JSON.stringify(v),headers:{"Content-Type":"application/json",Authorization:`Bearer ${L}`}}),S=n.headers.get("content-type");if(!n.ok){const K=yield n.json();return console.info(`${n.status} ${K}`),null}const O=yield n.json();return S&&S.includes("text/plain")?yield n.text():O}catch(i){return console.error(i),null}},new((l=void 0)||(l=Promise))(function(v,L){function g(S){try{n(u.next(S))}catch(O){L(O)}}function i(S){try{n(u.throw(S))}catch(O){L(O)}}function n(S){var O;S.done?v(S.value):(O=S.value,O instanceof l?O:new l(function(K){K(O)})).then(g,i)}n((u=u.apply(void 0,t||[])).next())});var t,l,u};class jl{constructor(){this.inDevelopment=!1,this.subscribers=[]}notify(o=null){this.subscribers.map(e=>{e(o||this.data)})}dataChange(o){this.subscribers.push(o)}}class Hl extends jl{constructor(){super(...arguments),this.element=null,this.elementIdentifier=0,this.widgetMounted=!1}getComponent(){return this.element}getElementById(o){let e=this.getComponent(),t=document.body;if(e){let l=e.querySelector("#"+o);if(l)return t=l,t}return null}createWidgetWrapperIdentifier(){return this.elementIdentifier=1e4*Math.random(),this.elementIdentifier.toString()}}class Zo extends Hl{constructor(){super(...arguments),this.html="",this.css="",this.js="",this.state={},this.previousState={},this.childWidgets=[],this.childWidgetElement=[],this.widgetState={},this.parentElement=""}querySelector(o){return this.element?this.element.querySelector(o):null}querySelectorAll(o){return this.element?this.element.querySelectorAll(o):null}getElement(){return this.element}setTitle(o){document.title=o}getHtml(){return this.html}UpdateChildData(o,e){let t=e;t.data=o,t.render(),t.update()}update(){}setState(o){this.previousState=Object.assign({},this),this.data=o,this.state=Object.assign({},this),this.hasStateChanged()&&(this.notify(),this.render())}setStateProperty(o){this.previousState=Object.assign({},this),Object.assign(this,o),this.state=Object.assign({},this),this.hasStateChanged()&&(this.notify(),this.render())}hasStateChanged(){return!this.isPropertyEqual(this.state,this.previousState)}isPropertyEqual(o,e){if(o===e)return!0;if("object"!=typeof o||"object"!=typeof e||null===o||null===e)return!1;const t=Object.keys(o),l=Object.keys(e);if(t.length!==l.length)return!1;for(let u of t){if(!l.includes(u))return!1;for(let v of l)if(u==v&&"state"!=u&&"previousState"!=u&&o[u]!=e[u])return!1}return!0}loadChildWidgets(){this.childWidgets.map(o=>{let e=this.getElementById(o.parentElement);e&&(e.innerHTML=""),o.mount(e)})}render(){this.element&&(this.element.innerHTML=this.getHtml()),this.loadChildWidgets(),this.after_render()}getElementByClassName(o){let e=this.getComponent();return e?e?.querySelectorAll("."+o):[]}mount_child(){}mount(o){return e=this,l=function*(){o&&(this.element=document.createElement("div"),this.element.id=this.createWidgetWrapperIdentifier(),this.element.innerHTML=this.getHtml(),this.element.classList.add("mftsccs-marking-rendered"),o.appendChild(this.element),this.parentElement=o.id,this.before_render(),this.mount_child(),this.widgetMounted=!0)},new((t=void 0)||(t=Promise))(function(u,v){function L(n){try{i(l.next(n))}catch(S){v(S)}}function g(n){try{i(l.throw(n))}catch(S){v(S)}}function i(n){var S;n.done?u(n.value):(S=n.value,S instanceof t?S:new t(function(O){O(S)})).then(L,g)}i((l=l.apply(e,[])).next())});var e,t,l}before_render(){this.render()}after_render(){console.log("this is calling the after render",this)}renderChildWidgets(){function o(e){var t;e&&(null===(t=e.childWidgets)||void 0===t||t.forEach(l=>{o(l)}),e.render())}console.log("this is the render child widget",this),this.childWidgets.forEach(e=>{o(e)})}setWidgetState(o,e){this.widgetState[o]=e,function t(l){l&&Array.isArray(l.childWidgets)&&l.childWidgets.forEach(u=>{u.widgetState=Object.assign(Object.assign({},u.widgetState),l.widgetState),t(u)})}(this),this.renderChildWidgets()}getWidgetState(o,e){return Object.keys.length&&this.widgetState[o]?this.widgetState[o]:e}}var uo=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Ro extends Zo{constructor(){super(...arguments),this.childComponents=[],this.componentMounted=!1,this.oldHtml=null,this.phonebooks=[],this.childrenData={},this.childWidgets=[],this.typeValueList=[],this.widgetType="the_element_name",this.parentConceptList=[],this.customFunctions=[]}getUserId(){return uo(this,void 0,void 0,function*(){return(yield new Promise(e=>{let t=(null==localStorage?void 0:localStorage.getItem("profile"))||"";t?e(JSON.parse(t)):e()}))?.userId})}getTypeValueList(){return uo(this,arguments,void 0,function*(o=""){return new Promise(e=>uo(this,void 0,void 0,function*(){const t=null==(o=this.widgetType)?void 0:o.match(/^[a-z0-9]+_[a-z0-9]+/i),l=t?t[0]:"",u=o?.match(/^([a-z0-9]+).*_([a-z0-9]+)$/i),v=u?`${u[1]}_${u[2]}`:"";let L=[],g=new zo;g.type=v,g.search="1",g.logicoperator=">",g.name="emailfilter",g.operateon="entityEmail",g.composition=!1,L.push(g);let i=new En;i.typeConnection=o,i.name="entityEmail";let n=new En;n.type=l,n.filterLogic="( emailfilter )",n.filters=L,n.name="top",n.inpage=100,n.freeschemaQueries=[i],n.outputFormat=Dt.y0,Oo(n,"").subscribe(S=>{if(S?.length){const O=S?.map(K=>{var j,ae,Ie,Ge,tt,Be,ut;const xt=null===(Ge=null===(Ie=null===(ae=null===(j=K.data)||void 0===j?void 0:j[l])||void 0===ae?void 0:ae[o])||void 0===Ie?void 0:Ie.data)||void 0===Ge?void 0:Ge[v];return{id:null===(ut=null===(Be=null===(tt=K.data)||void 0===tt?void 0:tt[l])||void 0===Be?void 0:Be[o])||void 0===ut?void 0:ut.id,name:xt,text:xt}});return this.typeValueList=O,e(O),O}})}))})}setTitle(o){document.title=o}getHtml(){return this.html}createRandomNumber(){return this.elementIdentifier=1e4*Math.random(),this.elementIdentifier}mount_child(){return uo(this,void 0,void 0,function*(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.mountChildWidgetsFunction}\n        }).call(this);\n      `).bind(this)(B)}catch(o){throw console.log("This is the error in the mount child",o),o}})}setProperty(o){return uo(this,void 0,void 0,function*(){return this.widgetType=o,this.getTypeValueList(this.widgetType).then(()=>{var e,t,l;null===(e=this.element)||void 0===e||e.setAttribute("data-type-value",this.widgetType),null===(l=null===(t=this.element)||void 0===t?void 0:t.parentElement)||void 0===l||l.setAttribute("data-type-value",this.widgetType),this.render()}),this})}createTypeEditor(o){!function(e,t){if(e){const l=document.querySelector("#widget-properties #widget-type"),u=l?.querySelectorAll("input");u?.forEach(S=>{S?.remove()});const v=e.target.closest(".added-widget-container"),L=e.target.closest("div");let g="";v?g=v?.getAttribute("data-type-value"):L&&(g=L?.getAttribute("data-type-value"));const i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("name","input-widgetTypeValue"),i.setAttribute("of",t.elementIdentifier.toString()),i.setAttribute("class","form-control"),i.setAttribute("id","widgetType"),i.setAttribute("onchange","updateWidgetTypeValue(event)"),t.widgetType?i.value=t.widgetType:i.setAttribute("placeholder","e.g. the_entity");let n=t;i.addEventListener("change",function(S){var O,K,j;const ae=null===(O=S?.target)||void 0===O?void 0:O.value;n.widgetType=ae,n.before_render(),n.loadChildWidgets(),null===(j=null===(K=n.element)||void 0===K?void 0:K.parentElement)||void 0===j||j.setAttribute("data-type-value",n.widgetType)}),l?.appendChild(i)}}(o,this)}mount(o){return uo(this,void 0,void 0,function*(){if(o){this.element=document.createElement("div"),this.element.id=this.createWidgetWrapperIdentifier();let e=this;this.inDevelopment?(this.element.onclick=function(t){t.preventDefault(),e.createTypeEditor(t)},this.element.className="mftsccs-marking-element"):this.element.classList.add("mftsccs-marking-rendered"),this.element.innerHTML=this.getHtml(),o?.setAttribute("data-type-value",e.widgetType),o.appendChild(this.element),this.parentElement=o.id,0==this.componentMounted||0==this.widgetMounted?(this.render_custom_functions(),this.before_render(),this.mount_child(),this.widgetMounted=!0,this.componentMounted=!0):this.render(),this.childWidgetElement=this.getElementByClassName("added-widget-container")}})}render_custom_functions(){var o;const e=null===(o=this.customFunctions)||void 0===o?void 0:o.map(t=>t?.code).join("");try{new Function("tsccs",`\n          return (async function() {\n            ${e}\n          }).call(this);\n        `).bind(this)(B)}catch(t){throw console.error("This is the error in the render_custom_functions",t),t}}before_render(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.componentDidMountFunction}\n        }).call(this);\n      `).bind(this)(B)}catch(o){throw console.log("This is the error in the before render",o),o}}after_render(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.addEventFunction}\n        }).call(this);\n      `).bind(this)(B)}catch(o){throw console.log("This is the error in the after render",o),o}}CreateConnectionBetweenEntityLocal(o,e,t){return uo(this,void 0,void 0,function*(){var l;const u=o.userId,v=(null===(l=o.type)||void 0===l?void 0:l.characterValue)+"_"+t,L=yield(0,_t.$)(v,999,999,u);return yield(0,jn.F)(o.id,e.id,L.id,1e3),"connection created"})}}var ql=_(3077),Sn=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Fi{constructor(){this.actions={concepts:[],connections:[]},this.success=!0,this.transactionId=Math.random().toString().substring(5)}initialize(){return Sn(this,void 0,void 0,function*(){yield bo.H.initializeTransaction(this.transactionId)})}commitTransaction(){return Sn(this,void 0,void 0,function*(){if(!this.success)throw Error("Query Transaction Expired");yield bo.H.SyncDataOnline(this.transactionId),this.actions={concepts:[],connections:[]},this.success=!1})}rollbackTransaction(){return Sn(this,void 0,void 0,function*(){this.success=!1,this.actions={concepts:[],connections:[]},yield bo.H.rollbackTransaction(this.transactionId,this.actions)})}markAction(){return Sn(this,void 0,void 0,function*(){yield bo.H.markTransactionActions(this.transactionId,this.actions)})}MakeTheInstanceConceptLocal(o,e){return Sn(this,arguments,void 0,function*(t,l,u=!1,v,L,g=999,i=0){try{if(!this.success)throw Error("Query Transaction Expired");const n=yield(0,Qe.k)(t,l,u,v,L,g,i,this.actions);return yield this.markAction(),n}catch(n){throw console.log(n),this.success=!1,n}})}MakeTheTypeConceptLocal(o,e,t,l){return Sn(this,void 0,void 0,function*(){try{if(!this.success)throw Error("Query Transaction Expired");const u=yield(0,_t.$)(o,e,t,l,this.actions);return yield this.markAction(),u}catch(u){throw console.log(u),this.success=!1,u}})}CreateTheConceptLocal(o,e,t,l,u,v){return Sn(this,arguments,void 0,function*(L,g,i,n,S,O,K=!1,j=0,ae={concepts:[],connections:[]}){try{if(!this.success)throw Error("Query Transaction Expired");const Ie=yield(0,ql.A)(L,g,i,n,S,O,K,j,this.actions);return yield this.markAction(),Ie}catch(Ie){throw console.log(Ie),this.success=!1,Ie}})}CreateConnectionBetweenTwoConceptsLocal(o,e,t){return Sn(this,arguments,void 0,function*(l,u,v,L=!1){try{if(!this.success)throw Error("Query Transaction Expired");const g=yield(0,Ai.h)(l,u,v,L,this.actions);return yield this.markAction(),g}catch(g){throw console.log(g),this.success=!1,g}})}CreateTheConnectionLocal(o,e,t){return Sn(this,arguments,void 0,function*(l,u,v,L=1,g="",i=999){try{if(!this.success)throw Error("Query Transaction Expired");const n=yield(0,jn.F)(l,u,v,L,g,i,this.actions);return yield this.markAction(),n}catch(n){throw console.log(n),this.success=!1,n}})}CreateConnection(o,e,t){return Sn(this,void 0,void 0,function*(){try{if(!this.success)throw Error("Query Transaction Expired");const l=yield(0,jn.d)(o,e,t,this.actions);return yield this.markAction(),l}catch(l){throw console.log(l),this.success=!1,l}})}CreateConnectionBetweenEntityLocal(o,e,t){return Sn(this,void 0,void 0,function*(){try{if(!this.success)throw Error("Query Transaction Expired");const l=yield Gi(o,e,t,this.actions);return yield this.markAction(),l}catch(l){throw console.log(l),this.success=!1,l}})}CreateTheCompositionLocal(o){return Sn(this,arguments,void 0,function*(e,t=null,l=null,u=null,v=null,L=null,g=null,i=!1){try{if(!this.success)throw Error("Query Transaction Expired");const n=yield(0,fe.R)(e,t,l,u,v,L,g,i,this.actions);return yield this.markAction(),n}catch(n){throw console.log(n),this.success=!1,n}})}}const ha={number:/^\d+(\.\d+)?$/,text:/^[\s\S]*$/,textOnly:/^[A-Za-z\s]+$/,email:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,document:/\.(pdf|docx?|pptx?|xlsx?)$/i,sound:/\.(mp3|wav|ogg|flac)$/i,image:/\.(jpg|jpeg|png|gif|bmp|svg|webp)$/i,video:/\.(mp4|avi|mov|mkv|flv|webm)$/i,url:/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/,date:/^\d{4}-\d{2}-\d{2}$/,time:/^(?:[01]\d|2[0-3]):[0-5]\d$/,password:/^.{6,}$/,ipaddress:/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^([0-9a-fA-F]{1,4}:){7}([0-9a-fA-F]{1,4})$/,uuid:/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/};var Ao=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Jt{constructor(){Jt.cacheInitialized||Jt.initializeAnomalyParameters()}static initializeAnomalyParameters(){return Ao(this,void 0,void 0,function*(){try{yield Jt.getAnomalyParameters(),Jt.refreshCache(),Jt.cacheInitialized=!0}catch(o){console.error("Error during anomaly parameter initialization:",o)}})}static getAnomalyParameters(){return Ao(this,void 0,void 0,function*(){const o=Date.now();if(Jt.anomalyParamsCache&&o-Jt.lastFetchedTime<Jt.cacheExpiryThreshold)return console.log("Returning cached anomaly parameters"),Jt.anomalyParamsCache;try{return yield Jt.fetchAnomalyParameters()}catch(e){throw console.error("Error fetching anomaly parameters:",e),e}})}static fetchAnomalyParameters(){return Ao(this,void 0,void 0,function*(){try{const o=yield fetch("https://devai.freeschema.com/v1/get-frontend-anomaly-parameters",{method:"GET",headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error("Failed to fetch anomaly parameters");const e=yield o.json();return Jt.anomalyParamsCache=e.data,Jt.lastFetchedTime=Date.now(),e.data}catch(o){throw console.error("API Fetch Error:",o),o}})}static refreshCache(){return Ao(this,void 0,void 0,function*(){try{Date.now()-Jt.lastFetchedTime>Jt.cacheExpiryThreshold&&(yield Jt.getAnomalyParameters())}catch(o){console.error("Error refreshing anomaly parameters cache:",o)}})}detectDataType(o){for(const[e,t]of Object.entries(ha))if(t.test(o))return e;return null}checkConceptAnomaly(o,e){return Ao(this,void 0,void 0,function*(){const t=[];try{if(!e)return t.push("Null value"),{valid:!1,warnings:t};const l=Jt.anomalyParamsCache;o.startsWith("the_")||(o=`the_${o}`);const u=l[o];if(console.log("Concept Details : ",u),!u)return console.warn(`No concept details found for type: ${o}`),t.push(`No concept details found for type: ${o}`),{valid:!1,warnings:t};const v=e.length,{min_length:L,max_length:g,data_types:i}=u,n=v>=L&&v<=g,S=this.detectDataType(e),O=i.includes(S);return n||t.push(`Length of '${e}' is outside the allowed range (min: ${L}, max: ${g}). Current length: ${v}.`),O||t.push(`Type mismatch for '${e}'. Expected types: ${i.join(", ")}, detected type: ${S}.`),n&&O&&t.push(`Concept ${o} is valid. Length: ${v}, Type: ${S}`),{valid:n&&O,warnings:t}}catch(l){return console.error(`Error checking anomaly for ${o} with value ${e}:`,l),{valid:!1,warnings:t}}})}static checkAnomalyInBulk(o){return Ao(this,void 0,void 0,function*(){Jt.cacheInitialized||(yield Jt.initializeAnomalyParameters());try{const e={};for(const[t,l]of Object.entries(o)){const u=l.value,{valid:v,warnings:L}=yield(new Jt).checkConceptAnomaly(t,u);e[t]={valid:v,warnings:L}}return e}catch(e){throw console.error("Bulk Anomaly Check Error:",e),e}})}static getExportedFunction(){console.log("Main : ",B);const o=Object.keys(B);return console.log("The exported List : ",o),o}static getFunctionaAnomalyParameters(){}}Jt.anomalyParamsCache=null,Jt.cacheInitialized=!1,Jt.lastFetchedTime=0,Jt.cacheExpiryThreshold=6e5;var Ei=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class pa{checkUniqueness(o,e){return Ei(this,void 0,void 0,function*(){const t=Te.V.logfunction("checkUniqueness");o.startsWith("the_")||(o="the_"+o);let l=(yield ro(o,999)).id,u=yield(0,It.A)(e,l);return console.log("This is the concept for validator",u),!(u.id>0||(Te.V.logUpdate(t),0))})}validateField(o){return Ei(this,void 0,void 0,function*(){var e;const t=Te.V.logfunction("validateField");try{performance.now();const l={},{name:u,value:v,type:L,dataType:g,pattern:i,conceptType:n,maxLength:S,minLength:O,minValue:K,maxValue:j,accept:ae,file:Ie,required:Ge,isUnique:tt}=o;if(console.log("Validation is happening on : \n",o),!Ge||null!==v&&""!==v||(l.required=`The field ${u} is required.`),g&&v){let Be=ha[g];Be&&""!==v&&!Be.test(v)&&(l.dataType=`Invalid value for ${g}`)}if(i&&v){const Be="string"==typeof i?new RegExp(i):i;""===v||Be.test(v)||(l.pattern="Pattern doesn't match with value")}if(v&&null!=S&&v.length>S&&(l.maxLength=`Length exceeds the maximum length of ${S}`),v&&null!=O&&v.length<O&&(l.minLength=`Length must be at least ${O} characters long`),null!=K&&v&&!isNaN(Number(v))&&Number(v)<K&&(l.minValue=`Value must be greater than or equal to ${K}`),null!=j&&v&&!isNaN(Number(v))&&Number(v)>j&&(l.maxValue=`Value must be less than or equal to ${j}`),Ie&&L&&ae){const Be=ae.split(",").map(xt=>xt.trim().toLowerCase()),ut=null===(e=Ie.name.split(".").pop())||void 0===e?void 0:e.toLowerCase();ut&&!Be.includes(ut)&&(l.accept=`File must be a valid file type: ${Be.join(", ")}`)}return n&&tt&&v&&((yield this.checkUniqueness(n,v))||(l.unique="Value is not unique")),Te.V.logUpdate(t),console.log("Before Validation Result : ",l),l}catch(l){throw(0,d.ey)(t,"Validator.validateField",l),l}})}validateForm(o){return Ei(this,void 0,void 0,function*(){const e=Te.V.logfunction("validateForm");try{performance.now();const t={};for(const l in o){const u=yield this.validateField(o[l]);Object.keys(u).length>0&&(t[l]=u)}return Te.V.logUpdate(e),t}catch(t){throw(0,d.ey)(e,"Validator.validateForm",t),t}})}validate(o){const e=Te.V.logfunction("validate");try{let t={};return this.validateField(o).then(l=>{Object.keys(l).length>0?(t.status=!1,t.details=l):t.status=!0}),console.error("Error on validate object"),Te.V.logUpdate(e),t}catch(t){(0,d.ey)(e,"Validator.validate",t)}}}const fa=k=>{var o;const e=document.getElementsByName(k)[0];if(!e)return console.warn(`Element with NAME "${k}" not found.`),{name:null,value:null,type:null,dataType:null,pattern:null,conceptType:null,maxLength:null,minLength:null,minValue:null,maxValue:null,accept:null,file:null,required:!1,isUnique:!0};const t=e.hasAttribute("required")||"true"===e.getAttribute("data-required"),l=e.hasAttribute("isUnique")&&"true"===e.getAttribute("isUnique");return{name:e.name,value:e.value,type:e.type,dataType:e.getAttribute("data-type"),pattern:e.getAttribute("data-pattern"),conceptType:e.getAttribute("concept-type"),maxLength:e.getAttribute("maxlength")?parseInt(e.getAttribute("maxlength")):null,minLength:e.getAttribute("minlength")?parseInt(e.getAttribute("minlength")):null,minValue:e.getAttribute("min")?parseInt(e.getAttribute("min")):null,maxValue:e.getAttribute("max")?parseInt(e.getAttribute("max")):null,accept:e.getAttribute("accept")||null,file:"file"===e.type&&(null===(o=e.files)||void 0===o?void 0:o[0])||null,required:t,isUnique:l}};var ya=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ga(k,o){var e=arguments;return ya(this,void 0,void 0,function*(){const t=Te.V.logfunction("DeleteConnectionByType",e)||{};if(Tt){t.serviceWorker=!0;try{const g=yield Gt("DeleteConnectionByType",{id:k,linker:o});return Te.V.logUpdate(t),g.data}catch(g){console.error("DeleteConnectionByType sw error: ",g),(0,d.ey)(t,"DeleteConnectionByType",g),Ot(g)}}let l=yield ai(k);for(let g=0;g<l.length;g++)In.d.AddConnection(l[g]);let u=yield In.d.GetConnectionsOfConcept(k),v=yield(0,y.A)(o),L=[];for(let g=0;g<u.length;g++)u[g].typeId==v.id&&L.push(u[g]);for(let g=0;g<L.length;g++)(0,Me.m)(L[g].id);Te.V.logUpdate(t)})}function va(k,o){return ya(this,arguments,void 0,function*(e,t,l=!1){if(Tt)try{return(yield Gt("GetAllTheConnectionsByTypeAndOfTheConcept",{id:e,linker:t,reverse:l})).data}catch(v){console.error("GetAllTheConnectionsByTypeAndOfTheConcept sw error: ",v),Ot(v)}let u=[];if(l){let v=yield Yi(e),L=yield ro(t,999);for(let g=0;g<v.length;g++)v[g].typeId==L.id&&u.push(v[g])}else{let v=yield ai(e);for(let i=0;i<v.length;i++)In.d.AddConnection(v[i]);let L=yield In.d.GetConnectionsOfConcept(e),g=yield(0,y.A)(t);for(let i=0;i<L.length;i++)L[i].typeId==g.id&&u.push(L[i])}return u})}class En{constructor(){this.type="",this.inpage=10,this.page=1,this.concepts=[],this.conceptIds=[],this.selectors=[],this.freeschemaQueries=[],this.filters=[],this.filterLogic="",this.typeConnection="",this.order="DESC",this.outputFormat=Dt.yv,this.name="",this.reverse=!1,this.limit=!1,this.isSecure=!1,this.includeInFilter=!1,this.isOldConnectionType=!1}}var Jl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Qo(k){var o=arguments;return Jl(this,arguments,void 0,function*(e,t=""){const l=Te.V.logfunction("FreeschemaQueryApi",o);var u=(0,r.ab)("application/json",t);const v=a.B.FreeschemaQueryUrl(),L=JSON.stringify(e);try{const g=yield fetch(v,{method:"POST",headers:u,body:L});return g.ok?yield g.json():((0,d.ry)(g),console.log("This is the freeschema query error",g.status),[])}catch(g){console.log("This is the freeschema query error others",g),(0,d.Mb)(g,v),(0,d.ey)(l,"FreeschemaQueryApi",g)}})}var zl=_(5898),Bi=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class ma extends to.w{constructor(o,e){super(),this.query=new En,this.countInfoStrings=[],this.order="DESC",this.totalCount=0,this.query=o,this.format=o.outputFormat,this.order=o.order}run(){return Bi(this,void 0,void 0,function*(){var o,e;this.query.outputFormat=Dt.BG,this.compositionIds=[];let t=yield Qo(this.query,"");return this.conceptIds=t.conceptIds,this.internalConnections=null!==(o=t.internalConnections)&&void 0!==o?o:[],this.linkers=null!==(e=t.linkers)&&void 0!==e?e:[],this.reverse=t.reverse,this.compositionIds=t.mainCompositionIds,this.totalCount=t.mainCount,this.countInfoStrings=t.countinfo,yield this.build()})}bind(){return Bi(this,void 0,void 0,function*(){var o,e;if(this.compositionIds.length>0)for(let l=0;l<this.compositionIds.length;l++)this.removeListenToEvent(this.compositionIds[l]);if(this.isDataLoaded)for(let l=0;l<this.compositionIds.length;l++)this.listenToEvent(this.compositionIds[l]);else{this.query.outputFormat=Dt.BG,this.compositionIds=[];let l=yield Qo(this.query,"");this.conceptIds=l.conceptIds,this.internalConnections=null!==(o=l.internalConnections)&&void 0!==o?o:[],this.linkers=null!==(e=l.linkers)&&void 0!==e?e:[],this.reverse=l.reverse,this.compositionIds=l.mainCompositionIds,this.totalCount=l.mainCount,this.countInfoStrings=l.countinfo}let t=yield this.build();if(!this.isDataLoaded){this.isDataLoaded=!0;for(let l=0;l<this.compositionIds.length;l++)this.listenToEvent(this.compositionIds[l]);if(""!=this.query.type){let l=yield ro(this.query.type,999);l.id>0&&this.listenToEventType(l.id)}}for(let l=0;l<this.newIds.length;l++)this.listenToEvent(this.newIds[l]);return this.newIds=[],t})}build(){return Bi(this,void 0,void 0,function*(){Te.V.logfunction("build",["schemaquery",this.compositionIds]);let o=(0,zl.w)(this.countInfoStrings);return this.data=this.format==Dt.y0?yield(0,lo.e$)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,o,this.order):this.format==Dt.ZJ?yield(0,lo.y6)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,o,this.order):yield(0,lo.b6)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,o),this.data})}}function Oo(k,o){return new ma(k,o)}function Ca(k,o){return new ma(k,o).execute()}class Di{constructor(){this.id=0,this.name="",this.html="",this.css="",this.js="",this.library={css:[],js:[]},this.assistant={id:"",input:"",type:""},this.timestamp="",this.widgetId=0,this.type="",this.clean="",this.after_render="",this.before_render="",this.custom_functions=[],this.update="",this.origin=0,this.version=0,this.mount_child="",this.children=[],this.wrapper="0",this.widget=new Ro}}var Zl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Gi(k,o,e){return Zl(this,arguments,void 0,function*(t,l,u,v={concepts:[],connections:[]}){var L,g,i,n,S;const O=Te.V.logfunction("CreateConnectionBetweenEntityLocal",[t.id,l.id,u]);if(Tt)try{const Ie=yield Gt("CreateConnectionBetweenEntityLocal",{concept1Data:t,concept2Data:l,linker:u,actions:v});return!(null===(g=null===(L=Ie?.actions)||void 0===L?void 0:L.concepts)||void 0===g)&&g.length&&(v.concepts=JSON.parse(JSON.stringify(Ie.actions.concepts))),!(null===(n=null===(i=Ie?.actions)||void 0===i?void 0:i.connections)||void 0===n)&&n.length&&(v.connections=JSON.parse(JSON.stringify(Ie.actions.connections))),Ie.data}catch(Ie){console.log("CreateConnectionBetweenEntityLocal error sw: ",Ie),Ot(Ie)}const K=t.userId,j=(null===(S=t.type)||void 0===S?void 0:S.characterValue)+"_"+u,ae=yield(0,_t.$)(j,999,999,K,v);console.log(yield(0,jn.F)(t.id,l.id,ae.id,1e3,void 0,void 0,v)),Te.V.logUpdate(O)})}var Lo=_(4310);function Ui(k){for(;k.firstChild;)k.removeChild(k.firstChild)}class _a extends Zo{constructor(o,e,t,l="",u=10){super(),this.inpage=10,this.selector=e,this.mainType=o,this.filterType=l,this.inpage=u,this.parentDomElement=t,this.mount(this.parentDomElement)}before_render(){this.render()}addFilter(o){if(""!=o){let e=new zo;e.search=o,e.type=this.filterType,e.logicoperator="like",e.operateon="selector",e.name="selector_filter";let t="( selector_filter )";this.query.filters=[e],this.query.filterLogic=t}else this.query.filters=[],this.query.filterLogic="";console.log("this is the filters",this.query)}after_render(){let o=this.getElementById("selector"),e=this.getElementById("search-bar"),t=this;e.onchange=()=>{t.addFilter(e.value),t.mainDetails.update()};let l=new En;l.type=this.mainType,l.inpage=this.inpage;let u=new En;u.typeConnection=this.selector,u.name="selector",l.freeschemaQueries=[u],this.query=l,Oo(this.query,"").subscribe((v,L)=>{let g={};this.mainDetails=L;for(let i=0;i<v.length;i++){let n=v[i],S=n.id,O=n[this.mainType];if(console.log("this is the selected data myItem",O,v[i],this.mainType,n),O){let K=O[this.selector];if(K){const j=Object.values(K)[0];g[S]=j}}}Ui(o);for(const[i,n]of Object.entries(g)){const S=document.createElement("option");S.value=i,S.textContent=n,o.appendChild(S)}console.log("this is the output from selector",v)})}getHtml(){const o=document.createElement("style");return o.textContent="\n.search-select-wrapper {\n  width: 300px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  font-family: Arial, sans-serif;\n}\n\n#search-bar {\n  padding: 8px;\n  font-size: 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n}\n\n#selector {\n  padding: 6px;\n  font-size: 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n}\n",document.head.prepend(o),this.html='\n        <div class="search-select-wrapper">\n        <input type="text" placeholder="Select or type..." id=\'search-bar\'>\n        <select id=\'selector\'>\n        </div>',this.html}}const Ql='\n/* CKEditor content styles */\n.ck-content {\n  /* Container styles */\n  max-width: 100%;\n  margin: 0 auto;\n  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;\n  line-height: 1.5;\n  padding: 0.75rem;\n  background: #fff;\n  color: #333;\n  border: 1px solid #ccced1;\n}\n\n/* Headings */\n.ck-content h1, .ck-content h2, .ck-content h3, \n.ck-content h4, .ck-content h5, .ck-content h6 {\n  font-weight: 700;\n  line-height: 1.2;\n  margin: 1em 0 0.5em;\n}\n\n.ck-content h1 { font-size: 2.5em; }\n.ck-content h2 { font-size: 2em; }\n.ck-content h3 { font-size: 1.75em; }\n.ck-content h4 { font-size: 1.5em; }\n.ck-content h5 { font-size: 1.25em; }\n.ck-content h6 { font-size: 1em; }\n\n/* Paragraphs and spacing */\n.ck-content p {\n  margin: 1em 0;\n  line-height: 1.6;\n}\n\n/* Links */\n.ck-content a {\n  color: #1a73e8;\n  text-decoration: none;\n}\n\n.ck-content a:hover {\n  text-decoration: underline;\n}\n\n/* Lists */\n.ck-content ul,\n.ck-content ol {\n  padding-left: 2em;\n  margin: 1em 0;\n}\n\n.ck-content ul {\n  list-style: disc;\n}\n\n.ck-content ol {\n  list-style: decimal;\n}\n\n.ck-content li {\n  margin: 0.5em 0;\n}\n\n/* Blockquotes */\n.ck-content blockquote {\n  margin: 1em 0;\n  padding-left: 1em;\n  border-left: 5px solid #ccc;\n  font-style: italic;\n  color: #666;\n}\n\n/* Code blocks */\n.ck-content pre {\n  background: #f5f5f5;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  padding: 1em;\n  margin: 1em 0;\n  overflow-x: auto;\n  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;\n}\n\n.ck-content code {\n  background: #f5f5f5;\n  padding: 0.2em 0.4em;\n  border-radius: 3px;\n  font-size: 0.9em;\n  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;\n}\n\n/* Tables */\n.ck-content table {\n  border-collapse: collapse;\n  width: 100%;\n  margin: 1em 0;\n}\n\n.ck-content table th,\n.ck-content table td {\n  border: 1px solid #ddd;\n  padding: 0.75em;\n  text-align: left;\n}\n\n.ck-content table th {\n  background: #f5f5f5;\n  font-weight: bold;\n}\n\n/* Images */\n.ck-content img {\n  max-width: 100%;\n  height: auto;\n  margin: 1em 0;\n}\n\n.ck-content figure {\n  margin: 1em 0;\n  text-align: center;\n}\n\n.ck-content figure img {\n  margin: 0;\n}\n\n.ck-content figcaption {\n  color: #666;\n  font-size: 0.9em;\n  margin-top: 0.5em;\n}\n\n/* Dark mode */\n/*\n@media (prefers-color-scheme: dark) {\n  .ck-content {\n    background: #1a1a1a;\n    color: #e0e0e0;\n  }\n\n  .ck-content a {\n    color: #64b5f6;\n  }\n\n  .ck-content blockquote {\n    border-left-color: #404040;\n    color: #b0b0b0;\n  }\n\n  .ck-content pre,\n  .ck-content code {\n    background: #2d2d2d;\n    border-color: #404040;\n  }\n\n  .ck-content table th,\n  .ck-content table td {\n    border-color: #404040;\n  }\n\n  .ck-content table th {\n    background: #2d2d2d;\n  }\n\n  .ck-content figcaption {\n    color: #b0b0b0;\n  }\n}\n*/\n\n/* CUSTOM DOCUMENTATION CSS */\n\n#documentation-preview {\n  border: 1px solid #ccc;\n  padding: 1rem;\n}\n\n#documentation-preview h3 {\n  font-size: 1.5rem;\n  margin-bottom: 1rem;\n}\n\n.pre-wrapper {\n  background: #f2f5f9;\n  border: 1px solid #cecece;\n  display: block;\n  padding: 1rem;\n  border-radius: 0.25rem;\n  margin-top: 1rem;\n  margin-bottom: 1rem;\n}\n\n.pre-wrapper pre {\n  margin: 0;\n  color: #e87aa2;\n}\n\n.widget-doc-section pre {\n  background-color: transparent;\n}\n\n.widget-doc-section p {\n  margin: 0;\n}\n\n.widget-doc-section code {\n  color: #e87aa2;\n  font-size: 0.875rem;\n}\n\n.mv-3 {\n  margin-top: 1rem;\n  margin-bottom: 1rem;\n}\n\n.pv-3 {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n}\n\n  .widget-documentation-heading {\n    background-color: #6e757d;\n    color: #eee;\n    font-size: 1.5rem;\n    padding: 0.5rem 1rem;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n  }\n\n  .widget-documentation-heading h4 {\n    margin-bottom: 0;\n  }\n\n  .close-documentation-button {\n    border: none;\n    outline: none;\n    background-color: transparent;\n    line-height: 0;\n    margin: 0;\n    padding: 0;\n    cursor: pointer;\n  }\n\n  .close-documentation-button:hover,\n  .close-documentation-button:focus  {\n    background-color: transparent;\n  }\n\n  .documentation-creator {\n    text-align: right;\n    color: #666;\n    margin: 0;\n    padding-top: 0.5rem;\n    padding-bottom: 0.5rem;\n  }\n\n  .documentation-creator span {\n    font-style: italic;\n  }\n\n  .documentation-attachments {\n    display: flex;\n    flex-wrap: wrap;\n  }\n\n  .documentation-attachments img {\n    width: 25%;\n    height: auto;\n    border: 1px solid #ccc;\n    padding: 0.25rem;\n    margin-top: 0.5rem;\n    margin-bottom: 0.5rem;\n  }\n\n  .documentation-attachments iframe {\n    width: 50%;\n    border: 1px solid #ccc;\n    padding: 0.25rem;\n    margin-top: 0.5rem;\n    margin-bottom: 0.5rem;\n  }\n\n  .widget-documentation-footer {\n    text-align: right;\n    margin-top: 1rem;\n  }\n\n  .widget-documentation-footer button {\n    border-radius: 0;\n    border: none;\n    padding: 0.5rem 1.5rem;\n    text-align: center;\n    background: #6e757d;\n    color: #eee;\n  }\n\n  #widget-details {\n    position: absolute;\n    right: 0px;\n    top: 0px;\n    z-index: 9999;\n  }\n\n  #widget-details button {\n    background: #fff;\n    border: 1px solid #ccc;\n    border-radius: 0 0 0 0.25rem;\n    height: auto;\n    width: auto;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.25rem;\n  }\n\n  #widget-details button:hover, \n  #widget-details button:focus {\n    opacity: 0.75;\n  }\n\n  #widget-details button span {\n    pointer-events: none;\n    font-size: 1rem;\n  }\n\n  #widget-details button svg {\n    pointer-events: none;\n    width: 16px;\n    height: 16px;\n    fill: #999;\n  }\n\n  #widget-documentation-preview-modal {\n    border: none;\n  }\n\n  @media (min-width: 768px) {\n    #widget-documentation-preview-modal {\n      flex: 0 0 auto;\n      width: 66.66666667%;\n    }\n  }\n\n';function Ta(k){var o,e,t,l;!(null===(e=null===(o=k?.library)||void 0===o?void 0:o.css)||void 0===e)&&e.length&&function(u){var v;const L=null===(v=u?.library)||void 0===v?void 0:v.css,g=`vde-css-${u?.origin?u?.origin:u?.widgetId}`;(function(i){const S=document.querySelectorAll(`link.${i}`);S?.length&&S?.forEach(O=>{O.remove()})})(g),L?.length&&L?.sort((i,n)=>Number(i?.order)-Number(n?.order)),L?.forEach(i=>{const n=document.createElement("link");n.classList.add(g),n.setAttribute("rel","stylesheet"),n.setAttribute("href",i.url),document.head.appendChild(n)})}(k),null!==(l=null===(t=k?.library)||void 0===t?void 0:t.js)&&void 0!==l&&l.length&&function(u){var v;const L=null===(v=u?.library)||void 0===v?void 0:v.js,g=`vde-js-${u?.origin?u?.origin:u?.widgetId}`;(function(i){const S=document.querySelectorAll(`script.${i}`);S?.length&&S?.forEach(O=>{O.remove()})})(g),L?.length&&L?.sort((i,n)=>Number(i?.order)-Number(n?.order)),L?.forEach(i=>{const n=document.createElement("script");n.classList.add(g),n.setAttribute("type","text/javascript"),n.setAttribute("src",i.url),document.body.appendChild(n)})}(k)}var Cn=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function wa(k,o,e){return Cn(this,void 0,void 0,function*(){var t;const l=yield _i(k,"the_page_body");null!==(t=l?.[0])&&void 0!==t&&t.id?yield Ri(l[0].id,o,e):o.innerHTML="<h4>Invalid or Page doesn't exist</h4>"})}function Ia(k,o,e){return Cn(this,void 0,void 0,function*(){try{o.innerHTML='\n  <div style="display: flex; align-items: center; gap: 10px; width: 100%">\n    <div style="\n      width: 20px;\n      height: 20px;\n      border: 3px solid #f3f3f3;\n      border-top: 3px solid #3498db;\n      border-radius: 50%;\n      animation: spin 1s linear infinite;\n    "></div>\n    <span>Please Wait...</span>\n  </div>\n  \n  <style>\n    @keyframes spin {\n      0% {\n        transform: rotate(0deg);\n      }\n      100% {\n        transform: rotate(360deg);\n      }\n    }\n  </style>\n';const t=yield(0,Lo.qj)(k);let l=t.mainId,u=t.data;return yield ka(l,u,o,e)}catch(t){console.error(`Error Caught Rendering Widget: ${t}`),o.textContent=`Error: ${t.message}`}})}function Ri(k,o,e){return Cn(this,void 0,void 0,function*(){try{const t=yield(0,Lo.Cp)(k);return yield ka(k,t,o,e)}catch(t){console.error(`Error Caught Rendering Widget: ${t}`)}})}function ka(k,o,e,t){return Cn(this,void 0,void 0,function*(){const l=yield Mo(k,[],o);if(!l.name)return void(e.innerHTML="<h4>Invalid or Widget doesn't exist</h4>");const u=e,v=yield Ko(l,u,void 0,t),L=Array.from({length:32},()=>"abcdef"[Math.floor(6*Math.random())]).join("");e.classList.add(`${L}`),e.style.position="relative";const g=document.createElement("style");g.id="mystyleid",g.innerHTML=`\n  .${L} {\n    ${l.css+v.css+Ql} \n  }\n`,Ta(l),l.children.length&&l?.children.forEach(j=>{var ae;const Ie=j?.library;(null!==(ae=Ie?.css)&&void 0!==ae&&ae.length||Ie?.js.length)&&Ta(j)}),document.head.appendChild(g);const i=document.createElement("script");i.innerHTML=l.js,u.appendChild(i);const n=document.createElement("div");n.id="widget-details",n.innerHTML="",n.innerHTML=`\n        <button class="widget-documentation-btn" widget-id="${l?.origin||l?.widgetId}" class="d-flex align-items-center gap-1" title="Documentation">\n          <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 441 512.02"><path d="M324.87 279.77c32.01 0 61.01 13.01 82.03 34.02 21.09 21 34.1 50.05 34.1 82.1 0 32.06-13.01 61.11-34.02 82.11l-1.32 1.22c-20.92 20.29-49.41 32.8-80.79 32.8-32.06 0-61.1-13.01-82.1-34.02-21.01-21-34.02-50.05-34.02-82.11s13.01-61.1 34.02-82.1c21-21.01 50.04-34.02 82.1-34.02zM243.11 38.08v54.18c.99 12.93 5.5 23.09 13.42 29.85 8.2 7.01 20.46 10.94 36.69 11.23l37.92-.04-88.03-95.22zm91.21 120.49-41.3-.04c-22.49-.35-40.21-6.4-52.9-17.24-13.23-11.31-20.68-27.35-22.19-47.23l-.11-1.74V25.29H62.87c-10.34 0-19.75 4.23-26.55 11.03-6.8 6.8-11.03 16.21-11.03 26.55v336.49c0 10.3 4.25 19.71 11.06 26.52 6.8 6.8 16.22 11.05 26.52 11.05h119.41c2.54 8.79 5.87 17.25 9.92 25.29H62.87c-17.28 0-33.02-7.08-44.41-18.46C7.08 432.37 0 416.64 0 399.36V62.87c0-17.26 7.08-32.98 18.45-44.36C29.89 7.08 45.61 0 62.87 0h173.88c4.11 0 7.76 1.96 10.07 5l109.39 118.34c2.24 2.43 3.34 5.49 3.34 8.55l.03 119.72c-8.18-1.97-16.62-3.25-25.26-3.79v-89.25zm-229.76 54.49c-6.98 0-12.64-5.66-12.64-12.64 0-6.99 5.66-12.65 12.64-12.65h150.49c6.98 0 12.65 5.66 12.65 12.65 0 6.98-5.67 12.64-12.65 12.64H104.56zm0 72.3c-6.98 0-12.64-5.66-12.64-12.65 0-6.98 5.66-12.64 12.64-12.64h142.52c3.71 0 7.05 1.6 9.37 4.15a149.03 149.03 0 0 0-30.54 21.14H104.56zm0 72.3c-6.98 0-12.64-5.66-12.64-12.65 0-6.98 5.66-12.64 12.64-12.64h86.2c-3.82 8.05-6.95 16.51-9.29 25.29h-76.91zm239.61-18.85c7.41 7.43 4.68 18.9-3.05 25.23-7.46 6.01-20.97 8.92-28.68 1.83-7.77-7.23-4.68-18.87 2.76-25.24 7.18-6.05 21.39-9.37 28.97-1.82zm-43.88 95h6.34v-41.33H294.6c0-16.37 30.05-5.74 52.18-11.32v52.65h8.37v17.58h-54.86v-17.58z"/></svg>\n        </button>\n      `,u.appendChild(n);const S=document.createElement("dialog");return S.id="widget-documentation-preview-modal",S.className="col-md-8",S.innerHTML="",S.innerHTML='\n        <div class="widget-documentation-heading">\n          <h4>Documentation</h4>\n          <button class="close-documentation-button document-preview-close-button" title="Close">\n            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>\n          </button>\n        </div>\n\n        <div id="documentation-preview" class="ck-content"></div>\n\n        <div class="widget-documentation-footer">\n          <button class="document-preview-close-button">Close</button>\n        </div>\n      ',u.appendChild(S),u.querySelectorAll(".widget-documentation-btn")?.forEach(j=>{j.addEventListener("click",ae=>{const Ie=ae?.target;!function(Ge){Cn(this,void 0,void 0,function*(){console.log("openDocumentationPreviewModal widgetId",Ge);const tt=new En;tt.typeConnection="the_widget_documentation",tt.name="documentationText",tt.selectors=["the_documentation_text"];const Be=new En;Be.typeConnection="the_widget_s_documentation",Be.name="documentationBlank",Be.selectors=["the_documentation_text","the_documentation_content","the_documentation_language","the_documentation_doc_title","the_documentation_folder","the_documentation_creator_email","the_documentation_created_by","the_documentation_content","the_documentation_type","the_documentation_s_doc_url","the_documentation_s_image_url","the_documentation_s_video_link","the_documentation_auth_type","the_documentation_bearer_token","the_documentation_method","the_documentation_method_url","the_documentation_username","the_documentation_password","the_documentation_s_json_list","the_documentation_api_script","the_documentation_api_body","the_documentation_code_editor","the_documentation_return"];const ut=new En;ut.typeConnection="the_documentation_s_json_list",ut.name="documentationJSON",ut.selectors=["the_json_list_key","the_json_list_value"],Be.freeschemaQueries=[ut];const xt=new En;xt.conceptIds=[Ge],xt.freeschemaQueries=[tt,Be],xt.inpage=100,xt.outputFormat=Dt.y0,yield Oo(xt,"").subscribe(Mt=>Cn(this,void 0,void 0,function*(){var Ht,Qt,rn,Bn,po,fo,yo,go,vo,mo,Co;let _o;console.log("widget documentation preview data ->",Mt);const So=(null===(go=null===(yo=null===(fo=null===(po=null===(Bn=null===(rn=null===(Qt=null===(Ht=Mt?.[0])||void 0===Ht?void 0:Ht.data)||void 0===Qt?void 0:Qt.the_widget)||void 0===rn?void 0:rn.the_widget_documentation)||void 0===Bn?void 0:Bn.data)||void 0===po?void 0:po.the_documentation)||void 0===fo?void 0:fo.the_documentation_text)||void 0===yo?void 0:yo.data)||void 0===go?void 0:go.the_text)||"";So&&(_o=So);const no=null===(Co=null===(mo=null===(vo=Mt?.[0])||void 0===vo?void 0:vo.data)||void 0===mo?void 0:mo.the_widget)||void 0===Co?void 0:Co.the_widget_s_documentation;no?.length&&(_o=no?.map(yn=>{var kt,Dn,Gn,Un,Rn,qn,_n,On,ln,Mn,Pn,Wn,Vn,Kn,Yn,Xn,an,xn,Tn,gn,Fn,qt,oo,Et,To,$n,Wo,Vo,Jn,xo,zt;const Ct=null===(kt=yn?.data)||void 0===kt?void 0:kt.the_documentation,nn=null===(Gn=null===(Dn=Ct?.the_documentation_type)||void 0===Dn?void 0:Dn.data)||void 0===Gn?void 0:Gn.the_type,dn=null===(Rn=null===(Un=Ct?.the_documentation_content)||void 0===Un?void 0:Un.data)||void 0===Rn?void 0:Rn.the_content,vn=null===(_n=null===(qn=Ct?.the_documentation_creator_email)||void 0===qn?void 0:qn.data)||void 0===_n?void 0:_n.the_creator_email,bn=null===(ln=null===(On=Ct?.the_documentation_doc_title)||void 0===On?void 0:On.data)||void 0===ln?void 0:ln.the_doc_title,An=null===(Pn=null===(Mn=Ct?.the_documentation_method)||void 0===Mn?void 0:Mn.data)||void 0===Pn?void 0:Pn.the_method,Ln=null===(Vn=null===(Wn=Ct?.the_documentation_method_url)||void 0===Wn?void 0:Wn.data)||void 0===Vn?void 0:Vn.the_method_url,pn=null===(Yn=null===(Kn=Ct?.the_documentation_bearer_token)||void 0===Kn?void 0:Kn.data)||void 0===Yn?void 0:Yn.the_bearer_token,nd=null===(an=null===(Xn=Ct?.the_documentation_username)||void 0===Xn?void 0:Xn.data)||void 0===an?void 0:an.the_username,od=null===(Tn=null===(xn=Ct?.the_documentation_password)||void 0===xn?void 0:xn.data)||void 0===Tn?void 0:Tn.the_password,id=null===(Fn=null===(gn=Ct?.the_documentation_auth_type)||void 0===gn?void 0:gn.data)||void 0===Fn?void 0:Fn.the_auth_type,ei=Ct?.the_documentation_s_json_list,rd=null===(oo=null===(qt=Ct?.the_documentation_api_script)||void 0===qt?void 0:qt.data)||void 0===oo?void 0:oo.the_api_script,ad=null===(To=null===(Et=Ct?.the_documentation_api_body)||void 0===Et?void 0:Et.data)||void 0===To?void 0:To.the_api_body,cd=null===(Wo=null===($n=Ct?.the_documentation_language)||void 0===$n?void 0:$n.data)||void 0===Wo?void 0:Wo.the_language,sd=null===(Jn=null===(Vo=Ct?.the_documentation_return)||void 0===Vo?void 0:Vo.data)||void 0===Jn?void 0:Jn.the_return,ld=null===(zt=null===(xo=Ct?.the_documentation_code_editor)||void 0===xo?void 0:xo.data)||void 0===zt?void 0:zt.the_code_editor,ti=Ct?.the_documentation_s_doc_url,ni=Ct?.the_documentation_s_image_url,oi=Ct?.the_documentation_s_video_link;let eo={type:nn,content:dn,creatorEmail:vn,title:bn};if("blank"===nn)eo=Object.assign({},eo);else if("api"===nn){const zn=[];ei?.length&&ei?.forEach(fn=>{var ji,Hi,qi,Ji,zi,Zi,Qi,Ki;zn.push({key:null===(Ji=null===(qi=null===(Hi=null===(ji=fn?.data)||void 0===ji?void 0:ji.the_json_list)||void 0===Hi?void 0:Hi.the_json_list_key)||void 0===qi?void 0:qi.data)||void 0===Ji?void 0:Ji.the_key,value:null===(Ki=null===(Qi=null===(Zi=null===(zi=fn?.data)||void 0===zi?void 0:zi.the_json_list)||void 0===Zi?void 0:Zi.the_json_list_value)||void 0===Qi?void 0:Qi.data)||void 0===Ki?void 0:Ki.the_value})}),eo=Object.assign(Object.assign({},eo),{method:An,methodURL:Ln,authType:id,username:nd,password:od,bearerToken:pn,json:zn,script:rd,body:ad})}else"function"===nn&&(eo=Object.assign(Object.assign({},eo),{language:cd,return:sd,codeEditor:ld}));const Ra=[],Oa=[],Ma=[];return ni?.length&&ni?.forEach(zn=>{var fn;Ra.push(null===(fn=zn?.data)||void 0===fn?void 0:fn.the_image_url)}),oi?.length&&oi?.forEach(zn=>{var fn;Oa.push(null===(fn=zn?.data)||void 0===fn?void 0:fn.the_video_link)}),ti?.length&&ti?.forEach(zn=>{var fn;Ma.push(null===(fn=zn.data)||void 0===fn?void 0:fn.the_doc_url)}),eo=Object.assign(Object.assign({},eo),{imageList:Ra,linkList:Ma,videoList:Oa}),eo})),yield function(){return Cn(this,void 0,void 0,function*(){document.getElementById("widget-documentation-preview-modal").showModal()})}(),function(kn){const yn=document.getElementById("documentation-preview");yn.innerHTML="",kn&&kn?.length&&"string"!=typeof kn?kn?.forEach(kt=>{var Dn,Gn,Un,Rn;const qn=document.createElement("h3");let _n="";switch(kt?.type){case"api":_n="API";break;case"function":_n="Functions and Classes";break;case"imgAndLink":_n="Images and Links";break;default:_n=""}qn.innerHTML=`\n        ${kt?.title} ${_n?"("+_n+")":""}\n      `,yn?.appendChild(qn);const On=document.createElement("div");On.classList.add("widget-doc-content"),kt?.content&&(On.innerHTML=kt.content,yn?.appendChild(On));const ln=document.createElement("div");if(ln.classList.add("widget-doc-section"),"api"===kt.type){let an="";an="basicAuth"===kt.authType?`\n            <p>username: <code>${kt?.username}</code></p>\n            <p>password: <code>${kt?.password}</code></p>\n          `:"bearerToken"===kt.authType?`\n          <h6>Token: <code>${kt?.bearerToken}</code></h6>\n          `:"None";const xn=kt.json.map(Fn=>`${Fn?.key}: ${Fn?.value}`).join(", "),Tn=document.createElement("pre");Tn.textContent=xn,ln.innerHTML=`\n          <div class="pv-3">\n            <h6>Method Type: <code>${kt?.method.toUpperCase()}</code></h6>\n            <h6>Endpoint: <code>${kt?.methodURL}</code></h6>\n          </div>\n          <div class="pv-3">\n            <h6>Auth Type: <code>${(null===(Dn=kt?.authType)||void 0===Dn?void 0:Dn.toUpperCase())||""}</code></h6>\n            ${an}\n          </div>\n          <div class="pv-3">\n            <h6>JSON</h6>\n            <code class="pre-wrapper" id="json-list-pre"></code>\n          </div>\n          <div class="pv-3">\n            <h6>Body</h6>\n            ${kt.body}\n          </div>\n          <div class="pv-3">\n            <h6>Scripts</h6>\n            ${kt.script}\n          </div>\n        `;const gn=ln.querySelector("#json-list-pre");gn&&(gn.appendChild(Tn),gn.removeAttribute("id"))}else if("function"===kt.type){const an=document.createElement("pre");an.textContent=kt?.codeEditor;const xn=document.createElement("pre");xn.textContent=kt?.return,ln.innerHTML=`\n          <div class="mv-3">\n            <h6>Parameter</h6>\n            <p>Language: ${kt?.language}</p>\n            <code class="pre-wrapper" id="editor-pre"></pre></code>\n            <h6>Returns</h6>\n            <code class="pre-wrapper" id="return-pre"></code>\n          </div>\n        `;const Tn=ln.querySelector("#editor-pre");Tn&&(Tn.appendChild(an),Tn.removeAttribute("id"));const gn=ln.querySelector("#return-pre");gn&&(gn.appendChild(xn),gn.removeAttribute("id"))}const Mn=document.createElement("div");Mn.classList.add("mv-3");const Pn=null===(Gn=kt?.linkList)||void 0===Gn?void 0:Gn.map(an=>`\n            <p>${an}</p>\n          `).join(""),Wn=null===(Un=kt?.imageList)||void 0===Un?void 0:Un.map(an=>`\n          <img src="${an}">\n        `).join(""),Vn=null===(Rn=kt?.videoList)||void 0===Rn?void 0:Rn.map(an=>`\n            <iframe width="560" height="315" src="${an}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>\n        `).join("");Mn.innerHTML=`\n        <div class="mv-3">\n          ${Pn?.length?`\n          <div class="mv-3">\n          <h6>Web links</h6>\n          ${Pn}\n          </div>\n        `:""}\n          ${Wn?.length?`\n          <h6>Attachments</h6>\n          <div class="documentation-attachments">\n            ${Wn}\n          </div>\n        `:""}\n          ${Vn?.length?`\n            <h6>Videos</h6>\n            <div class="documentation-attachments">\n              ${Vn}\n            </div>\n            `:""}\n        </div>\n        <p class="documentation-creator">- added by: <span>${kt?.creatorEmail}</span></p>\n      `,ln?.appendChild(Mn),yn?.appendChild(ln)}):void 0!==kn&&(yn.innerHTML=kn)}(_o)}))})}(Ie?.getAttribute("widget-id"))})}),u.querySelectorAll(".document-preview-close-button")?.forEach(j=>{j.addEventListener("click",()=>{!function(){Cn(this,void 0,void 0,function*(){const ae=document.getElementById("widget-documentation-preview-modal"),Ie=ae?.querySelector("form");Ie?.reset(),ae?.close()})}()})}),u.querySelectorAll(".wb-initial-empty").forEach(j=>{j.classList.remove("wb-initial-empty")}),document.querySelectorAll('[onclick="widgetSelected(event)"]').forEach(j=>{j.removeAttribute("onclick")}),v})}function ba(k){return Cn(this,arguments,void 0,function*(o,e=[],t=""){const l=yield(0,Lo.Cp)(o);return yield Mo(o,[],l)})}function Mo(k){return Cn(this,arguments,void 0,function*(o,e=[],t,l=""){var u,v,L,g,i,n,S,O,K,j,ae,Ie,Ge,tt,Be,ut,xt,Mt,Ht,Qt,rn,Bn,po,fo,yo,go,vo,mo,Co,_o,So,no,kn,yn,kt,Dn,Gn,Un,Rn,qn,_n,On,ln,Mn,Pn,Wn,Vn,Kn,Yn,Xn,an,xn,Tn,gn,Fn;try{const qt=new Di,oo=(0,Lo.ix)(t,o);console.log("getWidgetBulkFromId output ->",oo),e.push(o);const Et=null===(u=oo?.data)||void 0===u?void 0:u.the_widget;qt.name=null===(L=null===(v=Et?.the_widget_name)||void 0===v?void 0:v.data)||void 0===L?void 0:L.the_name,qt.html=null===(i=null===(g=Et?.the_widget_html)||void 0===g?void 0:g.data)||void 0===i?void 0:i.the_html,qt.css=null===(S=null===(n=Et?.the_widget_css)||void 0===n?void 0:n.data)||void 0===S?void 0:S.the_css,qt.js=null===(K=null===(O=Et?.the_widget_js)||void 0===O?void 0:O.data)||void 0===K?void 0:K.the_js,qt.origin=Number(null===(ae=null===(j=Et?.the_widget_origin)||void 0===j?void 0:j.data)||void 0===ae?void 0:ae.the_origin),qt.version=null===(Ge=null===(Ie=Et?.the_widget_version)||void 0===Ie?void 0:Ie.data)||void 0===Ge?void 0:Ge.the_version,qt.clean=null===(Be=null===(tt=Et?.the_widget_clean)||void 0===tt?void 0:tt.data)||void 0===Be?void 0:Be.the_clean,qt.timestamp=null===(xt=null===(ut=Et?.the_widget_timestamp)||void 0===ut?void 0:ut.data)||void 0===xt?void 0:xt.the_timestamp,qt.id=oo.id;const To=null===(Ht=null===(Mt=Et?.the_widget_type)||void 0===Mt?void 0:Mt.data)||void 0===Ht?void 0:Ht.the_type;qt.type="null"==To||null==To?"the_element_name":To,qt.after_render=null===(rn=null===(Qt=Et?.the_widget_after_render)||void 0===Qt?void 0:Qt.data)||void 0===rn?void 0:rn.the_after_render,qt.before_render=null===(po=null===(Bn=Et?.the_widget_before_render)||void 0===Bn?void 0:Bn.data)||void 0===po?void 0:po.the_before_render,qt.update=null===(yo=null===(fo=Et?.the_widget_update)||void 0===fo?void 0:fo.data)||void 0===yo?void 0:yo.the_update,qt.widgetId=o,qt.mount_child=null===(vo=null===(go=Et?.the_widget_mount_child)||void 0===go?void 0:go.data)||void 0===vo?void 0:vo.the_mount_child;const $n=Et?.the_widget_s_child,Wo=null===(mo=Et?.the_widget_s_css_library)||void 0===mo?void 0:mo.map(zt=>{var Ct,nn,dn,vn,bn,An,Ln,pn;return{order:null===(vn=null===(dn=null===(nn=null===(Ct=zt?.data)||void 0===Ct?void 0:Ct.the_css_library)||void 0===nn?void 0:nn.the_css_library_order)||void 0===dn?void 0:dn.data)||void 0===vn?void 0:vn.the_order,url:null===(pn=null===(Ln=null===(An=null===(bn=zt?.data)||void 0===bn?void 0:bn.the_css_library)||void 0===An?void 0:An.the_css_library_url)||void 0===Ln?void 0:Ln.data)||void 0===pn?void 0:pn.the_url}}),Vo=null===(Co=Et?.the_widget_s_js_library)||void 0===Co?void 0:Co.map(zt=>{var Ct,nn,dn,vn,bn,An,Ln,pn;return{order:null===(vn=null===(dn=null===(nn=null===(Ct=zt?.data)||void 0===Ct?void 0:Ct.the_js_library)||void 0===nn?void 0:nn.the_js_library_order)||void 0===dn?void 0:dn.data)||void 0===vn?void 0:vn.the_order,url:null===(pn=null===(Ln=null===(An=null===(bn=zt?.data)||void 0===bn?void 0:bn.the_js_library)||void 0===An?void 0:An.the_js_library_url)||void 0===Ln?void 0:Ln.data)||void 0===pn?void 0:pn.the_url}});qt.library={css:Wo||[],js:Vo||[]};const Jn=null===(So=null===(_o=Et?.the_widget_assistant)||void 0===_o?void 0:_o.data)||void 0===So?void 0:So.the_assistant;qt.assistant={id:null===(kn=null===(no=Jn?.the_assistant_id)||void 0===no?void 0:no.data)||void 0===kn?void 0:kn.the_id,input:null===(kt=null===(yn=Jn?.the_assistant_input)||void 0===yn?void 0:yn.data)||void 0===kt?void 0:kt.the_input,type:null===(Gn=null===(Dn=Jn?.the_assistant_type)||void 0===Dn?void 0:Dn.data)||void 0===Gn?void 0:Gn.the_type};const xo=null===(Un=Et?.the_widget_s_custom_function)||void 0===Un?void 0:Un.map(zt=>{var Ct,nn,dn,vn,bn,An,Ln;const pn=null===(Ct=zt?.data)||void 0===Ct?void 0:Ct.the_custom_function;return{id:zt?.id,name:null===(dn=null===(nn=pn?.the_custom_function_name)||void 0===nn?void 0:nn.data)||void 0===dn?void 0:dn.the_name,slug:null===(bn=null===(vn=pn?.the_custom_function_slug)||void 0===vn?void 0:vn.data)||void 0===bn?void 0:bn.the_slug,code:null===(Ln=null===(An=pn?.the_custom_function_code)||void 0===An?void 0:An.data)||void 0===Ln?void 0:Ln.the_code}});if(console.log("customFunctionList -> ",xo),qt.custom_functions=xo,$n?.length)for(let zt=0;zt<$n.length;zt++){const Ct=(null===(_n=null===(qn=null===(Rn=$n[zt])||void 0===Rn?void 0:Rn.data.the_child_widget)||void 0===qn?void 0:qn.the_child_widget_info)||void 0===_n?void 0:_n.id)||(null===(Pn=null===(Mn=null===(ln=null===(On=$n[zt])||void 0===On?void 0:On.data.the_child_widget)||void 0===ln?void 0:ln.the_child_widget_parent)||void 0===Mn?void 0:Mn.data)||void 0===Pn?void 0:Pn.the_parent),nn=yield Mo(Ct,e,t,l),dn=null===(Xn=null===(Yn=null===(Kn=null===(Vn=null===(Wn=$n[zt])||void 0===Wn?void 0:Wn.data)||void 0===Vn?void 0:Vn.the_child_widget)||void 0===Kn?void 0:Kn.the_child_widget_type)||void 0===Yn?void 0:Yn.data)||void 0===Xn?void 0:Xn.the_type,vn=null===(Fn=null===(gn=null===(Tn=null===(xn=null===(an=$n[zt])||void 0===an?void 0:an.data)||void 0===xn?void 0:xn.the_child_widget)||void 0===Tn?void 0:Tn.the_child_widget_wrapper)||void 0===gn?void 0:gn.data)||void 0===Fn?void 0:Fn.the_wrapper;nn.type="null"==dn||null==dn?"the_element_name":dn,nn.wrapper=vn,qt.children.push(nn)}return qt}catch(qt){throw console.error("error",qt),qt}})}function Ko(k,o){return Cn(this,arguments,void 0,function*(e,t,l=!0,u,v){var L,g;const i=new Ro;i.html=e.html,i.widgetType=e.type,i.componentDidMountFunction=e.before_render,i.addEventFunction=e.after_render,i.mountChildWidgetsFunction=e.mount_child,i.widgetState=Object.assign({},v),i.customFunctions=e.custom_functions,i.css=`#${e.id} { ${e.css} }`,u&&(i.data=u),t.innerHTML="";const n=t;if(n&&(yield i.mount(n),e.widget=i,e.children.length>0&&(null===(L=i.childWidgetElement)||void 0===L?void 0:L.length)>0))for(let S=0;S<(null===(g=e.children)||void 0===g?void 0:g.length);S++){const O=e.children[S];for(let K=0;K<i.childWidgetElement.length;K++){const j=i.childWidgetElement[K];if(O.wrapper===j.id){const ae=Aa(O);O.html=`<div id="${O.wrapper}">${O.html}</div>`;const Ie=yield Ko(ae,j,!1,i.data,i.widgetState);i.childWidgets.push(Ie),i.css=i.css+Ie.css+`#${j.id} { ${O.css} }`,Ie.dataChange(Ge=>{var tt;const Be=null===(tt=Ge?.type)||void 0===tt?void 0:tt.characterValue;Be&&(i.childrenData[Be]=Ge)})}}}return console.log("newWidget ->",i,e),yield Mi(t,".widget_container"),i})}function Oi(k,o){return Cn(this,arguments,void 0,function*(e,t,l=!0,u,v){var L,g;let i=new Ro;i.html=e.html,i.widgetState=Object.assign({},u),i.widgetType=e.type,i.componentDidMountFunction=e.before_render,i.addEventFunction=e.after_render,i.mountChildWidgetsFunction=e.mount_child,i.customFunctions=e.custom_functions,i.inDevelopment=!1!==v,t.innerHTML="";let n=t;if(n&&(yield i.mount(n),e.widget=i,e.children.length>0&&(null===(L=i.childWidgetElement)||void 0===L?void 0:L.length)>0))for(let S=0;S<(null===(g=e.children)||void 0===g?void 0:g.length);S++){let O=e.children[S];for(let K=0;K<i.childWidgetElement.length;K++){let j=i.childWidgetElement[K];if(O.wrapper===j.id){const ae=Aa(O),Ie=yield Oi(ae,j,!1,i.widgetState,v);i.childWidgets.push(Ie),i.css=i.css+Ie.css+`#${j.id} { ${O.css} }`,Ie.dataChange(Ge=>{var tt;console.log("This is the data change in child",Ge);let Be=null===(tt=Ge?.type)||void 0===tt?void 0:tt.characterValue;Be&&(i.childrenData[Be]=Ge),console.log("new child data",i.childrenData)})}}}return console.log("newWidget ->",i,e),i})}function Aa(k){return k.html=k.html.replace(/<[^>]*\bclass=["'][^"']*\bwidget_container\b[^"']*["'][^>]*>/g,o=>o.replace(/\bwidget_container\b/g,"").trim()),k.html=k.html.replace(/<[^>]*\bdraggable=["'][^"']*\btrue\b[^"']*["'][^>]*>/g,o=>o.replace(/\btrue\b/g,"false").trim()),k.html=k.html.replace(/<[^>]*\bclass=["'][^"']*\bhover-element\b[^"']*["'][^>]*>/g,o=>o.replace(/\bhover-element\b/g,"").trim()),k.html=k.html.replace(/<[^>]*\bclass=["'][^"']*\bwb-block\b[^"']*["'][^>]*>/g,o=>o.replace(/\bwb-block\b/g,"").trim()),k.html=k.html.replace(/<[^>]*onclick="widgetSelected\(event\)"\s*,?\s*ondragover="_dragService\.dragOverWidgetElement\(event\)"\s*,?\s*ondrop="_dragService\.dropWidgetElement\(event\)"\s*,?\s*ondragstart="_dragService\.dragStartWidgetElement\(event\)"\s*,?\s*ondragend="_dragService\.dragEndWidgetElement\(event\)"[^>]*>/g,o=>o.replace(/onclick="widgetSelected\(event\)"/g,'onclick=""').replace(/ondragover="_dragService\.dragOverWidgetElement\(event\)"/g,'ondragover=""').replace(/ondrop="_dragService\.dropWidgetElement\(event\)"/g,'ondrop=""').replace(/ondragstart="_dragService\.dragStartWidgetElement\(event\)"/g,'ondragstart=""').replace(/ondragend="_dragService\.dragEndWidgetElement\(event\)"/g,'ondragend=""').trim()),k.html=k.html.replace(/<[^>]*\bondragstart=["'][^"']*\b_dragService\.onWidgetDragStart\(event\)\b[^"']*["'][^>]*>/g,o=>o.replace(/\b_dragService\.onWidgetDragStart\(event\)\b/g,"").trim()),k}function Kl(k,o){return Cn(this,void 0,void 0,function*(){return k&&1===k.nodeType&&k.querySelectorAll(o).forEach(e=>{for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.remove()}),k})}function Mi(k,o){return Cn(this,void 0,void 0,function*(){const e=k.querySelectorAll(o);for(const t of e){const l=t.parentElement;if(l){for(;t.firstChild;){const u=yield Kl(t.firstChild,o);l.insertBefore(u,t)}l.removeChild(t)}}})}var Yl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Yo(k){return Yl(this,arguments,void 0,function*(o,e=null,t="",l={concepts:[],connections:[]}){var u,v,L,g;if(Tt)try{const O=yield Gt("CreateData",{json:o,ofConcept:e,typeConcept:t,actions:l});return!(null===(v=null===(u=O?.actions)||void 0===u?void 0:u.concepts)||void 0===v)&&v.length&&(l.concepts=JSON.parse(JSON.stringify(O.actions.concepts))),!(null===(g=null===(L=O?.actions)||void 0===L?void 0:L.connections)||void 0===g)&&g.length&&(l.connections=JSON.parse(JSON.stringify(O.actions.connections))),O.data}catch(O){console.error("CreateTheComposition sw error: ",O),Ot(O)}let i=999,n=999,S=(0,ke.o)();for(const O in o){let K=Xl(O);if("string"!=typeof o[O]&&"number"!=typeof o[O])if(null==e||0==e.id)S=yield(0,Qe.k)(K,"",!0,i,4,n,void 0,l),Array.isArray(o[O])&&(K=La(K)),yield Yo(o[O],S,K,l);else{Array.isArray(o[O])&&(K=Na(K));let j=Na(O),ae=yield(0,Qe.k)(K,"",!0,i,4,n,void 0,l);S=ae;let Ie=Sa(t,j),Ge=yield(0,_t.$)(Ie,n,i,i,l);yield(0,jn.F)(e.id,ae.id,Ge.id,1e3,Ge.characterValue,i,l),Array.isArray(o[O])&&(K=La(K)),yield Yo(o[O],ae,K,l)}else{let j=Sa(t,O),ae=yield(0,_t.$)(j,n,i,i,l),Ie=yield(0,Qe.k)(O,o[O].toString(),!1,i,4,n,void 0,l);console.log("this is the type concept in down",ae,Ie),null!=e&&(yield(0,jn.F)(e.id,Ie.id,ae.id,1e3,j,i,l))}}return S})}function Xl(k){return k.startsWith("the_")?k:"the_"+k}function La(k){return k.endsWith("_s")?k:k+"_s"}function Na(k){return k.replace(/_s$/,"")}const ed=k=>/^[+-]?\d+(\.\d+)?$/.test(k);function Sa(k,o){return ed(o)?k+"_":k+"_"+((e=o).startsWith("the_")?e.slice(4):e);var e}class xa{constructor(){this.prototype="",this.required=[],this.optional=[],this.field="string",this.childPrototypes=[],this.isCompositional=!1,this.options=[],this.isQueryType=!1,this.querySelector=null,this.concepts=[],this.connections=[],this.addedConcepts=[],this.addedConnections=[]}}function Hn(k,o){if(Array.isArray(k)&&Array.isArray(o))for(let e=0;e<o.length;e++)k.push(o[e]);return k}var ho=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Pi(k){return ho(this,arguments,void 0,function*(o,e=null){let t=[],l=[],u=[],v=(0,ke.o)();try{null==e&&(e=new Fi,yield e.initialize());let L=[];if(o.isCompositional){if(v=yield function(n,S,O,K){return ho(this,void 0,void 0,function*(){let j=(0,ke.o)(),ae=yield K.MakeTheInstanceConceptLocal("the_composition","",!0,999,999,999),Ie=yield K.MakeTheTypeConceptLocal("the_composition_type",999,999,999),Ge=yield K.MakeTheTypeConceptLocal(n,999,999,999),tt=yield K.CreateTheConnectionLocal(ae.id,Ge.id,Ie.id,1e3,"the_composition_type");return j=ae,S.push(Ie),S.push(Ge),O.push(tt),j})}(o.prototype,t,l,e),o.isQueryType){let n=yield function(O,K,j){return ho(this,void 0,void 0,function*(){let ae=[],Ie=[],Ge="the_composition_filter_type",tt="the_composition_selector",Be=yield j.MakeTheTypeConceptLocal(Ge,999,999,999),ut=yield j.MakeTheTypeConceptLocal(tt,999,999,999);if(null!=O){let xt=yield j.MakeTheTypeConceptLocal(O.selector,999,999,999);ae.push(xt);let Mt=yield j.MakeTheTypeConceptLocal(O.filterType,999,999,999);ae.push(xt),ae.push(Mt);let Ht=yield j.CreateTheConnectionLocal(K.id,xt.id,ut.id,1e3,tt,999);Ie.push(Ht);let Qt=yield j.CreateTheConnectionLocal(K.id,Mt.id,Be.id,1e3,Ge,999);Ie.push(Qt)}return{concepts:ae,connections:Ie}})}(o.querySelector,v,e),S=n.concepts;Hn(u,n.connections),Hn(t,S)}if(o.options.length>0){let n=yield function(O,K,j){return ho(this,void 0,void 0,function*(){let ae=[],Ie=[],Ge="the_composition_s_option",tt=yield j.MakeTheTypeConceptLocal(Ge,999,999,999);for(let Be=0;Be<O.length;Be++){let ut=O[Be].type,xt=O[Be].value,Mt=yield j.MakeTheInstanceConceptLocal(ut,xt,!1,999,999,999);ae.push(Mt);let Ht=yield j.CreateTheConnectionLocal(K.id,Mt.id,tt.id,1e3,Ge,999);Ie.push(Ht)}return{concepts:ae,connections:Ie}})}(o.options,v,e),S=n.concepts;Hn(u,n.connections),Hn(t,S)}}else v=yield function(n,S){return ho(this,void 0,void 0,function*(){let O=yield(0,Ne.A)(5124),K=yield S.MakeTheTypeConceptLocal(n,999,999,999);return yield function(ae,Ie,Ge,tt){return ho(this,void 0,void 0,function*(){let Be=yield tt.CreateTheConceptLocal("",Ie.characterValue,999,ae.id,Ie.id,4,!1);return Be.characterValue=Ie.characterValue,Be.typeCharacter=Ie.characterValue,Be.isComposition=!0,Be.type=Ie,Be})}(O,K,0,S)})}(o.prototype,e),u=yield Ea(o.required,v,t,e,!0),L=yield Ea(o.optional,v,t,e),t.push(v);let g=Fa(v,!0,!0),i=yield e.MakeTheTypeConceptLocal(g,999,999,999);if(t.push(i),o.childPrototypes.length>0)for(let n=0;n<o.childPrototypes.length;n++){let S=yield Pi(o.childPrototypes[n]),O=S.mainConcept,K=S.connections,j=S.concepts,ae=yield e.CreateTheConnectionLocal(v.id,O.id,i.id,1e3,g,999);u.push(ae),Hn(u,K),Hn(t,j),t.push(O)}Hn(u,L),Hn(u,l),Hn(t,o.addedConcepts),Hn(u,o.addedConnections),o.concepts=t,o.connections=u,console.log("this is the connections",u)}catch{e?.rollbackTransaction()}return{concepts:t,connections:u,mainConcept:v}})}function Fa(k,o=!0,e=!1){var t;let l="the_prototype_of_"+(null===(t=k.type)||void 0===t?void 0:t.characterValue);return l+=o?"_requires":"_optional",e&&(l+="_the_composition"),l}function Ea(k,o,e,t){return ho(this,arguments,void 0,function*(l,u,v,L,g=!1,i=!1){let n=[],S=[],O=Fa(u,g,i),K=yield L.MakeTheTypeConceptLocal(O,999,999,999);v.push(K);for(let j=0;j<l.length;j++){let ae=yield L.MakeTheTypeConceptLocal(l[j],999,999,999);n.push(ae)}for(let j=0;j<n.length;j++){let ae=yield L.CreateTheConnectionLocal(u.id,n[j].id,K.id,1e3,O,999);S.push(ae)}for(let j=0;j<n.length;j++)v.push(n[j]);return S})}var Tt,tn=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};const td=Date.now().toString(36)+Math.random().toString(36).substring(2);let Wi=[],Qn=[],Vi=!1;function Ba(k){Vi=k}function $i(k="",o){sn.b.BearerAccessToken=k,sn.b.sessionId=null==typeof document?o:parseInt((0,Te.R)("SessionId")),Tt&&Gt("updateAccessToken",{accessToken:k,session:parseInt((0,Te.R)("SessionId"))})}function Da(){return tn(this,arguments,void 0,function*(k="",o="",e="",t="",l=!0,u="",v,L={},g={}){var i;try{a.B.BASE_URL=k,a.B.AI_URL=o,a.B.NODE_URL=t,a.B.BASE_APPLICATION=u,a.B.LOG_SERVER=null!==(i=g.logserver)&&void 0!==i?i:"https://logdev.freeschema.com",console.log("setting the logserver",a.B.LOG_SERVER,g.logserver),$i(e);let n=Math.floor(1e8*Math.random());a.B.setRandomizer(n);const S={logApplication:!1,logPackage:!1,accessTracker:!1,isTest:!1};if(a.B.FLAGS=S,a.B.FLAGS=Object.assign(Object.assign({},S),L),function(O){const K=Te.V.logfunction("initializeFlags",arguments);try{O.logApplication&&($l.initialize(),Te.V.logApplicationActivationStatus=!0,console.warn("Application log started.")),O.logPackage&&(Te.V.logPackageActivationStatus=!0,console.warn("Package log started.")),O.accessTracker&&(Eo.J.activateStatus=!0,console.warn("Access Tracker Activated.")),O.isTest&&(c.B.isDataLoaded=!0,c.B.isCharacterLoaded=!0,c.B.isTypeLoaded=!0,c.B.isLocalDataLoaded=!0,c.B.isLocalTypeLoaded=!0,c.B.isLocalCharacterLoaded=!0,c.B.isConnectionLoaded=!0,c.B.isConnectionTypeLoaded=!0,c.B.isLocalConnectionLoaded=!0),Te.V.logUpdate(K)}catch(j){throw(0,d.ey)(K,"initializeFlags",j),j}}(a.B.FLAGS),!("serviceWorker"in navigator))return yield Po(),void console.warn("Service Worker not supported in this browser.");if(yield function(){return tn(this,void 0,void 0,function*(){let O=sessionStorage.getItem("cacheServers");void 0!==O&&"undefined"!==O?(O=JSON.parse(O),O?a.B.NODE_CACHE_URL=Array.isArray(O)&&O.length?O[0]:a.B.BASE_URL:yield function(){return tn(this,void 0,void 0,function*(){try{const K=yield fetch(a.B.getMyCacheServer(),{method:"POST"});if(!K.ok)throw new Error("Failed to sync data to the server.");const j=yield K.json();j.success&&(sessionStorage.setItem("cacheServers",JSON.stringify(j.servers)),a.B.NODE_CACHE_URL=j.servers?j.servers[0]:a.B.BASE_URL)}catch(K){console.error("error getting cache server",K.message)}})}(),Gt("SESSION_DATA",{type:"SESSION_DATA",data:a.B.NODE_CACHE_URL})):a.B.NODE_CACHE_URL=a.B.BASE_URL})}(),function(){navigator.serviceWorker.addEventListener("message",O=>tn(this,void 0,void 0,function*(){var K,j,ae,Ie;try{if(O.data&&"API_401"===O.data.type){const{requestDetails:Ge}=O.data,tt={method:Ge.method,headers:new Headers(Ge.headers),body:Ge.body},Be=yield fetch(Ge.url,tt),ut=yield Be?.json();null===(j=null===(K=navigator?.serviceWorker)||void 0===K?void 0:K.controller)||void 0===j||j.postMessage({type:"API_RESPONSE",messageId:O.data.messageId,response:new Response(ut,{status:Be.status,statusText:Be.statusText,headers:Be.headers})})}}catch(Ge){console.error("Error during listenPostMessage",Ge),null===(Ie=null===(ae=navigator?.serviceWorker)||void 0===ae?void 0:ae.controller)||void 0===Ie||Ie.postMessage({type:"API_RESPONSE",messageId:O.data.messageId})}}))}(),function(){la.x.addEventListener("message",O=>tn(this,void 0,void 0,function*(){const{type:K,payload:j}=O.data;K&&(Ga[K]?yield Ga[K](j):console.warn(`Unable to handle "${K}" case in BC service worker`))}))}(),v&&v.activate&&v.manual)yield new Promise((O,K)=>{navigator.serviceWorker.ready.then(j=>tn(this,void 0,void 0,function*(){console.log("registraions ready",j),Tt=j.active,yield No(),O("done")})).catch(j=>{console.error("Error: Ready service worker",j),K(j)}).finally(()=>console.log("Finally service worker ready done")),setTimeout(()=>K("Timeout ready"),3e4)});else if(v&&v?.activate)try{console.log("service worker initialiing"),yield function(O){var K=arguments;return tn(this,void 0,void 0,function*(){const j=Te.V.logfunction("handleRegisterServiceWorker",K);yield new Promise((ae,Ie)=>{var Ge,tt;let Be=!1;navigator.serviceWorker.register(null!==(Ge=O.pathToSW)&&void 0!==Ge?Ge:"./serviceWorker.bundle.js",{scope:null!==(tt=O.scope)&&void 0!==tt?tt:"/"}).then(ut=>tn(this,void 0,void 0,function*(){console.log("Service Worker registered:",ut),setInterval(()=>{Qn.length&&Xo()},2e3),console.log("update listen start"),ut.onupdatefound=()=>{const xt=ut.installing;console.log("new worker",xt),xt&&(xt.onstatechange=()=>tn(this,void 0,void 0,function*(){console.warn("on state change triggered",xt.state,navigator.serviceWorker.controller),"installing"===xt.state&&(console.log("Service Worker installing"),Tt=void 0),"activated"!==xt.state&&"redundant"!==xt.state||!navigator.serviceWorker.controller||(Tt=xt,console.log("New Service Worker is active",ut),setTimeout(()=>{console.log("Message Processed after some time"),Xo()},5e3),yield No(),Be=!0,Xo(),ae())}))},ut.addEventListener("controllerchange",()=>tn(this,void 0,void 0,function*(){console.warn("controller change triggered",navigator.serviceWorker.controller),navigator.serviceWorker.controller&&(Tt=navigator.serviceWorker.controller,console.warn("Service worker has been activated; controller change"),yield No())})),(ut.installing||ut.waiting||ut.active)&&ut.addEventListener("statechange",xt=>tn(this,void 0,void 0,function*(){var Mt;"activating"===(null===(Mt=xt?.target)||void 0===Mt?void 0:Mt.state)&&(Tt=navigator.serviceWorker.controller,console.warn("Service Worker is activating statechange"),yield No())})),ut.active?(console.log("active sw"),Tt=ut.active,yield No(),Xo(),ae()):setTimeout(()=>{Be||Ie("Not Completed Initialization")},1e4)})).catch(ut=>tn(this,void 0,void 0,function*(){yield Po(),Ie(ut),console.error("Service Worker registration failed:",ut),(0,d.ey)(j,"handleRegisterServiceWorker",ut)}))})})}(v)}catch(O){yield Po(),console.error("Unable to start service worker",O)}else yield Po(),console.warn("Service Worker not activated");return!0}catch(n){yield Po(),console.warn("Cannot initialize the system",n)}})}function Gt(k,o){return tn(this,arguments,void 0,function*(e,t,l=0){let u=!1;const v=Math.random().toString(36).substring(2);t.messageId=v,t.TABID=td;const L=JSON.parse(JSON.stringify(t));let g;return"checkProcess"!=e&&0==l&&(g=setInterval(()=>tn(this,void 0,void 0,function*(){if(console.log("process took more than one second",v,e,u),!u&&!(yield function(i,n){return tn(this,void 0,void 0,function*(){var S;try{const O=yield Gt("checkProcess",{checkMessageId:i});if(console.log("check interval data res for type ",n,i,O.data),null===(S=O?.data)||void 0===S?void 0:S.processing)return!0}catch(O){return console.error("error on checing executing process",n,i,O),!1}})}(v,e))&&(clearInterval(g),!u)){if(console.log("Failed to handle type "+e+" message not found "+v,"retrying: ",0==l,e),0==l&&"checkProcess"!=e)return console.log("retrying ",e,v),yield Gt(e,t,l+1);console.log("Failed to handle type "+e+" "+v)}}),2e3)),new Promise((i,n)=>{if(navigator.serviceWorker.controller||Tt||console.log("will go to queue",navigator.serviceWorker.controller,Tt,e),navigator.serviceWorker.controller||Tt){const S=O=>{var K,j,ae,Ie,Ge,tt;(null===(K=O?.data)||void 0===K?void 0:K.messageId)==v&&(u=!0,clearInterval(g),O.data.success||(401==(null===(j=O?.data)||void 0===j?void 0:j.status)?n((0,d.ry)(new Response("Unauthorized",{status:401,statusText:null===(ae=O?.data)||void 0===ae?void 0:ae.statusText}))):500==(null===(Ie=O?.data)||void 0===Ie?void 0:Ie.status)?n((0,d.Mb)(new Response("Internal Server Error",{status:500,statusText:null===(Ge=O?.data)||void 0===Ge?void 0:Ge.statusText}))):(console.error("Error in the response from worker:",O),n(`Failed to handle action ${e} ${JSON.stringify(t)}, Response: ${JSON.stringify(O.data)}`))),!(null===(tt=O.data)||void 0===tt)&&tt.actions&&(t.actions=JSON.parse(JSON.stringify(O.data.actions))),i(O.data),navigator.serviceWorker.removeEventListener("message",S))};if(navigator.serviceWorker.addEventListener("message",S),navigator.serviceWorker.controller)"checkProcess"!=e&&console.log("sent to sw",e,v),navigator.serviceWorker.controller.postMessage({type:e,payload:L});else if(Tt){console.warn(`controller not found but serviceWorker is available. messageId: ${v}, type: ${e}`);try{Tt.postMessage({type:e,payload:L})}catch(O){console.log("Retrying again on catch service worker",O),Tt.postMessage({type:e,payload:L})}}else console.warn(`Service Worker hasn't loaded yet. messageId: ${v}, type: ${e}`),console.info("ready",navigator.serviceWorker.ready),setTimeout(()=>{console.warn(`Re-Trying after certain time. messageId: ${v}, type: ${e}`),Tt?(console.info("This is triggered "),Tt?.postMessage({type:e,payload:t})):(console.log("not ready",e),clearInterval(g),n("Service worker not ready"))},3e4);setTimeout(()=>{clearInterval(g),n(`No response from service worker after timeout: ${e}`),navigator.serviceWorker.removeEventListener("message",S)},21e4)}else Qn.push({message:{type:e,payload:L}}),console.log("Message Queued",e,t),console.log(navigator.serviceWorker.controller,Tt,e),"init"==e&&(clearInterval(g),i(null))})})}const Ga={GetLinkListener:k=>tn(void 0,void 0,void 0,function*(){return Wi.find(e=>e.listenerId==k.listenerId)?.callback(k.data),{success:!0}}),dispatchEvent:k=>tn(void 0,void 0,void 0,function*(){if(Tt){let o=new CustomEvent(k.id||"",k.data);dispatchEvent(o)}return{success:!0}}),checkInit:k=>tn(void 0,void 0,void 0,function*(){return console.log("service worker init 0"),navigator.serviceWorker.controller&&(console.log("service worker init 1"),Tt=navigator.serviceWorker.controller),yield No(),{success:!0}})};function Po(){return tn(this,void 0,void 0,function*(){yield(0,Vl.A)();const k=(new Date).getTime();yield(0,M.A)().then(()=>{let o=(new Date).getTime()-k;console.log("The time taken to prepare concept  data is  ",o)}).catch(o=>{throw o}),yield(0,sa.Ay)().then(()=>{let o=(new Date).getTime()-k;console.log("The time taken to prepare local concept  ",o)}).catch(o=>{throw o}),yield(0,ca.p)().then(()=>{c.B.isLocalConnectionLoaded=!0}).catch(o=>{throw o}),yield(0,sa.xd)().catch(o=>{throw console.log("This is the error in populating binary tree"),o}),yield(0,ca.a)().then(()=>{c.B.isConnectionLoaded=!0,c.B.isConnectionTypeLoaded=!0;let o=(new Date).getTime()-k;console.log("The time taken to prepare connections  ",o)}).catch(o=>{throw o})})}function Ua(k,o={}){if(Tt||typeof window<"u"){let e=new CustomEvent(`${k}`,o);dispatchEvent(e)}else la.x.postMessage({type:"dispatchEvent",payload:{id:k,data:o}})}function Xo(){return tn(this,void 0,void 0,function*(){console.log("message queue",Qn);const k=Qn.find(o=>{var e;return"init"==(null===(e=o?.message)||void 0===e?void 0:e.type)});if(k){console.log("Processing Init Queue poped",k?.type,k);const o=Qn.indexOf(k);o>-1&&Qn.splice(o,1),yield Gt(k?.type,k?.payload)}for(console.log("message queue while",Qn);Qn.length>0;){const{message:o}=Qn.shift();console.log("Queue poped",o.type,o),yield Gt(o.type,o.payload)}})}const Ot=k=>{if(k instanceof Oe.z)throw console.error("FreeSchemaResponse Error",k),k;console.error("Service Worker Error",k)};function No(){return tn(this,void 0,void 0,function*(){yield Gt("init",{url:a.B.BASE_URL,aiurl:a.B.AI_URL,accessToken:sn.b.BearerAccessToken,nodeUrl:a.B.NODE_URL,enableAi:!1,applicationName:a.B.BASE_APPLICATION,flags:a.B.FLAGS})})}}},Wt={};function pe(Re){var ce=Wt[Re];if(void 0!==ce)return ce.exports;var _=Wt[Re]={exports:{}};return je[Re](_,_.exports,pe),_.exports}pe.d=(Re,ce)=>{for(var _ in ce)pe.o(ce,_)&&!pe.o(Re,_)&&Object.defineProperty(Re,_,{enumerable:!0,get:ce[_]})},pe.o=(Re,ce)=>Object.prototype.hasOwnProperty.call(Re,ce),pe.r=Re=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(Re,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Re,"__esModule",{value:!0})};var q=pe(1834),$e=q.ADMIN,U=q.ALLID,st=q.AccessTracker,dt=q.AddGhostConcept,it=q.Anomaly,Ye=q.BaseUrl,Xe=q.BinaryTree,Ve=q.BuildWidgetFromId,Nt=q.BuilderStatefulWidget,se=q.Composition,$=q.CompositionBinaryTree,ee=q.CompositionNode,re=q.Concept,le=q.ConceptsData,ie=q.Connection,ve=q.ConnectionData,he=q.CreateComposition,xe=q.CreateConnection,Le=q.CreateConnectionBetweenEntityLocal,Ze=q.CreateConnectionBetweenTwoConcepts,ct=q.CreateConnectionBetweenTwoConceptsGeneral,Se=q.CreateConnectionBetweenTwoConceptsLocal,rt=q.CreateData,gt=q.CreateDefaultConcept,Ft=q.CreateDefaultLConcept,$t=q.CreateSession,Kt=q.CreateSessionVisit,Bt=q.CreateTheCompositionLocal,Yt=q.CreateTheCompositionWithCache,on=q.CreateTheConnection,un=q.CreateTheConnectionGeneral,hn=q.CreateTheConnectionLocal,me=q.DATAID,ne=q.DATAIDDATE,Y=q.DelayFunctionExecution,X=q.DeleteConceptById,Q=q.DeleteConceptLocal,W=q.DeleteConnectionById,J=q.DeleteConnectionByType,oe=q.DeleteUser,ge=q.DependencyObserver,Ce=q.FilterSearch,Pe=q.FormatFromConnections,Je=q.FormatFromConnectionsAltered,He=q.FreeschemaQuery,Fe=q.FreeschemaQueryApi,nt=q.GetAllConnectionsOfComposition,wt=q.GetAllConnectionsOfCompositionBulk,pt=q.GetAllTheConnectionsByTypeAndOfTheConcept,Ut=q.GetComposition,Zt=q.GetCompositionBulk,Rt=q.GetCompositionBulkWithDataId,jt=q.GetCompositionFromConnectionsWithDataId,Pt=q.GetCompositionFromConnectionsWithDataIdFromConnections,Xt=q.GetCompositionFromConnectionsWithDataIdInObject,wn=q.GetCompositionFromConnectionsWithDataIdIndex,Fo=q.GetCompositionFromConnectionsWithIndex,ii=q.GetCompositionFromConnectionsWithIndexFromConnections,ri=q.GetCompositionFromMemoryWithConnections,Pa=q.GetCompositionList,Wa=q.GetCompositionListAll,Va=q.GetCompositionListAllWithId,$a=q.GetCompositionListListener,ja=q.GetCompositionListLocal,Ha=q.GetCompositionListLocalWithId,qa=q.GetCompositionListWithId,Ja=q.GetCompositionListWithIdUpdated,za=q.GetCompositionListener,Za=q.GetCompositionLocal,Qa=q.GetCompositionLocalWithId,Ka=q.GetCompositionWithAllIds,Ya=q.GetCompositionWithCache,Xa=q.GetCompositionWithDataIdBulk,ec=q.GetCompositionWithDataIdWithCache,tc=q.GetCompositionWithId,nc=q.GetCompositionWithIdAndDateFromMemory,oc=q.GetConceptBulk,ic=q.GetConceptByCharacter,rc=q.GetConceptByCharacterAndCategoryLocal,ac=q.GetConceptByCharacterAndType,cc=q.GetConnectionBetweenTwoConceptsLinker,sc=q.GetConnectionBulk,lc=q.GetConnectionById,dc=q.GetConnectionDataPrefetch,uc=q.GetConnectionOfTheConcept,hc=q.GetLink,pc=q.GetLinkListListener,fc=q.GetLinkListener,yc=q.GetLinkRaw,gc=q.GetLinkerConnectionFromConcepts,vc=q.GetLinkerConnectionToConcepts,mc=q.GetRelation,Cc=q.GetRelationLocal,_c=q.GetRelationRaw,Tc=q.GetTheConcept,wc=q.GetTheConceptLocal,Ic=q.GetUserGhostId,kc=q.JUSTDATA,bc=q.LConcept,Ac=q.LConnection,Lc=q.LISTNORMAL,Nc=q.LocalConceptsData,Sc=q.LocalSyncData,xc=q.LocalTransaction,Fc=q.Logger,Ec=q.LoginToBackend,Bc=q.MakeTheInstanceConcept,Dc=q.MakeTheInstanceConceptLocal,Gc=q.MakeTheTimestamp,Uc=q.MakeTheTypeConceptApi,Rc=q.MakeTheTypeConceptLocal,Oc=q.NORMAL,Mc=q.PRIVATE,Pc=q.PUBLIC,Wc=q.PatcherStructure,Vc=q.Prototype,$c=q.RAW,jc=q.RecursiveSearchApi,Hc=q.RecursiveSearchApiNewRawFullLinker,qc=q.RecursiveSearchApiRaw,Jc=q.RecursiveSearchApiRawFullLinker,zc=q.RecursiveSearchApiWithInternalConnections,Zc=q.RecursiveSearchListener,Qc=q.SchemaQuery,Kc=q.SchemaQueryListener,Yc=q.SearchAllConcepts,Xc=q.SearchLinkInternal,es=q.SearchLinkInternalAll,ts=q.SearchLinkMultipleAll,ns=q.SearchLinkMultipleAllObservable,os=q.SearchLinkMultipleApi,is=q.SearchQuery,rs=q.SearchStructure,as=q.SearchWithLinker,cs=q.SearchWithTypeAndLinker,ss=q.SearchWithTypeAndLinkerApi,ls=q.Selector,ds=q.SessionData,us=q.Signin,hs=q.Signup,ps=q.SignupEntity,fs=q.SplitStrings,ys=q.StatefulWidget,gs=q.SyncData,vs=q.TrashTheConcept,ms=q.UpdateComposition,Cs=q.UpdateCompositionLocal,_s=q.UserBinaryTree,Ts=q.Validator,ws=q.ViewInternalData,Is=q.ViewInternalDataApi,ks=q.WidgetTree,bs=q.convertFromConceptToLConcept,As=q.convertFromLConceptToConcept,Ls=q.convertWidgetTreeToWidget,Ns=q.convertWidgetTreeToWidgetWithWrapper,Ss=q.createFormFieldData,xs=q.createPrototypeLocal,Fs=q.dispatchIdEvent,Es=q.getFromDatabaseWithType,Bs=q.getObjectsFromIndexDb,Ds=q.getWidgetBulkFromId,Gs=q.getWidgetFromId,Us=q.handleServiceWorkerException,Rs=q.hasActivatedSW,Os=q.init,Ms=q.recursiveFetch,Ps=q.recursiveFetchNew,Ws=q.removeAllChildren,Vs=q.renderLatestWidget,$s=q.renderPage,js=q.renderWidget,Hs=q.searchLinkMultipleListener,qs=q.sendEmail,Js=q.sendMessage,zs=q.serviceWorker,Zs=q.setHasActivatedSW,Qs=q.storeToDatabase,Ks=q.subscribedListeners,Ys=q.unwrapContainers,Xs=q.updateAccessToken,el=q.uploadAttachment,tl=q.uploadFile,nl=q.uploadImage,ol=q.validDocumentFormats,il=q.validImageFormats},793:(vt,R)=>{Object.defineProperty(R,"__esModule",{value:!0}),R.setConfiguration=R.config=R.myprefix=void 0,R.myprefix="Boomconsole_FMS_2024_",R.config={userToken:"",userId:0,userConcept:0,apiUrl:"",aiUrl:"",nodeUrl:"",icons:{}},R.setConfiguration=function(ot){R.config=Object.assign({},ot)}}},yt={};function qe(vt){var R=yt[vt];if(void 0!==R)return R.exports;var ot=yt[vt]={exports:{}};return Nn[vt].call(ot.exports,ot,ot.exports,qe),ot.exports}return qe.d=(vt,R)=>{for(var ot in R)qe.o(R,ot)&&!qe.o(vt,ot)&&Object.defineProperty(vt,ot,{enumerable:!0,get:R[ot]})},qe.o=(vt,R)=>Object.prototype.hasOwnProperty.call(vt,R),qe.r=vt=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(vt,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(vt,"__esModule",{value:!0})},qe(156)})()}}]);
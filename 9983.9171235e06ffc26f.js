(self.webpackChunkngx_boomconsole=self.webpackChunkngx_boomconsole||[]).push([[9983],{4954:(wo,Nn,gt)=>{"use strict";gt.d(Nn,{$:()=>O});var je=gt(4650),mt=gt(9446);let O=(()=>{const $e=class{constructor(fe){this._activeModal=fe,this.slides=[],this.currentSlideUrl="",this.i=0}ngOnInit(){this.slides=this.imageUrl||[],this.slides.length>0&&(this.currentSlideUrl=this.slides[this.i]?.url||this.slides[this.i]?.path)}showSlide(fe){this.slides&&this.slides.length>0&&fe>=0&&fe<this.slides.length&&(this.currentSlideUrl=this.slides[fe].url||this.slides[fe].path)}getPrev(){this.i>0&&(this.i=this.i-1),this.showSlide(this.i)}getNext(){this.i<this.slides.length-1&&(this.i=this.i+1),this.showSlide(this.i)}handleKeyboardEvent(fe){"ArrowLeft"===fe.key?this.getPrev():"ArrowRight"===fe.key&&this.getNext()}};let tt=$e;return $e.\u0275fac=function(H){return new(H||$e)(je.Y36(mt.Kz))},$e.\u0275cmp=je.Xpm({type:$e,selectors:[["app-full-image-preview"]],hostBindings:function(H,Ve){1&H&&je.NdJ("keydown",function(lt){return Ve.handleKeyboardEvent(lt)},!1,je.Jf7)},inputs:{imageUrl:"imageUrl",i:"i"},decls:15,vars:3,consts:[["type","button","aria-label","Close",1,"btn-close",3,"click"],["id","carouselExampleControls",1,"carousel","slide"],[1,"carousel-inner"],[1,"carousel-item","active"],["alt","slide",1,"d-block","w-100",3,"src"],["role","button",1,"carousel-control-prev",3,"click"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"sr-only"],["role","button",1,"carousel-control-next",3,"click"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"carousel-index"]],template:function(H,Ve){1&H&&(je.TgZ(0,"button",0),je.NdJ("click",function(){return Ve._activeModal.dismiss()}),je.qZA(),je.TgZ(1,"div",1)(2,"div",2)(3,"div",3),je._UZ(4,"img",4),je.qZA()(),je.TgZ(5,"a",5),je.NdJ("click",function(){return Ve.getPrev()}),je._UZ(6,"span",6),je.TgZ(7,"span",7),je._uU(8,"Previous"),je.qZA()(),je.TgZ(9,"a",8),je.NdJ("click",function(){return Ve.getNext()}),je._UZ(10,"span",9),je.TgZ(11,"span",7),je._uU(12,"Next"),je.qZA()(),je.TgZ(13,"div",10),je._uU(14),je.qZA()()),2&H&&(je.xp6(4),je.Q6J("src",Ve.currentSlideUrl,je.LSH),je.xp6(10),je.AsE("",Ve.i+1," / ",Ve.slides.length,""))},styles:[".btn-close[_ngcontent-%COMP%]{position:absolute;right:-10px;z-index:999;top:-10px;background-color:#fff;border-radius:50%;padding:8px;opacity:1;box-shadow:0 3px 3px #0000004d}#carouselExampleControls[_ngcontent-%COMP%]{position:relative;width:100%;max-width:800px;margin:auto}.carousel-inner[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.carousel-control-prev[_ngcontent-%COMP%], .carousel-control-next[_ngcontent-%COMP%]{position:absolute;top:50%;width:5%;height:50px;background-color:#00000080;color:#fff;border:none;border-radius:50%;transform:translateY(-50%);display:flex;align-items:center;justify-content:center}.carousel-control-prev[_ngcontent-%COMP%]{left:10px}.carousel-control-next[_ngcontent-%COMP%]{right:10px}.carousel-control-prev-icon[_ngcontent-%COMP%], .carousel-control-next-icon[_ngcontent-%COMP%]{background-size:100%,100%;background-repeat:no-repeat;background-position:center}.carousel-index[_ngcontent-%COMP%]{position:absolute;bottom:10px;left:50%;transform:translate(-50%);background-color:#00000080;color:#fff;padding:5px 10px;border-radius:5px}"]}),tt})()},3139:(wo,Nn,gt)=>{"use strict";gt.d(Nn,{f:()=>oe});var je=gt(5861),mt=gt(9808),O=gt(6251),tt=gt(7899),$e=gt(4006),Dt=gt(6636),fe=gt.n(Dt),H=gt(2340),Ve=gt(9402),U=gt(4650),lt=gt(7518),dt=gt(9446),nt=gt(7009),Je=gt(384),He=gt(8154),et=gt(8180),De=gt(4383),X=gt(1685),q=gt(6895);function se(J,ue){1&J&&(U.TgZ(0,"div",18),U._UZ(1,"span",19),U.qZA())}function ie(J,ue){if(1&J&&(U.TgZ(0,"div",20)(1,"p",21),U._uU(2),U.TgZ(3,"a",22),U._uU(4,"here"),U.qZA(),U._uU(5,". "),U.qZA()()),2&J){const ee=U.oxw(2);U.xp6(2),U.hij(" Your quota for uploading file ",null==ee.uploadFilesInfo?null:ee.uploadFilesInfo.limit," has exceeded. Please upgrade your plan "),U.xp6(1),U.Q6J("routerLink","/subscription")}}function le(J,ue){if(1&J&&U._UZ(0,"img",38),2&J){const ee=U.oxw(2).$implicit;U.Q6J("src",ee.preview,U.LSH)}}function ce(J,ue){if(1&J&&(U.TgZ(0,"a",36),U.YNc(1,le,1,1,"img",37),U.qZA()),2&J){const ee=U.oxw().$implicit;U.Q6J("href",ee.url,U.LSH),U.xp6(1),U.Q6J("ngIf",ee.preview)}}function re(J,ue){1&J&&(U.TgZ(0,"span"),U._uU(1,"\u2022 Uploading..."),U.qZA())}function Ae(J,ue){1&J&&(U.TgZ(0,"span"),U._uU(1,"\u2022 Uploaded"),U.qZA())}function Ge(J,ue){if(1&J&&(U.TgZ(0,"span"),U._uU(1),U.qZA()),2&J){const ee=U.oxw().$implicit;U.xp6(1),U.hij("\u2022 Error: ",ee.error,"")}}function Pe(J,ue){if(1&J&&(U.TgZ(0,"a",39),U._uU(1,"Open"),U.qZA()),2&J){const ee=U.oxw().$implicit;U.Q6J("href",ee.url,U.LSH)}}function ve(J,ue){if(1&J){const ee=U.EpF();U.TgZ(0,"div",25),U.YNc(1,ce,2,2,"a",26),U.TgZ(2,"div",27)(3,"span",28),U._uU(4),U.qZA(),U.TgZ(5,"div",29)(6,"div",30),U._uU(7),U.qZA(),U.TgZ(8,"div",31),U._uU(9),U.YNc(10,re,2,0,"span",32),U.YNc(11,Ae,2,0,"span",32),U.YNc(12,Ge,2,1,"span",32),U.qZA()(),U.TgZ(13,"div",33),U.YNc(14,Pe,2,1,"a",34),U.TgZ(15,"button",35),U.NdJ("click",function(){const pe=U.CHM(ee).index,Le=U.oxw(3);return U.KtG(Le.removeFile(pe))}),U._uU(16," Remove "),U.qZA()()()()}if(2&J){const ee=ue.$implicit,j=U.oxw(3);U.xp6(1),U.Q6J("ngIf",ee.url&&j.isImageExtension(ee.extension)),U.xp6(3),U.Oqu(j.getFileIconFromExtension(ee.extension)),U.xp6(2),U.s9C("title",ee.file.name),U.xp6(1),U.hij(" ",ee.file.name," "),U.xp6(2),U.hij(" ",j.formatFileSize(ee.file.size)," "),U.xp6(1),U.Q6J("ngIf","uploading"===ee.status),U.xp6(1),U.Q6J("ngIf","done"===ee.status),U.xp6(1),U.Q6J("ngIf","error"===ee.status),U.xp6(2),U.Q6J("ngIf",ee.url)}}function ot(J,ue){if(1&J&&(U.TgZ(0,"div",23),U.YNc(1,ve,17,9,"div",24),U.qZA()),2&J){const ee=U.oxw(2);U.xp6(1),U.Q6J("ngForOf",ee.uploadedFiles)}}function ht(J,ue){if(1&J){const ee=U.EpF();U.TgZ(0,"div",4)(1,"h2",5),U._uU(2,"Upload to Folder"),U.qZA(),U.TgZ(3,"div",6)(4,"label",7),U._uU(5,"Document(s)"),U.qZA(),U.YNc(6,se,2,0,"div",8),U.TgZ(7,"div",9)(8,"input",10),U.NdJ("change",function(Y){U.CHM(ee);const pe=U.oxw();return U.KtG(pe.uploadAttachments(Y))}),U.qZA()(),U.YNc(9,ie,6,2,"div",11),U.qZA(),U.YNc(10,ot,2,1,"div",12),U.TgZ(11,"div",6)(12,"label",13),U._uU(13,"Description"),U.qZA(),U.TgZ(14,"textarea",14),U.NdJ("keyup",function(Y){U.CHM(ee);const pe=U.oxw();return U.KtG(pe.handleDescriptionChange(Y))}),U.qZA()(),U.TgZ(15,"div",15)(16,"button",16),U.NdJ("click",function(){U.CHM(ee);const Y=U.oxw();return U.KtG(Y.saveUploadedCaptures())}),U._uU(17," Save Data "),U.qZA(),U.TgZ(18,"button",17),U.NdJ("click",function(){U.CHM(ee);const Y=U.oxw();return U.KtG(Y._activeModal.close())}),U._uU(19," Close "),U.qZA()()()}if(2&J){const ee=U.oxw();U.xp6(6),U.Q6J("ngIf",ee.uploadLoader),U.xp6(3),U.Q6J("ngIf",!ee.isAllowedToUploadFile),U.xp6(1),U.Q6J("ngIf",ee.uploadedFiles&&ee.uploadedFiles.length>0),U.xp6(6),U.Q6J("disabled",ee.uploadLoader||ee.loader||!ee.isAllowedToUploadFile||!ee.hasAnyUploadedFiles())}}function vt(J,ue){1&J&&(U.TgZ(0,"div",18),U._UZ(1,"span",19),U.qZA())}function Pt(J,ue){1&J&&(U.TgZ(0,"div",18),U._UZ(1,"span",19),U.qZA())}function Jt(J,ue){1&J&&(U.TgZ(0,"div",48),U._uU(1," Document name is required. "),U.qZA())}function Kt(J,ue){1&J&&(U.TgZ(0,"div",48),U._uU(1," Document name cannot be longer than 10 characters. "),U.qZA())}const ct=function(J,ue,ee){return{"ng-untouched":J,"ng-pristine":ue,"ng-invalid":ee}};function Ut(J,ue){if(1&J){const ee=U.EpF();U.TgZ(0,"input",46),U.NdJ("change",function(Y){U.CHM(ee);const pe=U.oxw(3);return U.KtG(pe.handleFileNameChange(Y))}),U.qZA(),U.YNc(1,Jt,2,0,"div",47),U.YNc(2,Kt,2,0,"div",47)}if(2&J){const ee=U.oxw(3);let j,Y,pe;U.Q6J("ngClass",U.kEZ(3,ct,null==(j=ee.myForm.get("documentName"))?null:j.untouched,null==(j=ee.myForm.get("documentName"))?null:j.pristine,(null==(j=ee.myForm.get("documentName"))?null:j.invalid)&&(null==(j=ee.myForm.get("documentName"))?null:j.touched))),U.xp6(1),U.Q6J("ngIf",(null==(Y=ee.myForm.get("documentName"))?null:Y.hasError("required"))&&(null==(Y=ee.myForm.get("documentName"))?null:Y.touched)),U.xp6(1),U.Q6J("ngIf",(null==(pe=ee.myForm.get("documentName"))?null:pe.hasError("maxlength"))&&(null==(pe=ee.myForm.get("documentName"))?null:pe.touched))}}function Vt(J,ue){if(1&J&&(U.TgZ(0,"div",6)(1,"label",7),U._uU(2,"Document Name"),U.qZA(),U.YNc(3,vt,2,0,"div",44),U.YNc(4,Pt,2,0,"div",8),U.YNc(5,Ut,3,7,"ng-template",null,45,U.W1O),U.qZA()),2&J){const ee=U.MAs(6),j=U.oxw(2);U.xp6(3),U.Q6J("ngIf",j.uploadLoader)("ngIfElse",ee),U.xp6(1),U.Q6J("ngIf",j.loader)}}function Ht(J,ue){if(1&J){const ee=U.EpF();U.TgZ(0,"button",16),U.NdJ("click",function(Y){U.CHM(ee);const pe=U.oxw(2);return U.KtG(pe.saveDocument(Y))}),U._uU(1," Save Data "),U.qZA()}if(2&J){const ee=U.oxw(2);U.Q6J("disabled",ee.isSaving||ee.uploadLoader||ee.loader||!ee.isAllowedToUploadFile)}}function Rt(J,ue){if(1&J){const ee=U.EpF();U.TgZ(0,"button",16),U.NdJ("click",function(){U.CHM(ee);const Y=U.oxw(3);return U.KtG(Y.updateDocument())}),U._uU(1," Update Data "),U.qZA()}if(2&J){const ee=U.oxw(3);U.Q6J("disabled",ee.uploadLoader||ee.loader||!ee.isAllowedToUploadFile)}}function Mt(J,ue){if(1&J&&U.YNc(0,Rt,2,1,"button",49),2&J){const ee=U.oxw(2);U.Q6J("ngIf",ee.documentId)}}function he(J,ue){if(1&J){const ee=U.EpF();U.TgZ(0,"div",4)(1,"h2",5),U._uU(2,"Save to Folder"),U.qZA(),U.TgZ(3,"form",40),U.YNc(4,Vt,7,3,"div",41),U.TgZ(5,"div",15),U.YNc(6,Ht,2,1,"button",42),U.YNc(7,Mt,1,1,"ng-template",null,43,U.W1O),U.TgZ(9,"button",17),U.NdJ("click",function(){U.CHM(ee);const Y=U.oxw();return U.KtG(Y._activeModal.close(!0))}),U._uU(10," Close "),U.qZA()()()()}if(2&J){const ee=U.MAs(8),j=U.oxw();U.xp6(3),U.Q6J("formGroup",j.myForm),U.xp6(1),U.Q6J("ngIf",!j.selectedFileURL),U.xp6(2),U.Q6J("ngIf",!j.documentId)("ngIfElse",ee)}}let oe=(()=>{const ue=class{constructor(j,Y,pe,Le,Se,Ze,it,Qe){this._snapshot=j,this._activeModal=Y,this._snackBar=pe,this._auth=Le,this._itemService=Se,this._snackbarService=Ze,this._folder=it,this.captureService=Qe,this.upload=!1,this.isUploadFromConsole=!1,this.loader=!1,this.folderSelector="#boom-sidebar-upload",this.captureTypes=O.Z,this.selectedFolders=[],this.boomgptComposition=tt.rG,this.selectedFileURL="",this.uploadedFiles=[],this.selectedDescription="",this.uploadLoader=!1,this.isAllowedToUploadFile=!0,this.isSaving=!1,this.validImageField=["png","jpeg","jpg","svg","webp"],this.validDocumentField=["pdf","txt","docx","doc","xlsx","pptx","mp4","mov","avi","wmv","mpeg"],this.getUserProfile();const Fe=this._auth.loadFromLocalStorage();this.userCompositionId=Fe.userConcept}ngOnDestroy(){this.subs.unsubscribe()}ngOnInit(){let j=localStorage.getItem("profile");j&&(this.userDetails=j=JSON.parse(j)),fe()({token:j.token,userId:j.theUserId||j.userId,userConcept:j.userConcept,...H.d}),Dt.FolderTreeModule.renderTreeSidebar({sidebarQuerySelector:this.folderSelector,navigateThroughLabel:!0,showCheckbox:!0},!0),this.myForm=new $e.cw({documentName:new $e.NI(this.docTitle,[$e.kI.required,$e.kI.maxLength(50)])}),this.subs=this._snapshot.queryParams.subscribe(Y=>{if(Y.s){const pe=Dt.FolderTreeModule.globalFolders;this.currentFolderId=Y.s;const Se=pe.filter(Ze=>Ze.id==Y.s).map(Ze=>({id:Ze?.id,name:Ze?.name}));Dt.FolderTreeModule.updateSelectedFolders(this.folderSelector,Se,!0)}else this.currentFolderId=""}),this.isUploadFromConsole||(Dt.FolderTreeModule.updateSelectedFolders(this.folderSelector,[{id:this.projectId,name:""}],!0),Dt.FolderTreeModule.setCurrentFolderId(this.projectId,this.folderSelector))}getUserProfile(){this._auth.getUserProfile().subscribe({next:j=>{const Y=j?.data?.the_user?.entity.person;this.userProfile={first_name:Y?.first_name,last_name:Y?.last_name,profile_img:Y?.profile_img,userid:j?.id}}})}getFileExtension(j){return j.split(".").pop()?.toLowerCase()||""}getFileIcon(j){switch(this.getFileExtension(j)){case"pdf":return"\u{1f4c4}";case"doc":case"docx":return"\u{1f4dd}";case"xls":case"xlsx":return"\u{1f4ca}";case"ppt":case"pptx":return"\u{1f4c8}";case"txt":return"\u{1f4c3}";case"mp4":case"mov":case"avi":case"wmv":case"mpeg":return"\u{1f3ac}";case"jpg":case"jpeg":case"png":case"gif":case"webp":return"\u{1f5bc}\ufe0f";default:return"\u{1f4c1}"}}uploadAttachment(j){var Y=this;return(0,je.Z)(function*(){Y.fileUploadErrorMessage="";const pe=["jpg","jpeg","png"],Le=["doc","docx","xls","xlsx","ppt","pptx","txt","pdf","mp4","mov","avi","wmv","mpeg"];let Se;if(j&&j.target&&j.target.files){if(!j.target.files[0])return null;Se=j.target.files[0]}else{if(!j||!j.name&&!j.size)return null;Se=j}if(!Se)return null;const it=Se.name.split(".").pop()?.toLowerCase()||"",Qe=Se.size/1024,Fe=yield Y._folder.checkUserSubscription("fileSize"),at=Fe?.isAllowedToCreate,It=Fe?.limit;if(Qe>=at)return Y.fileUploadErrorMessage=`File size must be less than ${It} KB`,Y._snackbarService.openSnackBar(Y.fileUploadErrorMessage,"warning"),null;Y.uploadLoader=!0;try{if(pe.includes(it)){const ft=new FormData;ft.append("image",Se);const Gt=yield(0,mt.n)(Y._itemService.uploadNewImage(ft));return Y.uploadLoader=!1,{url:Gt?.data,file:Se,extension:it}}if(Le.includes(it)){const ft=new FormData;ft.append("file",Se);const Gt=yield(0,mt.n)(Y._itemService.uploadFile(ft));return Y.uploadLoader=!1,{url:Gt?.data,file:Se,extension:it}}return Y.uploadLoader=!1,Y._snackbarService.openSnackBar("Invalid File Format","error"),null}catch{return Y.uploadLoader=!1,Y._snackbarService.openSnackBar("Sorry, couldn't upload file at the moment.","error"),null}})()}uploadAttachments(j){var Y=this;return(0,je.Z)(function*(){if(!j.target.files||0===j.target.files.length)return;const pe=j.target.files,Le=j.target;setTimeout(()=>Le.value="",0);const Se=Array.from(pe);Se.forEach(it=>{const Qe=(it.name.split(".").pop()||"").toLowerCase(),Fe={file:it,extension:Qe,preview:null,url:void 0,status:"pending"};if(Y.validImageField.includes(Qe)){const at=new FileReader;at.onload=()=>Fe.preview=at.result,at.readAsDataURL(it)}Y.uploadedFiles.push(Fe)}),Y.uploadLoader=!0;const Ze=Y.uploadedFiles.slice(-Se.length).map(it=>(it.status="uploading",Y.uploadAttachment(it.file).then(Qe=>{Qe&&Qe.url?(it.url=Qe.url,it.status="done"):(it.status="error",it.error="Upload failed")})));yield Promise.allSettled(Ze),Y.uploadLoader=Y.uploadedFiles.some(it=>"uploading"===it.status)})()}uploadImage(j){const Y=new FormData;Y.append("image",j),this._itemService.uploadNewImage(Y).subscribe({next:pe=>{this.selectedFileURL=pe.data,this.uploadLoader=!1},error:()=>{this.uploadLoader=!1,this._snackbarService.openSnackBar("Sorry, couldn't upload file at the moment.","error")}})}uploadFile(j){const Y=new FormData;Y.append("file",j),this._itemService.uploadFile(Y).subscribe({next:pe=>{this.selectedFileURL=pe.data,this.uploadLoader=!1},error:()=>{this.uploadLoader=!1,this._snackbarService.openSnackBar("Sorry, couldn't upload file at the moment.","error")}})}editSelectedFolders(j){this.selectedFolders=j}saveUploadedCaptures(){var j=this;return(0,je.Z)(function*(){if(j.fileUploadErrorMessage)return void j._snackbarService.openSnackBar(j.fileUploadErrorMessage,"warning");if(!j.hasAnyUploadedFiles())return void j._snackbarService.openSnackBar("No files ready for upload","warning");let Y;j.loader=!0;const pe={};for(let Le=0;Le<j.uploadedFiles.length;Le++){const Se=j.uploadedFiles[Le];if("done"!==Se.status)continue;Y={title:Se.file.name,short_desc:"",data_type:j.validImageField.includes(Se.extension)?O.Z.Image:O.Z.Document,image:Se.url,filepath:Se.url,filename:Se.file.name,boom_folder:{category_name:"",category_id:""},source_url:"",created_at:String(Date.now()),note:j.selectedDescription},pe[j.boomgptComposition]=Y;const Ze=Dt.FolderTreeModule.selectedFolders;j.selectedFolders=Ze.map(Qe=>parseInt(Qe?.id||Qe.category_id));const it=Ze.map(Qe=>({id:parseInt(Qe?.id||Qe.category_id),name:Qe?.name||Qe.category_name}));if(j.selectedFolders?.length>0)for(let Qe=0;Qe<it.length;Qe++){const Fe=it[Qe],at={category_name:Fe?.name||"",category_id:Fe?.id||""};Y={...Y,boom_folder:{...at}},pe[j.boomgptComposition]=Y,yield j.captureService.uploadDocument(pe,j.userDetails.theUserId,Fe?.id||Fe?.id,j.userDetails.userConcept)}else Y={...Y,boom_folder:{category_name:"",category_id:""}},pe[j.boomgptComposition]=Y,yield j.captureService.uploadDocument(pe,j.userDetails.theUserId,j.userDetails.userConcept,j.userDetails.userConcept)}j._activeModal.close("Media Uploaded!")})()}removeFile(j){j>=0&&j<this.uploadedFiles.length&&this.uploadedFiles.splice(j,1)}hasAnyUploadedFiles(){return this.uploadedFiles.some(j=>"done"===j.status)}isImageExtension(j){return this.validImageField.includes(j)}getFileIconFromExtension(j){switch(j){case"pdf":return"\u{1f4c4}";case"doc":case"docx":return"\u{1f4dd}";case"xls":case"xlsx":return"\u{1f4ca}";case"ppt":case"pptx":return"\u{1f4c8}";case"txt":return"\u{1f4c3}";case"mp4":case"mov":case"avi":case"wmv":case"mpeg":return"\u{1f3ac}";case"jpg":case"jpeg":case"png":case"gif":case"webp":return"\u{1f5bc}\ufe0f";default:return"\u{1f4c1}"}}formatFileSize(j){if(0===j)return"0 B";const Le=Math.floor(Math.log(j)/Math.log(1024));return parseFloat((j/Math.pow(1024,Le)).toFixed(2))+" "+["B","KB","MB","GB","TB"][Le]}handleFileNameChange(j){j.preventDefault(),this.isdocValue.docTitle=j.target.value}saveDocument(j){var Y=this;return(0,je.Z)(function*(){if(j.preventDefault(),Y.isdocValue.folderId=Dt.FolderTreeModule.selectedFolders,Y.myForm?.valid){Y.isSaving=!0,Y.loader=!0;try{const pe=localStorage.getItem("profile"),Le=JSON.parse(pe);if((yield(0,Ve.oKR)(Y.projectId,"my_console_s")).find(it=>it?.data?.the_createDocument?.docTitle==Y.isdocValue.docTitle))return Y._snackbarService.openSnackBar("document already exist","error"),Y.isSaving=!1,void(Y.loader=!1);{let it;if(yield Promise.all(Y.isdocValue.folderId&&Y.isdocValue.folderId?.map(function(){var Qe=(0,je.Z)(function*(Fe){const at={the_createDocument:{docTitle:Y.isdocValue?.docTitle,folderId:parseInt(Fe?.category_id),createdByEmail:Le?.email||"",created_by:Le?.userConcept||"",assignUsers:Y.isdocValue?.assignUsers||"",content:Y.isdocValue?.content||"",types:Y.isdocValue?.types||"",methodTypes:Y.isdocValue?.methodTypes||"",methodUrl:Y.isdocValue?.methodUrl||"",authType:Y.isdocValue?.authType||"",username:Y.isdocValue?.username||"",password:Y.isdocValue?.password||"",bearerToken:Y.isdocValue?.bearerToken||"",jsonList:Y.isdocValue?.jsonList||"",languageType:Y.isdocValue?.languageType||"",codeEditor:Y.isdocValue?.codeEditor||"",desAboutReturnOpt:Y.isdocValue?.desAboutReturnOpt||"",docsUrl:Y.isdocValue?.docsUrl||"",imagesUrl:Y.isdocValue?.imagesUrl||""}},It=yield(0,Ve.J0M)(parseInt(Fe.category_id)),ft=yield(0,Ve.joo)(at,void 0,void 0,void 0,Le.theUserId,4);yield(0,Ve.GIn)(It,ft,"my_console"),yield Ve.smK.SyncDataOnline();const Gt=yield(0,Ve.J0M)(ft.id);it={title:"Document Invitaion",body:`You are assign for ${Y.isdocValue?.docTitle} document`,timestamp:(new Date).toISOString(),link:`projects/view/${parseInt(Fe?.category_id)}?tab=Documentation&docid=${Gt.id}`}});return function(Fe){return Qe.apply(this,arguments)}}())),Y.isdocValue?.assignUsers.length>0){const Qe=Y.isdocValue?.assignUsers?.map(Fe=>Fe.id);if(Qe.length>0){const Fe={userConceptIds:Qe,fs_notification:it};(yield fetch(H.N.baseUrl+"/notification-bulk/send",{method:"POST",body:JSON.stringify(Fe),headers:{"Content-Type":"application/json",Authorization:`Bearer ${Y.userDetails.token}`}})).ok||Y._snackbarService.openSnackBar("Unable to send notification","error")}}Y._snackbarService.openSnackBar("document created successful","success"),Y.isSaving=!1,Y.loader=!1,Y.childComponent(),Y._activeModal.close()}}catch{Y._snackbarService.openSnackBar("Error creating Document","error")}}})()}updateDocument(){var j=this;return(0,je.Z)(function*(){if(j.isSaving=!0,j.loader=!0,j.myForm?.valid){j.isdocValue.folderId=Dt.FolderTreeModule.selectedFolders,j.isdocValue.docTitle=j.myForm.value.documentName;try{let Y;const pe=new Ve.MYZ;if(pe.userId=j.userProfile?.userid,pe.compositionId=j.documentId,j.isdocValue.folderId&&j.isdocValue?.folderId?.map(Le=>{pe.patchObject={docTitle:j.isdocValue?.docTitle||"",folderId:parseInt(Le?.category_id)||"",categoryName:Le&&Le?.category_name||"",last_updated_by:j.userProfile.first_name+" "+j.userProfile.last_name||"",assignUsers:j.isdocValue?.assignUsers||"",content:j.isdocValue?.content||"",types:j.isdocValue?.types||"",methodTypes:j.isdocValue?.methodTypes||"",methodUrl:j.isdocValue?.methodUrl||"",authType:j.isdocValue?.authType||"",username:j.isdocValue?.username||"",password:j.isdocValue?.password||"",bearerToken:j.isdocValue?.bearerToken||"",jsonList:j.isdocValue?.jsonList||"",languageType:j.isdocValue?.languageType||"",codeEditor:j.isdocValue?.codeEditor||"",desAboutReturnOpt:j.isdocValue?.desAboutReturnOpt||"",docsUrl:j.isdocValue?.docsUrl||"",imagesUrl:j.isdocValue?.imagesUrl||""},Y={title:"Document Invitaion",body:`You are assign for ${j.isdocValue?.docTitle} document`,timestamp:(new Date).toISOString(),link:`projects/view/${parseInt(Le?.category_id)}?tab=Documentation&docid=${j.documentId}`}}),yield(0,Ve.hrH)(pe),Ve.smK.SyncDataOnline(),j.isSaving=!1,j.loader=!1,j.isdocValue?.assignUsers.length>0){const Le=j.isdocValue?.assignUsers?.map(Se=>Se.id);Le.length>0&&(yield fetch("https://theta.boomconcole.com/api/notification-bulk/send",{method:"POST",body:JSON.stringify({userConceptIds:Le,fs_notification:Y}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${j.userDetails.token}`}}))}j._snackbarService.openSnackBar("Document Update successful","success"),j._activeModal.close()}catch{j._snackbarService.openSnackBar("Failed to Update Document","error")}j.childComponent()}})()}handleDescriptionChange(j){this.selectedDescription=j.target.value}};let J=ue;return ue.\u0275fac=function(Y){return new(Y||ue)(U.Y36(lt.gz),U.Y36(dt.Kz),U.Y36(nt.ux),U.Y36(Je.e),U.Y36(He.e),U.Y36(et.o),U.Y36(De.s),U.Y36(X.F))},ue.\u0275cmp=U.Xpm({type:ue,selectors:[["app-folder-upload-modal"]],inputs:{upload:"upload",isdoc:"isdoc",isdocValue:"isdocValue",singleDocValue:"singleDocValue",projectId:"projectId",documentId:"documentId",docTitle:"docTitle",childComponent:"childComponent",isUploadFromConsole:"isUploadFromConsole"},decls:5,vars:2,consts:[[1,"modal-body","row"],[1,"col-lg-5","col-md-6","col-sm-12","sidebar_wrapper"],["id","boom-sidebar-upload",1,"sidebar","bg-white"],["class","col-lg-7 col-md-6 col-sm-12",4,"ngIf"],[1,"col-lg-7","col-md-6","col-sm-12"],[1,"mb-3"],[1,"form-group"],["for","document",1,"form-label"],["class","loading","style","position: relative; min-height: 70px",4,"ngIf"],[1,"mb-2"],["type","file","name","document","id","document","multiple","","accept","application/msword, .docx, .doc, application/vnd.ms-excel, application/vnd.ms-powerpoint, text/plain, application/pdf, image/jpeg, image/jpg, image/png, video/mp4, video/mpeg, video/quicktime, video/x-msvideo, video/x-ms-wmv",1,"form-control",3,"change"],["class","d-inline-block",4,"ngIf"],["class","uploaded-list",4,"ngIf"],["for","description",1,"form-label"],["name","description","id","description","rows","3","placeholder","Add Description",1,"form-control",3,"keyup"],[1,"d-flex","flex-row","gap-2"],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-secondary",3,"click"],[1,"loading",2,"position","relative","min-height","70px"],[1,"loader",2,"position","relative"],[1,"d-inline-block"],[1,"text-danger","exceed-limit-msg"],["target","_blank",3,"routerLink"],[1,"uploaded-list"],["class","card d-flex align-items-center justify-content-start border rounded p-2 mb-2 uploaded-item",4,"ngFor","ngForOf"],[1,"card","d-flex","align-items-center","justify-content-start","border","rounded","p-2","mb-2","uploaded-item"],["target","_blank","class","d-flex align-items-center gap-2 no-decoration w-100",3,"href",4,"ngIf"],[1,"w-100","d-flex","align-items-center","gap-2"],[2,"font-size","24px","margin-right","10px"],[1,"file-meta"],[1,"file-name",3,"title"],[1,"file-sub","small","text-muted"],[4,"ngIf"],[1,"ms-auto","d-flex","gap-2"],["target","_blank","class","btn btn-sm btn-outline-secondary",3,"href",4,"ngIf"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],["target","_blank",1,"d-flex","align-items-center","gap-2","no-decoration","w-100",3,"href"],["alt","Image","class","thumb",3,"src",4,"ngIf"],["alt","Image",1,"thumb",3,"src"],["target","_blank",1,"btn","btn-sm","btn-outline-secondary",3,"href"],[3,"formGroup"],["class","form-group",4,"ngIf"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateDocumentAs",""],["class","loading","style","position: relative; min-height: 70px",4,"ngIf","ngIfElse"],["loaded",""],["formControlName","documentName","type","text","name","documentName","id","document","required","",1,"form-control",3,"ngClass","change"],["style","color: red",4,"ngIf"],[2,"color","red"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"]],template:function(Y,pe){1&Y&&(U.TgZ(0,"div",0)(1,"div",1),U._UZ(2,"div",2),U.qZA(),U.YNc(3,ht,20,4,"div",3),U.YNc(4,he,11,4,"div",3),U.qZA()),2&Y&&(U.xp6(3),U.Q6J("ngIf",!pe.isdoc),U.xp6(1),U.Q6J("ngIf",pe.isdoc))},dependencies:[q.mk,q.sg,q.O5,lt.rH,$e._Y,$e.Fj,$e.JJ,$e.JL,$e.Q7,$e.sg,$e.u],styles:[".exceed-limit-msg[_ngcontent-%COMP%]{font-size:.875rem;margin-top:.5rem;margin-bottom:0}.exceed-limit-msg[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline;color:#1f75cb}.exceed-limit-msg[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .exceed-limit-msg[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus{color:#ff9472}.sidebar_wrapper[_ngcontent-%COMP%]{max-height:600px;overflow:scroll}.uploaded-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}.uploaded-item[_ngcontent-%COMP%]{display:flex;align-items:center}.thumb[_ngcontent-%COMP%]{width:64px;height:48px;object-fit:cover;border-radius:4px;margin-right:8px;background:#f8f9fa;border:1px solid #e9ecef}.file-meta[_ngcontent-%COMP%]{overflow:hidden}.file-name[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:500}.no-decoration[_ngcontent-%COMP%]{text-decoration:none;color:inherit}"]}),J})()},1685:(wo,Nn,gt)=>{"use strict";gt.d(Nn,{F:()=>nt});var je=gt(5861),mt=gt(6296),O=gt(9402),tt=gt(7899),$e=gt(2902),Dt=gt(4650),fe=gt(8154),H=gt(4383),Ve=gt(8180),U=gt(384),lt=gt(5495);let dt=(()=>{const He=class{constructor(De,X){this._authService=De,this._items=X;const q=this._authService.loadFromLocalStorage();q&&(this.userConcept=q.userConcept,this.userId=q.theUserId)}formatDocumentation(De){if(!De)return[];const X=De?.[0]?.data?.the_documentation||[];return{isDocumentation:!0,types:X?.the_documentation_type?.[0]?.data?.the_type,title:X?.the_documentation_doc_title?.[0]?.data?.the_doc_title,data_type:"documentation",boom_folder:{category_name:X.categoryName,category_id:X.folderId},short_desc:X?.the_documentation_doc_title?.[0]?.data?.the_doc_title,visual_text:X?.the_documentation_content?.[0]?.data?.the_content,codeEditor:X?.the_documentation_code_editor?.[0]?.data?.the_code_editor,desAboutReturnOpt:X?.the_documentation_return?.[0]?.data?.the_return,methodTypes:X?.the_documentation_method?.[0]?.data?.the_method,url:X?.the_documentation_method_url?.[0]?.data?.the_method_url,authType:X?.the_documentation_auth_type?.[0]?.data?.the_auth_type,jsonKeyValuePair:Array.isArray(X?.the_documentation_s_json_list)?X.the_documentation_s_json_list.map(q=>{const se=q.data.the_json_list.the_json_list_key?.[0],ie=q.data.the_json_list.the_json_list_value?.[0],le=se?.data?.the_key,ce=ie?.data?.the_value;return{keyValuePairs:{[le]:ce}}}):[],imagesUrl:Array.isArray(X?.the_documentation_s_image_url)?X.the_documentation_s_image_url.map(q=>q?.data?.the_image_url):[],docsUrl:Array.isArray(X?.the_documentation_s_doc_url)?X.the_documentation_s_doc_url.map(q=>q?.data?.the_doc_url):[],videoLinks:Array.isArray(X?.the_documentation_s_video_link)?X.the_documentation_s_video_link.map(q=>q?.data?.the_video_link):[],bearer_token:X?.the_documentation_bearer_token?.[0]?.data?.the_bearer_token,basicAuthUserName:X?.the_documentation_username?.[0]?.data?.the_username,basicAuthpassword:X?.the_documentation_password?.[0]?.data?.the_password,note:"",created_by_email:X?.the_documentation_creator_email?.[0]?.data?.the_creator_email,source_url:"",id:De?.[0]?.id,created_at:De?.[0]?.created_at}}getSingleDocumentationDetails(De){var X=this;return(0,je.Z)(function*(){try{const q=[{composition:De,listLinkers:[],fullLinkers:["the_documentation_doc_title","the_documentation_type","the_documentation_created_by","the_documentation_creator_email","the_documentation_content","the_documentation_api_script","the_documentation_api_body","the_documentation_method","the_documentation_method_url","the_documentation_auth_type","the_documentation_username","the_documentation_password","the_documentation_bearer_token","the_documentation_language","the_documentation_code_editor","the_documentation_return","the_documentation_s_json_list","the_documentation_s_doc_url","the_documentation_s_video_link","the_documentation_s_image_url"],inpage:500,page:1,logic:"or",filterSearches:[]},{listLinkers:[],fullLinkers:["the_json_list_key","the_json_list_value"],inpage:1e3,page:1,logic:"or",filterSearches:[]}],se=yield(0,O.eHe)(q);return X.formatDocumentation([se])}catch(q){return console.error("Error fetching new doc data:",q),[]}})()}};let Je=He;return He.\u0275fac=function(X){return new(X||He)(Dt.LFG(U.e),Dt.LFG(fe.e))},He.\u0275prov=Dt.Yz7({token:He,factory:He.\u0275fac,providedIn:"root"}),Je})(),nt=(()=>{const He=class{constructor(De,X,q,se,ie,le){this._apiServices=De,this._folderService=X,this._snackbarService=q,this._authService=se,this.crmService=ie,this.documentationService=le,this.allCapturesInCurrentFolder=[],this.allFolders=[],this.userConcept=this._authService.loadFromLocalStorage().userConcept,this.entityId=this._authService.loadFromLocalStorage()?.entityId}getCaptures(De,X){var q=this;return(0,je.Z)(function*(){const se=["the_entity_title","the_entity_type","the_entity_name","the_entity_data_type","the_entity_first_name","the_entity_last_name","the_entity_tag","the_entity_note","the_entity_source_url","the_entity_avatar","the_documentation_doc_title","the_documentation_type","the_documentation_created_by","the_documentation_creator_email","the_documentation_content","the_documentation_api_script","the_documentation_api_body","the_documentation_method","the_documentation_method_url","the_documentation_auth_type","the_documentation_username","the_documentation_password","the_documentation_bearer_token","the_documentation_language","the_documentation_code_editor","the_documentation_return","the_documentation_s_json_list","the_documentation_s_doc_url","the_documentation_s_video_link","the_documentation_s_image_url","self"];return new Promise(ie=>{const le=new O.LtL;le.typeConnection="the_documentation_s_json_list",le.name="json",le.selectors=["the_json_list_key","the_json_list_value"];const ce=new O.LtL;ce.name="access1",ce.typeConnection=$e.Oc,ce.reverse=!0;const re=new O.LtL;re.name="access2",re.typeConnection=$e.Oc,re.reverse=!0;const Ae=new O.LtL;Ae.typeConnection=$e.u,Ae.name="contain",Ae.freeschemaQueries=[le,ce],Ae.selectors=se;const Ge=new O.LtL;Ge.name="folder",Ge.typeConnection=$e.NF,Ge.freeschemaQueries=[re],Ge.selectors=se;const Pe=new O.LtL;Pe.name="top",Pe.conceptIds=[Number(De)],Pe.outputFormat=O.xY7,Pe.freeschemaQueries=[Ge,Ae],(0,O.og0)(Pe,X).subscribe(ve=>{console.log("response",ve);const ht=(ve?.[0]?.data?Object.keys(ve[0]?.data):[]).find(ct=>"id"!==ct);let vt=[];const Pt=ve?.[0]?.data?.boomFolder?.[$e.u];if(Pt?.length){let ct=[];Pt.forEach(Ut=>{if(Ut?.data?.the_entity){const Vt=q.crmService.formatNewEntityContactsConsole([Ut],"preview"),Ht=Jt(Ut);Ht?.shared&&Vt.forEach(Rt=>{Rt.shared=Ht.shared}),ct=[...ct,...Vt]}else if(Ut?.data?.[tt.rG]?.crm_data){const Vt=q.crmService.formatOldEntityContactsConsole([Ut],"preview"),Ht=Jt(Ut);Ht?.shared&&ct.push(Ht?.shared),Ht?.shared&&Vt.forEach(Rt=>{Rt.shared=Ht.shared}),ct=[...ct,...Vt]}else{const Vt=Kt(Ut);Vt&&ct.push(Vt)}}),vt=ct,ie(vt)}else{let ct=[];ht===$e.TB?ct=ve?.[0]?.data?.[$e.TB]?.[$e.u]:"the_user"===ht&&(ct=ve?.[0]?.data?.the_user?.[$e.u]),vt=ct?.map(Ut=>Kt(Ut)),vt=vt?.filter(Boolean),ie(vt||[])}function Jt(ct){if(ct?.data){const Ut={...ct},Vt=ct?.data?.the_entity?.the_user_s_read_access_reverse||ct?.data?.boomgpt?.the_user_s_read_access_reverse;return Vt&&(Ut.shared=Vt),Ut}}function Kt(ct){if(ct?.data?.[$e.TB]&&Object.keys(ct?.data?.[$e.TB]).length){const Rt={name:ct?.data?.[$e.TB]?.name?.data?.the_name,parent:ct?.data?.[$e.TB]?.parent?.data?.the_parent,id:ct?.id,created_at:ct?.created_on},Mt=ct?.data?.[$e.TB][`${$e.Oc}_reverse`];return Mt&&(Rt.shared=Mt,delete ct?.data?.[$e.TB][`${$e.Oc}_reverse`]),Rt}if(ct?.data?.[tt.rG]){const Mt={...function Ht(Rt,Mt,he){const oe={};for(const J in Rt)if(J===`${Mt}_s_${he}_by`)oe.shared=Rt[J];else{if("comment"===J)continue;{const ue=Rt[J]?.data;if(ue&&"object"==typeof ue){const ee=Object.keys(ue)[0];oe[J]=ue[ee]}}}return oe}(ct.data[tt.rG],tt.rG,$e.Zm),id:ct.id,created_at:ct.created_on},he=ct?.data?.[tt.rG][`${$e.Oc}_reverse`];return he&&(Mt.shared=he,delete ct?.data?.[tt.rG][`${$e.Oc}_reverse`]),Mt}return ct?.data?.the_documentation?function Vt(Rt){if(!Rt?.data?.the_documentation)return null;const Mt=Rt.data.the_documentation,he=function Ut(Rt){const Mt={};for(const he in Rt){const oe=Rt[he];if(oe?.data&&"object"==typeof oe.data){const J=Object.keys(oe.data)[0];Mt[he]=oe.data[J]}}return Mt}(Mt);return{isDocumentation:!0,data_type:"documentation",id:Rt.id,created_at:Rt.created_on,title:he.the_documentation_doc_title,short_desc:he.the_documentation_doc_title,visual_text:he.the_documentation_content,types:he.the_documentation_type,codeEditor:he.the_documentation_code_editor,desAboutReturnOpt:he.the_documentation_return,methodTypes:he.the_documentation_method,url:he.the_documentation_method_url,authType:he.the_documentation_auth_type,bearer_token:he.the_documentation_bearer_token,basicAuthUserName:he.the_documentation_username,basicAuthpassword:he.the_documentation_password,created_by_email:he.the_documentation_creator_email,jsonKeyValuePair:Array.isArray(Mt.the_documentation_s_json_list)?Mt.the_documentation_s_json_list.map(oe=>{const J=oe.data?.the_json_list?.the_json_list_key?.[0],ue=oe.data?.the_json_list?.the_json_list_value?.[0],ee=J?.data?.the_key,j=ue?.data?.the_value;return{keyValuePairs:{[ee]:j}}}):[],imagesUrl:Array.isArray(Mt.the_documentation_s_image_url)?Mt.the_documentation_s_image_url.map(oe=>oe?.data?.the_image_url):[],docsUrl:Array.isArray(Mt.the_documentation_s_doc_url)?Mt.the_documentation_s_doc_url.map(oe=>oe?.data?.the_doc_url):[],videoLinks:Array.isArray(Mt.the_documentation_s_video_link)?Mt.the_documentation_s_video_link.map(oe=>oe?.data?.the_video_link):[],note:"",source_url:""}}(ct):null}ie(ve)})})})()}getCategories(De){return new Promise((X,q)=>{const se=`${$e.CH}_s`;(0,O.zAo)(Number(De),[se]).then(ie=>{let le=ie?.filter(re=>re?.data?.[$e.TB]&&re?.data?.[$e.TB]?.name);le=le?.map(re=>{const Ae={...re};return{name:Ae?.data?.[$e.TB]?.name,parent:Ae?.data?.[$e.TB]?.parent,description:Ae?.data?.[$e.TB]?.description,id:Ae?.id}}),le=le?.sort(function(re,Ae){const Ge=re?.name?.toLowerCase(),Pe=Ae?.name?.toLowerCase();return Ge.localeCompare(Pe)}),X({message:"success",status:200,data:le})}).catch(ie=>{q({message:"error",status:500,error:ie.message})})})}getCategoriesById(De,X){return new Promise((q,se)=>{(0,O.zAo)(De,[`${$e.CH}_s`]).then(le=>{let ce=le?.filter(Ae=>Ae?.data?.[$e.TB]&&Ae?.data?.[$e.TB]?.name);ce=ce?.map(Ae=>{const Ge={...Ae};return{name:Ge?.data?.[$e.TB]?.name,parent:Ge?.data?.[$e.TB]?.parent,description:Ge?.data?.[$e.TB]?.description,id:Ge?.id}}),ce=ce?.filter(Ae=>Ae?.id!==X),ce=ce?.sort(function(Ae,Ge){const Pe=Ae?.name?.toLowerCase(),ve=Ge?.name?.toLowerCase();return Pe.localeCompare(ve)});let re={};if(X===De)re={count:ce?.length,data:ce};else{const Ae=[],Ge=Pe=>{ce?.forEach(ve=>{ve?.parent==Pe&&(Ae.push(ve),Ge(ve?.id))})};Ge(X),re={count:Ae?.length,data:Ae},q(re)}}).catch(le=>{se(le)})})}getSharedCaptures(De){var X=this;return new Promise((q,se)=>{(0,O.$Er)(De,$e.Oc,100,1).then(function(){var le=(0,je.Z)(function*(ce){const re=ce,Ae=new Map;re.forEach((J,ue)=>{Ae.set(J.id,ue)});const Ge=re?.map(J=>({...J})),Pe=Ge?.filter(J=>J?.data?.boomgpt?.crm_data),ve=X.crmService.formatOldEntityContacts(Pe,"preview"),ot=re?.filter(J=>null!=J?.data?.the_entity),vt=(yield Promise.all(ot.map(function(){var J=(0,je.Z)(function*(ue){return yield X.crmService.getSingleEntityDetails(ue?.id,"sharedwithme")});return function(ue){return J.apply(this,arguments)}}()))).flat().map(J=>({...J,title:J?.profileInformation?.name?.value,data_type:J?.type})),Pt=re?.filter(J=>null!=J?.data?.the_documentation),Kt=(yield Promise.all(Pt.map(function(){var J=(0,je.Z)(function*(ue){return yield X.documentationService.getSingleDocumentationDetails(ue?.id)});return function(ue){return J.apply(this,arguments)}}()))).flat().map(J=>({...J,title:J?.title,data_type:J?.data_type}));let ct=Ge?.filter(J=>Object.prototype.hasOwnProperty.call(J?.data,tt.co));ct=ct?.map(J=>{let ue;return Object.prototype.hasOwnProperty.call(J?.data,tt.co)&&(ue={parent:"1",name:J?.data?.boomFolder?.name,created_at:J?.created_at,id:J?.id}),ue});let Ut=Ge?.filter(J=>Object.prototype.hasOwnProperty.call(J?.data,tt.rG));Ut=Ut?.map(J=>{let ue;return Object.prototype.hasOwnProperty.call(J?.data,tt.rG)&&(ue={...J?.data?.[tt.rG],created_at:J?.created_at,id:J?.id},ue.boom_folder={category_id:1,category_parent:"",category_name:"Shared With Me"}),ue}),console.warn("shared_captures",Ut);const Rt=[...ct,...Ut,...vt,...Kt,...ve],Mt=new Map;Rt.forEach(J=>{J&&J.id&&Mt.set(J.id,J)});const oe=Array.from(Mt.values()).sort((J,ue)=>(Ae.get(J.id)??1/0)-(Ae.get(ue.id)??1/0));console.warn("newDataArray",Rt),console.warn("uniqueCapturesArray",oe),q(oe)});return function(ce){return le.apply(this,arguments)}}()).catch(le=>{se(le)})})}selectFilteredCaptures(De,X,q,se,ie){let le=[];if(!ie)return[];const ce=ie?.filter(ve=>ve?.data_type),re=ie?.filter(ve=>ve?.name&&!ve?.type),Ge=[...new Map(re?.map(ve=>[ve?.id,ve])).values()].sort((ve,ot)=>{const ht=ve?.name,vt=ot?.name;return ht?.localeCompare(vt)});switch(De||Ge.push({id:1,name:"Shared With Me"}),le=[...Ge?.map(ve=>({...ve,data_type:ve?.data_type?ve?.data_type:"1folder"})),...ce].filter(ve=>"1folder"===ve?.data_type&&se?.folder||("extension_youchat"==ve?.data_type||"extension_poechat"==ve?.data_type||"extension_googlebard"==ve?.data_type||"extension_chatgpt"==ve?.data_type)&&se?.aichat||"extension_whatsapp_chat"==ve?.data_type&&se?.human_chat||("screenshot"==ve?.data_type||"traced_url"==ve?.data_type||"plain_text"==ve?.data_type||"visual_text"==ve?.data_type||"url"==ve?.data_type||"only_images"==ve?.data_type||"all_but_css"==ve?.data_type||"full_page"==ve?.data_type||"youtube_notes"==ve?.data_type||"all"==ve?.data_type)&&se?.captures||("Document"==ve?.data_type||"Image"==ve?.data_type)&&se?.document_image||("extension_linkedin"==ve?.data_type||"extension_whatsapp"==ve?.data_type||"individual"==ve?.data_type||"company"==ve?.data_type||"student"==ve?.data_type||"employee"==ve?.data_type||"patient"==ve?.data_type||"extension_merojob"==ve?.data_type||"government"==ve?.data_type||"extension_indeed"==ve?.data_type||"extension_maps"==ve?.data_type||"maps"==ve?.data_type||"web_crm"==ve?.data_type||"extension_monster"==ve?.data_type)&&se?.crm||"item_amazon"===ve?.data_type||"item_ebay"===ve?.data_type||"item_costco"===ve?.data_type||"item_kayak"===ve?.data_type||"item_expedia"===ve?.data_type||"item_agoda"===ve?.data_type||"documentation"===ve?.data_type||"sticky_note"===ve?.data_type||"widget"===ve?.data_type),X){case"type":le.sort(q?(ve,ot)=>{const ht=ve?.data_type,vt=ot?.data_type;return ht?.localeCompare(vt)}:(ve,ot)=>{const ht=ve?.data_type;return ot?.data_type.localeCompare(ht)});break;case"title":le.sort(q?(ve,ot)=>(ve?.title||ve?.name).localeCompare(ot?.title||ot?.name):(ve,ot)=>(ot?.title||ot?.name).localeCompare(ve?.title||ve?.name));break;case"note":le.sort(q?(ve,ot)=>ve?.note.localeCompare(ot?.note):(ve,ot)=>ot?.note.localeCompare(ve?.note))}return le}selectCaptureListsByIds(De,X){if(!De)return;const q=[];return X.forEach(se=>{const ie=De?.filter(le=>le?.id==se);q.push(ie[0])}),0==X?.length?null:q}searchCaptures(De,X){return new Promise(q=>{this._apiServices.getRecursiveSearchData(De,[],X).subscribe(se=>{let ie=se?.map(re=>{if(re?.data?.data?.[tt.rG]||re?.data?.data?.the_entity)return{...re?.data?.data?.[tt.rG]||re?.data?.data?.the_entity,id:re?.id,parent:[...re?.parent]}});ie=ie?.filter(re=>re);const ce=(ie?.length>0?[...ie]:[])?.map(re=>{let Ae="",Ge="",Pe="";if("extension_chatgpt"===re?.data_type||"extension_googlebard"===re?.data_type||"extension_poechat"===re?.data_type||"extension_youchat"===re?.data_type){const ot=re?.answer,ht=document.createElement("div");ht.innerHTML=ot,Ge=ht?.textContent,Pe=ht?.textContent?.toLowerCase()}else"item_amazon"===re?.data_type||"item_ebay"===re?.data_type||"item_costco"===re?.data_type||"item_kayak"===re?.data_type||"item_expedia"===re?.data_type||"item_agoda"===re?.data_type?(Ge=`${re?.itemData?.description} ${re?.itemData?.delivery}`,Pe=Ge?.toLowerCase()):("extension_indeed"===re?.data_type||"extension_indeed"===re?.type||"extension_linkedin"===re?.data_type||"extension_linkedin"===re?.type||"extension_monster"===re?.data_type||"extension_monster"===re?.type||"extension_maps"===re?.data_type||"extension_maps"===re?.type||"web_crm"===re?.data_type||"extension_whatsapp"===re?.data_type||"extension_whatsapp"===re?.type||"individual"==re?.type||"company"==re?.type||"student"==re?.type||"employee"==re?.type||"patient"==re?.type||"extension_merojob"==re?.type||"government"==re?.type||"extension_whatsapp_chat"===re?.data_type)&&(Ge=`${re?.crm_data?.name} ${re?.crm_data?.addresses?.[0]?.location||""} ${re?.crm_data?.companyWebsite||""}  ${re?.crm_data?.ceo||""} ${re?.crm_data?.founded||""} ${re?.crm_data?.companySize||""} ${re?.crm_data?.companyRevenue||""} ${re?.crm_data?.about} || ''`,Pe=Ge?.toLowerCase());const ve=Pe?.indexOf(X.toLowerCase());if(-1!==ve){const ot=Math.max(0,ve-20),ht=Math.min(Pe?.length,ve+X?.length+20);Ae=Ge?.substring(ot,ht)}else Ae="";return{...re,searchedContent:Ae}});if(ce?.length){let re=[];ce.forEach(Ae=>{let Ge=[];Ge=Ae?.the_entity_type?this.crmService.formatNewEntityContacts([Ae],"preview"):Ae?.crm_data?this.crmService.formatOldEntityContacts([Ae],"preview"):[{...Ae}],Ge=Ge?.map(Pe=>({...Pe,searchedContent:Ae.searchedContent,parent:Ae.parent})),re=[...re,...Ge]}),q(re)}else q(ce)})})}moveDataToFolder(De,X,q,se,ie){var le=this;return(0,je.Z)(function*(){let ce=localStorage.getItem("profile");ce&&(ce=JSON.parse(ce)),le.allCapturesInCurrentFolder=[...ie];const re=X,Ae=re?.filter(Pe=>Pe?.title),Ge=re?.filter(Pe=>Pe?.name&&!Pe.type);De.ctrlKey?(Ae?.length>0&&(yield le.copyCapturesToNewFolder(Ae,q.id||ce.userConcept)),Ge?.length>0&&le.validFolderCopy(Ge,q.id||ce.userConcept)&&(yield le.copyFoldersToNewFolder(Ge,q.id||ce.userConcept)),le._snackbarService.openSnackBar("Data copied to folder!","success")):(Ae?.length>0&&(yield le.moveCapturesToNewFolder(Ae,se||ce.userConcept,q.id||ce.userConcept)),Ge?.length>0&&le.validFolderMove(Ge,q.id||ce.userConcept)&&(yield le.moveFoldersToNewFolder(Ge,se||ce.userConcept,q.id||ce.userConcept)),le._snackbarService.openSnackBar("Data moved to folder!","success"))})()}moveCapturesToNewFolder(De,X,q){return(0,je.Z)(function*(){var le,se=!1,ie=!1;try{for(var re,ce=(0,mt.Z)(De);se=!(re=yield ce.next()).done;se=!1){const ct=re.value;{const Ut=yield(0,O.Mu8)(Number(ct?.id)),Vt=yield(0,O.J0M)(Number(ct?.id)),Ht=yield(0,O.Mu8)(Number(X)),Rt=yield(0,O.J0M)(Number(q)),Mt=yield(0,O.kqu)(Ht,Ut,"",$e.u,!0);var Pe,Ae=!1,Ge=!1;try{for(var ot,ve=(0,mt.Z)(Mt);Ae=!(ot=yield ve.next()).done;Ae=!1){const he=ot.value;yield(0,O.TAP)(he?.id)}}catch(he){Ge=!0,Pe=he}finally{try{Ae&&null!=ve.return&&(yield ve.return())}finally{if(Ge)throw Pe}}if("isBoomgpt"in ct){const he=yield(0,O.kqu)(Ht,Ut,"",$e.u,!0);var Pt,ht=!1,vt=!1;try{for(var Kt,Jt=(0,mt.Z)(he);ht=!(Kt=yield Jt.next()).done;ht=!1){const oe=Kt.value;yield(0,O.TAP)(oe?.id)}}catch(oe){vt=!0,Pt=oe}finally{try{ht&&null!=Jt.return&&(yield Jt.return())}finally{if(vt)throw Pt}}}yield(0,O.KFq)(Rt,Vt,$e.u)}}}catch(ct){ie=!0,le=ct}finally{try{se&&null!=ce.return&&(yield ce.return())}finally{if(ie)throw le}}yield O.smK.SyncDataOnline()})()}moveFoldersToNewFolder(De,X,q){return(0,je.Z)(function*(){try{var le,se=!1,ie=!1;try{for(var re,ce=(0,mt.Z)(De);se=!(re=yield ce.next()).done;se=!1){const ct=re.value;{const Ut=yield(0,O.Mu8)(ct?.id),Vt=yield(0,O.J0M)(ct?.id),Ht=yield(0,O.Mu8)(X),Rt=yield(0,O.J0M)(q),Mt=yield(0,O.kqu)(Ht,Ut,"",$e.u,!0),he=yield(0,O.kqu)(Ht,Ut,"",$e.NF,!0);var Pe,Ae=!1,Ge=!1;try{for(var ot,ve=(0,mt.Z)(Mt);Ae=!(ot=yield ve.next()).done;Ae=!1){const oe=ot.value;yield(0,O.TAP)(oe?.id)}}catch(oe){Ge=!0,Pe=oe}finally{try{Ae&&null!=ve.return&&(yield ve.return())}finally{if(Ge)throw Pe}}var Pt,ht=!1,vt=!1;try{for(var Kt,Jt=(0,mt.Z)(he);ht=!(Kt=yield Jt.next()).done;ht=!1){const oe=Kt.value;yield(0,O.TAP)(oe?.id)}}catch(oe){vt=!0,Pt=oe}finally{try{ht&&null!=Jt.return&&(yield Jt.return())}finally{if(vt)throw Pt}}yield(0,O.KFq)(Rt,Vt,$e.u),yield(0,O.KFq)(Rt,Vt,$e.NF)}}}catch(ct){ie=!0,le=ct}finally{try{se&&null!=ce.return&&(yield ce.return())}finally{if(ie)throw le}}yield O.smK.SyncDataOnline()}catch(ct){console.warn(ct)}})()}validFolderMove(De,X){return De.some(se=>se.id==X)?(this._snackbarService.openSnackBar("Cannot move a folder inside same folder!","error"),!1):!De?.map(se=>{const ie=[];return this._folderService.getAllDescendentFolders(se?.id,ie,this.allCapturesInCurrentFolder),!ie?.length||!ie.includes(Number(X))||(this._snackbarService.openSnackBar("The destination folder is a subfolder of the source folder.","error"),!1)}).includes(!1)}copyCapturesToNewFolder(De,X){return(0,je.Z)(function*(){var ie,q=!1,se=!1;try{for(var ce,le=(0,mt.Z)(De);q=!(ce=yield le.next()).done;q=!1){const re=ce.value;{const Ae=yield(0,O.J0M)(re?.id),Ge=yield(0,O.J0M)(X);yield(0,O.KFq)(Ge,Ae,$e.u)}}}catch(re){se=!0,ie=re}finally{try{q&&null!=le.return&&(yield le.return())}finally{if(se)throw ie}}yield O.smK.SyncDataOnline()})()}copyFoldersToNewFolder(De,X){return(0,je.Z)(function*(){try{var ie,q=!1,se=!1;try{for(var ce,le=(0,mt.Z)(De);q=!(ce=yield le.next()).done;q=!1){const re=ce.value;{const Ae=yield(0,O.J0M)(X),Ge={};Ge[tt.co]={...re};const Pe=yield(0,O.joo)(Ge);yield(0,O.KFq)(Ae,Pe,$e.u),yield(0,O.KFq)(Ae,Pe,$e.NF)}}}catch(re){se=!0,ie=re}finally{try{q&&null!=le.return&&(yield le.return())}finally{if(se)throw ie}}yield O.smK.SyncDataOnline()}catch(re){console.warn(re)}})()}validFolderCopy(De,X){return De.some(se=>se.id==X)?(this._snackbarService.openSnackBar("Cannot copy a folder inside same folder!","error"),!1):!De?.map(se=>{const ie=[];return this._folderService.getAllDescendentFolders(se?.id,ie,this.allCapturesInCurrentFolder),!ie?.length||!ie.includes(Number(X))||(this._snackbarService.openSnackBar("The destination folder is a subfolder of the source folder.","error"),!1)}).includes(!1)}uploadDocument(De,X,q,se){return(0,je.Z)(function*(){try{const ie=yield(0,O.joo)(De,null,null,null,X,null,null),le=yield(0,O.J0M)(q);yield(0,O.KFq)(le,ie,$e.u);const ce=yield(0,O.J0M)(se);yield(0,O.GIn)(ce,ie,$e.cx,!0),yield O.smK.SyncDataOnline();const re=yield(0,O.J0M)(ie?.id);return{...De?.[tt.rG],id:re?.id}}catch(ie){throw console.error("Error uploading document:",ie),ie}})()}deleteCaptureConnection(De,X,q,se){var ie=this;return(0,je.Z)(function*(){const le=yield(0,O.Mu8)(Number(De)),ce=[];for(const re of X){const Ae=yield(0,O.Mu8)(Number(re)),Ge=yield(0,O.kqu)(le,Ae,"",$e.u,!0),Pe=yield(0,O.Mu8)(Number(ie.entityId)),ve=yield(0,O.kqu)(Pe,Ae,"","the_entity_s_crm_contact_s",!0);yield Promise.all([Ge?.map(function(){var ht=(0,je.Z)(function*(vt){yield(0,O.TAP)(vt?.id)});return function(vt){return ht.apply(this,arguments)}}()),ve?.map(function(){var ht=(0,je.Z)(function*(vt){yield(0,O.TAP)(vt?.id)});return function(vt){return ht.apply(this,arguments)}}())]);const ot=["extension_indeed","extension_linkedin","extension_monster","extension_maps","extension_whatsapp","extension_merojob","web_crm"];if(Array.isArray(se))for(const ht of se)if(ot.includes(ht)){let vt=ht;vt=vt.replace("extension_","")+"_contact";const Pt=`the_entity_s_${vt}_s`;yield ie.searchAndDeleteEntityContact(re,Pt,vt)}ce.push({success:!0,id:re})}return ce})()}searchAndDeleteEntityContact(De,X,q){var se=this;return(0,je.Z)(function*(){try{const ie=new O.LtL;ie.typeConnection=X,ie.name="entity";const le=new O.LtL;le.typeConnection=X,le.isOldConnectionType=!0,le.reverse=!0,le.name="contact",le.freeschemaQueries=[ie];const ce=new O.LtL;ce.conceptIds=[De],ce.name="top",ce.freeschemaQueries=[le],ce.selectors=["self"],ce.outputFormat=O.xY7,(0,O.og0)(ce,"").subscribe(function(){var re=(0,je.Z)(function*(Ae){const Ge=Ae?.[0].id,Pe=Ae?.[0]?.data?.boomgpt?.[X+"_reverse"]?.[0]?.id;if(Ge==De){const ve=yield(0,O.J0M)(Number(Ge)),ot=yield(0,O.J0M)(Number(Pe)),ht=Ae?.[0]?.data?.boomgpt?.[X+"_reverse"]?.[0]?.data?.the_entity?.[X];if((yield(0,O.kqu)(ot,ve,q,"",!0))?.map(function(){var Pt=(0,je.Z)(function*(Jt){yield(0,O.TAP)(Jt?.id)});return function(Jt){return Pt.apply(this,arguments)}}()),ht&&1==ht?.length){const Pt=yield(0,O.J0M)(Number(se.userConcept));(yield(0,O.kqu)(Pt,ot,"contact","",!0))?.map(function(){var Kt=(0,je.Z)(function*(ct){yield(0,O.TAP)(ct?.id)});return function(ct){return Kt.apply(this,arguments)}}())}}});return function(Ae){return re.apply(this,arguments)}}())}catch{console.error("Error: search and delete Entity Contact")}})()}deleteFolderConnection(De,X){return(0,je.Z)(function*(){const q=yield(0,O.Mu8)(Number(De)),se=[];for(const ie of X){const le=yield(0,O.Mu8)(Number(ie)),ce=yield(0,O.kqu)(q,le,"",$e.u,!0),re=yield(0,O.kqu)(q,le,"",$e.NF,!0);yield Promise.all(re?.map(function(){var Ae=(0,je.Z)(function*(Ge){yield(0,O.TAP)(Ge?.id)});return function(Ge){return Ae.apply(this,arguments)}}())),ce?.map(function(){var Ae=(0,je.Z)(function*(Ge){yield(0,O.TAP)(Ge?.id)});return function(Ge){return Ae.apply(this,arguments)}}()),se.push({success:!0,id:ie})}return se})()}};let Je=He;return He.\u0275fac=function(X){return new(X||He)(Dt.LFG(fe.e),Dt.LFG(H.s),Dt.LFG(Ve.o),Dt.LFG(U.e),Dt.LFG(lt._),Dt.LFG(dt))},He.\u0275prov=Dt.Yz7({token:He,factory:He.\u0275fac,providedIn:"root"}),Je})()},4383:(wo,Nn,gt)=>{"use strict";gt.d(Nn,{s:()=>Je});var je=gt(5861),mt=gt(7899),O=gt(2902),tt=gt(9653);const $e=(0,tt.ZF)("mycategories");var lt=gt(4650),dt=gt(384),nt=gt(8154);let Je=(()=>{const et=class{constructor(X,q,se){this.authService=X,this.itemService=q,this.store=se,this.allCategories$=this.store.pipe((0,tt.Ys)((0,tt.P1)($e,et=>typeof et>"u"?null:et.filter(X=>X?.name)))),this.allTotalFolders=[],this.canCreateFolder=!1}nest(X,q=""){return X.filter(se=>se?.parent==q).map(se=>({...se,children:this.nest(X,se?.id)}))}getSiblingFolders(X,q){return q.filter(ie=>X?ie?.parent==X:""==ie?.parent).map(ie=>ie?.name)}getFolderDirectory(X,q,se=[]){if(X){const ie=q.filter(ce=>ce?.id==X)[0],le=ie?.parent;se.unshift(ie),le&&this.getFolderDirectory(le,q,se)}}getNodeDirectory(X,q){const se=[];let ie=[...q];if(X?.length>0)return X.forEach(le=>{const ce=ie.filter(re=>re?.id==le?.id)[0];se.push(ce),ie=ce?.children}),se}getAllDescendentFolders(X,q=[],se){const ie=[...se];for(const le in ie)ie[le]?.category_parent==X&&(q.push(ie[le]?.category_name?.toLowerCase()),this.getAllDescendentFolders(ie[le]?.id,q,se))}checkUserSubscription(X){var q=this;return(0,je.Z)(function*(){return new Promise((se,ie)=>{q.checkDataType=X;const le=q.authService.loadFromLocalStorage();var ce;q.userConceptId=le.userConcept,q.itemService.getMySubscription().subscribe({next:(ce=(0,je.Z)(function*(re){q.subscribedPlanId=re?.pricings?.[0]?.productId;let Ae="",Ge=!1;if(!q.subscribedPlanId){const Pt=(yield q.getFreePlanDetails())?.filter(Kt=>"0"===Kt?.internal_product?.data?.price);Ae=Pt[0]?.internal_product?.data?.name,q.subscribedPlanId=Number(Pt[0]?.internal_product?.id)}Ge=yield q.checkPlanLimitation();let ve=0,ot=0;"folder"===q.checkDataType?(ve=Number(q.userFolderLimit),ot=q.allTotalFolders.length):"file"===q.checkDataType?(ve=q.filesUploadLimit,ot=q.uploadedFilesCount):"fileSize"===q.checkDataType&&(ve=q.filesUploadSizeLimit,ot=0),se({limit:ve,createdCount:ot,isAllowedToCreate:Ge,subscription:Ae})}),function(Ae){return ce.apply(this,arguments)}),error:ce=>{console.error(ce),ie(ce)},complete:()=>{}})})})()}checkPlanLimitation(){var X=this;return(0,je.Z)(function*(){return new Promise(q=>{var ie;X.itemService.searchLinkMultipleAll([{composition:X.subscribedPlanId,listLinkers:[`${O.$t}_s`,`${O.aJ}_s`,`${O.r}_s`],inpage:100,page:1,logic:"or",filterSearches:[]}]).subscribe({next:(ie=(0,je.Z)(function*(le){if(console.log("RESPONSE",le),X.userFolderLimit=le?.internal_product?.[`internal_product_s_${O.$t}_s`]?.[0]?.[mt.FK]?.data?.limit,X.filesUploadLimit=le?.internal_product?.[`internal_product_s_${O.aJ}_s`]?.[0]?.[mt.aK]?.data?.limit,X.filesUploadSizeLimit=le?.internal_product?.[`internal_product_s_${O.r}_s`]?.[0]?.[mt.s$]?.data?.limit,"folder"===X.checkDataType){const ce=yield X.checkCreatedFolders();q(ce)}else if("file"===X.checkDataType){const ce=yield X.checkUploadFileLimitations();q(ce)}else if("fileSize"===X.checkDataType){const ce=X.filesUploadSizeLimit?.toLowerCase();let re,Ae;if(ce&&(re=ce.includes("mb"),Ae=ce.includes("gb")),re){const Ge=ce.split("mb"),Pe=1024*Number(Ge[0]);q(Pe)}else if(Ae){const Ge=ce.split("gb"),Pe=1024*Number(Ge[0])*1024;q(Pe)}}}),function(ce){return ie.apply(this,arguments)})})})})()}checkUserSubscription_old(X){var q=this;return(0,je.Z)(function*(){return new Promise((se,ie)=>{q.checkDataType=X;const le=q.authService.loadFromLocalStorage();var re;q.userConceptId=le.userConcept,q.itemService.getSemanticConnection({compositionId:q.userConceptId,linker:O.PJ+"_s"}).subscribe({next:(re=(0,je.Z)(function*(Ae){let Ge="",Pe=!1;if(Ae.count&&Ae.output.length){const Jt=Ae?.output?.sort((ct,Ut)=>{const Vt=new Date(ct?.data[mt.LI].timestamp).getTime(),Ht=new Date(Ut?.data[mt.LI].timestamp).getTime();return Number(Ht)-Number(Vt)});q.subscribedPlanId=Number(Jt[0]?.id),Ge=Jt[0]?.data[mt.LI]?.name,Pe=yield q.checkLimitation()}else{const Kt=(yield q.getFreePlanDetails())?.filter(Ht=>"0"===Ht?.internal_product?.data?.price);Ge=Kt[0]?.internal_product?.data?.name;const Ut=Number(Kt[0]?.internal_product?.id);Pe=yield q.updateUserToFreePackage(Ut)}const ot={...q.authService.loadFromLocalStorage(),pkg:Ge};q.authService.saveToLocalStorage(ot);let ht=0,vt=0;"folder"===q.checkDataType?(ht=Number(q.userFolderLimit),vt=q.allTotalFolders.length):"file"===q.checkDataType&&(ht=q.filesUploadLimit,vt=q.uploadedFilesCount),se({limit:ht,createdCount:vt,isAllowedToCreate:Pe,subscription:Ge,subscriptionId:q.subscribedPlanId})}),function(Ge){return re.apply(this,arguments)}),error:re=>{console.error(re),ie(re)},complete:()=>{}})})})()}updateUserToFreePackage(X){var q=this;return(0,je.Z)(function*(){return new Promise((se,ie)=>{const le={compositionJsons:[{[mt.LI]:{id:X,name:"Free",time:"yearly",price:0,timestamp:(new Date).toISOString(),expireDate:"Never"}}],compositionToJoin:q.userConceptId,direction:"backward",linker:O.PJ,both:!0,count:!0};q.itemService.createCompositionAndLinker(le).subscribe({next:ce=>{const re=ce?.data[0][mt.LI]?.id;q.subscribedPlanId=re;const Ae=q.connectPackageToProductDetails(X);se(Ae)},error:ce=>{console.error(ce),ie(ce)},complete:()=>{}})})})()}connectPackageToProductDetails(X){var q=this;return(0,je.Z)(function*(){return new Promise(se=>{var le;q.itemService.createSemanticConnection({compositionId1:X,compositionId2:q.subscribedPlanId,linker:O.uC}).subscribe({next:(le=(0,je.Z)(function*(){const ce=yield q.checkLimitation();se(ce)}),function(){return le.apply(this,arguments)}),error:le=>{console.error(le)},complete:()=>{}})})})()}checkLimitation(){var X=this;return(0,je.Z)(function*(){return new Promise(q=>{var ie;X.itemService.searchLinkMultipleAll([{composition:X.userConceptId,listLinkers:[`${O.PJ}_s`],inpage:100,page:1,logic:"or",filterSearches:[]},{listLinkers:[`${O.uC}_by`]},{listLinkers:[`${O.$t}_s`,`${O.aJ}_s`]}]).subscribe({next:(ie=(0,je.Z)(function*(le){const ce=le?.the_user?.the_user_s_get_package_s;if(ce.length){let re={};if(re=le?.the_user?.the_user_s_get_package_s[0],ce.length>1&&(re=ce?.sort((Pe,ve)=>{const ot=new Date(Pe[mt.LI]?.data?.timestamp).getTime(),ht=new Date(ve[mt.LI]?.data?.timestamp).getTime();return Number(ht)-Number(ot)})[0]),re?.[mt.LI]?.subscription_package_s_package_product_by){const Ge=re?.[mt.LI]?.subscription_package_s_package_product_by?.[0]?.internal_product?.internal_product_s_folder_limit_s?.[0]?.[mt.FK]?.data?.limit;X.userFolderLimit=Ge;const Pe=re?.[mt.LI]?.subscription_package_s_package_product_by?.[0]?.internal_product?.internal_product_s_upload_file_limit_s?.[0]?.[mt.aK]?.data?.limit;X.filesUploadLimit=Pe}}if("folder"===X.checkDataType){const re=yield X.checkCreatedFolders();q(re)}if("file"===X.checkDataType){const re=yield X.checkUploadFileLimitations();q(re)}}),function(ce){return ie.apply(this,arguments)})})})})()}checkCreatedFolders(){return new Promise((X,q)=>{this.allCategories$.subscribe({next:se=>{this.allTotalFolders=se;const ie=Number(this.userFolderLimit);this.canCreateFolder=this.allTotalFolders.length<ie||!0===isNaN(ie),X(this.canCreateFolder)},error:se=>{console.error(se),q(se)}})})}getFreePlanDetails(){return new Promise(X=>{this.itemService.listAllWithoutAuthWithLinker([{type:"internal_product",listLinkers:[`${O.$t}_s`,`${O.aJ}_s`],inpage:100,page:1,logic:"or",filterSearches:[]}]).subscribe({next:se=>{X(se)}})})}checkUploadFileLimitations(){return new Promise((X,q)=>{this.itemService.getSemanticConnection({compositionId:this.userConceptId,linker:`${O.cx}_s`}).subscribe({next:ie=>{const le=ie?.output;this.uploadedFilesCount=le?le.length:0;let ce=!1;const re=Number(this.filesUploadLimit);ce=this.uploadedFilesCount<re||!0===isNaN(re),X(ce)},error:ie=>{console.error(ie),q(ie)}})})}checkUploadFileLimitations_old(){return new Promise((X,q)=>{this.itemService.searchLinkMultipleAll([{composition:this.userConceptId,listLinkers:[`${O.cx}_s`],inpage:100,page:1,logic:"or",filterSearches:[]}]).subscribe({next:ie=>{const le=ie?.the_user?.[`the_user_s_${O.cx}_s`];this.uploadedFilesCount=le?le.length:0;let ce=!1;const re=Number(this.filesUploadLimit);ce=this.uploadedFilesCount<re||!0===isNaN(re),X(ce)},error:ie=>{console.error(ie),q(ie)}})})}};let He=et;return et.\u0275fac=function(q){return new(q||et)(lt.LFG(dt.e),lt.LFG(nt.e),lt.LFG(tt.yh))},et.\u0275prov=lt.Yz7({token:et,factory:et.\u0275fac,providedIn:"root"}),He})()},9808:(wo,Nn,gt)=>{"use strict";gt.d(Nn,{n:()=>mt});var je=gt(6805);function mt(O,tt){const $e="object"==typeof tt;return new Promise((Dt,fe)=>{let Ve,H=!1;O.subscribe({next:U=>{Ve=U,H=!0},error:fe,complete:()=>{H?Dt(Ve):$e?Dt(tt.defaultValue):fe(new je.K)}})})}},6636:wo=>{self,wo.exports=(()=>{"use strict";var Nn={26:function(mt,O,tt){var $e=this&&this.__createBinding||(Object.create?function(he,oe,J,ue){void 0===ue&&(ue=J);var ee=Object.getOwnPropertyDescriptor(oe,J);ee&&!("get"in ee?!oe.__esModule:ee.writable||ee.configurable)||(ee={enumerable:!0,get:function(){return oe[J]}}),Object.defineProperty(he,ue,ee)}:function(he,oe,J,ue){void 0===ue&&(ue=J),he[ue]=oe[J]}),Dt=this&&this.__setModuleDefault||(Object.create?function(he,oe){Object.defineProperty(he,"default",{enumerable:!0,value:oe})}:function(he,oe){he.default=oe}),fe=this&&this.__importStar||function(he){if(he&&he.__esModule)return he;var oe={};if(null!=he)for(var J in he)"default"!==J&&Object.prototype.hasOwnProperty.call(he,J)&&$e(oe,he,J);return Dt(oe,he),oe},H=this&&this.__awaiter||function(he,oe,J,ue){return new(J||(J=Promise))(function(ee,j){function Y(Se){try{Le(ue.next(Se))}catch(Ze){j(Ze)}}function pe(Se){try{Le(ue.throw(Se))}catch(Ze){j(Ze)}}function Le(Se){var Ze;Se.done?ee(Se.value):(Ze=Se.value,Ze instanceof J?Ze:new J(function(it){it(Ze)})).then(Y,pe)}Le((ue=ue.apply(he,oe||[])).next())})};Object.defineProperty(O,"__esModule",{value:!0}),O.handleAddSharedWithMeFolder=O.getPathToFolder=O.deleteFolder=O.createFolder=O.setCurrentFolderId=O.updateSelectedFolders=O.insertFolderListItem=O.handleFolderRightOption=O.getAllFolders=O.nestedInsertFolderTree=O.addEventListenerToCheckboxElement=O.folderToggler=O.createNestedTreeAndAddToDOM=O.currentFolderId=O.globalFolders=O.selectedFolders=void 0;const Ve=fe(tt(215)),U=tt(793),lt=fe(tt(793)),dt=tt(726),nt=tt(777),Je=tt(356);O.selectedFolders=[],O.globalFolders=[];let He=[],et={},De=[],X=!1,q=!1,se=!1,ie=[],le=[];function ce(he){return H(this,void 0,void 0,function*(){try{const oe=he.querySelectorAll(`#${U.myprefix}category_list_tree`);if(!oe.length)return;he.getElementById(`${U.myprefix}loader`);const J=yield Ve.getUser();oe?.forEach(ue=>{for(var ee;ue?.firstChild;)null===(ee=ue?.firstChild)||void 0===ee||ee.remove();let j=he.querySelectorAll(`.${U.myprefix}root_folder`);j?.length>0&&j.forEach(Le=>Le?.remove());let Y=document.createElement("div");Y.classList.add(`${U.myprefix}root_folder`),Y.textContent="Boom",Y.addEventListener("contextmenu",Le=>{Le.preventDefault(),pe?.params.disableRightClick||vt(Le,he,!1)});const pe=(0,Je.getCurrentTreeParams)(he);Jt(Y,pe),Pt(Y,pe),ue.before(Y),console.log("Folder MS Completed Adding root listeners"),Ge(ue,J.userConcept,he,pe),console.log("Folder MS Completed Adding nested tree"),re(he)}),Vt(he)}catch(oe){console.error("Error in creating nested tree",oe)}})}function re(he){let oe=he.querySelectorAll(`.${U.myprefix}toggler`);for(let J=0;J<oe.length;J++)oe[J].addEventListener("click",function(){this.parentElement.querySelector(`.${U.myprefix}submenuLevel`).classList.toggle(`${U.myprefix}active`);let ue=this.parentElement.querySelector(`.${U.myprefix}openFolderContent`).getAttribute("data-folder-id");He=He.includes(ue)?He.filter(ee=>ee!==ue):[...He,ue]})}function Ae(he){he?.addEventListener("change",oe=>{null!=O.selectedFolders&&O.selectedFolders.some(J=>J.id==oe.target.value)?O.selectedFolders=null==O.selectedFolders?void 0:O.selectedFolders.filter(J=>J.id!=oe.target.value):O.selectedFolders.push({name:oe.target.name,id:oe.target.value})})}function Ge(he,oe,J,ue,ee=!1){var j,Y,pe,Le;try{const Se=le.find(Fe=>"the_user_s_read_access"==Fe.characterValue),Ze=new Map;De.filter(Fe=>{var at,It;return 1==oe?Se?.id==Fe.typeId&&(null===(It=null===(at=et?.[Fe.toTheConceptId])||void 0===at?void 0:at.data)||void 0===It?void 0:It.boomFolder):Fe.ofTheConceptId==oe&&Se?.id!=Fe.typeId}).sort((Fe,at)=>{var It,ft,Gt,en;if(1===Fe.toTheConceptId)return 1;if(1===at.toTheConceptId)return-1;const Ot=et?.[Fe.toTheConceptId],zt=et?.[at.toTheConceptId],jt=(null===(ft=null===(It=Ot?.data)||void 0===It?void 0:It[dt.boomFolderComposition])||void 0===ft?void 0:ft.name)||"",nn=(null===(en=null===(Gt=zt?.data)||void 0===Gt?void 0:Gt[dt.boomFolderComposition])||void 0===en?void 0:en.name)||"";return jt?.localeCompare(nn||"")}).map(Fe=>{const at=`${Fe.ofTheConceptId}-${Fe.toTheConceptId}`;Ze.has(at)||Ze.set(at,Fe)});const it=Array.from(Ze.values());let Qe=0;for(let Fe=0;Fe<it.length;Fe++){let at=it[Fe],It=et[at.toTheConceptId],ft=It?.id,Gt="";if(!(null===(j=It?.data)||void 0===j)&&j[dt.boomFolderComposition]&&(Gt=null===(pe=null===(Y=It?.data)||void 0===Y?void 0:Y[dt.boomFolderComposition])||void 0===pe?void 0:pe.name),!Gt||!ft){Qe+=1;continue}let en=ht(he,ft,Gt,J,ue,ee);null!==(Le=ue?.params)&&void 0!==Le&&Le.showCheckbox&&Ae(en);let Ot=!1;if(1==at.id&&De.some(zt=>{var jt,nn;return Se?.id==zt.typeId&&(null===(nn=null===(jt=et?.[zt.toTheConceptId])||void 0===jt?void 0:jt.data)||void 0===nn?void 0:nn.boomFolder)})&&(Ot=!0),De.some(zt=>at.toTheConceptId==zt.ofTheConceptId)||Ot){let zt=he.querySelectorAll(":scope > li")[Fe-Qe];zt.setAttribute("class",`${U.myprefix}has_submenu`);let jt=document.createElement("ul"),nn=document.createElement("span");nn.setAttribute("class",`${U.myprefix}toggler`),jt.setAttribute("class",`${U.myprefix}submenuLevel`),(He.includes(It.id.toString())||O.currentFolderId==ft)&&jt.classList.add(`${U.myprefix}active`),zt.append(jt);let wn=zt.querySelectorAll("ul")[0];zt.insertBefore(nn,wn),Ge(wn,at.toTheConceptId,J,ue,!!Ot||ee)}}}catch(Se){console.error("FolderMS nested Intert Folder Error:",Se)}}function Pe(he,oe){return H(this,void 0,void 0,function*(){nt.Logger.logfunction("getAllFolders");try{q=!0;const ue=(yield Ve.getUser())?.userConcept;let ee=yield(0,nt.RecursiveSearchApiRaw)(ue,[],"",["the_boom_folder_s_folder","the_user_s_read_access"]);console.log("FolderMS",ee);let j=ee.compositionIds,Y=ee.internalConnections,pe=ee.externalConnections,Le=yield(0,nt.GetCompositionFromConnectionsWithDataIdIndex)(j,Y),Se=yield(0,nt.GetConnectionBulk)(pe),Ze=[],it=[],Qe=[];et=Le,De=yield Promise.all(Se.filter(Fe=>{var at;const It=`${Fe.ofTheConceptId}-${Fe.toTheConceptId}`,ft=`${Fe.toTheConceptId}-${Fe.ofTheConceptId}`;if(Qe.includes(It))return!1;Qe.push(It),Qe.push(ft),Ze.includes(Fe.typeId)||Ze.push(Fe.typeId);const Gt=et?.[Fe.toTheConceptId];return!(null===(at=Gt?.data)||void 0===at||!at[dt.boomFolderComposition])}));for(let Fe=0;Fe<Ze.length;Fe++)it.push((0,nt.GetTheConcept)(Ze[Fe]));if(le=yield Promise.all(it),yield Rt(ue,he,oe),yield function(Fe,at,It){var ft,Gt,en,Ot;return H(this,void 0,void 0,function*(){nt.Logger.logfunction("setGlobalFolders",[at]);let zt=[];for(let jt=0;jt<Fe.length;jt++){const nn=Fe[jt],wn=It[nn.toTheConceptId];null!==(Gt=null===(ft=wn?.data)||void 0===ft?void 0:ft[dt.boomFolderComposition])&&void 0!==Gt&&Gt.name&&zt.push({id:nn.toTheConceptId,name:(null===(Ot=null===(en=wn?.data)||void 0===en?void 0:en[dt.boomFolderComposition])||void 0===Ot?void 0:Ot.name)||"",parent:nn.ofTheConceptId==at?"":nn.ofTheConceptId.toString()})}O.globalFolders=zt?.filter(jt=>jt&&jt?.name),O.globalFolders=null==O.globalFolders?void 0:O.globalFolders.sort(function(jt,nn){var wn,Fo;let ii=null===(wn=jt?.name)||void 0===wn?void 0:wn.toLowerCase(),ri=null===(Fo=nn?.name)||void 0===Fo?void 0:Fo.toLowerCase();return ii.localeCompare(ri)})})}(Se,ue,Le),console.log("FolderMS fetched all folders adding to tree"),se=!0,q=!1,he){const Fe=(0,Je.getShadowRoot)(he);if(!Fe)return O.globalFolders;yield ce(Fe)}else oe&&(yield ce(oe));return O.globalFolders}catch(J){console.error("Error in fetching folders",J)}})}function ve(he,oe,J,ue=!1){var ee,j;He=[...He,oe.toString()];let Y=J.querySelectorAll(`#${U.myprefix}new_category_wrapper`);Y?.length>0&&Y.forEach(Ot=>Ot?.remove());let pe=document.createElement("div");pe.setAttribute("id",`${U.myprefix}new_category_wrapper`);let Le=document.createElement("input");Le.setAttribute("type","text"),Le.setAttribute("id",`${U.myprefix}new_category_input`),Le.setAttribute("class",`${U.myprefix}field_input`),Le.setAttribute("placeholder","New Folder name");const Se="New Folder";let Ze=O.globalFolders.filter(Ot=>Ot?.parent==oe).filter(Ot=>{let zt=Ot?.name;return Ot?.parent==oe&&zt.match(/^New Folder \([0-9]*\)/gm)||zt.match(/^New Folder/gm)}),it=Ze.sort((Ot,zt)=>{var jt,nn;return(null===(jt=Ot?.name)||void 0===jt?void 0:jt.replace(/\D/g,""))-(null===(nn=zt?.name)||void 0===nn?void 0:nn.replace(/\D/g,""))}),Fe=(null===(ee=it[it.length-1])||void 0===ee?void 0:ee.name)?.replace(/\D/g,"");Le.value=Ze.length>0?Se+` (${Number(Fe)+1})`:Se,ue&&(Le.value=he.getAttribute("data-name"));let at=document.createElement("div");at.setAttribute("class",`${U.myprefix}field_error`);let It=document.createElement("div");It.setAttribute("class",`${U.myprefix}field_success`);let ft=document.createElement("input");ft.setAttribute("type","button"),ft.setAttribute("id",`${U.myprefix}new_category_button`),ft.setAttribute("value","Save");let Gt=document.createElement("input");if(Gt.setAttribute("type","button"),Gt.setAttribute("id",`${U.myprefix}small_close_button`),Gt.setAttribute("value","Close"),pe.append(Le),pe.append(at),pe.append(ft),pe.append(Gt),ue){const Ot=O.globalFolders.find(jt=>jt.id.toString()==he.getAttribute("data-id"));J.querySelector(`[data-id="${Ot.id}"]`)?.insertAdjacentElement("afterend",pe)}else he?.append(pe);Le.focus(),Le.select();let en=!1;Le.addEventListener("focusout",Ot=>{en?en=!1:ot(oe,Le,pe,at,It,J,ue)}),Le.addEventListener("keyup",Ot=>{"Escape"==Ot.key?(en=!0,pe?.remove(),setTimeout(()=>{en&&(en=!1)},200)):"Enter"==Ot.key&&ot(oe,Le,pe,at,It,J,ue)}),null===(j=document.querySelectorAll(`.${U.myprefix}sidebar_body`)[0])||void 0===j||j.append(It),ft.addEventListener("click",Ot=>H(this,void 0,void 0,function*(){return ot(oe,Le,pe,at,It,J,ue)})),Gt.addEventListener("click",Ot=>{pe?.remove()})}function ot(he,oe,J,ue,ee,j,Y){if(X)return;X=!0;const pe=O.globalFolders.find(Se=>Se.id==he);let Le=!1;if(Y?pe&&pe?.name&&"Contacts"!=pe.name&&"Projects"!=pe.name&&"Chats"!=pe.name&&(Le=""!=oe.value.trim()&&!(null!=O.globalFolders&&O.globalFolders.some(Se=>Se?.name==oe.value.trim()&&Se?.parent==pe.parent))):Le=""!=oe.value.trim()&&!(null!=O.globalFolders&&O.globalFolders.some(Se=>Se?.name==oe.value.trim()&&Se?.parent==he)),!Y&&Le){let Se={};Se=he?{name:oe.value.trim(),parent:he}:{name:oe.value.trim(),parent:""},J?.remove(),H(this,void 0,void 0,function*(){yield ct(Se.name,""==Se.parent?void 0:parseInt(Se.parent),j),ee.innerHTML="New Folder Created!",setTimeout(()=>{ee.remove()},2500),ue.innerHTML=""})}else Y&&Le?H(this,void 0,void 0,function*(){var Se;const Ze=et[pe.id],it=new nt.PatcherStructure;it.compositionId=pe.id,!(null===(Se=Ze?.data)||void 0===Se)&&Se.boomFolder&&(it.patchObject={name:oe.value.trim()},et[pe.id].data.boomFolder.name=oe.value.trim()),O.globalFolders=O.globalFolders.map(Qe=>Qe.id==pe.id?Object.assign(Object.assign({},Qe),{name:oe.value.trim()}):Qe),setTimeout(()=>{if(J?.parentNode)try{J?.remove()}catch(Qe){console.log(Qe)}},0),yield ce(j),yield(0,nt.UpdateCompositionLocal)(it),Kt({id:pe.id,name:oe.value,parent:pe.parent},"update"),ee.innerHTML="Updated Folder!",setTimeout(()=>{ee?.remove()},2500),ue.innerHTML="",setTimeout(()=>H(this,void 0,void 0,function*(){yield Pe(void 0,j)}),500)}):Y&&!Le?(console.log(J,"formwrapper not allwoed but is update"),ee.innerHTML="",ue.innerHTML="Folder already exists or not valid."):(ee.innerHTML="",ue.innerHTML="Folder already exists or not valid.");X=!1}function ht(he,oe,J,ue,ee,j=!1){var Y,pe;let Le=document.createElement("li");Le.setAttribute("data-id",oe),Le.setAttribute("data-name",J);let Se=document.createElement("label"),Ze=null;var Qe;ee.params.showCheckbox&&(Ze=document.createElement("input"),Ze.setAttribute("type","checkbox"),Ze.setAttribute("id",U.myprefix+J),Ze.setAttribute("value",oe),Ze.setAttribute("name",J),Ze.checked=(Qe=oe,!!Array.isArray(O.selectedFolders)&&!(null==O.selectedFolders||!O.selectedFolders.find(Fe=>Fe.id==Qe))),Ze.setAttribute("class",`${U.myprefix}folder_checkbox`),(null!==(Y=parseInt(oe))&&void 0!==Y?Y:0)<0&&(Ze.style.display="none"),Se.append(Ze)),!(null===(pe=ee?.params)||void 0===pe)&&pe.onCurrentFolderChange&&O.currentFolderId==parseInt(oe)&&Se.classList.add(`${U.myprefix}current_folder`),Jt(Se,ee),"1"!=oe&&Pt(Le,ee),Le.append(Se);const it=document.createElement("span");return it.innerText=J,it.classList.add(U.myprefix+"openFolderContent"),it.setAttribute("data-folder-id",oe),Se.append(it),Se.addEventListener("contextmenu",Qe=>{var Fe;Qe.preventDefault(),"1"==oe||null!==(Fe=ee?.params)&&void 0!==Fe&&Fe.disableRightClick||j||vt(Qe,ue)}),he.append(Le),Ze}function vt(he,oe,J=!0){var ue,ee,j,Y,pe;null===(ue=oe.getElementById(`${U.myprefix}folder_actions`))||void 0===ue||ue.remove();const Le=he.currentTarget.parentElement;let Se=Le.getAttribute("data-id"),Ze=he.pageY+5-window.scrollY,it=he.pageX+5-window.scrollX;window.innerHeight>200&&window.innerHeight-Ze<115?Ze-=125:window.innerWidth>300&&window.innerWidth-it<130&&(it-=125);let Qe=`\n  <div id="${U.myprefix}folder_actions" \n    style="top: ${Ze}px; left: ${it}px;">\n    <ul>\n      <li><a id="${U.myprefix}folder_action_create" role="button">New Folder</a></li>\n      ${J?`\n        <li><a id="${U.myprefix}folder_action_rename" role="button">Rename Folder</a></li>\n        <li><a id="${U.myprefix}folder_action_delete" role="button">Delete Folder</a></li>\n        `:""}\n    </ul>\n  </div>\n  `;null===(ee=oe.querySelector(`.${U.myprefix}boom_sidebar`))||void 0===ee||ee.insertAdjacentHTML("beforeend",Qe);const Fe=()=>{var at;null===(at=oe.getElementById(`${U.myprefix}folder_actions`))||void 0===at||at.remove(),window.removeEventListener("click",Fe)};window.addEventListener("click",Fe),oe.addEventListener("click",at=>{var It,ft;null!==(It=oe.querySelector(`.${U.myprefix}boom_sidebar #${U.myprefix}folder_actions`))&&void 0!==It&&It.contains(at.target)||null===(ft=oe.getElementById(`${U.myprefix}folder_actions`))||void 0===ft||ft.remove()}),null===(j=oe.getElementById(`${U.myprefix}folder_action_create`))||void 0===j||j.addEventListener("click",()=>{var at;ve(Le,Se,oe),null===(at=oe.getElementById(`${U.myprefix}folder_actions`))||void 0===at||at.remove()}),null===(Y=oe.getElementById(`${U.myprefix}folder_action_rename`))||void 0===Y||Y.addEventListener("click",()=>{ve(Le,Se,oe,!0)}),null===(pe=oe.getElementById(`${U.myprefix}folder_action_delete`))||void 0===pe||pe.addEventListener("click",()=>H(this,void 0,void 0,function*(){var at,It,ft;null===(at=oe.getElementById(`${U.myprefix}folder_actions`))||void 0===at||at.remove();const Gt=O.globalFolders.find(Ot=>Ot.id==parseInt(Se));let en=(0,Je.getCurrentTreeParams)(oe);null!==(It=en?.params)&&void 0!==It&&It.manualDeleteFn?null===(ft=en?.params)||void 0===ft||ft.manualDeleteFn(Gt):(yield Ut(Gt,oe),yield Pe(void 0,oe))}))}function Pt(he,oe){var J;null!=(null===(J=oe?.params)||void 0===J?void 0:J.dropFn)&&(he.addEventListener("dragover",ue=>{var ee,j,Y,pe;if(ue.preventDefault(),null===(ee=ue.currentTarget)||void 0===ee||!ee.querySelector(`.${U.myprefix}dragover`)){let Le=document.createElement("div");null===(j=Le?.classList)||void 0===j||j.add(`${U.myprefix}dragover`),ue.currentTarget.querySelector("label")?null===(Y=ue.currentTarget.querySelector("label"))||void 0===Y||Y.insertAdjacentElement("afterend",Le):null===(pe=ue.currentTarget)||void 0===pe||pe.append(Le)}}),he.addEventListener("dragleave",ue=>{var ee,j;ue.preventDefault(),null===(j=null===(ee=ue.currentTarget)||void 0===ee?void 0:ee.querySelector(`.${U.myprefix}dragover`))||void 0===j||j.remove()}),he.addEventListener("drop",ue=>{var ee,j,Y,pe;ue.preventDefault(),ue.stopPropagation(),null===(j=null===(ee=ue.currentTarget)||void 0===ee?void 0:ee.querySelector(`.${U.myprefix}dragover`))||void 0===j||j.remove();let Le=O.globalFolders.find(Se=>Se.id.toString()==ue.currentTarget.getAttribute("data-id"));Le||(Le={id:void 0,name:void 0}),null!==(Y=oe?.params)&&void 0!==Y&&Y.dropFn&&(null===(pe=oe?.params)||void 0===pe||pe.dropFn(ue,Le))}))}function Jt(he,oe){var J,ue,ee,j,Y;if(null!==(J=oe?.params)&&void 0!==J&&J.onCurrentFolderChange){he.addEventListener("click",Le=>{var Se,Ze,it,Qe;const Fe=null===(Se=Le?.currentTarget)||void 0===Se?void 0:Se.parentElement,at=Fe?.getAttribute("data-id");if("li"==Fe.tagName.toLowerCase()&&Fe.querySelector(":scope > ul")){null===(Ze=Fe.querySelector(":scope > ul"))||void 0===Ze||Ze.classList.add(`${U.myprefix}active`);let It=Fe.getAttribute("data-id");He=[...He,It]}null!==(it=oe?.params)&&void 0!==it&&it.onCurrentFolderChange&&(null===(Qe=oe?.params)||void 0===Qe||Qe.onCurrentFolderChange(at?parseInt(at):void 0))});const pe=document.createElement("span");pe.classList.add(`${U.myprefix}clickable_folder_icon_placeholder`),he.prepend(pe),"span"==(null===(ue=he?.tagName)||void 0===ue?void 0:ue.toLowerCase())&&"li"==(null===(j=null===(ee=he?.parentElement)||void 0===ee?void 0:ee.tagName)||void 0===j?void 0:j.toLowerCase())&&null!==(Y=he?.parentElement)&&void 0!==Y&&Y.querySelector(":scope > ul")&&he.parentElement.addEventListener("click",Le=>{var Se,Ze,it,Qe;const Fe=null===(Se=Le?.currentTarget)||void 0===Se?void 0:Se.parentElement,at=Fe?.getAttribute("data-id");if("li"==Fe.tagName.toLowerCase()&&Fe.querySelector(":scope > ul")){null===(Ze=Fe.querySelector(":scope > ul"))||void 0===Ze||Ze.classList.add(`${U.myprefix}active`);let It=Fe.getAttribute("data-id");He=[...He,It]}null!==(it=oe?.params)&&void 0!==it&&it.onCurrentFolderChange&&(null===(Qe=oe?.params)||void 0===Qe||Qe.onCurrentFolderChange(at?parseInt(at):void 0))})}}function Kt(he,oe){const J=document.createEvent("Event");J.initEvent("onBCFolderCreated",!0,!0),J.folder=he,J.actionType=oe,document.dispatchEvent(J)}function ct(he,oe,J){var ue,ee,j;return H(this,void 0,void 0,function*(){const Y=new nt.LocalTransaction;try{yield Y.initialize(),Date.now();const pe=oe||lt.config.userConcept;if(ie.some(ft=>ft.name==he&&ft.parent==pe))for(;ie.some(ft=>ft.name==he&&ft.parent==pe);)yield Mt(100);ie.push({name:he,parent:pe});let Le=O.globalFolders.find(ft=>ft.name==he&&ft.parent==pe);if(Le)return(0,nt.GetTheConceptLocal)(Le.id);let Se,Ze,it=!1;const Qe=yield Ve.getUser();if(oe){if("Projects"==(null===(ee=null===(ue=et[oe]?.data)||void 0===ue?void 0:ue[dt.boomFolderComposition])||void 0===ee?void 0:ee.name)&&oe==Qe.userConcept){it=!0;const Gt=yield Ve.createProject({title:he});Se=null===(j=Gt?.data)||void 0===j?void 0:j.projectId,Ze=yield(0,nt.GetTheConceptLocal)(Se)}}else oe=Qe.userConcept;let Fe;if(!it){const ft={[dt.boomFolderComposition]:{name:he,parent:Qe.userConcept!=oe?oe:""}};Ze=yield Y.CreateTheCompositionLocal(ft),Se=Ze.id;const Gt=yield(0,nt.GetTheConcept)(oe||Qe.userConcept);yield Y.CreateConnection(Gt,Ze,"the_boom_folder_s_contain");const en=yield Y.CreateConnection(Gt,Ze,"the_boom_folder_s_folder");De.push(en),et[Ze.id.toString()]={id:Ze.id,data:ft},Fe=Y.commitTransaction()}let at={id:Se,name:he,parent:oe||""};O.globalFolders.push(at),ie=ie.filter(ft=>ft.name!=he&&ft.parent!=pe),J&&(yield ce(J)),null!=Fe&&(yield Fe);const It=yield(0,nt.GetTheConceptLocal)(Ze.id);return It>0&&(at.id=It.id),Kt(at,"create"),J&&setTimeout(()=>H(this,void 0,void 0,function*(){yield Pe(void 0,J)}),50),It||void 0}catch(pe){console.error("Error in creating folder",pe),Y.rollbackTransaction()}})}function Ut(he,oe){var J,ue,ee;return H(this,void 0,void 0,function*(){try{let j=he.parent;if(se||(yield Pe()),!he)return;j=j?parseInt(j):lt.config.userConcept;let Y=De.filter(pe=>pe.ofTheConceptId==j&&pe.toTheConceptId==he.id);for(let pe=0;pe<Y.length;pe++){const Le=Y[pe];yield(0,nt.DeleteConnectionById)(Le.id)}if((yield(0,nt.GetTheConcept)(he.id)).userId==lt.config.userId&&(yield(0,nt.DeleteConceptById)(he.id)),yield nt.SyncData.SyncDataOnline(),O.globalFolders=O.globalFolders.filter(pe=>pe.id!=he.id),Kt(he,"delete"),oe){const pe=oe.querySelector(`li[data-id="${he.id}"]`);0==(null===(ue=null===(J=pe?.querySelector(":scope > ul"))||void 0===J?void 0:J.children)||void 0===ue?void 0:ue.length)&&(pe?.querySelector(`${U.myprefix}toggler`),null===(ee=pe?.querySelector(":scope > ul"))||void 0===ee||ee.remove()),pe?.remove()}return!0}catch(j){console.error("Error in deleting folder",j)}})}function Vt(he){var oe,J,ue,ee;if(O.currentFolderId){let j=he.querySelector(`[data-id="${O.currentFolderId}"]`);for(;j?.closest("li");){null===(ue=null===(J=null===(oe=j?.closest("li"))||void 0===oe?void 0:oe.querySelector(":scope > ul"))||void 0===J?void 0:J.classList)||void 0===ue||ue.add(`${U.myprefix}active`);const Y=j.getAttribute("data-id");Y&&(He=[...He,Y]),j=(null===(ee=j.parentElement)||void 0===ee?void 0:ee.closest("li"))||null}}}function Ht(he){var oe,J,ue;let ee={};return!(null===(oe=he?.data)||void 0===oe)&&oe[dt.boomFolderComposition]&&(ee={id:he.id,name:null===(ue=null===(J=he?.data)||void 0===J?void 0:J[dt.boomFolderComposition])||void 0===ue?void 0:ue.name}),ee}function Rt(he,oe,J){var ue;return H(this,void 0,void 0,function*(){let ee;nt.Logger.logfunction("handleAddSharedWithMeFolder",[he]),oe?ee=(0,Je.getRenderTreeSidebarOption)(oe):J&&(ee=(0,Je.getCurrentTreeParams)(J)),(null===(ue=ee?.params)||void 0===ue?void 0:ue.sharedFolder)&&(et[1]={id:1,data:{[dt.boomFolderComposition]:{name:"Shared With Me",parent:""}}},De.push({id:1,ofTheConceptId:he,toTheConceptId:1,userId:0,mainKey:0,orderId:1e3,typeId:100201749,accessId:0}))})}function Mt(he){return new Promise(oe=>setTimeout(oe,he))}O.createNestedTreeAndAddToDOM=ce,O.folderToggler=re,O.addEventListenerToCheckboxElement=Ae,O.nestedInsertFolderTree=Ge,O.getAllFolders=Pe,O.handleFolderRightOption=ve,O.insertFolderListItem=ht,O.updateSelectedFolders=function(he){O.selectedFolders=he||[]},O.setCurrentFolderId=function(he,oe){var J,ue;if(O.currentFolderId!=he&&(O.currentFolderId=he,oe)){const ee=(0,Je.getShadowRoot)(oe);let j=ee?.querySelectorAll("[data-id]");j?.forEach(Y=>{var pe,Le;"li"==Y.tagName.toLowerCase()&&(null===(Le=null===(pe=Y.querySelector(":scope > label"))||void 0===pe?void 0:pe.classList)||void 0===Le||Le.remove(`${U.myprefix}current_folder`))}),O.currentFolderId&&(null===(ue=null===(J=ee?.querySelector(`[data-id="${O.currentFolderId}"]`))||void 0===J?void 0:J.querySelector(":scope > label"))||void 0===ue||ue.classList.add(`${U.myprefix}current_folder`),ee&&Vt(ee))}},O.createFolder=ct,O.deleteFolder=Ut,O.getPathToFolder=function(he){var oe,J,ue;return H(this,void 0,void 0,function*(){try{if(!he||he==lt.config.userConcept)return[];se||(yield Pe());let ee=he,j=[];const Y={id:1,name:"Shared With Me"};if(1==he||"1"==he.toString())return[Y];for(;q;)yield Mt(500);for(;lt.config.userConcept&&ee&&ee!=lt.config.userConcept;){let pe=O.globalFolders.find(Le=>Le.id==ee);pe&&j.push({id:pe.id,name:pe.name}),ee=pe?.parent}if(j.length>0){const pe=le.find(Le=>"the_user_s_read_access"==Le.characterValue);De.find(Le=>Le.ofTheConceptId==lt.config.userConcept&&Le.toTheConceptId==j?.[j.length-1].id&&Le.typeId==pe?.id)&&j.push(Y)}if(0==j.length){const pe=yield(0,nt.GetLink)(lt.config.userConcept,"read_access_s",100,1),Le=pe.map(Qe=>Qe.id);if(Le.includes(he)){const Qe=pe.find(Fe=>Fe.id=he);return[Y,{id:Qe.id,name:null===(J=null===(oe=Qe?.data)||void 0===oe?void 0:oe.boomFolder)||void 0===J?void 0:J.name}]}const Se=Ht(yield(0,nt.GetCompositionWithId)(he));if(!Se?.id)return[];j.push({id:Se?.id,name:Se?.name});let Ze=he,it=0;for(;Ze&&it<10;){it++;const Qe=yield(0,nt.GetLink)(Ze,"console_folder_by");if(null!==(ue=Qe?.[0])&&void 0!==ue&&ue.id){const Fe=Ht(Qe[0]);if(Fe.id&&Fe.name&&j.push({id:Fe?.id,name:Fe?.name}),Ze=Fe?.id,Le.includes(Ze))break}else Ze=void 0}j.push(Y)}return j.reverse()}catch(ee){console.error("Error in getting path to folder",ee)}})},O.handleAddSharedWithMeFolder=Rt},156:function(mt,O,tt){var $e=this&&this.__createBinding||(Object.create?function(Je,He,et,De){void 0===De&&(De=et);var X=Object.getOwnPropertyDescriptor(He,et);X&&!("get"in X?!He.__esModule:X.writable||X.configurable)||(X={enumerable:!0,get:function(){return He[et]}}),Object.defineProperty(Je,De,X)}:function(Je,He,et,De){void 0===De&&(De=et),Je[De]=He[et]}),Dt=this&&this.__setModuleDefault||(Object.create?function(Je,He){Object.defineProperty(Je,"default",{enumerable:!0,value:He})}:function(Je,He){Je.default=He}),fe=this&&this.__importStar||function(Je){if(Je&&Je.__esModule)return Je;var He={};if(null!=Je)for(var et in Je)"default"!==et&&Object.prototype.hasOwnProperty.call(Je,et)&&$e(He,Je,et);return Dt(He,Je),He},H=this&&this.__awaiter||function(Je,He,et,De){return new(et||(et=Promise))(function(X,q){function se(ce){try{le(De.next(ce))}catch(re){q(re)}}function ie(ce){try{le(De.throw(ce))}catch(re){q(re)}}function le(ce){var re;ce.done?X(ce.value):(re=ce.value,re instanceof et?re:new et(function(Ae){Ae(re)})).then(se,ie)}le((De=De.apply(Je,He||[])).next())})};Object.defineProperty(O,"__esModule",{value:!0}),O.FolderTreeModule=O.hasInitialized=O.globalFolders=O.selectedFolders=void 0;const Ve=fe(tt(793)),U=tt(777);var lt=tt(26);Object.defineProperty(O,"selectedFolders",{enumerable:!0,get:function(){return lt.selectedFolders}});var dt=tt(26);Object.defineProperty(O,"globalFolders",{enumerable:!0,get:function(){return dt.globalFolders}}),O.hasInitialized=!1,O.default=function(Je){return H(this,void 0,void 0,function*(){Ve.setConfiguration({userToken:Je.token,userId:Je.userId,userConcept:Je.userConcept,apiUrl:Je.apiUrl,aiUrl:Je.aiUrl,nodeUrl:Je.nodeUrl,icons:Je?.icons||{}}),O.hasInitialized||(yield(0,U.init)(Je.apiUrl,Je.aiUrl,Je.token,Je.nodeUrl.replace("/api/v1",""),!1,"Boomconsole_FMS",Je.enableSW,Je.flags,Je.parameters)),O.hasInitialized=!0})};const nt=fe(tt(356));O.FolderTreeModule=nt,console.debug(nt)},215:function(mt,O,tt){var $e=this&&this.__createBinding||(Object.create?function(lt,dt,nt,Je){void 0===Je&&(Je=nt);var He=Object.getOwnPropertyDescriptor(dt,nt);He&&!("get"in He?!dt.__esModule:He.writable||He.configurable)||(He={enumerable:!0,get:function(){return dt[nt]}}),Object.defineProperty(lt,Je,He)}:function(lt,dt,nt,Je){void 0===Je&&(Je=nt),lt[Je]=dt[nt]}),Dt=this&&this.__setModuleDefault||(Object.create?function(lt,dt){Object.defineProperty(lt,"default",{enumerable:!0,value:dt})}:function(lt,dt){lt.default=dt}),fe=this&&this.__importStar||function(lt){if(lt&&lt.__esModule)return lt;var dt={};if(null!=lt)for(var nt in lt)"default"!==nt&&Object.prototype.hasOwnProperty.call(lt,nt)&&$e(dt,lt,nt);return Dt(dt,lt),dt},H=this&&this.__awaiter||function(lt,dt,nt,Je){return new(nt||(nt=Promise))(function(He,et){function De(se){try{q(Je.next(se))}catch(ie){et(ie)}}function X(se){try{q(Je.throw(se))}catch(ie){et(ie)}}function q(se){var ie;se.done?He(se.value):(ie=se.value,ie instanceof nt?ie:new nt(function(le){le(ie)})).then(De,X)}q((Je=Je.apply(lt,dt||[])).next())})};Object.defineProperty(O,"__esModule",{value:!0}),O.recursiveSearchNestedLinks=O.createLink=O.getUser=O.createProject=O.createFolder=O.getFolders=O.getToken=void 0;const Ve=fe(tt(793));function U(){return Ve.config.userToken}O.getToken=U,O.getFolders=function(){return H(this,void 0,void 0,function*(){const lt=U(),dt=`${Ve.config.nodeUrl}/folders`;console.log("what start");const nt=yield fetch(dt,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+lt}});return console.log(nt," yay yar res"),nt.json()})},O.createFolder=function(lt,dt){return H(this,void 0,void 0,function*(){const nt=U();return lt=`${Ve.config.nodeUrl}/folders`,yield(yield fetch(lt,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+nt},body:JSON.stringify(dt)})).json()})},O.createProject=function(lt){return H(this,void 0,void 0,function*(){const dt=U();let nt=`${Ve.config.nodeUrl}/projects`;return yield(yield fetch(nt,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+dt},body:JSON.stringify(lt)})).json()})},O.getUser=function(){return{theUserId:Ve.config.userId,token:Ve.config.userToken,userConcept:Ve.config.userConcept}},O.createLink=function(lt,dt,nt){return H(this,void 0,void 0,function*(){const Je=yield U();return(yield Je)?yield(yield fetch(`${Ve.config.apiUrl}/api/Connection/create-link?composition1=${lt}&composition2=${dt}&linker=${nt}&both=true`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:`bearer ${Je}`}})).json():[]})},O.recursiveSearchNestedLinks=function(lt){return H(this,void 0,void 0,function*(){const dt=yield U();return(yield dt)?yield(yield fetch(`${Ve.config.apiUrl}/api/Connection/recursivesearch`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:`bearer ${dt}`},body:JSON.stringify(lt)})).json():[]})}},356:function(mt,O,tt){var $e=this&&this.__createBinding||(Object.create?function(q,se,ie,le){void 0===le&&(le=ie);var ce=Object.getOwnPropertyDescriptor(se,ie);ce&&!("get"in ce?!se.__esModule:ce.writable||ce.configurable)||(ce={enumerable:!0,get:function(){return se[ie]}}),Object.defineProperty(q,le,ce)}:function(q,se,ie,le){void 0===le&&(le=ie),q[le]=se[ie]}),Dt=this&&this.__setModuleDefault||(Object.create?function(q,se){Object.defineProperty(q,"default",{enumerable:!0,value:se})}:function(q,se){q.default=se}),fe=this&&this.__importStar||function(q){if(q&&q.__esModule)return q;var se={};if(null!=q)for(var ie in q)"default"!==ie&&Object.prototype.hasOwnProperty.call(q,ie)&&$e(se,q,ie);return Dt(se,q),se},H=this&&this.__awaiter||function(q,se,ie,le){return new(ie||(ie=Promise))(function(ce,re){function Ae(ve){try{Pe(le.next(ve))}catch(ot){re(ot)}}function Ge(ve){try{Pe(le.throw(ve))}catch(ot){re(ot)}}function Pe(ve){var ot;ve.done?ce(ve.value):(ot=ve.value,ot instanceof ie?ot:new ie(function(ht){ht(ot)})).then(Ae,Ge)}Pe((le=le.apply(q,se||[])).next())})};Object.defineProperty(O,"__esModule",{value:!0}),O.getRenderTreeSidebarOption=O.removeShadowRoot=O.setShadowRoot=O.getCurrentTreeParams=O.getShadowRoot=O.updateSelectedFolders=O.removeRenderedTreeSidebar=O.renderTreeSidebar=O.shadowRoot=O.deleteFolder=O.getPathToFolder=O.createFolder=O.setCurrentFolderId=O.currentFolderId=O.getAllFolders=O.globalFolders=O.selectedFolders=void 0;const Ve=tt(793),U=fe(tt(26)),lt=fe(tt(687));var dt=tt(26);Object.defineProperty(O,"selectedFolders",{enumerable:!0,get:function(){return dt.selectedFolders}}),Object.defineProperty(O,"globalFolders",{enumerable:!0,get:function(){return dt.globalFolders}}),Object.defineProperty(O,"getAllFolders",{enumerable:!0,get:function(){return dt.getAllFolders}}),Object.defineProperty(O,"currentFolderId",{enumerable:!0,get:function(){return dt.currentFolderId}}),Object.defineProperty(O,"setCurrentFolderId",{enumerable:!0,get:function(){return dt.setCurrentFolderId}}),Object.defineProperty(O,"createFolder",{enumerable:!0,get:function(){return dt.createFolder}}),Object.defineProperty(O,"getPathToFolder",{enumerable:!0,get:function(){return dt.getPathToFolder}}),Object.defineProperty(O,"deleteFolder",{enumerable:!0,get:function(){return dt.deleteFolder}});let nt=[];function Je(q,se=!1){var ie,le,ce;return H(this,void 0,void 0,function*(){try{const re=nt.find(Pe=>Pe.key==q.sidebarQuerySelector);re?nt=nt.map(Pe=>Pe.key==q.sidebarQuerySelector?{params:q,showHeader:se,key:re.key}:Pe):nt.push({params:q,showHeader:se,key:q.sidebarQuerySelector});const Ae=De(q.sidebarQuerySelector);if(!Ae)return;null===(ie=Ae?.querySelector(`.${Ve.myprefix}boom_sidebar`))||void 0===ie||ie.remove(),Ae.innerHTML=yield lt.sideBarHTML(!!q.uploadFn),function(Pe){var ve,ot;const ht=document.createElement("style");ht.textContent=`\n        /* Reset styles for shadow DOM */\n        /* .${Ve.myprefix}boom_sidebar { */\n          /* all: unset; */\n         *:not(svg path) {\n          all: revert;\n        }\n    \n        /* Styles specific to the shadow root */\n        .${Ve.myprefix}boom_sidebar {\n            width: 100%;\n            color: black;\n            font-family: sans-serif;\n        }\n        /* Other styles */\n    `,Pe.prepend(ht),Pe.getElementById(`${Ve.myprefix}generic_boomconsole_style`)&&(null===(ve=Pe.getElementById(`${Ve.myprefix}generic_boomconsole_style`))||void 0===ve||ve.remove());let vt=document.createElement("style");vt.id=Ve.myprefix+"generic_boomconsole_style",vt.textContent=lt.generic_boomconsole_style(Ve.config.icons),Pe.prepend(vt),Pe.getElementById(`${Ve.myprefix}dialog_styles`)&&(null===(ot=Pe.getElementById(`${Ve.myprefix}dialog_styles`))||void 0===ot||ot.remove());let Pt=document.createElement("style");Pt.id=Ve.myprefix+"dialog_styles",Pt.textContent=lt.dialog_styles(Ve.config.icons),Pe.prepend(Pt)}(Ae),console.log("FolderMS creating tree with old data"),U.createNestedTreeAndAddToDOM(Ae),yield U.getAllFolders(q.sidebarQuerySelector);let Ge=U.globalFolders;if(console.log("FolderMS get all folders fetched and completed"),!(Ge?.length>0)){const Pe=Ae.querySelector(`#${Ve.myprefix}loader`);return null===(ce=Pe?.classList)||void 0===ce||ce.add(`${Ve.myprefix}hide`),document.createElement("p").append("You have not created folders yet!"),Ge}{let Pe=Ae?.querySelector(`.${Ve.myprefix}boom_sidebar`);Pe&&(Pe.style.width="100%");const ve=Ae.querySelector(`#${Ve.myprefix}loader`);null===(le=ve?.classList)||void 0===le||le.add(`${Ve.myprefix}hide`);let ot=Ae.querySelector(`#${Ve.myprefix}boom_sidebar_header`);se&&ot&&(ot.style.display="flex");const ht=Ae.getElementById(`${Ve.myprefix}upload_icon`);ht&&q.uploadFn&&ht.addEventListener("click",vt=>{q.uploadFn&&q.uploadFn(vt)})}}catch(re){console.error("Error occured during folder rendering",re)}})}function He(q,se=[]){var ie,le,ce,re;return H(this,void 0,void 0,function*(){try{const Ae=X(q);null!==(ie=Ae?.params)&&void 0!==ie&&ie.sidebarQuerySelector?null===(ce=document.querySelector(`${null===(le=Ae?.params)||void 0===le?void 0:le.sidebarQuerySelector} .${Ve.myprefix}boom_sidebar`))||void 0===ce||ce.remove():null===(re=document.querySelector(`.${Ve.myprefix}boom_sidebar`))||void 0===re||re.remove(),U.updateSelectedFolders(se||[])}catch(Ae){console.error("Error occured during folder removal",Ae)}})}O.renderTreeSidebar=Je,O.removeRenderedTreeSidebar=He,O.updateSelectedFolders=function(q,se,ie=!0){var le;return H(this,void 0,void 0,function*(){try{yield U.updateSelectedFolders(se||[]);const ce=X(q);ie&&(yield He(q,se||[]),null!==(le=ce?.params)&&void 0!==le&&le.sidebarQuerySelector&&(yield Je(ce.params,ce.showHeader)))}catch(ce){console.error("Error occured during category update",ce)}})};let et=[];function De(q){let se=document.querySelector(q);if(!se)return;const ie=et.find(ce=>ce.domSelector==q);if(ie&&se.shadowRoot)return ie.shadowRoot;et=et.filter(ce=>ce.domSelector!=q);let le={domSelector:q,shadowRoot:se.attachShadow({mode:"open"})};return et.push(le),le.shadowRoot}function X(q){return nt?.find(se=>se.key==q)}O.getShadowRoot=function(q){const se=et.find(ie=>ie.domSelector==q);if(se)return se.shadowRoot},O.getCurrentTreeParams=function(q){const se=et.find(ie=>ie.shadowRoot==q);if(se)return X(se.domSelector)},O.setShadowRoot=De,O.removeShadowRoot=function(q){const se=document.querySelector(q);se&&(se.innerHTML=""),et=et.filter(ie=>ie.domSelector!=q)},O.getRenderTreeSidebarOption=X},687:function(mt,O,tt){var $e=this&&this.__awaiter||function(Ve,U,lt,dt){return new(lt||(lt=Promise))(function(nt,Je){function He(X){try{De(dt.next(X))}catch(q){Je(q)}}function et(X){try{De(dt.throw(X))}catch(q){Je(q)}}function De(X){var q;X.done?nt(X.value):(q=X.value,q instanceof lt?q:new lt(function(se){se(q)})).then(He,et)}De((dt=dt.apply(Ve,U||[])).next())})};Object.defineProperty(O,"__esModule",{value:!0}),O.dialog_styles=O.generic_boomconsole_style=O.sideBarHTML=O.boom_theme=void 0;const Dt=tt(215),fe=tt(793),H="https://boomconcole.com/freeschema/dfe603bd-7cd0-403a-9941-d379e5acd5e8.png";O.boom_theme="light",O.sideBarHTML=(Ve=!1)=>$e(void 0,void 0,void 0,function*(){return yield(0,Dt.getUser)(),`\n  <div class="${fe.myprefix}boom_sidebar">\n      <div id="${fe.myprefix}boom_sidebar_header" class="${fe.myprefix}boom_sidebar_header">\n          <h3>Folders</h3>\n          ${Ve?`<span id="${fe.myprefix}upload_icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M260-160q-91 0-155.5-63T40-377q0-78 47-139t123-78q25-92 100-149t170-57q117 0 198.5 81.5T760-520q69 8 114.5 59.5T920-340q0 75-52.5 127.5T740-160H520q-33 0-56.5-23.5T440-240v-206l-64 62-56-56 160-160 160 160-56 56-64-62v206h220q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-80q0-83-58.5-141.5T480-720q-83 0-141.5 58.5T280-520h-20q-58 0-99 41t-41 99q0 58 41 99t99 41h100v80H260Zm220-280Z"/></svg></span>`:""}\n      </div>\n      <div class="${fe.myprefix}sidebar_body" data-id=""> \n          <div class="${fe.myprefix}loader" id="${fe.myprefix}loader"></div>  \n          <ul id="${fe.myprefix}category_list_tree"></ul>\n      </div>\n  </div>\n  `}),O.generic_boomconsole_style=(Ve={})=>`\n  .${fe.myprefix}root_folder {\n    font-weight: 700;\n  }\n  .${fe.myprefix}current_folder {\n    font-weight: 700 !important;\n    font-size: 14px;\n  }\n  #${fe.myprefix}boom_dialog label,\n  #${fe.myprefix}root_folder{\n    font-size: 14px;\n    cursor: pointer;\n  }\n  a.${fe.myprefix}btn_plus {\n    padding: 0;\n    position: relative;\n    left: 5px;\n    cursor: pointer;\n    background: #aaa;\n    display: inline-block;\n    width: 20px;\n    height: 20px;\n    color: #fff;\n    text-align: center;\n    line-height: 18px;\n    border-radius: 20px;\n    margin-right: 10px;\n    text-decoration: none;\n    display: inline-flex;\n    /* align-items: center; */\n    justify-content: center;\n    font-weight: 500;\n    font-size: 16px\n  }\n  a.${fe.myprefix}btn_plus:hover{\n    background: #555;\n  }\n  .${fe.myprefix}folder_checkbox {\n    opacity: 1 !important; \n    position: relative !important; \n    width: 14px; \n    height: 14px; \n    border-radius: 2px; \n    -webkit-appearance: checkbox;\n    color-scheme: only light;\n  }\n  #${fe.myprefix}category_list_tree li,\n  .${fe.myprefix}root_folder {\n    text-align: start;\n    cursor: pointer;\n    background: url(${Ve?.folderIcon?Ve.folderIcon:H}) 16px 3px no-repeat;\n    background-size: 16px auto !important;\n    padding-left: 35px !important;\n    position: relative !important;\n    text-wrap: nowrap !important;\n    font-size: 13px;\n    line-height: 24px;\n  }\n  .${fe.myprefix}root_folder,\n  li.${fe.myprefix}has_submenu:has(> ul.${fe.myprefix}active) {\n    background: url(${Ve?.openIcon?Ve.openIcon:"https://boomconcole.com/freeschema/60491cf1-2a5b-46b6-9aea-c1bd45e081ab.png"}) 16px 3px no-repeat !important;\n    background-size: 16px auto !important;\n  }\n  #${fe.myprefix}category_list_tree li label{\n    display: inline-block !important;\n    width: auto !important;\n    cursor: pointer;\n    font-weight: 500;\n  }\n  .${fe.myprefix}clickable_folder_icon_placeholder {\n    height: 16px;\n    width: 16px;\n    position: absolute;\n    left: 16px;\n    top: 3px;\n  }\n  .${fe.myprefix}is_virtual > label::before {\n    background: url('http://localhost:4200/assets/app-icons/open-folder.png') 16px 3px no-repeat;\n    content: "";\n    background: mediumvioletred;\n    width: 5px;\n    height: 5px;\n    z-index: 1000;\n    position: absolute;\n    border-radius: 50%;\n    top: 3px;\n    left: 30px;\n  }\n  .${fe.myprefix}is_virtual a.btn_plus {\n    display: none\n  }\n  #${fe.myprefix}small_close_button,\n  #${fe.myprefix}new_category_button{\n    background: #777;\n    color: #fff;\n    cursor: pointer;\n    border: none;\n    padding: 4px 10px;\n    margin-left: 10px;\n    font-size: 14px;\n    width: auto;\n    display: none;\n  }\n  #${fe.myprefix}new_category_button{\n    background: #333;\n    margin: 0;\n  }\n  #${fe.myprefix}new_category_wrapper{\n    margin: 5px 0;\n    cursor: pointer;\n    background: url(${Ve?.folderIcon?Ve.folderIcon:H}) 16px 3px no-repeat;\n    background-size: 16px auto;\n    padding-left: 40px;\n    text-wrap: nowrap;\n    position: relative;\n    left: -15px;\n  }\n\n  /* New Folder CSS right click */\n  #${fe.myprefix}folder_actions {\n    position: fixed;\n    z-index: 999999;\n    font-size: 14px;\n    line-height: 16px;\n  }\n  #${fe.myprefix}folder_actions a {\n    display: block;\n    background: white;\n    color: black;\n    padding: 10px 15px;\n    border: 1px solid lightgray;\n    text-wrap: nowrap;\n    cursor: pointer;\n  }\n  .${fe.myprefix}dragover {\n    background-color: rgba(0,0,0, 0.1);\n    display: block;\n    position: relative;\n    transition: all 0.4s;\n    height: 40px;\n    width: 10px;\n    margin-top: -20px;\n  }\n  #${fe.myprefix}upload_icon {\n    width: 25px;\n    cursor: pointer;\n  }\n  #${fe.myprefix}upload_icon svg {\n    fill: white;\n  }\n  `,O.dialog_styles=(Ve={})=>(console.log("icons",Ve),`\n  .${fe.myprefix}boom_sidebar{\n    font-family: Arial, Helvetica, sans-serif;\n    width: 40%;\n    position: relative;\n    margin-right: 20px;\n  }\n  .${fe.myprefix}sidebar_body{\n      /* max-height: 400px; */\n      overflow: auto;\n      padding: 12px 0;\n      min-height: 250px;\n      position: relative;\n      z-index: 3;\n      line-height: 22px;\n  }\n  .${fe.myprefix}boom_sidebar ul{\n    margin: 0;\n    padding: 0;\n    list-style: none;\n  }\n  .${fe.myprefix}submenuLevel.${fe.myprefix}active {\n    position: relative;\n    left: -15px\n  }\n  .${fe.myprefix}boom_dialog  *{\n    color: #333;\n    box-sizing: border-box;\n  }\n  .${fe.myprefix}boom-field{\n    margin: 20px 0;\n  }\n  .${fe.myprefix}boom-field select,\n  .${fe.myprefix}boom-field input,\n  .${fe.myprefix}boom-field textarea{\n    width: 100%;\n    background: #fff;\n  }\n  .${fe.myprefix}field_input,\n  .${fe.myprefix}field_select{\n    width: 100%;\n    font-size: 14px;\n    // margin: 0 0 5px;\n    border: 1px solid #aaa;\n    padding: 5px;\n    background-color: white;\n    display: block;\n    min-width: 150px;\n    color: black;\n  }\n  .${fe.myprefix}boom-field textarea{\n    min-height: 130px;\n  }\n  #${fe.myprefix}boom_dialog .${fe.myprefix}boom_question {\n    margin-bottom: 10px;\n    border-bottom: 1px solid #ccc;\n    padding: 20px 0;   \n  }\n  .${fe.myprefix}boom_answer{\n    height: 400px;\n    overflow: auto;\n    position: relative;\n  }\n  .${fe.myprefix}boom-field select,\n  .${fe.myprefix}boom-field input,\n  .${fe.myprefix}boom-field textarea{\n      box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;\n      min-width: 250px;\n      border: 1px solid #ccc;\n      border-radius: 5px;\n      padding: 12px;\n  }\n  #${fe.myprefix}closeButton {\n    background: #aaa;\n      padding: 8px 20px;\n      border-radius: 5px;\n      margin: 10px 20px 0 0;\n      color: #fff;\n  }\n  #${fe.myprefix}redirect_button,button[${fe.myprefix}submit_dialog],\n  button[${fe.myprefix}redirect_button],\n  button[${fe.myprefix}submit_boom_the_chat_dialog]\n  .${fe.myprefix}boom_button{\n    background-color: initial;\n    background-image: linear-gradient(-180deg, #FF7E31, #E62C03);\n    border-radius: 6px;\n    box-shadow: rgba(0, 0, 0, 0.1) 0 2px 4px;\n    color: #FFFFFF;\n    cursor: pointer;\n    display: inline-block;\n    padding: 8px 20px;\n    pointer-events: auto;\n    position: relative;\n    text-align: center;\n    touch-action: manipulation;\n    user-select: none;\n    -webkit-user-select: none;\n    white-space: nowrap;\n    z-index: 9;\n    border: 0;\n    transition: box-shadow .2s;\n  }\n  #${fe.myprefix}redirect_button,button[${fe.myprefix}submit_dialog]:hover,\n  button[${fe.myprefix}submit_boom_the_chat_dialog]:hover,   button[${fe.myprefix}redirect_button]:hover {\n    box-shadow: rgba(253, 76, 0, 0.5) 0 3px 8px;\n  }\n  \n  #${fe.myprefix}boom_dialog::backdrop{\n    background: rgba(0,0,0,0.7);\n  }\n  \n  .${fe.myprefix}success_message {\n      padding: 20px;\n      color: green;\n      background: rgba(255,255,255,0.94);\n      left: 0;\n      z-index: 999;\n      top: 0;\n      width: 100%;\n      text-align: center;\n      position: fixed;\n      font-size: 30px;\n      text-transform: capitalize;\n      height: 100%;\n      padding: 50px 0;\n  }\n  \n  #${fe.myprefix}dialog_form{\n    position: relative;\n    padding: 0px 20px 20px;\n  }\n  #${fe.myprefix}category_results{\n    display: none;\n    box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;\n    position: absolute;\n    list-style: none;\n      left: 0;\n      width: 100%;\n      top: 57px;\n      border-radius: 5px;\n      z-index: 100;\n      margin: 10px 0;\n      background: #fff;\n      padding: 0;\n  }\n  #${fe.myprefix}category_results.show{\n    display: block;\n  }\n  #${fe.myprefix}category_results li a{\n    cursor: pointer;\n      display: block;\n      padding: 12px 20px;\n      border-bottom: 1px solid #eee;\n  }\n  #${fe.myprefix}category_results li a:hover{\n    background: #f3f3f3;\n  }\n  .${fe.myprefix}boom_sidebar_header{\n    color:white;\n    background: linear-gradient(132deg, rgb(36, 37, 38) 0%, rgb(65, 80, 95) 100%);\n    padding: 10px 30px;\n    position: sticky;\n    top: 0;\n    z-index: 10;\n    display: none;\n    align-items: center;\n    justify-content: space-between;\n  }\n  .${fe.myprefix}boom_sidebar_header h3 {\n      margin: 0px;\n      color: white;\n      font-weight: bold;\n      font-size: 16px;\n  }\n  .${fe.myprefix}boom_category {\n    position: relative;\n  }\n  .${fe.myprefix}boom_the_chat{\n    border-width: 1px;\n    padding: 0.5rem 0.75rem;\n    font-family: inherit;\n    font-weight: inherit;\n  }\n  .${fe.myprefix}loader {\n    border: 5px solid #f3f3f3; /* Light grey */\n    border-top: 5px solid #E62C03; /* pink */\n    border-radius: 50%;\n    width: 40px;\n    height: 40px;\n    animation: ${fe.myprefix}spin 2s linear infinite;\n    z-index: 12;\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n  }\n  \n  @keyframes ${fe.myprefix}spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  .${fe.myprefix}hide{\n    display:none;\n  }\n  .${fe.myprefix}submenuLevel{\n    display: none;\n    list-style: none;\n  }\n  .${fe.myprefix}has_submenu {\n    user-select: none; /* Prevent text selection */\n  }\n  #${fe.myprefix}category_list_tree input[type="checkbox"]{\n    margin: 0px 7px 5px 3px;\n  }\n  \n    .${fe.myprefix}category_list_tree input[type="checkbox"]{\n      margin: 3px;\n      position: relative !important;\n      opacity: 1 !important;\n      pointer-events: auto;\n    }\n  \n  .${fe.myprefix}has_submenu::before {\n    content: '';\n    color: black;\n    display: inline-block;\n    margin-right: 6px;\n  }\n  \n  .${fe.myprefix}has_submenu_down::before {\n    transform: rotate(90deg);\n  }\n  .${fe.myprefix}active {\n    display: block;\n  }\n  #${fe.myprefix}category_list_tree{\n    position: relative;\n    margin-left: 20px;  \n    padding-left: 0px;\n    list-style: none;\n  }\n  \n  /* #${fe.myprefix}category_list_tree li {\n    cursor: pointer;\n    background: url(${Ve?.folderIcon?Ve.folderIcon:H}) 16px 3px no-repeat !important;\n    background-size: 16px auto !important;\n    padding-left: 35px !important;\n    position: relative !important;\n    text-wrap: nowrap !important;\n  } */\n  #${fe.myprefix}category_list_tree li:before{\n    background: #000;\n    content: "";\n    width: 17px;\n    height: 2px;\n    position: absolute;\n    left: 0;\n    top: 9px;\n    z-index: 99\n  }\n  #${fe.myprefix}category_list_tree li:after{\n    background: #000;\n    content: "";\n    width: 2px;\n    position: absolute;\n    left: 0;\n    top: 0;\n    height: 100%;\n    z-index: 99\n  }\n  #${fe.myprefix}category_list_tree li:last-child:after{\n    height: 10px;\n  }\n  .${fe.myprefix}toggler {\n    background: url(${Ve?.nextIcon?Ve.nextIcon:"https://boomconcole.com/freeschema/d122f7dd-b0ec-409a-8131-d90a6c2b146a.png"}) left top no-repeat;\n      background-size: 100% auto;\n      display: block;\n      width: 18px;\n      height: 18px;\n      background-color: #fff;\n      position: absolute;\n      left: -9px;\n      top: 1px;\n      border-radius: 50%;\n      z-index: 100;\n      cursor: pointer;\n  }\n  #${fe.myprefix}create_category{\n    cursor: pointer;\n      position: absolute;\n      right: 0;\n      top: 10px;\n      padding: 5px 14px;\n      background: #333;\n      color: #fff;\n      border-radius: 20px;\n  }\n  #${fe.myprefix}create_category span{\n    color: #fff;\n  }\n  .${fe.myprefix}toggler:has(+ .${fe.myprefix}active){\n    transform: rotate(90deg);\n  }\n  .${fe.myprefix}boom_form{\n    margin: 0 8px 2px;\n    border: 1px solid #ccc\n  }\n  #${fe.myprefix}new_category_button{\n    background: #333;\n    color: #fff;\n    cursor: pointer;\n    border: none;\n    padding: 4px 10px;\n    \n  }\n  .${fe.myprefix}field_error{\n    font-size: 14px;\n    color:red;\n  }\n  .${fe.myprefix}field_success{\n    font-size: 14px;\n    color:green;\n  }\n  \n  /*\n  Theme: Dark\n  */\n  .${fe.myprefix}boom_dialog.${O.boom_theme}{\n    background: linear-gradient(\n      132deg,\n      rgb(90, 115, 139) 0%,\n      rgb(66, 73, 76) 100%\n    );\n    color: #f5f5f5;\n    border: rgb(90, 115, 139);\n  }\n  .${fe.myprefix}boom_dialog.${O.boom_theme} *{\n    color: #f5f5f5;\n  }\n  .${fe.myprefix}boom_dialog.${O.boom_theme} input,\n  .${fe.myprefix}boom_dialog.${O.boom_theme} select{\n    color: #555;\n  }\n  \n  .${fe.myprefix}preview{\n    border: 1px solid #666;\n    border-radius: 5px;\n    padding: 10px;\n    max-height: 250px;\n    overflow-y: auto;\n    margin: 20px 0;\n  }\n  .${fe.myprefix}preview h3{\n    font-size: 20px;\n    margin: 0 0 8px;\n  }\n  `)},726:(mt,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.boomFolderComposition=O.captureBoomGPTComposition=void 0,O.captureBoomGPTComposition="boomgpt",O.boomFolderComposition="boomFolder"},777:(mt,O,tt)=>{tt.r(O),tt.d(O,{ADMIN:()=>Ve,ALLID:()=>U,AccessTracker:()=>lt,AddGhostConcept:()=>dt,Anomaly:()=>nt,BaseUrl:()=>Je,BinaryTree:()=>He,BuildWidgetFromId:()=>et,BuilderStatefulWidget:()=>De,Composition:()=>X,CompositionBinaryTree:()=>q,CompositionNode:()=>se,Concept:()=>ie,ConceptsData:()=>le,Connection:()=>ce,ConnectionData:()=>re,CreateComposition:()=>Ae,CreateConnection:()=>Ge,CreateConnectionBetweenEntityLocal:()=>Pe,CreateConnectionBetweenTwoConcepts:()=>ve,CreateConnectionBetweenTwoConceptsGeneral:()=>ot,CreateConnectionBetweenTwoConceptsLocal:()=>ht,CreateData:()=>vt,CreateDefaultConcept:()=>Pt,CreateDefaultLConcept:()=>Jt,CreateSession:()=>Kt,CreateSessionVisit:()=>ct,CreateTheCompositionLocal:()=>Ut,CreateTheCompositionWithCache:()=>Vt,CreateTheConnection:()=>Ht,CreateTheConnectionGeneral:()=>Rt,CreateTheConnectionLocal:()=>Mt,DATAID:()=>he,DATAIDDATE:()=>oe,DelayFunctionExecution:()=>J,DeleteConceptById:()=>ue,DeleteConceptLocal:()=>ee,DeleteConnectionById:()=>j,DeleteConnectionByType:()=>Y,DeleteUser:()=>pe,DependencyObserver:()=>Le,FilterSearch:()=>Se,FormatFromConnections:()=>Ze,FormatFromConnectionsAltered:()=>it,FreeschemaQuery:()=>Qe,FreeschemaQueryApi:()=>Fe,GetAllConnectionsOfComposition:()=>at,GetAllConnectionsOfCompositionBulk:()=>It,GetAllTheConnectionsByTypeAndOfTheConcept:()=>ft,GetComposition:()=>Gt,GetCompositionBulk:()=>en,GetCompositionBulkWithDataId:()=>Ot,GetCompositionFromConnectionsWithDataId:()=>zt,GetCompositionFromConnectionsWithDataIdFromConnections:()=>jt,GetCompositionFromConnectionsWithDataIdInObject:()=>nn,GetCompositionFromConnectionsWithDataIdIndex:()=>wn,GetCompositionFromConnectionsWithIndex:()=>Fo,GetCompositionFromConnectionsWithIndexFromConnections:()=>ii,GetCompositionFromMemoryWithConnections:()=>ri,GetCompositionList:()=>Pa,GetCompositionListAll:()=>Wa,GetCompositionListAllWithId:()=>Va,GetCompositionListListener:()=>$a,GetCompositionListLocal:()=>ja,GetCompositionListLocalWithId:()=>Ha,GetCompositionListWithId:()=>qa,GetCompositionListWithIdUpdated:()=>Ja,GetCompositionListener:()=>za,GetCompositionLocal:()=>Za,GetCompositionLocalWithId:()=>Qa,GetCompositionWithAllIds:()=>Ka,GetCompositionWithCache:()=>Ya,GetCompositionWithDataIdBulk:()=>Xa,GetCompositionWithDataIdWithCache:()=>ec,GetCompositionWithId:()=>tc,GetCompositionWithIdAndDateFromMemory:()=>nc,GetConceptBulk:()=>oc,GetConceptByCharacter:()=>ic,GetConceptByCharacterAndCategoryLocal:()=>rc,GetConceptByCharacterAndType:()=>ac,GetConnectionBetweenTwoConceptsLinker:()=>cc,GetConnectionBulk:()=>sc,GetConnectionById:()=>lc,GetConnectionDataPrefetch:()=>dc,GetConnectionOfTheConcept:()=>uc,GetLink:()=>hc,GetLinkListListener:()=>pc,GetLinkListener:()=>fc,GetLinkRaw:()=>yc,GetLinkerConnectionFromConcepts:()=>gc,GetLinkerConnectionToConcepts:()=>vc,GetRelation:()=>mc,GetRelationLocal:()=>Cc,GetRelationRaw:()=>_c,GetTheConcept:()=>Tc,GetTheConceptLocal:()=>wc,GetUserGhostId:()=>Ic,JUSTDATA:()=>kc,LConcept:()=>bc,LConnection:()=>Ac,LISTNORMAL:()=>Lc,LocalConceptsData:()=>Nc,LocalSyncData:()=>Sc,LocalTransaction:()=>xc,Logger:()=>Fc,LoginToBackend:()=>Ec,MakeTheInstanceConcept:()=>Bc,MakeTheInstanceConceptLocal:()=>Dc,MakeTheTimestamp:()=>Gc,MakeTheTypeConceptApi:()=>Uc,MakeTheTypeConceptLocal:()=>Rc,NORMAL:()=>Oc,PRIVATE:()=>Mc,PUBLIC:()=>Pc,PatcherStructure:()=>Wc,Prototype:()=>Vc,RAW:()=>$c,RecursiveSearchApi:()=>jc,RecursiveSearchApiNewRawFullLinker:()=>Hc,RecursiveSearchApiRaw:()=>qc,RecursiveSearchApiRawFullLinker:()=>Jc,RecursiveSearchApiWithInternalConnections:()=>zc,RecursiveSearchListener:()=>Zc,SchemaQuery:()=>Qc,SchemaQueryListener:()=>Kc,SearchAllConcepts:()=>Yc,SearchLinkInternal:()=>Xc,SearchLinkInternalAll:()=>es,SearchLinkMultipleAll:()=>ts,SearchLinkMultipleAllObservable:()=>ns,SearchLinkMultipleApi:()=>os,SearchQuery:()=>is,SearchStructure:()=>rs,SearchWithLinker:()=>as,SearchWithTypeAndLinker:()=>cs,SearchWithTypeAndLinkerApi:()=>ss,Selector:()=>ls,SessionData:()=>ds,Signin:()=>us,Signup:()=>hs,SignupEntity:()=>ps,SplitStrings:()=>fs,StatefulWidget:()=>ys,SyncData:()=>gs,TrashTheConcept:()=>vs,UpdateComposition:()=>ms,UpdateCompositionLocal:()=>Cs,UserBinaryTree:()=>_s,Validator:()=>Ts,ViewInternalData:()=>ws,ViewInternalDataApi:()=>Is,WidgetTree:()=>ks,convertFromConceptToLConcept:()=>bs,convertFromLConceptToConcept:()=>As,convertWidgetTreeToWidget:()=>Ls,convertWidgetTreeToWidgetWithWrapper:()=>Ns,createFormFieldData:()=>Ss,createPrototypeLocal:()=>xs,dispatchIdEvent:()=>Fs,getFromDatabaseWithType:()=>Es,getObjectsFromIndexDb:()=>Bs,getWidgetBulkFromId:()=>Ds,getWidgetFromId:()=>Gs,handleServiceWorkerException:()=>Us,hasActivatedSW:()=>Rs,init:()=>Os,recursiveFetch:()=>Ms,recursiveFetchNew:()=>Ps,removeAllChildren:()=>Ws,renderLatestWidget:()=>Vs,renderPage:()=>$s,renderWidget:()=>js,searchLinkMultipleListener:()=>Hs,sendEmail:()=>qs,sendMessage:()=>Js,serviceWorker:()=>zs,setHasActivatedSW:()=>Zs,storeToDatabase:()=>Qs,subscribedListeners:()=>Ks,unwrapContainers:()=>Ys,updateAccessToken:()=>Xs,uploadAttachment:()=>el,uploadFile:()=>tl,uploadImage:()=>nl,validDocumentFormats:()=>ol,validImageFormats:()=>il});var $e={1735:(Re,ne,_)=>{_.d(ne,{J:()=>A});var B,M=_(1834),c=_(3278),f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};class A{static incrementConcept(a){try{a&&(this.conceptsData[a]=(this.conceptsData[a]||0)+1)}catch{console.error("Failed on increment concept")}}static incrementConnection(a){try{a&&(this.connectionsData[a]=(this.connectionsData[a]||0)+1)}catch{console.error("Failed on increment connection")}}static getTopConcepts(a){return Object.entries(this.conceptsData).map(([r,d])=>[parseInt(r),d]).sort((r,d)=>d[1]-r[1]).slice(0,a)}static getTopConnections(a){return Object.entries(this.connectionsData).map(([r,d])=>[parseInt(r),d]).sort((r,d)=>d[1]-r[1]).slice(0,a)}static saveDataToLocalStorage(){localStorage?.setItem(this.accessData,JSON.stringify({concepts:this.conceptsData,connections:this.connectionsData}))}static loadDataFromLocalStorage(){const a=null==localStorage?void 0:localStorage.getItem(this.accessData);if(a){const r=JSON.parse(a);this.conceptsData=r.concepts||{},this.connectionsData=r.connections||{}}}static sendToServer(){return f(this,void 0,void 0,function*(){try{yield this.syncToServer()}catch{console.error("Failed to process Access Tracker Sync with Server")}})}static syncToServer(){return f(this,void 0,void 0,function*(){try{if(!Object.keys(this.conceptsData).length&&!Object.keys(this.connectionsData).length)return;const a=c.b.BearerAccessToken;if(!a)return;const r=this.conceptsData&&Object.keys(this.conceptsData).length>0?this.conceptsData:{},d=this.connectionsData&&Object.keys(this.connectionsData).length>0?this.connectionsData:{},h=yield fetch(M.BaseUrl.PostPrefetchConceptConnections(),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({concepts:r,connections:d})});if(!h.ok)throw new Error("Failed to sync data to the server.");yield h.json(),this.conceptsData={},this.connectionsData={},this.setNextSyncTime()}catch(a){console.error("Sync error:",a)}})}static setNextSyncTime(){this.nextSyncTime=Date.now()+this.SYNC_INTERVAL_MS}static startAutoSync(){setInterval(()=>{const a=Date.now();this.nextSyncTime&&a>=this.nextSyncTime&&this.syncNow().catch(console.error)},6e4)}static syncNow(){return f(this,void 0,void 0,function*(){try{this.activateStatus?yield this.syncToServer():console.warn("Access Tracker inactive.")}catch{console.error("Error on sync access tracker")}})}static GetSuggestedConcepts(a){return f(this,void 0,void 0,function*(){try{const r=c.b.BearerAccessToken,d=new URL(M.BaseUrl.GetSuggestedConcepts());void 0!==a&&d.searchParams.append("top",a.toString());const h=yield fetch(d.toString(),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!h.ok){const T=yield h.text();throw new Error(`Failed to load concepts: ${h.status} ${h.statusText}. Details: ${T}`)}const C=(yield h.json())||[];return yield this.addConceptToBinaryTree(C.data),C}catch(r){throw r instanceof Error?(console.error("Error fetching suggested concepts:",r.message),new Error("Unable to fetch suggested concepts. Please try again later.")):(console.error("An unexpected error occurred:",r),new Error("An unexpected error occurred while fetching suggested concepts."))}})}static GetSuggestedConnections(a){return f(this,void 0,void 0,function*(){try{const r=c.b.BearerAccessToken,d=new URL(M.BaseUrl.GetSuggestedConnections());void 0!==a&&d.searchParams.append("top",a.toString());const h=yield fetch(d.toString(),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!h.ok){const T=yield h.text();throw new Error(`Failed to load connections: ${h.status} ${h.statusText}. Details: ${T}`)}const C=(yield h.json())||[];return yield this.addConnectionToBinaryTree(C.data),C}catch(r){throw r instanceof Error?(console.error("Error fetching suggested Connections:",r.message),new Error("Unable to fetch suggested connections. Please try again later.")):(console.error("An unexpected error occurred:",r),new Error("An unexpected error occurred while fetching suggested Connections."))}})}static addConceptToBinaryTree(a){return f(this,void 0,void 0,function*(){try{a.forEach(r=>{M.ConceptsData.AddConcept(r)})}catch{console.error("Error on adding Concepts Data into tree")}})}static addConnectionToBinaryTree(a){return f(this,void 0,void 0,function*(){try{a.forEach(r=>{M.ConnectionData.AddConnection(r)})}catch{console.error("Error on adding Connections Data into tree")}})}}B=A,A.conceptsData={},A.connectionsData={},A.SYNC_INTERVAL_MS=12e4,A.nextSyncTime=Date.now(),A.activateStatus=!1,A.accessData="Access Data",B.startAutoSync()},1167:(Re,ne,_)=>{_.d(ne,{Y:()=>N});var B=_(9581),M=_(3518),c=_(1834),f=_(1863),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};function N(a){return A(this,void 0,void 0,function*(){const r=c.Logger.logfunction("CreateTheConceptApi",a);let d=(0,c.CreateDefaultConcept)();try{var h=(0,M.Xr)();const C=yield fetch(B.B.CreateTheConceptUrl(),{method:"POST",headers:h,body:JSON.stringify(a)});if(!C.ok)throw(0,f.ry)(C),new Error(`Error! status: ${C.status}`);return d=yield C.json(),c.Logger.logUpdate(r),d}catch(C){C instanceof Error?console.log("Create the concept api error message: ",C.message):console.log("Create the concept api unexpected error: ",C),(0,f.Mb)(C,B.B.CreateTheConceptUrl()),(0,f.ey)(r,"CreateTheConceptApi",C)}})}},2:(Re,ne,_)=>{_.d(ne,{s:()=>r});var B=_(8286),M=_(9581),c=_(1412),f=_(3518),A=_(1863),N=_(1834),a=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};function r(h){var C=arguments;return a(this,void 0,void 0,function*(){const T=N.Logger.logfunction("GetAllConnectionsOfComposition",C);var b=[];if(0==(b=yield B.d.GetConnectionsOfConcept(h)).length)b=yield d(h);else{var m=yield d(h);(0,c.e)(m,b),b=m}return N.Logger.logUpdate(T),b})}function d(h){var C=arguments;return a(this,void 0,void 0,function*(){const T=N.Logger.logfunction("GetAllConnectionsOfCompositionOnline",C);var b=[];try{(0,f.Xr)("application/json");const y=new Headers,s=new FormData;s.append("composition_id",h.toString());const p=yield fetch(M.B.GetAllConnectionsOfCompositionUrl(),{method:"POST",headers:y,body:s});if(console.log("this is getting connection from online",M.B.GetAllConnectionsOfCompositionUrl(),h),!p.ok)throw(0,A.ry)(p),new Error(`Error! status: ${p.status}`);const I=yield p.json();for(var m=0;m<I.length;m++)B.d.AddConnection(I[m]),b.push(I[m]);return N.Logger.logUpdate(T),b}catch(y){y instanceof Error?console.log("Get all connection of composition error : ",y.message):console.log("Get all connection of composition error : ",y),(0,A.Mb)(y,M.B.GetAllConnectionsOfCompositionUrl()),(0,A.ey)(T,"GetAllConnectionsOfCompositionOnline",y)}})}},8642:(Re,ne,_)=>{_.d(ne,{Y:()=>h});var B=_(8286),M=_(9581),c=_(4364),f=_(5284),A=_(1412),N=_(3518),a=_(1863),r=_(1834),d=function(C,T,b,m){return new(b||(b=Promise))(function(y,s){function p(w){try{x(m.next(w))}catch(F){s(F)}}function I(w){try{x(m.throw(w))}catch(F){s(F)}}function x(w){var F;w.done?y(w.value):(F=w.value,F instanceof b?F:new b(function(E){E(F)})).then(p,I)}x((m=m.apply(C,T||[])).next())})};function h(){var C=arguments;return d(this,arguments,void 0,function*(T=[]){const b=r.Logger.logfunction("GetAllConnectionsOfCompositionBulk",C)||{};if(r.serviceWorker){b.serviceWorker=!0;try{const p=yield(0,r.sendMessage)("GetAllConnectionsOfCompositionBulk",{composition_ids:T});return r.Logger.logUpdate(b),p.data}catch(p){console.error("GetAllConnectionsOfCompositionBulk sw error: ",p),(0,a.ey)(b,"GetAllConnectionsOfCompositionBulk",p),(0,r.handleServiceWorkerException)(p)}}var m=[];if(T.length<=0)return m;var y=yield(0,f.B)(T),s=yield function(){var p=arguments;return d(this,arguments,void 0,function*(I=[]){const x=r.Logger.logfunction("GetAllConnectionsOfCompositionOnline",p);var w=[];try{var F=(0,N.Xr)();const D=yield fetch(M.B.GetAllConnectionsOfCompositionBulkUrl(),{method:"POST",headers:F,body:JSON.stringify(I)});if(D.ok){const G=yield D.json();for(var E=0;E<G.length;E++)B.d.AddConnection(G[E]),w.push(G[E])}else console.log("Get all connections of composition bulk error message: ","Cannot get response"),(0,a.ry)(D);return r.Logger.logUpdate(x),w}catch(D){D instanceof Error?console.log("Get all connections of composition bulk error message: ",D.message):console.log("Get all connections of composition bulk unexpected error: ",D),(0,a.Mb)(D,M.B.GetAllConnectionsOfCompositionBulkUrl()),(0,a.ey)(x,"GetAllConnectionsOfCompositionOnline",D)}})}(T);return(0,A.e)(m=s,y),yield(0,c.s)(m),r.Logger.logUpdate(b),m})}},2803:(Re,ne,_)=>{_.d(ne,{x:()=>N});var B=_(8286),M=_(9581),c=_(1863),f=_(1834),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};function N(a,r,d){var h=arguments;return A(this,void 0,void 0,function*(){const C=f.Logger.logfunction("GetCompositionConnectionsBetweenTwoConcepts",h)||{};var T=[];try{if(f.serviceWorker){C.serviceWorker=!0;try{const s=yield(0,f.sendMessage)("GetCompositionConnectionsBetweenTwoConcepts",{ofConceptId:a,toConcept:r,mainKey:d});return f.Logger.logUpdate(C),s.data}catch(s){console.error("GetCompositionConnectionsBetweenTwoConcepts sw error: ",s),(0,c.ey)(C,"GetCompositionConnectionsBetweenTwoConcepts",s),(0,f.handleServiceWorkerException)(s)}}var b=new FormData;b.append("ofConceptId",a.toString()),b.append("mainKey",d.toString()),b.append("toConceptId",r.toString());const y=yield fetch(M.B.GetCompositionConnectionBetweenTwoConceptsUrl(),{method:"POST",body:b,redirect:"follow"});if(y.ok){const s=yield y.json();for(var m=0;m<s.length;m++)B.d.AddConnection(s[m]),T.push(s[m]);f.Logger.logUpdate(C)}else console.log("Get composition connection between two concepts",y.status),(0,c.ry)(y)}catch(y){y instanceof Error?console.log("Get composition connection between two concepts error message: ",y.message):console.log("Get composition connection between two concepts unexpected error: ",y),(0,c.Mb)(y,M.B.GetCompositionConnectionBetweenTwoConceptsUrl()),(0,c.ey)(C,"GetCompositionConnectionsBetweenTwoConcepts",y)}return T})}},7139:(Re,ne,_)=>{_.d(ne,{r:()=>r});var B=_(9639),M=_(9581),c=_(1834),f=_(1863),A=_(1596),N=_(3278),a=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};function r(d){var h=arguments;return a(this,void 0,void 0,function*(){const C=c.Logger.logfunction("GetConcept",h)||{};let T=(0,c.CreateDefaultConcept)();const b=new FormData;b.append("id",d.toString());try{if(c.serviceWorker){C.serviceWorker=!0;try{const s=yield(0,c.sendMessage)("GetConcept",{id:d});return c.Logger.logUpdate(C),s.data}catch(s){console.error("GetConcept sw error: ",s),(0,f.ey)(C,"GetConcept",s),(0,c.handleServiceWorkerException)(s)}}if(0==d||null==d||null==d)return T;var m=yield B.I.GetConcept(d);let y=B.I.GetNpc(d);if(0!=m.id||y)return c.Logger.logUpdate(C),m;{let s;const p={method:"POST",body:b,headers:{Authorization:"Bearer "+N.b.BearerAccessToken}};try{console.log("this is the url",M.B.GetConceptUrl()),s=yield fetch(M.B.GetConceptUrl(),p)}catch{s=yield(0,A.g)(p,"/api/getConcept")}return yield function(I,x,w,F){return a(this,void 0,void 0,function*(){return I.ok?(x=yield I.json()).id>0?B.I.AddConcept(x):B.I.AddNpc(F):(console.log("Get the concept error",I.status),(0,f.ry)(I)),c.Logger.logUpdate(w),x})}(s,T,C,d)}}catch(y){y instanceof Error?console.log("Get the concept error message: ",y.message):console.log("Get the concept unexpected error: ",y),(0,f.Mb)(y,M.B.GetConceptUrl()),(0,f.ey)(C,"GetConcept",y)}})}},1239:(Re,ne,_)=>{_.d(ne,{I:()=>d,r:()=>r});var B=_(9639),M=_(9581),c=_(3518),f=_(1863),A=_(1834),N=_(1596),a=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};function r(h){return a(this,void 0,void 0,function*(){const C=A.Logger.logfunction("GetConceptBulk",[h.length])||{};let T=[],b=((new Date).getTime(),performance.now()),m=Array.from(new Set(h));try{if(A.serviceWorker){C.serviceWorker=!0;try{const y=yield(0,A.sendMessage)("GetConceptBulk",{passedConcepts:h});return A.Logger.logUpdate(C),y.data}catch(y){console.error("GetConceptBulk sw error: ",y),(0,f.ey)(C,"GetConceptBulk",y),(0,A.handleServiceWorkerException)(y)}}if(m.length>0){let y=[];for(let s=0;s<m.length;s++)if(!B.I.GetNpc(m[s])){let p=yield B.I.GetConcept(m[s]);0==p.id?y.push(m[s]):T.push(p)}if(0==y.length)return A.Logger.logfunction(C),T;{let s;const p={method:"POST",headers:(0,c.Xr)(),body:JSON.stringify(y)};try{s=yield fetch(M.B.GetConceptBulkUrl(),p)}catch{s=yield(0,N.g)(p,"/api/get_concept_bulk")}yield function(I,x,w,F,E){return a(this,void 0,void 0,function*(){if(I.ok){let D=yield I.json();if(D.length>0)for(let G=0;G<D.length;G++){let Z=D[G];B.I.AddConcept(Z),w.push(Z)}console.log("added the concepts"),A.Logger.logUpdate(F)}else console.log("Get Concept Bulk error",I.status),A.Logger.logError(E,"unknown","read","unknown",void 0,I.status,I,"GetConceptBulk",[x],"unknown",void 0),(0,f.ry)(I)})}(s,h,T,C,b)}}}catch(y){y instanceof Error?console.log("Get Concept Bulk  error message: ",y.message):console.log("Get Concept Bulk  unexpected error: ",y),A.Logger.logError(b,"unknown","read","unknown",void 0,500,y,"GetConceptBulk",[h],"unknown",void 0),(0,f.Mb)(y,M.B.GetConceptBulkUrl()),(0,f.ey)(C,"GetConceptBulk",y)}return T})}function d(h){return a(this,void 0,void 0,function*(){const C=[];if(h.length>0){const T={"Content-Type":"application/json"};try{const b=yield fetch(M.B.GetConceptBulkUrl(),{method:"POST",headers:T,body:JSON.stringify(h)});if(b.ok){const m=yield b.json();if(m.length>0)for(let y=0;y<m.length;y++){const s=m[y];C.push(s),B.I.AddConcept(s)}}else console.log("bulk concept getter api error: ",b.status),(0,f.ry)(b)}catch(b){b instanceof Error?console.log("bulk concept getter api error: ",b.message):console.log("bulk concept getter api error: ",b),(0,f.Mb)(b,M.B.GetConceptBulkUrl())}}return C})}},4402:(Re,ne,_)=>{_.d(ne,{A:()=>r});var B=_(9639),M=_(9581),c=_(3518),f=_(1863),A=_(1834),N=_(7876),a=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};function r(d,h){var C=arguments;return a(this,void 0,void 0,function*(){const T=A.Logger.logfunction("GetConceptByCharacterAndType",C);try{if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetConceptByCharacterAndType",{characterValue:d,typeId:h})).data}catch(p){console.error("GetConceptByCharacterAndType sw error: ",p),(0,A.handleServiceWorkerException)(p)}let s=yield B.I.GetConceptByCharacterAndTypeLocal(d,h);if(null==s||0==s.id){var b={character_value:`${d}`,type_id:h},m=JSON.stringify(b),y=(0,c.Xr)();const p=yield fetch(M.B.GetConceptByCharacterAndTypeUrl(),{method:"POST",headers:y,body:m});p.ok?(s=yield p.json(),(0,N.K)(s).then(x=>{B.I.AddConcept(s)})):((0,f.ry)(p),console.log("This is the concept by type and character error",p.status))}return A.Logger.logUpdate(T),s}catch(s){s instanceof Error?console.log(" This is the concept by type and character error message: ",s.message):console.log(" This is the concept by type and character unexpected error: ",s),(0,f.Mb)(s,M.B.GetConceptByCharacterAndTypeUrl()),(0,f.ey)(T,"GetConceptByCharacterAndType",s)}})}},8146:(Re,ne,_)=>{_.d(ne,{Y:()=>a});var B=_(9639),M=_(9581),c=_(1834),f=_(1863),A=_(7876),N=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function a(r){var d=arguments;return N(this,void 0,void 0,function*(){const h=c.Logger.logfunction("GetConceptByCharacterValue",d);let C=(0,c.CreateDefaultConcept)();try{const T=new FormData;T.append("character_value",r);const b=yield fetch(M.B.GetConceptByCharacterValueUrl(),{method:"POST",body:T});b.ok?(C=yield b.json(),C.id>0&&(0,A.K)(C).then(m=>{B.I.AddConcept(C)}),c.Logger.logUpdate(h)):((0,f.ry)(b),console.log("Error in Getting concept by character value Error",b.status))}catch(T){T instanceof Error?console.log("Error in Getting concept by character value error message: ",T):console.log("Error in Getting concept by character value unexpected error: ",T),(0,f.Mb)(T,M.B.GetConceptByCharacterValueUrl()),(0,f.ey)(h,"GetConceptByCharacterValue",T)}return C})}},7467:(Re,ne,_)=>{_.d(ne,{j:()=>d});var B=_(8286),M=_(9581),c=_(4364),f=_(3518),A=_(1863),N=_(1834),a=_(1596),r=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};function d(){return r(this,arguments,void 0,function*(h=[]){const C=N.Logger.logfunction("GetConnectionBulk",h.length)||{};let T=[];try{if(N.serviceWorker){C.serviceWorker=!0;try{const b=yield(0,N.sendMessage)("GetConnectionBulk",{connectionIds:h});return N.Logger.logUpdate(C),b.data}catch(b){console.error("GetConnectionBulk sw error: ",b),(0,A.ey)(C,"GetConnectionBulk",b),(0,N.handleServiceWorkerException)(b)}}if(h.length>0){let b=[];for(let m=0;m<h.length;m++)if(!B.d.GetNpConn(h[m])){let y=yield B.d.GetConnection(h[m]);0==y.id?b.push(h[m]):T.push(y)}if(0==b.length)return N.Logger.logUpdate(C),T;{let m;const y={method:"POST",headers:(0,f.Xr)(),body:JSON.stringify(b)};try{m=yield fetch(M.B.GetConnectionBulkUrl(),y)}catch{m=yield(0,a.g)(y,"/api/get_connection_bulk")}yield function(s,p,I){return r(this,void 0,void 0,function*(){if(s.ok){const x=yield s.json();if(x.length>0)for(let w=0;w<x.length;w++){let F=x[w];p.push(F),B.d.AddConnection(F)}}else(0,A.ey)(I,"GetConnectionBulk",s.status),(0,A.ry)(s),console.log("Get Connection Bulk error",s.status)})}(m,T,C),N.Logger.logUpdate(C)}}}catch(b){b instanceof Error?console.log("Get Connection Bulk error message: ",b):console.log("Get Connection Bulk unexpected error: ",b),(0,A.ey)(C,"GetConnectionBulk",b),(0,A.Mb)(b,M.B.GetConnectionBulkUrl())}return yield(0,c.s)(T),T})}},2832:(Re,ne,_)=>{_.d(ne,{j:()=>N});var B=_(1834),M=_(9581),c=_(1863),f=_(3518),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};function N(a){var r=arguments;return A(this,arguments,void 0,function*(d,h=""){const C=B.Logger.logfunction("SearchLinkMultipleApi",r);let T=performance.now();var b=(0,f.ab)("application/json",h);const m=M.B.SearchLinkMultipleAllApiUrl(),y=JSON.stringify(d);try{const s=yield fetch(m,{method:"POST",headers:b,body:y});if(s.ok){let p=yield s.json();return B.Logger.logUpdate(C),p}return(0,c.ry)(s),console.log("This is the searching multiple error",s.status),B.Logger.logError(T,"unknown","search","unknown",void 0,s.status,s,"SearchLinkMultipleApi",[d,h],"unknown",void 0),[]}catch(s){console.log("This is the searching multiple error",s),B.Logger.logError(T,"unknown","search","unknown",void 0,500,s,"SearchLinkMultipleApi",[d,h],"unknown",void 0),(0,c.Mb)(s,m),(0,c.ey)(C,"SearchLinkMultipleApi",s)}})}},3130:(Re,ne,_)=>{_.d(ne,{BG:()=>N,SL:()=>a,XZ:()=>A,ZJ:()=>c,iw:()=>f,y0:()=>M,yv:()=>B});const B=1,M=2,c=3,f=4,A=5,N=6,a=7},9635:(Re,ne,_)=>{_.d(ne,{x:()=>B});const B=new BroadcastChannel("Freeschema_mftsccs_browser_channel")},9581:(Re,ne,_)=>{_.d(ne,{B:()=>B});class B{static setRandomizer(c){console.log("set randomizer",c),this.BASE_RANDOMIZER=c}static getRandomizer(){return this.BASE_RANDOMIZER}static GetConceptUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/getConcept":this.NODE_CACHE_URL+"/api/getConcept"}static GetConnectionUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get-connection-by-id":this.NODE_CACHE_URL+"/api/get-connection-by-id"}static GetConceptBulkUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get_concept_bulk":this.NODE_CACHE_URL+"/api/get_concept_bulk"}static GetConnectionBulkUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get_connection_bulk":this.NODE_CACHE_URL+"/api/get_connection_bulk"}static GetAllConceptsOfUserUrl(){return this.BASE_URL+"/api/get_all_concepts_of_user"}static GetAllConnectionsOfUserUrl(){return this.BASE_URL+"/api/get_all_connections_of_user"}static GetAllConnectionsOfCompositionUrl(){return this.BASE_URL+"/api/get_all_connections_of_composition"}static GetAllConnectionsOfCompositionBulkUrl(){return this.BASE_URL+"/api/get_all_connections_of_composition_bulk"}static GetConceptByCharacterValueUrl(){return this.BASE_URL+"/api/get_concept_by_character_value"}static GetConceptByCharacterAndTypeUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_type"}static GetConceptByCharacterAndCategoryUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_category"}static GetConceptByCharacterAndCategoryDirectUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_category_direct"}static GetCharacterByCharacterUrl(){return this.BASE_URL+"/api/get_character_by_character"}static GetAllConceptsByTypeUrl(){return this.BASE_URL+"/api/get_all_concepts_by_type"}static GetAllConnectionsOfConceptUrl(){return this.BASE_URL+"/api/get-link-connections"}static GetAllConnectionsToConceptUrl(){return this.BASE_URL+"/api/get-link-reverse-connections"}static GetAllAiData(){return this.BASE_URL+"/api/get-preloaded-concepts"}static getMyCacheServer(){return this.NODE_URL+"/api/v1/cache-server"}static PostPrefetchConceptConnections(){return this.NODE_URL+"/api/v1/access-tracker/sync-access-tracker"}static GetSuggestedConcepts(){return this.NODE_URL+"/api/v1/access-tracker/list-concepts-file"}static GetSuggestedConnections(){return this.NODE_URL+"/api/v1/access-tracker/list-connections-file"}static PostLogger(){return this.LOG_SERVER+"/api/logger"}static GetAllPrefetchConnectionsUrl(){return this.BASE_URL+"/api/get_all_connections_of_user?inpage=500"}static GetAllLinkerConnectionOfConceptUrl(){return this.BASE_URL+"/api/get-all-linkers-from-concept"}static GetAllLinkerConnectionToConceptUrl(){return this.BASE_URL+"/api/get-all-linkers-to-concept"}static DeleteConceptUrl(){return this.BASE_URL+"/api/delete_concept"}static DeleteUserUrl(){return this.BASE_URL+"/api/deleteuser"}static RecursiveSearchUrl(){return this.BASE_URL+"/api/recursivesearch-concept-connection"}static SearchLinkMultipleAllApiUrl(){return this.BASE_URL+"/api/Connection/search-link-multiple-all-ccs"}static MakeTheNameInBackendUrl(){return this.BASE_URL+"/api/make-name-from-frontend"}static SearchAllTypeWithLinker(c=!0){return c?this.BASE_URL+"/api/search-all-with-linker-ccs":this.BASE_URL+"/api-search-compositions-internal-clean-ccs"}static LoginUrl(){return this.BASE_URL+"/api/auth/login"}static SignupUrl(){return this.BASE_URL+"/api/auth/signup"}static GetCompositionConnectionBetweenTwoConceptsUrl(){return this.BASE_URL+"/api/get-composition-connection-between-two-concepts"}static SearchCompositionsUrl(){return this.BASE_URL+"/api/search-compositions"}static SearchLinkMultipleAll(){return this.BASE_URL+"/api/Connection/search-link-multiple-all"}static CreateSessionId(){return this.BASE_URL+"/api/create-session-id-remote"}static CreateSessionVisitUrl(){return this.BASE_URL+"/api/create-remote-session-visit"}static ViewInternalDataUrl(){return this.BASE_URL+"/api/view-api-internal-data-ccs-id-bulk"}static SearchInternalWithAuthenticatedCcsUrl(){return this.BASE_URL+"/api/search-composition-internal-authenticated-ccs"}static SearchInternalWithCcsUrl(){return this.BASE_URL+"/api-search-compositions-internal-clean-ccs"}static CreateGhostConceptApiUrl(){return B.NODE_URL+"/api/v1/local-concepts"}static CreateGhostConnectionApiUrl(){return B.NODE_URL+"/api/v1/local-connections"}static GetRealConceptById(){return B.NODE_URL+"/api/v1/local-concepts-translate"}static GetReservedIdUrl(){return this.BASE_URL+"/api/get_reserved_ids"}static GetReservedConnectionIdUrl(){return this.BASE_URL+"/api/get_reserved_connection_ids"}static CreateTheTextDataUrl(){return this.BASE_URL+"/api/create_text_data"}static CreateTheCharacterDataUrl(){return this.BASE_URL+"/api/create_character_data"}static CreateTheConceptUrl(){return this.BASE_URL+"/api/create_the_concept"}static CreateTheConnectionUrl(){return this.BASE_URL+"/api/create_the_connection"}static CreateTheConnectionNewUrl(){return this.BASE_URL+"/api/create_the_connection_new"}static MakeTheTypeConceptUrl(){return this.BASE_URL+"/api/make_the_type_concept"}static DeleteTheConnectionUrl(){return this.BASE_URL+"/api/delete_connection"}static FreeschemaQueryUrl(){return this.BASE_URL+"/api/freeschema-query"}static uploadImageUrl(){return this.BASE_URL+"/api/Image/UploadImage"}static uploadFileUrl(){return this.BASE_URL+"/api/Image/UploadFile"}static sendMail(){return this.BASE_URL+"/api/sendmail"}static sendBulkMail(){return this.BASE_URL+"/api/sendmail/bulk"}static getWidgetData(){return this.BASE_URL+"/api/get-widget"}static getLatestWidgetData(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get-latest-widget":this.NODE_CACHE_URL+"/api/get-latest-widget"}static getConnectionsByTypes(){return this.BASE_URL+"/api/get-connection-by-types"}static CreatePrototypeUrl(){return this.BASE_URL+"/api/create-prototype"}}B.BASE_URL="https://localhost:7053/",B.NODE_CACHE_URL="",B.AI_URL="https://ai.freeschema.com",B.MQTT_URL="192.168.1.249",B.NODE_URL="http://localhost:5001",B.LOG_SERVER="https://logdev.freeschema.com",B.BASE_APPLICATION="",B.FLAGS={logApplication:!1,logPackage:!1,accessTracker:!1,isTest:!1},B.BASE_RANDOMIZER=999},6963:(Re,ne,_)=>{_.d(ne,{f:()=>f});var B=_(205),M=_(6731),c=function(A,N,a,r){return new(a||(a=Promise))(function(d,h){function C(m){try{b(r.next(m))}catch(y){h(y)}}function T(m){try{b(r.throw(m))}catch(y){h(y)}}function b(m){var y;m.done?d(m.value):(y=m.value,y instanceof a?y:new a(function(s){s(y)})).then(C,T)}b((r=r.apply(A,N||[])).next())})};let f=(()=>{class A{static waitForDataToLoad(){return c(this,void 0,void 0,function*(){return new Promise((a,r)=>{this.checkFlag(a),setTimeout(()=>{r("not")},25e3)})})}static checkFlag(a){if(B.B.isCharacterLoaded)return a("done");setTimeout(A.checkFlag,1e3,a)}static addNodeToTree(a){return c(this,void 0,void 0,function*(){return null==this.characterRoot?(this.characterRoot=a,this.characterRoot):(this.characterRoot=this.characterRoot.addCharacterNode(a,this.characterRoot,this.characterRoot.height),this.characterRoot)})}static removeNodeByCharacter(a,r){return c(this,void 0,void 0,function*(){this.characterRoot&&this.characterRoot.removeNodeWithVariants(this.characterRoot,a,r)})}static countNumberOfNodes(){return this.characterRoot?this.characterRoot.countNodeBelow(this.characterRoot):0}static addConceptToTree(a){if(""!=a.characterValue){var r=new M.b(a.characterValue,a,null,null);this.addNodeToTree(r)}}static getNodeFromTree(a){return this.characterRoot?this.characterRoot.getCharacterFromNode(a,this.characterRoot):this.characterRoot}static getNodeFromTreeUpdated(a){return this.characterRoot?this.characterRoot.getCharacterFromNode(a,this.characterRoot):this.characterRoot}static getCharacterAndTypeFromTree(a,r){return c(this,void 0,void 0,function*(){return this.characterRoot?this.characterRoot.getFromNodeWithCharacterAndType(a,r,this.characterRoot):this.characterRoot})}static getCharacterAndCategoryFromTree(a,r){return c(this,void 0,void 0,function*(){return this.characterRoot?this.characterRoot.getFromNodeWithCharacterAndCategory(a,r,this.characterRoot):this.characterRoot})}static removeConceptCharacter(a){this.characterRoot&&(this.characterRoot=this.characterRoot.removeNode(this.characterRoot,a))}}return A.characterRoot=null,A})()},2202:(Re,ne,_)=>{_.d(ne,{W:()=>N});var B=_(6963),M=_(6731),c=_(205),f=_(1834),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};let N=(()=>{class a{static addNodeToTree(d){if(null==this.root)return this.root=d,this.root;this.root=this.root.addNode(d,this.root,this.root.height)}static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((d,h)=>{this.checkFlag(d),setTimeout(()=>{h("not")},25e3)})})}static checkFlag(d){if(c.B.isDataLoaded)return d("done");setTimeout(a.checkFlag,1e3,d)}static addConceptToTree(d){let h=new M.b(d.id,d,null,null),C=new M.b(d.characterValue,d,null,null);B.f.addNodeToTree(C),this.addNodeToTree(h)}static getNodeFromTree(d){return A(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(d,this.root):null})}static removeNodeFromTree(d){return A(this,void 0,void 0,function*(){if(this.root){let h=new Event(`${d}`);console.log("this is the fired event after delete",h),(0,f.dispatchIdEvent)(d),this.root=this.root.removeNode(this.root,d)}})}static getConceptListFromIds(d,h,C){return A(this,void 0,void 0,function*(){this.root&&this.root.checkIfIdsInNode(this.root,d,h,C)})}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}return a.root=null,a})()},5457:(Re,ne,_)=>{_.d(ne,{c:()=>N});var B=_(1834),M=_(7282),c=_(205);class f{constructor(r,d){this.value=[],this.height=1,this.key=r,this.value.push(d),this.leftNode=null,this.rightNode=null,this.currentNode=null}addType(r,d,h){var C,T,b,m;if(null==r)return(0,B.dispatchIdEvent)(d,{detail:h}),new f(d,h);if(d<r.key)r.leftNode=this.addType(r.leftNode,d,h);else{if(!(d>r.key))return r.value.includes(h)||((0,B.dispatchIdEvent)(d,{detail:h}),r.value.push(h)),r;r.rightNode=this.addType(r.rightNode,d,h)}r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1;const y=this.getBalanceFactor(r);return y>1&&d<(null===(C=r.leftNode)||void 0===C?void 0:C.key)?this.rightRotate(r):y<-1&&d>(null===(T=r.rightNode)||void 0===T?void 0:T.key)?this.leftRotate(r):y>1&&d>(null===(b=r.leftNode)||void 0===b?void 0:b.key)?(r.leftNode=this.leftRotate(r.leftNode),this.rightRotate(r)):y<-1&&d<(null===(m=r.rightNode)||void 0===m?void 0:m.key)?(r.rightNode=this.rightRotate(r.rightNode),this.leftRotate(r)):r}rightRotate(r){if(r){let d=r.leftNode;if(d)return r.leftNode=d.rightNode,d.rightNode=r,r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,d.height=Math.max(this.getHeight(d.leftNode),this.getHeight(d.rightNode))+1,d}return r}leftRotate(r){if(r){let d=r.rightNode;if(d){let h=d.leftNode;return d.leftNode=r,r.rightNode=h,r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,d.height=Math.max(this.getHeight(d.leftNode),this.getHeight(r.rightNode))+1,d}}return r}getHeight(r){return r?r.height:0}getBalanceFactor(r){return null==r?0:this.getHeight(r.leftNode)-this.getHeight(r.rightNode)}getFromNode(r,d){return d&&(r==d.key?d:r<d.key?this.getFromNode(r,d.leftNode):r>d.key?this.getFromNode(r,d.rightNode):d)}removeNodeWithVariants(r,d,h){if(null==r)return r;if(r.key>d)return r.leftNode=this.removeNodeWithVariants(r.leftNode,d,h),r;if(r.key<d)return r.rightNode=this.removeNodeWithVariants(r.rightNode,d,h),r;if(r.value.length>0)for(let C=0;C<r.value.length;C++)if(h==r.value[C])return r.value.splice(C,1),r;if(null==r.leftNode){let C=r.rightNode;return r=null,C}if(null==r.rightNode){let C=r.leftNode;return r=null,C}{let C=this.inOrderSuccessor(r.rightNode);return r.value=C.value,r.key=C.key,r.currentNode=C.currentNode,r.rightNode=this.removeNodeWithVariants(r.rightNode,C.key,h),r}}countNodeBelow(r){return null==r?0:1+this.countNodeBelow(r.leftNode)+this.countNodeBelow(r.rightNode)}inOrderSuccessor(r){for(;null!=r.leftNode;)r=r.leftNode;return r}}var A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};class N{static addType(r){return A(this,void 0,void 0,function*(){return null==this.root?(this.root=r,new CustomEvent(`${r.key}`,{detail:r.value[0]}),(0,B.dispatchIdEvent)(r.key,{detail:r.value[0]}),this.root):(this.root=this.root.addType(this.root,r.key,r.value[0]),this.root)})}static addConceptToTree(r){if(0!=r.typeId){let d=new f(r.typeId,r.id);this.addType(d)}}static removeTypeConcept(r,d){this.root&&(this.root=this.root.removeNodeWithVariants(this.root,r,d))}static getNodeFromTreeNew(r){return this.root?this.root.getFromNode(r,this.root):this.root}static getTypeVariantsFromTreeNew(r){return A(this,void 0,void 0,function*(){let d=this.getNodeFromTreeNew(r),h=[],C=[];if(d){h=d.value;for(let T=0;T<h.length;T++){let b=!1;for(let m=0;m<C.length;m++)C[m].id==h[T]&&(b=!0);b||C.push(yield(0,B.GetTheConcept)(h[T]))}}return C})}static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((r,d)=>{this.checkFlag(r),setTimeout(()=>{d("not")},25e3)})})}static checkFlag(r){if(c.B.isTypeLoaded)return r("done");setTimeout(N.checkFlag,1e3,r)}static getTypeVariantsFromTreeWithUserIdNew(r,d){return A(this,void 0,void 0,function*(){let h=[],C=yield this.getTypeVariantsFromTreeNew(r);console.log("these are all the concepts",C);for(let T=0;T<C.length;T++)C[T].userId==d&&h.push(C[T]);return h})}static getTypeVariantsWithCharacterValueNew(r,d){return A(this,void 0,void 0,function*(){let h=yield this.getTypeVariantsFromTreeNew(d);console.log("this is all the concepts for character",h);let C=(0,M.o)();for(let T=0;T<h.length;T++)h[T].characterValue==r&&(C=h[T]);return C})}static countNumberOfNodes(){return this.typeRoot?this.typeRoot.countNodeBelow(this.typeRoot):0}}N.typeRoot=null,N.root=null},2615:(Re,ne,_)=>{_.d(ne,{j:()=>M});var B=_(1834);class M{constructor(f,A,N,a,r,d,h,C=!1,T,b,m){this.count=0,this.typeCharacter="",this.referent=null,this.isComposition=!1,this.isTemp=!1,this.isSynced=!1,this.applicationId=B.BaseUrl.getRandomizer(),this.x=0,this.y=0,this.id=f,this.userId=A,this.typeId=N,this.ghostId=f,this.categoryId=a,this.referentId=r,this.characterValue=`${d}`,this.accessId=h,this.typeCharacter=m,this.type=null,this.isNew=C,this.entryTimeStamp=T,this.updatedTimeStamp=b}getType(){console.log(this.typeId)}}},9639:(Re,ne,_)=>{_.d(ne,{I:()=>r});var B=_(3655),M=_(2202),c=_(6963),f=_(5457),A=_(7282),N=_(1834),a=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};class r{constructor(){this.name="conceptsArray"}static CheckContains(h){for(var C=!1,T=0;T<this.conceptsArray.length;T++)this.conceptsArray[T].id==h.id&&(C=!0);return C}static AddNpc(h){this.NPC.includes(h)||(this.NPC.length>10&&(this.NPC=[]),this.NPC.push(h))}static GetNpc(h){return!!this.NPC.includes(h)}static AddConceptToStorage(h){h.id>0&&(0,B.kH)("concept",h)}static GetConceptBulkData(h,C,T){return a(this,void 0,void 0,function*(){yield M.W.getConceptListFromIds(h,C,T)})}static AddConcept(h){if(N.serviceWorker)try{(0,N.sendMessage)("ConceptsData__AddConcept",{concept:h})}catch(C){console.error("Concept Data, Add Concpet sw error: ",C),(0,N.handleServiceWorkerException)(C)}h.id>0&&(M.W.addConceptToTree(h),f.c.addConceptToTree(h))}static AddConceptToMemory(h){h.id>0&&(M.W.addConceptToTree(h),f.c.addConceptToTree(h))}static AddConceptTemporary(h){var C=this.CheckContains(h);this.conceptDictionary[h.id]=h,C&&this.RemoveConcept(h),this.conceptsArray.push(h)}static RemoveConcept(h){for(var C=0;C<this.conceptsArray.length;C++)this.conceptsArray[C].id==h.id&&this.conceptsArray.splice(C,1);(0,B.wh)("concept",h.id)}static GetConcept(h){return a(this,void 0,void 0,function*(){if(N.serviceWorker)try{return(yield(0,N.sendMessage)("ConceptsData__GetConcept",{id:h})).data}catch(m){console.error("Concept Data, Get Concpet sw error: ",m),(0,N.handleServiceWorkerException)(m)}if(0==h||null==h||null==h)return(0,A.o)();var C=(0,A.o)(),T=yield M.W.getNodeFromTree(h);if(T?.value){var b=T.value;b&&(C=b)}return C})}static GetConceptByCharacter(h){return a(this,void 0,void 0,function*(){var C=(0,A.o)(),T=c.f.getNodeFromTree(h);return T&&(C=T.value),C})}static GetConceptByCharacterUpdated(h){return a(this,void 0,void 0,function*(){var C=(0,A.o)(),T=c.f.getNodeFromTree(h);return T&&(C=T.value),C})}static GetConceptByCharacterAndTypeLocal(h,C){return a(this,void 0,void 0,function*(){return(0,A.o)(),yield f.c.getTypeVariantsWithCharacterValueNew(h,C)})}static GetConceptByCharacterAndCategoryLocal(h,C){return a(this,void 0,void 0,function*(){var T=(0,A.o)(),b=yield c.f.getCharacterAndCategoryFromTree(h,C);return b&&(T=b.value),T})}static GetConceptsByTypeId(h){let C=[];for(var T=0;T<this.conceptsArray.length;T++)this.conceptsArray[T].typeId==h&&C.push(this.conceptsArray[T]);return C}static GetConceptsByTypeIdAndUser(h,C){var T=arguments;return a(this,void 0,void 0,function*(){if(N.Logger.logfunction("ConceptsData.GetConceptsByTypeIdAndUser",T),N.serviceWorker)try{return(yield(0,N.sendMessage)("ConceptsData__GetConceptsByTypeIdAndUser",{typeId:h,userId:C})).data}catch(m){console.error("Concept Data, Get Concpet sw error:",m),(0,N.handleServiceWorkerException)(m)}let b=[];return b=yield f.c.getTypeVariantsFromTreeWithUserIdNew(h,C),b})}static GetBinaryCharacterTree(){return c.f.characterRoot}getName(){return this.name}}r.conceptsArray=[],r.NPC=[],r.conceptDictionary=[]},2155:(Re,ne,_)=>{_.d(ne,{N:()=>c});var B=_(7282),M=_(9581);class c{constructor(A=0,N,a,r,d,h,C){this.count=0,this.isTemp=!1,this.toUpdate=!1,this.applicationId=M.B.getRandomizer(),this.type=(0,B.o)(),this.ofConcept=(0,B.o)(),this.toConcept=(0,B.o)(),this.id=A,this.ofTheConceptId=N,this.toTheConceptId=a,this.userId=r,this.typeId=d,this.ghostId=A,this.orderId=h,this.accessId=C,this.entryTimeStamp=new Date,this.terminationDateTime=new Date,this.localSyncTime=new Date,this.typeCharacter=""}}},5239:(Re,ne,_)=>{_.d(ne,{O:()=>A});var B=_(205),M=_(1834);class c{constructor(a,r,d,h){this.leftNode=null,this.rightNode=null,this.variants=[],this.height=1,this.key=a,this.value=r,this.leftNode=d,this.rightNode=h,this.currentNode=null}addCurrentNode(a,r){return null==r?r=a:(a.value.typeId!=r.value.typeId&&(r.currentNode=this.addCurrentNode(a,r.currentNode)),r)}addCurrentNodeType(a,r){if(null==r)return a;let d=!1;a.value.id==r.value.id&&(d=!0);for(let h=0;h<r.variants.length;h++)r.variants[h].value.id==a.value.id&&(d=!0);return d||r.variants.push(a),r}getMax(a,r){return a>r?a:r}addNode(a,r,d){if(null==r)return(0,M.dispatchIdEvent)(a.value.ofTheConceptId),a;let C=r.rightNode;if(a.key<r.key)r.leftNode=this.addNode(a,r.leftNode,d);else{if(!(a.key>r.key))return r;r.rightNode=this.addNode(a,C,d)}r.height=1+this.getMax(this.getHeight(r.leftNode),this.getHeight(r.rightNode));let T=this.getBalanceFactor(r);if(T>1&&r.leftNode){if(this.getBalanceFactor(r.leftNode)>=0)return this.rightRotate(r);if(this.getBalanceFactor(r.leftNode)<0)return r.leftNode=this.leftRotate(r.leftNode),this.rightRotate(r)}if(T<-1&&r.rightNode){if(this.getBalanceFactor(r.rightNode)<=0)return this.leftRotate(r);if(this.getBalanceFactor(r.rightNode)>0)return r.rightNode=this.rightRotate(r.rightNode),this.leftRotate(r)}return r}addTypeNode(a,r,d){if(0!=a.value.typeId){if(null==r)return a;let C=r.rightNode;if(r.key>a.key)r.leftNode=this.addTypeNode(a,r.leftNode,d);else{if(!(r.key<a.key))return r.key==a.key&&0!=r.key&&r.addCurrentNodeType(a,r),r;r.rightNode=this.addTypeNode(a,C,d)}r.height=1+this.getMax(this.getHeight(r.leftNode),this.getHeight(r.rightNode));let T=this.getBalanceFactor(r);if(T>1&&r.leftNode){if(a.key<r.leftNode.key)return this.rightRotate(r);if(a.key>r.leftNode.key)return r.leftNode=this.leftRotate(r.leftNode),this.rightRotate(r)}if(T<-1&&r.rightNode){if(a.key>r.rightNode.key)return this.leftRotate(r);if(a.key<r.rightNode.key)return r.rightNode=this.rightRotate(r.rightNode),this.leftRotate(r)}}return r}rightRotate(a){if(a){let r=a.leftNode;if(r)return a.leftNode=r.rightNode,r.rightNode=a,a.height=this.getMax(this.getHeight(a.leftNode),this.getHeight(a.rightNode))+1,r.height=this.getMax(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,r;throw console.log("this is the error in right rotation",a,r),new Error("Cannot perform right rotation: left node is null.")}return a}leftRotate(a){if(a){let r=a.rightNode;if(r){let d=r.leftNode;return r.leftNode=a,a.rightNode=d,a.height=this.getMax(this.getHeight(a.leftNode),this.getHeight(a.rightNode))+1,r.height=this.getMax(this.getHeight(r.leftNode),this.getHeight(a.rightNode))+1,r}throw console.log("this is the error in left rotation",a,r),new Error("Cannot perform left rotation: right node is null.")}return a}getHeight(a){return a?a.height:0}getBalanceFactor(a){return null==a?0:this.getHeight(a.leftNode)-this.getHeight(a.rightNode)}getFromNode(a,r){try{if(r)return a==r.key?(r.value.count?r.value.count++:r.value.count=1,r):a<r.key?this.getFromNode(a,r.leftNode):a>r.key?this.getFromNode(a,r.rightNode):r}catch{console.log("this is the exception",a,r,r?.leftNode,r?.rightNode)}return r}getCharacterFromNode(a,r){return r&&(a==r.key?r:a<r.key?this.getCharacterFromNode(a,r.leftNode):a>r.key?this.getCharacterFromNode(a,r.rightNode):r)}checkIfIdsInNode(a,r,d,h){if(a){if(r.includes(a.key)){d.push(a.value);let C=r.indexOf(a.key);r.splice(C,1)}a.leftNode&&this.checkIfIdsInNode(a.leftNode,r,d,h),a.rightNode&&this.checkIfIdsInNode(a.rightNode,r,d,h)}}traverse(a){let r=0;return a&&(r+=1,a?.leftNode&&(r+=this.traverse(a.leftNode)),a.rightNode&&(r+=this.traverse(a.rightNode))),r}removeNode(a,r){if(null==a)return a;if(a.key>r)return a.leftNode=this.removeNode(a.leftNode,r),a;if(a.key<r)return a.rightNode=this.removeNode(a.rightNode,r),a;if(new Event(`${a.value.ofTheConceptId}`),(0,M.dispatchIdEvent)(a.value.ofTheConceptId),null==a.leftNode){let d=a.rightNode;return a=null,d}if(null==a.rightNode){let d=a.leftNode;return a=null,d}{let d=this.inOrderSuccessor(a.rightNode);return a.value=d.value,a.key=d.key,a.variants=d.variants,a.currentNode=d.currentNode,a.rightNode=this.removeNode(a.rightNode,d.key),a}}removeNodeWithVariants(a,r,d){if(null==a)return a;if(a.key>r)return a.leftNode=this.removeNodeWithVariants(a.leftNode,r,d),a;if(a.key<r)return a.rightNode=this.removeNodeWithVariants(a.rightNode,r,d),a;if(a.variants.length>0)if(a.value.id==d){let h=a.variants[0];if(h)return a.value=h.value,a.key=h.key,a.currentNode=h.currentNode,a.variants.splice(0,1),a}else for(let h=0;h<a.variants.length;h++)if(d==a.variants[h].value.id)return a.variants.splice(h,1),a;if(null==a.leftNode){let h=a.rightNode;return a=null,h}if(null==a.rightNode){let h=a.leftNode;return a=null,h}{let h=this.inOrderSuccessor(a.rightNode);return a.value=h.value,a.key=h.key,a.variants=h.variants,a.currentNode=h.currentNode,a.rightNode=this.removeNodeWithVariants(a.rightNode,h.key,d),a}}inOrderSuccessor(a){for(;null!=a.leftNode;)a=a.leftNode;return a}}var f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};let A=(()=>{class N{static addNodeToTree(r){try{if(null==this.connectionroot)return this.connectionroot=r,this.connectionroot;this.connectionroot=this.connectionroot.addNode(r,this.connectionroot,this.connectionroot.height)}catch(d){throw console.log("This is the error in making the tree",d),d}}static addConnectionToTree(r){let d=new c(r.id,r,null,null);this.addNodeToTree(d)}static traverse(){var r;return null===(r=this.connectionroot)||void 0===r?void 0:r.traverse(this.connectionroot)}static waitForDataToLoad(){return f(this,void 0,void 0,function*(){return new Promise((r,d)=>{this.checkFlag(r),setTimeout(()=>{d("not")},25e3)})})}static checkFlag(r){if(B.B.isConnectionLoaded)return r("done");setTimeout(N.checkFlag,1e3,r)}static removeNodeFromTree(r){return f(this,void 0,void 0,function*(){this.connectionroot&&(this.connectionroot=this.connectionroot.removeNode(this.connectionroot,r))})}static getNodeFromTree(r){return f(this,void 0,void 0,function*(){try{return this.connectionroot?this.connectionroot.getFromNode(r,this.connectionroot):this.connectionroot}catch{console.log("this is the getNodeFromTree",r,this.connectionroot)}})}static getConnectionListFromIds(r,d,h){return f(this,void 0,void 0,function*(){this.connectionroot&&this.connectionroot.checkIfIdsInNode(this.connectionroot,r,d,h)})}}return N.connectionroot=null,N})()},991:(Re,ne,_)=>{_.d(ne,{H:()=>A});var B=_(1834),M=_(3996);class c extends M.i{constructor(a,r,d,h){super(a,r,d,h),this.key="",this.value=[],this.height=1,this.key=a,this.value=r,this.leftNode=d,this.rightNode=h}addNode(a,r,d){if(null==r)return a;let C=r.rightNode;if(r.key>a.key)r.leftNode=this.addNode(a,r.leftNode,d);else{if(!(r.key<a.key))return r;r.rightNode=this.addNode(a,C,d)}r.height=1+Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode));let T=this.getBalanceFactor(r);if(T>1&&r.leftNode){if(this.getBalanceFactor(r.leftNode)>=0)return this.rightRotate(r);if(this.getBalanceFactor(r.leftNode)<0)return r.leftNode=this.leftRotate(r.leftNode),this.rightRotate(r)}if(T<-1&&r.rightNode){if(this.getBalanceFactor(r.rightNode)<=0)return this.leftRotate(r);if(this.getBalanceFactor(r.rightNode)>0)return r.rightNode=this.rightRotate(r.rightNode),this.leftRotate(r)}return r}}var f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};let A=(()=>{class N{static CreateCompositionKey(r,d){return r}static GetConnectionByOfTheConceptAndTypeId(r,d){let h=this.CreateCompositionKey(r,d);if(this.node){let C=this.node.getFromNode(h,this.node);if(C)return C.value}return null}static addConnection(r){if(r.id>0){let d=this.CreateCompositionKey(r.ofTheConceptId,r.typeId);if(this.node){let h=this.node.getFromNode(d,this.node);if(h){let C=h?.value;0==C.length&&(h.value=[]),C.includes(r.id)||C.push(r.id)}else{let C=[];C.push(r.id);let T=new c(d,C,null,null);this.addNodeToTree(T)}}else{let h=[];h.push(r.id);let C=new c(d,h,null,null);this.addNodeToTree(C)}new Event(`${d}`)}else console.log("cannot insert key id with  n 0 to the connection tree",r)}static addNodeToTree(r){return f(this,void 0,void 0,function*(){return null==this.node?(this.node=r,console.log("this is type dispatch in connection",r),(0,B.dispatchIdEvent)(r.key),this.node):(this.node=this.node.addNode(r,this.node,this.node.height),this.node)})}static removeNodeFromTree(r){return f(this,void 0,void 0,function*(){this.node&&(this.node=this.node.removeNode(this.node,r))})}}return N.node=null,N})()},3996:(Re,ne,_)=>{_.d(ne,{i:()=>B});class B{constructor(c,f,A,N){this.key="",this.value=[],this.height=1,this.key=c,this.value=f,this.leftNode=A,this.rightNode=N}getFromNode(c,f){return f&&(c==f.key?f:c<f.key?this.getFromNode(c,f.leftNode):c>f.key?this.getFromNode(c,f.rightNode):f)}rightRotate(c){if(c){let f=c.leftNode;if(f)return c.leftNode=f.rightNode,f.rightNode=c,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode))+1,f}return c}leftRotate(c){if(c){let f=c.rightNode;if(f){let A=f.leftNode;return f.leftNode=c,c.rightNode=A,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(c.rightNode))+1,f}}return c}getHeight(c){return c?c.height:0}getBalanceFactor(c){return null==c?0:this.getHeight(c.leftNode)-this.getHeight(c.rightNode)}removeNode(c,f){if(null==c)return c;if(c.key>f)return c.leftNode=this.removeNode(c.leftNode,f),c;if(c.key<f)return c.rightNode=this.removeNode(c.rightNode,f),c;if(null==c.leftNode){let A=c.rightNode;return c=null,A}if(null==c.rightNode){let A=c.leftNode;return c=null,A}{let A=this.inOrderSuccessor(c.rightNode);return c.value=A.value,c.key=A.key,c.variants=A.variants,c.currentNode=A.currentNode,c.rightNode=this.removeNode(c.rightNode,A.key),c}}inOrderSuccessor(c){for(;null!=c.leftNode;)c=c.leftNode;return c}}},8286:(Re,ne,_)=>{_.d(ne,{d:()=>T});var B=_(1735),M=_(1834),c=_(3655),f=_(1863),A=_(2155),N=_(5239),a=_(991),r=_(3996);class d extends r.i{constructor(m,y,s,p){super(m,y,s,p),this.key="",this.value=[],this.height=1,this.key=m,this.value=y,this.leftNode=s,this.rightNode=p}addNode(m,y,s){if(null==y)return m;let I=y.rightNode;if(y.key>m.key)y.leftNode=this.addNode(m,y.leftNode,s);else{if(!(y.key<m.key))return y;y.rightNode=this.addNode(m,I,s)}y.height=1+Math.max(this.getHeight(y.leftNode),this.getHeight(y.rightNode));let x=this.getBalanceFactor(y);if(x>1&&y.leftNode){if(m.key<y.leftNode.key)return this.rightRotate(y);if(m.key>y.leftNode.key)return y.leftNode=this.leftRotate(y.leftNode),this.rightRotate(y)}if(x<-1&&y.rightNode){if(m.key>y.rightNode.key)return this.leftRotate(y);if(m.key<y.rightNode.key)return y.rightNode=this.rightRotate(y.rightNode),this.leftRotate(y)}return y}}let h=(()=>{class b{static CreateCompositionKey(y){return y}static addNodeToTree(y){return s=this,I=function*(){return null==this.connectionTypeRoot?(this.connectionTypeRoot=y,this.connectionTypeRoot):(this.connectionTypeRoot=this.connectionTypeRoot.addNode(y,this.connectionTypeRoot,this.connectionTypeRoot.height),this.connectionTypeRoot)},new((p=void 0)||(p=Promise))(function(x,w){function F(G){try{D(I.next(G))}catch(Z){w(Z)}}function E(G){try{D(I.throw(G))}catch(Z){w(Z)}}function D(G){var Z;G.done?x(G.value):(Z=G.value,Z instanceof p?Z:new p(function(W){W(Z)})).then(F,E)}D((I=I.apply(s,[])).next())});var s,p,I}static addConnectionToTree(y){if(y.id>0){let s=this.CreateCompositionKey(y.typeId);if(this.connectionTypeRoot){let p=this.connectionTypeRoot.getFromNode(s,this.connectionTypeRoot);if(p){let I=p?.value;0==I.length&&(p.value=[]),I.includes(y.id)||I.push(y.id)}else{let I=[];I.push(y.id);let x=new d(s,I,null,null);this.addNodeToTree(x)}}else{let p=[];p.push(y.id);let I=new d(s,p,null,null);this.addNodeToTree(I)}}else console.log("cannot insert key id with  n 0 to the connection tree",y)}static GetConnectionByOfTheConceptAndTypeId(y,s){let p=this.CreateCompositionKey(s);if(this.connectionTypeRoot){let I=this.connectionTypeRoot.getFromNode(p,this.connectionTypeRoot);if(I)return I.value}return null}}return b.connectionTypeRoot=null,b})();var C=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})};class T{constructor(){this.name="Connection Array"}static CheckContains(m){let y=!1;for(let s=0;s<this.connectionArray.length;s++)this.connectionArray[s].id==m.id&&(y=!0);return y}static AddConnectionToStorage(m){(0,c.kH)("connection",m)}static AddNpConn(m){this.deletedConnections.includes(m)||this.deletedConnections.push(m)}static GetNpConn(m){return!!this.deletedConnections.includes(m)}static AddConnection(m){try{N.O.addConnectionToTree(m),h.addConnectionToTree(m),a.H.addConnection(m)}catch(y){throw console.log("this is the error in making the connection"),y}}static AddConnectionToMemory(m){m.isTemp||(N.O.addConnectionToTree(m),h.addConnectionToTree(m),a.H.addConnection(m))}static AddToDictionary(m){this.connectionDictionary[m.id]=m}static RemoveConnection(m){0!=m.id&&((0,c.wh)("connection",m.id),N.O.removeNodeFromTree(m.id),a.H.removeNodeFromTree(m.id))}static GetConnectionTypeOfTree(){}static GetConnectionByOfTheConceptAndType(m,y){return C(this,void 0,void 0,function*(){try{if(M.serviceWorker)try{return(yield(0,M.sendMessage)("ConnectionData__GetConnectionByOfTheConceptAndType",{ofTheConceptId:m,typeId:y})).data}catch(s){console.error("GetConnectionByOfTheConceptAndType sw error: ",s),(0,M.handleServiceWorkerException)(s)}return a.H.GetConnectionByOfTheConceptAndTypeId(m,y)||[]}catch(s){return console.log("this is the error in GetConnectionByOfTheConceptAndType",s),[]}})}static GetConnectionByOfType(m,y){const s=M.Logger.logfunction("ConnectionData.GetConnectionByOfType",arguments);let p=h.GetConnectionByOfTheConceptAndTypeId(m,y);return p?(M.Logger.logUpdate(s),p):(M.Logger.logUpdate(s),[])}static GetConnectionTree(){return N.O.connectionroot}static GetConnectionTypeTree(){return h.connectionTypeRoot}static GetConnectionBulkData(m,y,s){return C(this,void 0,void 0,function*(){yield N.O.getConnectionListFromIds(m,y,s)})}static GetConnection(m){return C(this,void 0,void 0,function*(){B.J.incrementConnection(m);let y=new A.N(0,0,0,0,0,0,0);try{if(M.serviceWorker)try{return(yield(0,M.sendMessage)("ConnectionData__GetConnection",{id:m})).data}catch(p){console.error("GetConnection sw error: ",p),(0,M.handleServiceWorkerException)(p)}let s=yield N.O.getNodeFromTree(m);if(s?.value){let p=s.value;p&&(y=p)}return y}catch(s){return console.log("this is the error in GetConnection",s),y}})}static GetConnectionsOfCompositionLocal(m){var y=arguments;return C(this,void 0,void 0,function*(){const s=M.Logger.logfunction("ConnectionData.GetConnectionsOfCompositionLocal",y)||{};let p=[];try{if(M.serviceWorker){s.serviceWorker=!0;try{const x=yield(0,M.sendMessage)("ConnectionData__GetConnectionsOfCompositionLocal",{id:m});return M.Logger.logUpdate(s),x.data}catch(x){console.error("GetConnectionsOfCompositionLocal sw error: ",x),(0,f.ey)(s,"GetConnectionsOfCompositionLocal",x),(0,M.handleServiceWorkerException)(x)}}let I=[];I=T.GetConnectionByOfType(m,m);for(let x=0;x<I.length;x++){let w=yield N.O.getNodeFromTree(I[x]);w&&p.push(w.value),M.Logger.logUpdate(s)}}catch(I){console.log("this is the error GetConnectionsOfCompositionLocal",m,p),(0,f.ey)(s,"ConnectionData.GetConnectionsOfCompositionLocal",I)}return p})}static GetConnectionsOfConcept(m){return C(this,void 0,void 0,function*(){let y=[],s=[];try{if(M.serviceWorker)try{return(yield(0,M.sendMessage)("ConnectionData__GetConnectionsOfConcept",{id:m})).data}catch(p){console.error("GetConnectionsOfConcept sw error: ",p),(0,M.handleServiceWorkerException)(p)}y=yield T.GetConnectionByOfTheConceptAndType(m,m);for(let p=0;p<y.length;p++){let I=yield N.O.getNodeFromTree(y[p]);I&&s.push(I.value)}return s}catch(p){return console.log("this is the error in GetConnectionsOfConcept",p),s}})}getName(){return this.name}}T.deletedConnections=[],T.connectionArray=[],T.connectionDictionary=[]},205:(Re,ne,_)=>{_.d(ne,{B:()=>B});class B{}B.isTypeLoaded=!1,B.isCharacterLoaded=!1,B.isDataLoaded=!1,B.isLocalDataLoaded=!1,B.isLocalCharacterLoaded=!1,B.isLocalTypeLoaded=!1,B.isConnectionLoaded=!1,B.isConnectionTypeLoaded=!1,B.isLocalConnectionLoaded=!1},2515:(Re,ne,_)=>{_.d(ne,{x:()=>B});class B{constructor(c,f,A,N){this.variants=[],this.height=1,this.key=c,this.value=f,this.leftNode=A,this.rightNode=N,this.currentNode=null}addCurrentNode(c,f){return null==f?f=c:(c.value.typeId!=f.value.typeId&&(f.currentNode=this.addCurrentNode(c,f.currentNode)),f)}addCurrentNodeType(c,f){if(null==f)return c;var A=!1;for(let N=0;N<f.variants.length;N++)f.variants[N].value.id==c.value.id&&(A=!0);return A||f.variants.push(c),f}addNode(c,f,A){if(null==f)return c;var a=f.rightNode;if(f.key>c.key)f.leftNode=this.addNode(c,f.leftNode,A);else{if(!(f.key<c.key))return f;f.rightNode=this.addNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}return f}addCharacterNode(c,f,A){if(""!=c.value.characterValue){if(null==f)return c;var a=f.rightNode;if(f.key>c.key)f.leftNode=this.addCharacterNode(c,f.leftNode,A);else{if(!(f.key<c.key))return f.key==c.key&&""!=f.key&&f.value.id!=c.value.id&&f.addCurrentNodeType(c,f),f;f.rightNode=this.addCharacterNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}addTypeNode(c,f,A){if(0!=c.value.typeId){if(null==f)return c;var a=f.rightNode;if(f.key>c.key)f.leftNode=this.addTypeNode(c,f.leftNode,A);else{if(!(f.key<c.key))return f.key==c.key&&0!=f.key&&f.value.id!=c.value.id&&f.addCurrentNodeType(c,f),f;f.rightNode=this.addTypeNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}rightRotate(c){if(c){let f=c.leftNode;if(f)return c.leftNode=f.rightNode,f.rightNode=c,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode))+1,f}return c}leftRotate(c){if(c){let f=c.rightNode;if(f){let A=f.leftNode;return f.leftNode=c,c.rightNode=A,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(c.rightNode))+1,f}}return c}getHeight(c){return c?c.height:0}getBalanceFactor(c){return null==c?0:this.getHeight(c.leftNode)-this.getHeight(c.rightNode)}getFromNode(c,f){return f&&(c==f.key?f:c<f.key?this.getFromNode(c,f.leftNode):c>f.key?this.getFromNode(c,f.rightNode):f)}updateNodeSyncStatus(c,f,A){if(A){if(c==A.key){let N=A.value;return N.isSynced=f,A.value=N,A}return c<A.key?this.updateNodeSyncStatus(c,f,A.leftNode):c>A.key?this.updateNodeSyncStatus(c,f,A.rightNode):A}return A}getCharacterFromNode(c,f){return f&&(c==f.key?f:c<f.key?this.getCharacterFromNode(c,f.leftNode):c>f.key?this.getCharacterFromNode(c,f.rightNode):f)}getFromNodeWithCharacterAndType(c,f,A){if(c=`${c}`,A){if(c==A.key){if(c==A.value.characterValue&&f==A.value.typeId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.typeId==f)return A.variants[N]}else{if(c<A.key)return this.getFromNodeWithCharacterAndType(c,f,A.leftNode);if(c>A.key)return this.getFromNodeWithCharacterAndType(c,f,A.rightNode)}return null}return A}getFromNodeWithCharacterAndCategory(c,f,A){if(c=`${c}`,A){if(c==A.key){if(c==A.value.characterValue&&f==A.value.categoryId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.categoryId==f)return A.variants[N]}else{if(c<A.key)return this.getFromNodeWithCharacterAndCategory(c,f,A.leftNode);if(c>A.key)return this.getFromNodeWithCharacterAndCategory(c,f,A.rightNode)}return null}return A}removeNode(c,f){if(null==c)return c;if(c.key>f)return c.leftNode=this.removeNode(c.leftNode,f),c;if(c.key<f)return c.rightNode=this.removeNode(c.rightNode,f),c;if(null==c.leftNode){let N=c.rightNode;return c=null,N}if(null==c.rightNode){let N=c.leftNode;return c=null,N}var A=this.inOrderSuccessor(c.rightNode);return c.value=A.value,c.key=A.key,c.variants=A.variants,c.currentNode=A.currentNode,c.rightNode=this.removeNode(c.rightNode,A.key),c}removeNodeWithVariants(c,f,A){if(null==c)return c;if(c.key>f)return c.leftNode=this.removeNodeWithVariants(c.leftNode,f,A),c;if(c.key<f)return c.rightNode=this.removeNodeWithVariants(c.rightNode,f,A),c;if(c.variants.length>0)if(c.value.id==A){var N=c.variants[0];if(N)return c.value=N.value,c.key=N.key,c.currentNode=N.currentNode,c.variants.splice(0,1),c}else for(let r=0;r<c.variants.length;r++)if(A==c.variants[r].value.id)return c.variants.splice(r,1),c;if(null==c.leftNode){let r=c.rightNode;return c=null,r}if(null==c.rightNode){let r=c.leftNode;return c=null,r}var a=this.inOrderSuccessor(c.rightNode);return c.value=a.value,c.key=a.key,c.variants=a.variants,c.currentNode=a.currentNode,c.rightNode=this.removeNodeWithVariants(c.rightNode,a.key,A),c}countNodeBelow(c){return null==c?0:1+this.countNodeBelow(c.leftNode)+this.countNodeBelow(c.rightNode)}inOrderSuccessor(c){for(;null!=c.leftNode;)c=c.leftNode;return c}}},9736:(Re,ne,_)=>{_.d(ne,{v:()=>p});var B=_(205),M=_(2515),c=function(I,x,w,F){return new(w||(w=Promise))(function(E,D){function G(z){try{W(F.next(z))}catch(P){D(P)}}function Z(z){try{W(F.throw(z))}catch(P){D(P)}}function W(z){var P;z.done?E(z.value):(P=z.value,P instanceof w?P:new w(function($){$(P)})).then(G,Z)}W((F=F.apply(I,x||[])).next())})};let f=(()=>{class I{static addNodeToTree(w){if(null==this.root)return this.root=w,this.root;this.root=this.root.addNode(w,this.root,this.root.height)}static addConceptToTree(w){var F=new M.x(w.id,w,null,null);new M.x(w.characterValue,w,null,null),this.addNodeToTree(F)}static waitForDataToLoad(){return c(this,void 0,void 0,function*(){return new Promise((w,F)=>{this.checkFlag(w),setTimeout(()=>{F("not")},25e3)})})}static checkFlag(w){if(B.B.isLocalDataLoaded)return w("done");setTimeout(I.checkFlag,1e3,w)}static getNodeFromTree(w){return c(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(w,this.root):null})}static getCharacterAndTypeFromTree(w,F){return this.root?this.root.getFromNodeWithCharacterAndType(w,F,this.root):this.root}static updateSyncStatus(w){return this.root?this.root.updateNodeSyncStatus(w,!0,this.root):this.root}static removeNodeFromTree(w){return c(this,void 0,void 0,function*(){this.root&&(this.root=this.root.removeNode(this.root,w))})}}return I.root=null,I})();var A=function(I,x,w,F){return new(w||(w=Promise))(function(E,D){function G(z){try{W(F.next(z))}catch(P){D(P)}}function Z(z){try{W(F.throw(z))}catch(P){D(P)}}function W(z){var P;z.done?E(z.value):(P=z.value,P instanceof w?P:new w(function($){$(P)})).then(G,Z)}W((F=F.apply(I,x||[])).next())})};let N=(()=>{class I{static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((w,F)=>{this.checkFlag(w),setTimeout(()=>{F("not")},25e3)})})}static checkFlag(w){if(B.B.isLocalCharacterLoaded)return w("done");setTimeout(I.checkFlag,1e3,w)}static addNodeToTree(w){return A(this,void 0,void 0,function*(){return null==this.LocalCharacterRoot?(this.LocalCharacterRoot=w,this.LocalCharacterRoot):(this.LocalCharacterRoot=this.LocalCharacterRoot.addCharacterNode(w,this.LocalCharacterRoot,this.LocalCharacterRoot.height),this.LocalCharacterRoot)})}static addConceptToTree(w){if(""!=w.characterValue){var F=new M.x(w.characterValue,w,null,null);this.addNodeToTree(F)}}static getNodeFromTree(w){return this.LocalCharacterRoot?this.LocalCharacterRoot.getCharacterFromNode(w,this.LocalCharacterRoot):this.LocalCharacterRoot}static getCharacterAndTypeFromTree(w,F){return A(this,void 0,void 0,function*(){return this.LocalCharacterRoot?this.LocalCharacterRoot.getFromNodeWithCharacterAndType(w,F,this.LocalCharacterRoot):this.LocalCharacterRoot})}static getCharacterAndCategoryFromTree(w,F){return A(this,void 0,void 0,function*(){return this.LocalCharacterRoot?this.LocalCharacterRoot.getFromNodeWithCharacterAndCategory(w,F,this.LocalCharacterRoot):this.LocalCharacterRoot})}static removeConceptType(w,F){this.LocalCharacterRoot&&(this.LocalCharacterRoot=this.LocalCharacterRoot.removeNodeWithVariants(this.LocalCharacterRoot,w,F))}}return I.LocalCharacterRoot=null,I})();var a=function(I,x,w,F){return new(w||(w=Promise))(function(E,D){function G(z){try{W(F.next(z))}catch(P){D(P)}}function Z(z){try{W(F.throw(z))}catch(P){D(P)}}function W(z){var P;z.done?E(z.value):(P=z.value,P instanceof w?P:new w(function($){$(P)})).then(G,Z)}W((F=F.apply(I,x||[])).next())})};let r=(()=>{class I{static addNodeToTree(w){return a(this,void 0,void 0,function*(){return null==this.LocalTypeRoot?(this.LocalTypeRoot=w,this.LocalTypeRoot):(this.LocalTypeRoot=this.LocalTypeRoot.addTypeNode(w,this.LocalTypeRoot,this.LocalTypeRoot.height),this.LocalTypeRoot)})}static addConceptToTree(w){if(0!=w.typeId){var F=new M.x(w.typeId,w,null,null);this.addNodeToTree(F)}}static removeConceptType(w,F){this.LocalTypeRoot&&(this.LocalTypeRoot=this.LocalTypeRoot.removeNodeWithVariants(this.LocalTypeRoot,w,F))}static getNodeFromTree(w){return this.LocalTypeRoot?this.LocalTypeRoot.getFromNode(w,this.LocalTypeRoot):this.LocalTypeRoot}static getTypeVariantsFromTree(w){var F=this.getNodeFromTree(w),E=[];if(F){E.push(F?.value);for(let D=0;D<F.variants.length;D++)E.push(F.variants[D].value);return E}}static waitForDataToLoad(){return a(this,void 0,void 0,function*(){return new Promise((w,F)=>{this.checkFlag(w),setTimeout(()=>{F("not")},25e3)})})}static checkFlag(w){if(B.B.isLocalTypeLoaded)return w("done");setTimeout(I.checkFlag,1e3,w)}static getTypeVariantsFromTreeWithUserId(w,F){return a(this,void 0,void 0,function*(){var E=[],D=this.getNodeFromTree(w);if(D){console.log("this is the node to type",D),D.value.userId!=F&&999!=D.value.userId||E.push(D?.value);for(let G=0;G<D.variants.length;G++)D.variants[G].value.userId!=F&&999!=D.value.userId||E.push(D.variants[G].value)}return E})}}return I.LocalTypeRoot=null,I})();var d=_(6416),h=_(9639),C=_(7820),T=_(4864),b=_(628),m=_(1834),y=_(3278),s=function(I,x,w,F){return new(w||(w=Promise))(function(E,D){function G(z){try{W(F.next(z))}catch(P){D(P)}}function Z(z){try{W(F.throw(z))}catch(P){D(P)}}function W(z){var P;z.done?E(z.value):(P=z.value,P instanceof w?P:new w(function($){$(P)})).then(G,Z)}W((F=F.apply(I,x||[])).next())})};let p=(()=>{class I{constructor(){this.name="conceptsArray"}static AddConcept(w){0!=w.id&&(f.addConceptToTree(w),N.addConceptToTree(w),r.addConceptToTree(w),this.localconceptsArray.push(w))}static AddPermanentConcept(w){0!=w.id&&(f.removeNodeFromTree(w.ghostId),N.removeConceptType(w.characterValue,w.ghostId),r.removeConceptType(w.typeId,w.ghostId),C.G.addConceptToTree(w),h.I.AddConcept(w),(0,m.AddGhostConcept)(w,w.userId,y.b.sessionId))}static RemoveConcept(w){return s(this,void 0,void 0,function*(){try{0!=w.id&&(f.removeNodeFromTree(w.ghostId),N.removeConceptType(w.characterValue,w.ghostId),r.removeConceptType(w.typeId,w.ghostId))}catch(F){throw F}})}static RemoveConceptById(w){return s(this,void 0,void 0,function*(){try{let F=yield I.GetConcept(w);0!=F.id&&(f.removeNodeFromTree(w),N.removeConceptType(F.characterValue,F.ghostId),r.removeConceptType(F.typeId,F.ghostId),b.H.RemoveConcept(F))}catch(F){throw F}})}static AddConceptToMemory(w){0!=w.id&&(f.addConceptToTree(w),N.addConceptToTree(w),r.addConceptToTree(w))}static GetConcept(w){return s(this,void 0,void 0,function*(){var F=(0,d.u)(),E=yield f.getNodeFromTree(w);if(E?.value){var D=E.value;D&&(F=D)}return F})}static UpdateConceptSyncStatus(w){return s(this,void 0,void 0,function*(){f.updateSyncStatus(w)})}static GetConceptByGhostId(w){return s(this,void 0,void 0,function*(){var F=(0,d.u)(),E=yield C.G.getNodeFromTree(w);if(E?.value){var D=E.value;D&&(F=D)}return F})}static GetConceptByCharacter(w){return s(this,void 0,void 0,function*(){var F=(0,d.u)(),E=N.getNodeFromTree(w);return E&&(F=E.value),F})}static GetConceptByCharacterAndTypeLocal(w,F){return s(this,void 0,void 0,function*(){var E=(0,d.u)(),D=yield N.getCharacterAndTypeFromTree(w,F);return D&&(E=D.value),E})}static GetConceptByCharacterAndCategoryLocal(w,F){return s(this,void 0,void 0,function*(){var E=(0,d.u)(),D=yield N.getCharacterAndCategoryFromTree(w,F);return D&&(E=D.value),E})}static GetConceptsByTypeId(w){let F=[];for(var E=0;E<this.localconceptsArray.length;E++)this.localconceptsArray[E].typeId==w&&F.push(this.localconceptsArray[E]);return F}static GetConceptsByTypeIdAndUser(w,F){return s(this,void 0,void 0,function*(){let E=[];return E=yield r.getTypeVariantsFromTreeWithUserId(w,F),E})}static ClearData(){return s(this,void 0,void 0,function*(){this.localconceptsArray=[],T.G.connectionArray=[]})}getName(){return this.name}}return I.localconceptsArray=[],I})()},4864:(Re,ne,_)=>{_.d(ne,{G:()=>N});var B=_(2155),M=_(8286),c=_(205),f=_(628),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};class N{constructor(){this.name="Connection Array"}static CheckContains(r){for(var d=!1,h=0;h<this.connectionArray.length;h++)this.connectionArray[h].id==r.id&&(d=!0);return d}static AddConnection(r){this.CheckContains(r)&&this.RemoveConnection(r),this.connectionArray.push(r)}static AddConnectionToMemory(r){this.CheckContains(r)&&this.RemoveConnection(r),this.connectionArray.push(r)}static AddToDictionary(r){this.connectionDictionary[r.id]=r}static RemoveConnection(r){for(var d=0;d<this.connectionArray.length;d++)this.connectionArray[d].id==r.id&&this.connectionArray.splice(d,1)}static RemoveConnectionById(r){for(var d=0;d<this.connectionArray.length;d++)this.connectionArray[d].id==r&&this.connectionArray.splice(d,1);f.H.RemoveConnectionById(r)}static AddPermanentConnection(r){r.id>0&&M.d.AddConnection(function(d){let h=new B.N(0,0,0,0,0,0,0);return h.ofTheConceptId=d.ofTheConceptId,h.toTheConceptId=d.toTheConceptId,h.typeId=d.typeId,h.orderId=d.orderId,h.id=d.id,h}(r))}static GetConnection(r){var d;d=null;for(var h=0;h<this.connectionArray.length;h++)this.connectionArray[h].id==r&&(d=this.connectionArray[h]);return d}static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((r,d)=>{this.checkFlag(r),setTimeout(()=>{d("not")},25e3)})})}static checkFlag(r){if(c.B.isLocalConnectionLoaded)return r("done");setTimeout(N.checkFlag,1e3,r)}static GetConnectionsOfCompositionLocal(r){return A(this,void 0,void 0,function*(){var d=[];try{for(var h=0;h<this.connectionArray.length;h++)this.connectionArray[h].typeId==r&&d.push(this.connectionArray[h]);return d}catch{return d}})}static GetConnectionOfCompositionAndTypeLocal(r,d){return A(this,void 0,void 0,function*(){var h=[];try{for(var C=0;C<this.connectionArray.length;C++)this.connectionArray[C].typeId==r&&this.connectionArray[C].ofTheConceptId==d&&h.push(this.connectionArray[C]);return h}catch{return h}})}getName(){return this.name}}N.connectionArray=[],N.connectionDictionary=[]},7820:(Re,ne,_)=>{_.d(ne,{G:()=>f});var B=_(205),M=_(2515),c=function(A,N,a,r){return new(a||(a=Promise))(function(d,h){function C(m){try{b(r.next(m))}catch(y){h(y)}}function T(m){try{b(r.throw(m))}catch(y){h(y)}}function b(m){var y;m.done?d(m.value):(y=m.value,y instanceof a?y:new a(function(s){s(y)})).then(C,T)}b((r=r.apply(A,N||[])).next())})};let f=(()=>{class A{static addNodeToTree(a){if(null==this.root)return this.root=a,this.root;this.root=this.root.addNode(a,this.root,this.root.height)}static addConceptToTree(a){var r=new M.x(a.ghostId,a,null,null);this.addNodeToTree(r)}static waitForDataToLoad(){return c(this,void 0,void 0,function*(){return new Promise((a,r)=>{this.checkFlag(a),setTimeout(()=>{r("not")},25e3)})})}static checkFlag(a){if(B.B.isLocalDataLoaded)return a("done");setTimeout(A.checkFlag,1e3,a)}static getNodeFromTree(a){return c(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(a,this.root):null})}static removeNodeFromTree(a){return c(this,void 0,void 0,function*(){this.root&&(this.root=this.root.removeNode(this.root,a))})}}return A.root=null,A})()},5257:(Re,ne,_)=>{_.d(ne,{R:()=>f});var B=_(9003),M=_(3075),c=function(A,N,a,r){return new(a||(a=Promise))(function(d,h){function C(m){try{b(r.next(m))}catch(y){h(y)}}function T(m){try{b(r.throw(m))}catch(y){h(y)}}function b(m){var y;m.done?d(m.value):(y=m.value,y instanceof a?y:new a(function(s){s(y)})).then(C,T)}b((r=r.apply(A,N||[])).next())})};class f{static AddConceptId(N){this.localId=N.value,(0,B.kH)("localid",N)}static getConceptId(){return c(this,void 0,void 0,function*(){try{if(this.localId){if(this.ReservedLocalId.length<5){yield(0,M.EO)().then(()=>{let a=this.localId;for(let r=1;r<10;r++){let d=this.localId-r;this.ReservedLocalId.push(d),a=d}this.AddConceptId({id:0,value:a})}).catch(a=>(console.log(" getid: cannot get the id from indexdb"),-Math.floor(1e8*Math.random())));let N=this.ReservedLocalId[0];return this.ReservedLocalId.shift(),N}{let N=this.ReservedLocalId[0];return this.ReservedLocalId.shift(),N}}return yield(0,M.EO)().then(()=>{let N=this.localId;for(let a=1;a<10;a++){let r=this.localId-a;this.ReservedLocalId.push(r),N=r}this.AddConceptId({id:0,value:N})}),this.getConceptId()}catch(N){return console.log(" getid: this is the eror in concept",N),-Math.floor(1e8*Math.random())}})}static AddConnectionId(N){this.localConnectionId=N.value}static getConnectionId(){return c(this,void 0,void 0,function*(){try{if(this.localConnectionId){if(this.ReservedConnectionId.length<5){yield(0,M.xd)().then(()=>{let a=this.localConnectionId;for(let r=1;r<10;r++){let d=this.localConnectionId-r;this.ReservedConnectionId.push(d),a=d}}).catch(a=>(console.log("this is the new event",a),-Math.floor(1e8*Math.random())));let N=this.ReservedConnectionId[0];return this.ReservedConnectionId.shift(),N}{let N=this.ReservedConnectionId[0];return this.ReservedConnectionId.shift(),N}}return yield(0,M.xd)().then(()=>{let N=this.localConnectionId;for(let a=1;a<10;a++){let r=this.localConnectionId-a;this.ReservedConnectionId.push(r),N=r}this.AddConnectionId({id:1,value:N})}),this.getConnectionId()}catch{return-Math.floor(1e8*Math.random())}})}}f.ReservedLocalId=[],f.ReservedConnectionId=[]},628:(Re,ne,_)=>{_.d(ne,{H:()=>b});var B=_(9581),M=_(3278),c=_(1834),f=_(1863),A=function(m,y,s,p){return new(s||(s=Promise))(function(I,x){function w(D){try{E(p.next(D))}catch(G){x(G)}}function F(D){try{E(p.throw(D))}catch(G){x(G)}}function E(D){var G;D.done?I(D.value):(G=D.value,G instanceof s?G:new s(function(Z){Z(G)})).then(w,F)}E((p=p.apply(m,y||[])).next())})};const N=(m,y)=>A(void 0,void 0,void 0,function*(){let s={concepts:[],connections:[]};try{const p=new Headers;let I={concepts:m,connections:y};p.set("Content-Type","application/json"),p.set("Authorization","Bearer "+M.b.BearerAccessToken),p.set("Accept","application/json"),p.set("Randomizer",B.B.getRandomizer().toString());const x=yield fetch(B.B.CreateGhostConceptApiUrl(),{method:"POST",headers:p,body:JSON.stringify(I)});if(!x.ok)throw(0,f.ry)(x),new Error(`Error! status: ${x.status}`);const w=yield x.json();return s.concepts=w.concepts,s.connections=w.connections,s}catch(p){throw p instanceof Error?console.log("Create the concept api error message: ",p.message):console.log("Create the concept api unexpected error: ",p),p}});function a(m,y){const s=[];for(let p=0;p<m.length;p+=y){const I=m.slice(p,p+y);s.push(I)}return s}const r=(...m)=>A(void 0,[...m],void 0,function*(y=[]){return yield Promise.all(y.map(s=>{let p=JSON.parse(JSON.stringify(s));return delete p.type,delete p.ofConcept,delete p.toConcept,p}))});var d=_(9003),h=_(9736),C=_(4864),T=function(m,y,s,p){return new(s||(s=Promise))(function(I,x){function w(D){try{E(p.next(D))}catch(G){x(G)}}function F(D){try{E(p.throw(D))}catch(G){x(G)}}function E(D){var G;D.done?I(D.value):(G=D.value,G instanceof s?G:new s(function(Z){Z(G)})).then(w,F)}E((p=p.apply(m,y||[])).next())})};class b{static CheckContains(y){for(var s=!1,p=0;p<this.conceptsSyncArray.length;p++)this.conceptsSyncArray[p].id==y.id&&(s=!0);return s}static SyncDataDelete(y){for(var s=0;s<this.conceptsSyncArray.length;s++)y==this.conceptsSyncArray[s].id&&this.conceptsSyncArray.splice(s,1);for(s=0;s<this.connectionSyncArray.length;s++)this.connectionSyncArray[s].ofTheConceptId!=y&&this.connectionSyncArray[s].toTheConceptId!=y&&this.connectionSyncArray[s].typeId!=y||this.connectionSyncArray.splice(s,1)}static CheckContainsConnection(y){for(var s=!1,p=0;p<this.connectionSyncArray.length;p++)this.connectionSyncArray[p].id==y.id&&(s=!0);return s}static AddConcept(y){try{let s=!1;0!=b.CheckIfTheConceptIdExists(y.id,this.conceptsSyncArray).id&&(s=!0),s||this.conceptsSyncArray.push(y)}catch(s){throw s}}static RemoveConcept(y){for(var s=0;s<this.conceptsSyncArray.length;s++)this.conceptsSyncArray[s].id==y.id&&this.conceptsSyncArray.splice(s,1)}static SyncDataOnline(y,s){return T(this,void 0,void 0,function*(){let p=performance.now();console.log("syncing...",y,s,"aa: ",this.conceptsSyncArray,this.connectionSyncArray,!!c.serviceWorker),setTimeout(()=>{console.log("syncing...",y,s,"aa: ",this.conceptsSyncArray,this.connectionSyncArray,!!c.serviceWorker)},5e3);try{if(c.serviceWorker)try{return(yield(0,c.sendMessage)("LocalSyncData__SyncDataOnline",{transactionId:y})).data}catch(G){console.error("LocalSyncData__SyncDataOnline sw error: ",G),(0,c.handleServiceWorkerException)(G)}let I=[],x=[];if(y&&this.transactionCollections.some(G=>G.id==y)){const G=this.transactionCollections.find(Z=>Z.id==y);if(this.transactionCollections=this.transactionCollections.filter(Z=>Z.id!=y),this.transactionCollections=this.transactionCollections.filter(Z=>new Date(Z.createdDate).getTime()>(new Date).getTime()-6048e5),!G)return;I=G.data.concepts.slice(),x=G.data.connections.slice()}else Array.isArray(s?.concepts)&&Array.isArray(s?.connections)?(console.log("this is the concepts and connections array",s?.concepts,s?.connections),I=s.concepts.slice(),x=s.connections.slice(),console.log("this is the concepts and connections array",I,x),this.conceptsSyncArray=this.conceptsSyncArray.filter(G=>{const Z=s.concepts.some(W=>G.id==W.id||G.ghostId==W.ghostId);return Z||console.warn(`Concept not found in sync array: ${G.id||G.ghostId}`),Z}),this.connectionSyncArray=this.connectionSyncArray.filter(G=>{const Z=s.connections.some(W=>G.id==W.id||G.ghostId==W.ghostId);return Z||console.warn(`Connection not found in sync array: ${G.id||G.ghostId}`),Z})):(console.warn("Syncing this way has been Depreceted in service worker."),console.info("Only if serive worker is not running"),I=this.conceptsSyncArray.slice()||[],x=this.connectionSyncArray.slice()||[],this.connectionSyncArray=[],this.conceptsSyncArray=[]);let w=[];for(let G=0;G<I.length;G++)w.push(I[G]),yield h.v.UpdateConceptSyncStatus(I[G].id);yield this.UpdateConceptListToIncludeRelatedConcepts(x,w);let F=yield function(G,Z){return A(this,void 0,void 0,function*(){const W=c.Logger.logfunction("CreateTheGhostConceptApi",[G.length,Z.length]);try{let P={concepts:[],connections:[]};const $=yield r(G),K=yield r(Z);if(G.length+Z.length<=2e3){const Ie=yield N($,K);return Array.isArray(Ie?.concepts)&&(P.concepts=[...P.concepts,...Ie.concepts]),Array.isArray(Ie?.connections)&&(P.connections=[...P.connections,...Ie.connections]),c.Logger.logUpdate(W),P}const ge=a($,1e3),ae=a(K,1e3),_e=[],ye=[];for(let Ie=0;Ie<ge.length;Ie++)_e.push(N(ge[Ie],[]));const me=yield Promise.all(_e);for(let Ie=0;Ie<me.length;Ie++){const de=me[Ie];Array.isArray(de?.concepts)&&(P.concepts=[...P.concepts,...de.concepts]),Array.isArray(de?.connections)&&(P.connections=[...P.connections,...de.connections])}for(let Ie=0;Ie<ae.length;Ie++)ye.push(N([],ae[Ie]));const Ee=yield Promise.all(ye);for(let Ie=0;Ie<Ee.length;Ie++){const de=Ee[Ie];Array.isArray(de?.concepts)&&(P.concepts=[...P.concepts,...de.concepts]),Array.isArray(de?.connections)&&(P.connections=[...P.connections,...de.connections])}return c.Logger.logUpdate(W),P}catch(z){throw console.log(z),(0,f.ey)(W,"CreateTheGhostConceptApi",z),z}})}(w,x),E=F.concepts,D=F.connections;for(let G=0;G<E.length;G++)h.v.AddPermanentConcept(E[G]);for(let G=0;G<D.length;G++)C.G.AddPermanentConnection(D[G]);return I}catch(I){throw c.Logger.logError(p,"unknown",void 0,"unknown",void 0,500,I,"SyncDataOnline",[],"unknown",void 0),I}})}static ConvertGhostIdsInConnections(y){var s,p,I;for(let x=0;x<y.length;x++){let w=y[x].ofTheConceptId,F=y[x].toTheConceptId,E=y[x].typeId,D=null!==(s=b.ghostIdMap.get(w))&&void 0!==s?s:w,G=null!==(p=b.ghostIdMap.get(F))&&void 0!==p?p:F,Z=null!==(I=b.ghostIdMap.get(E))&&void 0!==I?I:E;y[x].ofTheConceptId=D,y[x].toTheConceptId=G,y[x].typeId=Z}}static UpdateConceptListToIncludeRelatedConcepts(y,s){return T(this,void 0,void 0,function*(){for(let p=0;p<y.length;p++){let I=y[p].ofTheConceptId,x=y[p].toTheConceptId,w=y[p].typeId;if(I<0){let F=this.CheckIfTheConceptIdExists(I,s);0==F.id&&(F=yield h.v.GetConceptByGhostId(I),0!=F.id?F.id!=F.ghostId&&(y[p].ofTheConceptId=F.id):(F=yield h.v.GetConcept(I),this.AddConceptIfDoesNotExist(F,s)))}if(x<0){let F=this.CheckIfTheConceptIdExists(x,s);0==F.id&&(F=yield h.v.GetConceptByGhostId(x),0!=F.id?F.id!=F.ghostId&&(y[p].toTheConceptId=F.id):(F=yield h.v.GetConcept(x),this.AddConceptIfDoesNotExist(F,s)))}if(w<0){let F=this.CheckIfTheConceptIdExists(w,s);0==F.id&&(F=yield h.v.GetConceptByGhostId(w),0!=F.id?F.id!=F.ghostId&&(y[p].typeId=F.id):(F=yield h.v.GetConcept(w),this.AddConceptIfDoesNotExist(F,s)))}}})}static AddConceptIfDoesNotExist(y,s=[]){let p=!1;for(let I=0;I<s.length;I++)y.ghostId==s[I].ghostId&&(p=!0);p||s.push(y)}static CheckIfTheConceptIdExists(y,s=[]){let p=(0,c.CreateDefaultLConcept)();for(let I=0;I<s.length;I++)y!=s[I].ghostId&&y!=s[I].id||(p=s[I]);return p}static AddConnection(y){this.connectionSyncArray.push(y)}static RemoveConnection(y){for(var s=0;s<this.connectionSyncArray.length;s++)this.connectionSyncArray[s].id==y.id&&this.connectionSyncArray.splice(s,1)}static RemoveConnectionById(y){for(var s=0;s<this.connectionSyncArray.length;s++)this.connectionSyncArray[s].id==y&&this.connectionSyncArray.splice(s,1)}static syncDataLocalDb(){return T(this,void 0,void 0,function*(){if(this.conceptsSyncArray.length>0){for(let y=0;y<this.conceptsSyncArray.length;y++)(0,d.kH)("localconcept",this.conceptsSyncArray[y]);this.conceptsSyncArray=[]}if(this.connectionSyncArray.length>0){for(let y=0;y<this.connectionSyncArray.length;y++)(0,d.kH)("localconnection",this.connectionSyncArray[y]);this.connectionSyncArray=[]}return"done"})}static initializeTransaction(y){return T(this,void 0,void 0,function*(){try{if(c.serviceWorker)try{return(yield(0,c.sendMessage)("LocalSyncData__initializeTransaction",{transactionId:y})).data}catch(s){console.error("LocalSyncData__initializeTransaction sw error: ",s),(0,c.handleServiceWorkerException)(s)}if(this.transactionCollections.some(s=>s.id==y))return;this.transactionCollections.push({id:y,data:{concepts:[],connections:[]},createdDate:(new Date).toISOString()})}catch(s){console.log("error in initializeTransaction",s)}})}static markTransactionActions(y,s){return T(this,void 0,void 0,function*(){try{if(c.serviceWorker)try{return(yield(0,c.sendMessage)("LocalSyncData__markTransactionActions",{transactionId:y,actions:s})).data}catch(p){console.error("LocalSyncData__markTransactionActions sw error: ",p),(0,c.handleServiceWorkerException)(p)}this.transactionCollections=this.transactionCollections.map(p=>p.id==y?Object.assign(Object.assign({},p),{data:JSON.parse(JSON.stringify(s))}):p),this.conceptsSyncArray=this.conceptsSyncArray.filter(p=>!s.concepts.some(I=>I.id==p.id||I.ghostId==p.id)),this.connectionSyncArray=this.connectionSyncArray.filter(p=>!s.connections.some(I=>I.id==p.id||I.ghostId==p.id))}catch(p){console.log("error in markTransactionActions",p)}})}static rollbackTransaction(y,s){return T(this,void 0,void 0,function*(){try{if(c.serviceWorker)try{return(yield(0,c.sendMessage)("LocalSyncData__rollbackTransaction",{transactionId:y,actions:s})).data}catch(p){console.error("LocalSyncData__rollbackTransaction sw error: ",p),(0,c.handleServiceWorkerException)(p)}if(this.transactionCollections.some(p=>p.id==y))return;this.transactionCollections=this.transactionCollections.filter(p=>p.id!=y)}catch(p){console.log("LocalSyncData, roll",p)}})}}b.conceptsSyncArray=[],b.connectionSyncArray=[],b.ghostIdMap=new Map,b.transactionCollections=[]},6731:(Re,ne,_)=>{_.d(ne,{b:()=>B});class B{constructor(c,f,A,N){this.variants=[],this.height=1,this.key=c,this.value=f,this.leftNode=A,this.rightNode=N,this.currentNode=null}addCurrentNode(c,f){return null==f?f=c:(c.value.typeId!=f.value.typeId&&(f.currentNode=this.addCurrentNode(c,f.currentNode)),f)}addCurrentNodeType(c,f){if(null==f)return c;let A=!1;for(let N=0;N<f.variants.length;N++)f.variants[N].value.id==c.value.id&&(A=!0);return A||f.variants.push(c),f}addNode(c,f,A){if(null==f)return c;let a=f.rightNode;if(f.key>c.key)f.leftNode=this.addNode(c,f.leftNode,A);else{if(!(f.key<c.key))return f;f.rightNode=this.addNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}return f}checkIfIdsInNode(c,f,A,N){if(c){if(f.includes(c.key)){A.push(c.value);let a=f.indexOf(c.key);f.splice(a,1)}c.leftNode&&this.checkIfIdsInNode(c.leftNode,f,A,N),c.rightNode&&this.checkIfIdsInNode(c.rightNode,f,A,N)}}addCharacterNode(c,f,A){if(""!=c.value.characterValue){if(null==f)return c;let a=f.rightNode;if(f.key>c.key)f.leftNode=this.addCharacterNode(c,f.leftNode,A);else{if(!(f.key<c.key))return f.key==c.key&&""!=f.key&&f.value.id!=c.value.id&&f.addCurrentNodeType(c,f),f;f.rightNode=this.addCharacterNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}addTypeNode(c,f,A){if(0!=c.value.typeId){if(null==f)return console.log("adding the type node to the tree",c),c;let a=f.rightNode;if(f.key>c.key)f.leftNode=this.addTypeNode(c,f.leftNode,A);else{if(!(f.key<c.key))return console.log("adding the type node to the tree down",c),f.key==c.key&&0!=f.key&&f.value.id!=c.value.id&&f.addCurrentNodeType(c,f),console.log("adding the type node to the tree last",f),f;f.rightNode=this.addTypeNode(c,a,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let r=this.getBalanceFactor(f);if(r>1&&f.leftNode){if(c.key<f.leftNode.key)return this.rightRotate(f);if(c.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(r<-1&&f.rightNode){if(c.key>f.rightNode.key)return this.leftRotate(f);if(c.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}rightRotate(c){if(c){let f=c.leftNode;if(f)return c.leftNode=f.rightNode,f.rightNode=c,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode))+1,f}return c}leftRotate(c){if(c){let f=c.rightNode;if(f){let A=f.leftNode;return f.leftNode=c,c.rightNode=A,c.height=Math.max(this.getHeight(c.leftNode),this.getHeight(c.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(c.rightNode))+1,f}}return c}getHeight(c){return c?c.height:0}getBalanceFactor(c){return null==c?0:this.getHeight(c.leftNode)-this.getHeight(c.rightNode)}getFromNode(c,f){return f&&(c==f.key?f:c<f.key?this.getFromNode(c,f.leftNode):c>f.key?this.getFromNode(c,f.rightNode):f)}getCharacterFromNode(c,f){return f&&(c==f.key?f:c<f.key?this.getCharacterFromNode(c,f.leftNode):c>f.key?this.getCharacterFromNode(c,f.rightNode):f)}getCharacterFromNodeUpdated(c,f){var A;return f&&(c==f.key||51==(null===(A=f.value)||void 0===A?void 0:A.typeId)?f:c<f.key?this.getCharacterFromNode(c,f.leftNode):c>f.key?this.getCharacterFromNode(c,f.rightNode):f)}getFromNodeWithCharacterAndType(c,f,A){if(c=`${c}`,A){if(c==A.key){if(c==A.value.characterValue&&f==A.value.typeId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.typeId==f)return A.variants[N]}else{if(c<A.key)return this.getFromNodeWithCharacterAndType(c,f,A.leftNode);if(c>A.key)return this.getFromNodeWithCharacterAndType(c,f,A.rightNode)}return null}return A}getFromNodeWithCharacterAndCategory(c,f,A){if(c=`${c}`,A){if(c==A.key){if(c==A.value.characterValue&&f==A.value.categoryId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.categoryId==f)return A.variants[N]}else{if(c<A.key)return this.getFromNodeWithCharacterAndCategory(c,f,A.leftNode);if(c>A.key)return this.getFromNodeWithCharacterAndCategory(c,f,A.rightNode)}return null}return A}removeNode(c,f){if(null==c)return c;if(c.key>f)return c.leftNode=this.removeNode(c.leftNode,f),c;if(c.key<f)return c.rightNode=this.removeNode(c.rightNode,f),c;if(null==c.leftNode){let A=c.rightNode;return c=null,A}if(null==c.rightNode){let A=c.leftNode;return c=null,A}{let A=this.inOrderSuccessor(c.rightNode);return c.value=A.value,c.key=A.key,c.variants=A.variants,c.currentNode=A.currentNode,c.rightNode=this.removeNode(c.rightNode,A.key),c}}removeNodeWithVariants(c,f,A){if(null==c)return c;if(c.key>f)return c.leftNode=this.removeNodeWithVariants(c.leftNode,f,A),c;if(c.key<f)return c.rightNode=this.removeNodeWithVariants(c.rightNode,f,A),c;if(c.variants.length>0)if(c.value.id==A){let N=c.variants[0];if(N)return c.value=N.value,c.key=N.key,c.currentNode=N.currentNode,c.variants.splice(0,1),c}else for(let N=0;N<c.variants.length;N++)if(A==c.variants[N].value.id)return c.variants.splice(N,1),c;if(null==c.leftNode){let N=c.rightNode;return c=null,N}if(null==c.rightNode){let N=c.leftNode;return c=null,N}{let N=this.inOrderSuccessor(c.rightNode);return c.value=N.value,c.key=N.key,c.variants=N.variants,c.currentNode=N.currentNode,c.rightNode=this.removeNodeWithVariants(c.rightNode,N.key,A),c}}countNodeBelow(c){return null==c?0:1+this.countNodeBelow(c.leftNode)+this.countNodeBelow(c.rightNode)}inOrderSuccessor(c){for(;null!=c.leftNode;)c=c.leftNode;return c}}},5976:(Re,ne,_)=>{_.d(ne,{p:()=>a,B:()=>N});var B=_(9581),M=_(3518),c=_(1863),f=_(1834),A=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};let N=(()=>{class r{static getId(){return A(this,void 0,void 0,function*(){this.ids.length<5&&(yield function(){var C,T,b,m=arguments;return C=this,b=function*(){const y=f.Logger.logfunction("GetReservedIds",m);try{let s=(0,M.Xr)("application/x-www-form-urlencoded");const p=yield fetch(B.B.GetReservedIdUrl(),{method:"GET",headers:s});if(!p.ok)throw(0,c.ry)(p),new Error(`Error! status: ${p.status}`);const I=yield p.json();for(let x=0;x<I.length;x++)r.AddId(I[x]);f.Logger.logUpdate(y)}catch(s){s instanceof Error?console.log("get reserved ids error message: ",s.message):console.log("get reserved ids  unexpected error: ",s),(0,c.Mb)(s,B.B.GetReservedIdUrl()),(0,c.ey)(y,"GetReservedIds",s)}},new((T=void 0)||(T=Promise))(function(y,s){function p(w){try{x(b.next(w))}catch(F){s(F)}}function I(w){try{x(b.throw(w))}catch(F){s(F)}}function x(w){var F;w.done?y(w.value):(F=w.value,F instanceof T?F:new T(function(E){E(F)})).then(p,I)}x((b=b.apply(C,[])).next())})}());var h=this.ids[0];return this.ids.shift(),h})}static AddId(h){this.ids.includes(h)||this.ids.push(h)}}return r.ids=[],r})(),a=(()=>{class r{static getId(){return A(this,void 0,void 0,function*(){this.connectionIds.length<5&&(yield function(){var C,T,b,m=arguments;return C=this,b=function*(){const y=f.Logger.logfunction("GetReservedConnectionIds",m);try{let s=(0,M.Xr)("application/x-www-form-urlencoded");const p=yield fetch(B.B.GetReservedConnectionIdUrl(),{method:"GET",headers:s});if(!p.ok)throw(0,c.ry)(p),new Error(`Error! status: ${p.status}`);const I=yield p.json();for(let x=0;x<I.length;x++)r.AddId(I[x]);f.Logger.logUpdate(y)}catch(s){s instanceof Error?console.log("get reserved connection ids error message: ",s.message):console.log("get reserved connection ids  unexpected error: ",s),(0,c.Mb)(s,B.B.GetReservedConnectionIdUrl()),(0,c.ey)(y,"GetReservedConnectionIds",s)}},new((T=void 0)||(T=Promise))(function(y,s){function p(w){try{x(b.next(w))}catch(F){s(F)}}function I(w){try{x(b.throw(w))}catch(F){s(F)}}function x(w){var F;w.done?y(w.value):(F=w.value,F instanceof T?F:new T(function(E){E(F)})).then(p,I)}x((b=b.apply(C,[])).next())})}());var h=this.connectionIds[0];return this.connectionIds.shift(),h})}static AddId(h){this.connectionIds.includes(h)||this.connectionIds.push(h)}}return r.connectionIds=[],r})()},7273:(Re,ne,_)=>{_.d(ne,{z:()=>M});var B=_(9581);class M{constructor(f,A,N,a){this.url=B.B.BASE_URL,this.message=f,this.ok=A,this.status=N,this.data=a}getMessage(){return this.message}setMessage(f){return this.message=f,this}getStatus(){return this.status}setStatus(f){return this.status=f,this}getData(){return this.data}setData(f){return this.data=f,this}getOk(){return this.ok}setOk(f){return this.ok=f,this}getUrl(){return this.url}setUrl(f){return this.url=f,this}}},3278:(Re,ne,_)=>{_.d(ne,{b:()=>B});class B{}B.BearerAccessToken="",B.sessionId=998},2299:(Re,ne,_)=>{_.d(ne,{B:()=>B});class B{constructor(c){this.id=1,this.isOnlineSync=!1,this.isOnlineSync=c}}},442:(Re,ne,_)=>{_.d(ne,{Y:()=>d});var B=_(1167),M=_(2155),c=_(9581),f=_(3518),A=_(1863),N=_(9639),a=_(8286),r=_(1834);class d{static CheckContains(C){for(var T=!1,b=0;b<this.conceptsSyncArray.length;b++)this.conceptsSyncArray[b].id==C.id&&(T=!0);return T}static SyncDataDelete(C){for(var T=0;T<this.conceptsSyncArray.length;T++)C==this.conceptsSyncArray[T].id&&this.conceptsSyncArray.splice(T,1);for(T=0;T<this.connectionSyncArray.length;T++)this.connectionSyncArray[T].ofTheConceptId!=C&&this.connectionSyncArray[T].toTheConceptId!=C&&this.connectionSyncArray[T].typeId!=C||this.connectionSyncArray.splice(T,1)}static CheckContainsConnection(C){for(var T=!1,b=0;b<this.connectionSyncArray.length;b++)this.connectionSyncArray[b].id==C.id&&(T=!0);return T}static AddConcept(C){this.conceptsSyncArray.push(C)}static RemoveConcept(C){for(var T=0;T<this.conceptsSyncArray.length;T++)this.conceptsSyncArray[T].id==C.id&&this.conceptsSyncArray.splice(T,1)}static AddConnection(C){this.connectionSyncArray.push(C)}static RemoveConnection(C){for(var T=0;T<this.connectionSyncArray.length;T++)this.connectionSyncArray[T].id==C.id&&this.connectionSyncArray.splice(T,1)}static SyncDataOnline(){return C=this,b=function*(){if(r.serviceWorker)try{return(yield(0,r.sendMessage)("SyncData__SyncDataOnline",{})).data}catch(m){console.error("SyncData__SyncDataOnline sw error: ",m),(0,r.handleServiceWorkerException)(m)}for(let m=0;m<this.conceptsSyncArray.length;m++)N.I.AddConcept(this.conceptsSyncArray[m]);for(let m=0;m<this.connectionSyncArray.length;m++)a.d.AddConnection(this.connectionSyncArray[m]);if(this.conceptsSyncArray.length>0){let m=this.conceptsSyncArray.slice();this.conceptsSyncArray=[],(0,B.Y)(m)}if(this.connectionSyncArray.length>0){let m=this.connectionSyncArray.slice();this.connectionSyncArray=[],yield function(y){return s=this,I=function*(){let x=new M.N(0,0,0,0,0,0,0);try{var w=(0,f.Xr)(),F=JSON.stringify(y);const E=yield fetch(c.B.CreateTheConnectionUrl(),{method:"POST",headers:w,body:F});return E.ok?yield E.json():(console.log("Create the connection error message: ",E.status),(0,A.ry)(E)),x}catch(E){throw E instanceof Error?console.log("Create the connection error message: ",E.message):console.log(" Create the connection unexpected error: ",E),E}},new((p=void 0)||(p=Promise))(function(x,w){function F(G){try{D(I.next(G))}catch(Z){w(Z)}}function E(G){try{D(I.throw(G))}catch(Z){w(Z)}}function D(G){var Z;G.done?x(G.value):(Z=G.value,Z instanceof p?Z:new p(function(W){W(Z)})).then(F,E)}D((I=I.apply(s,[])).next())});var s,p,I}(m)}return"done"},new((T=void 0)||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(C,[])).next())});var C,T,b}}d.conceptsSyncArray=[],d.connectionSyncArray=[]},9003:(Re,ne,_)=>{_.d(ne,{S5:()=>a,kH:()=>d,qI:()=>N});var B=_(1863),M=_(1834),c=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};let f=10;class A{}function N(h){const C=M.Logger.logfunction("openDatabase",arguments);return new Promise(function(T,b){A.db&&(M.Logger.logUpdate(C),T(A.db));let m=M.BaseUrl.BASE_URL+"_FreeSchemaLocal"+M.BaseUrl.BASE_APPLICATION;const y=indexedDB.open(m,f);y.onupgradeneeded=s=>{var p=s.target.result,I="localconcept",x="localconnection",w="localid";console.log("this is the version upgrade",f),p.objectStoreNames.contains(I)&&p.deleteObjectStore(I),p.objectStoreNames.contains(x)&&p.deleteObjectStore(x),p.objectStoreNames.contains(w)&&p.deleteObjectStore(w),p.objectStoreNames.contains(I)||(p.createObjectStore(I,{keyPath:"id"}).transaction.oncomplete=F=>{}),p.objectStoreNames.contains(x)||(p.createObjectStore(x,{keyPath:"id"}).transaction.oncomplete=F=>{}),p.objectStoreNames.contains(w)||(p.createObjectStore(w,{keyPath:"id"}).transaction.oncomplete=F=>{r(w,{id:0,value:-100}),r(w,{id:1,value:-200}),r(w,{id:3,value:M.BaseUrl.getRandomizer()})}),T(p)},y.onerror=s=>{console.error("Why didn't you allow my web app to use IndexedDB?!",s),indexedDB.deleteDatabase(m),N(h),(0,B.ey)(C,"openDatabase",s),b(s)},y.onsuccess=function(s){A.db=s.target.result,M.Logger.logUpdate(C),T(A.db)}})}function a(h){var C=arguments;return c(this,void 0,void 0,function*(){const T=M.Logger.logfunction("getObjectsFromLocalIndexDb",C);return new Promise(function(b,m){N(h).then(y=>{var s=[],p=y.transaction(h,"readwrite").objectStore(h).getAll();p.onsuccess=()=>{const I=p.result;for(var x=0;x<I.length;x++)s.push(I[x]);M.Logger.logUpdate(T),b(s)}}).catch(y=>{let s={status:400,ok:!1,message:"Cannot get objects from database because you cannot open the Local database",data:y};(0,B.ey)(T,"getObjectsFromLocalIndexDb",s),m(s)})})})}function r(h,C){const T=M.Logger.logfunction("storeToDatabase",[h,"localindexdb"]);return new Promise(function(b,m){N(h).then(y=>{const s=y.transaction(h,"readwrite").objectStore(h).add(C);s.onsuccess=p=>{M.Logger.logUpdate(T),b(C)},s.onerror=p=>{let I={status:400,ok:!1,message:"Cannot store to the Local database "+h,data:p,body:C};(0,B.ey)(T,"storeToDatabase",I),m(I)}}).catch(y=>{let s={status:400,ok:!1,message:"Cannot store to database because you cannot open the Local database",data:y};(0,B.ey)(T,"storeToDatabase",s),m(s)})})}function d(h,C){const T=M.Logger.logfunction("UpdateToDatabase",arguments);return new Promise(function(b,m){N(h).then(y=>{const s=y.transaction(h,"readwrite").objectStore(h).put(C);s.onsuccess=p=>{M.Logger.logUpdate(T),b(C)},s.onerror=p=>{let I={status:400,ok:!1,message:"Cannot Update to the Local database"+h,data:p,body:C};(0,B.ey)(T,"UpdateToDatabase",I),m(I)}}).catch(y=>{let s={status:400,ok:!1,message:"Cannot update to database because you cannot open the Local database",data:y};(0,B.ey)(T,"UpdateToDatabase",s),m(s)})})}},3655:(Re,ne,_)=>{_.d(ne,{El:()=>h,b8:()=>d,kH:()=>r,qI:()=>a,wh:()=>C});var B=_(2299),M=_(9581),c=_(1834),f=_(1863);let A=10;class N{}function a(T){const b=c.Logger.logfunction("openDatabase",[T,"indexdb"]);return new Promise(function(m,y){N.db&&(c.Logger.logUpdate(b),m(N.db));let s=M.B.BASE_URL+"_FreeSchema"+M.B.BASE_APPLICATION;const p=indexedDB.open(s,A);console.log("this is the update version",A,p),p.onupgradeneeded=I=>{let x=I.target.result,w="concept",F="connection",E="settings";console.log("this is the version update for index",A),x.objectStoreNames.contains(w)&&x.deleteObjectStore(w),x.objectStoreNames.contains(F)&&x.deleteObjectStore(F),x.objectStoreNames.contains(E)&&x.deleteObjectStore(E),x.objectStoreNames.contains(w)||(x.createObjectStore(w,{keyPath:"id"}).transaction.oncomplete=D=>{}),x.objectStoreNames.contains(F)||(x.createObjectStore(F,{keyPath:"id"}).transaction.oncomplete=D=>{}),x.objectStoreNames.contains(E)||(x.createObjectStore(E,{keyPath:"id"}).transaction.oncomplete=D=>{}),c.Logger.logUpdate(b),m(x)},p.onerror=I=>{console.error("Why didn't you allow my web app to use IndexedDB?!",I),indexedDB.deleteDatabase(s),a(T),(0,f.ey)(b,"openDatabase",I),y(I)},p.onsuccess=function(I){N.db=I.target.result,c.Logger.logUpdate(b),m(N.db)}})}function r(T,b){const m=c.Logger.logfunction("UpdateToDatabase",[T,"indexdb"]);return new Promise(function(y,s){a(T).then(p=>{const I=p.transaction(T,"readwrite").objectStore(T).put(b);I.onsuccess=x=>{c.Logger.logUpdate(m),y(b)},I.onerror=x=>{let w={status:400,ok:!1,message:"Cannot Update to the database"+T,data:x,body:b};(0,f.ey)(m,"UpdateToDatabase",w),s(w)}}).catch(p=>{let I={status:400,ok:!1,message:"Cannot update to database because you cannot open the database",data:p};(0,f.ey)(m,"UpdateToDatabase",I),s(I)})})}function d(){const T=c.Logger.logfunction("GetLastSettingsFromDatabase",["indexdb"]);return new Promise(function(b,m){let y="settings";a(y).then(s=>{let p=s.transaction(y,"readwrite").objectStore(y).getAll();p.onsuccess=()=>{let I=new B.B(!1),x=p.result;for(let w=0;w<x.length;w++)I=x[w];c.Logger.logUpdate(T),b(I)},p.onerror=I=>{(0,f.ey)(T,"GetLastSettingsFromDatabase",I),m(I)}}).catch(s=>{let p={status:400,ok:!1,message:"Cannot get last object from database because you cannot open the database",data:s};(0,f.ey)(T,"GetLastSettingsFromDatabase",p),m(p)})})}function h(T){const b=c.Logger.logfunction("AiUpdateFlag",["indexdb"]);return new Promise(function(m,y){let s="settings";a(s).then(p=>{const I=p.transaction(s,"readwrite").objectStore(s).put(T);I.onsuccess=x=>{c.Logger.logUpdate(b),m(T)},I.onerror=x=>{let w={status:400,ok:!1,message:"Cannot update AI flag",data:x,body:T};(0,f.ey)(b,"AiUpdateFlag",w),y(w)}}).catch(p=>{let I={status:400,ok:!1,message:"Cannot update AI flag because you cannot open the database",data:p};(0,f.ey)(b,"AiUpdateFlag",I),y(I)})})}function C(T,b){const m=c.Logger.logfunction("removeFromDatabase",[T,"indexdb"]);return new Promise(function(y,s){a(T).then(p=>{const I=p.transaction(T,"readwrite").objectStore(T).delete(Number(b));I.onsuccess=function(x){c.Logger.logUpdate(m),y(b)},I.onerror=x=>{let w={status:400,ok:!1,message:"Cannot remove from the database"+T,data:x};(0,f.ey)(m,"removeFromDatabase",w),s(w)}}).catch(p=>{let I={status:400,ok:!1,message:"Cannot remove from the database because you cannot open the database",data:p,body:b};(0,f.ey)(m,"removeFromDatabase",I),s(I)})})}},4485:(Re,ne,_)=>{function B(A=[],N){var a,r;let d=[],h=null===(a=N.type)||void 0===a?void 0:a.characterValue;if(h?.startsWith("the_")||(h="the_"+h),Array.isArray(A))for(let C=0;C<A.length;C++){let T=null===(r=A[C].type)||void 0===r?void 0:r.characterValue;T?.startsWith("the_")||(T="the_"+T),N.typeId!=A[C].typeId&&h!=T||d.push(A[C])}return d}function M(A=[],N){let a=[],r=N.typeCharacter;if(r?.startsWith("the_")||(r="the_"+r),Array.isArray(A))for(let d=0;d<A.length;d++){let h=A[d].typeCharacter;h?.startsWith("the_")||(h="the_"+h),N.typeId!=A[d].typeId&&r!=h||a.push(A[d])}return a}function c(A=[],N){let a=[];if(Array.isArray(A)){const r=A.find(h=>h.toTheConceptId==N);r&&a.push(r);const d=A.find(h=>h.ofTheConceptId==N);d&&a.push(d)}return a}function f(A=[],N){let a=[];if(Array.isArray(A)){const r=A.find(h=>h.toTheConceptId==N);r&&a.push(r);const d=A.find(h=>h.ofTheConceptId==N);d&&a.push(d)}return a}_.d(ne,{gt:()=>f,nm:()=>M,vo:()=>B,wS:()=>c}),_(2155),_(7282)},9934:(Re,ne,_)=>{function B(M,c){return-1===M.indexOf(c)&&M.push(c),M}_.d(ne,{A:()=>B})},9700:(Re,ne,_)=>{_.d(ne,{R:()=>r,V:()=>a});var B,M=_(1834),c=_(3278),f=_(1863),A=_(3518),N=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};class a{static startAutoSync(){this.autoSyncInterval?console.warn("Auto-sync is already running."):(this.nextSyncTime=Date.now()+this.SYNC_INTERVAL_MS,setInterval(()=>{const h=Date.now();this.nextSyncTime&&h>=this.nextSyncTime&&(this.nextSyncTime=h+this.SYNC_INTERVAL_MS,this.sendPackageLogsToServer(),this.sendApplicationLogsToServer())},3e4))}static stopAutoSync(){null!==this.autoSyncInterval&&(clearInterval(this.autoSyncInterval),this.autoSyncInterval=null,this.nextSyncTime=null)}static setLogLevel(h){this.logLevel=h}static shouldLog(h){return this.LOG_LEVELS.indexOf(h)>=this.LOG_LEVELS.indexOf(this.logLevel)}static formatLogData(h,C,T){const b=Object.assign({timestamp:(new Date).toISOString(),level:h,message:C},T);return this.packageLogsData.push(b),"ERROR"==h&&(this.sendPackageLogsToServer(),this.sendApplicationLogsToServer()),b}static log(h,C,T){if(this.logPackageActivationStatus)try{this.formatLogData(h,C,T||null)}catch(b){console.error("Error on Logger Log : ",b)}}static logUpdate(h){var C;try{if(!this.logPackageActivationStatus)return{};if(!h)return{};const T=Date.now();h.startTime=null!==(C=h.startTime)&&void 0!==C?C:T,h.responseTime=T-h.startTime+" ms",1==!h.serviceWorker&&(h.serviceWorker=!1)}catch(T){(0,f.ey)(h,"Logger.logUpdate",T)}}static logfunction(h,...C){if(!this.logPackageActivationStatus)return{};const T=Date.now();let b=C;const m=M.BaseUrl.getRandomizer();return this.formatLogData("INFO","function called",{startTime:T,functionName:h,functionParameters:b,requestFrom:M.BaseUrl.BASE_APPLICATION,sessionId:c.b.sessionId,applicationId:m})}static logError(h,C,T,b,m,y,s,p,I,x,w){try{const F=r("SessionId"),E={startTime:h,userId:C,operationType:T,requestFrom:b,requestIP:m,responseStatus:y,responseTime:`${(performance.now()-h).toFixed(3)}ms`,responseSize:s?`${JSON.stringify(s).length}`:"0",sessionId:F?.toString(),functionName:p,functionParameters:I,userAgent:x,conceptsUsed:w};this.formatLogData("ERROR",`Information logged for ${p}`,E)}catch{console.error("Error on logError")}}static logApplication(h,C,T){if(this.logApplicationActivationStatus)try{const b={timestamp:(new Date).toISOString(),level:h,message:C,data:T||null};this.applicationLogsData.push(b)}catch(b){console.error("Failed to log application activity:",b)}}static sendApplicationLogsToServer(){return N(this,void 0,void 0,function*(){const h=this.applicationLogsData;try{if(0===h.length)return;this.applicationLogsData=[];const C=50;let T=(0,A.Xr)(),b=0;for(;0!=h.length;){const m=h.slice(0,C),y=yield fetch(M.BaseUrl.PostLogger(),{method:"POST",headers:T,body:JSON.stringify({logType:this.appLogs,logData:m})});y.ok||(yield y.text()),h.splice(0,C),b+=C,b++}}catch{}})}static sendPackageLogsToServer(){return N(this,void 0,void 0,function*(){const h=this.packageLogsData;try{if(0===h.length)return;this.packageLogsData=[];const C=300;let T=0;for(;0!=h.length;){const b=h.slice(0,C);let m=(0,A.Xr)();const y=yield fetch(M.BaseUrl.PostLogger(),{method:"POST",headers:m,body:JSON.stringify({logType:this.mftsccsBrowser,logData:b})});if(!y.ok)return void(yield y.text());h.splice(0,C),T++}}catch{}})}static saveLogToLocalStorage(h,C){try{if(void 0===typeof localStorage)return void console.warn("Local Storage type undefined");{const T=JSON.parse((null==localStorage?void 0:localStorage.getItem(h))||"[]");T.push(C),localStorage?.setItem(h,JSON.stringify(T))}}catch{console.error("Error on saving log in localstorage"),this.log("ERROR","Error while saving log in local storage")}}static clearLogsFromLocalStorage(h){void 0!==typeof localStorage?localStorage?.removeItem(h):console.warn("localStorage is not available")}}function r(d){try{let h=d+"=",C=decodeURIComponent(document.cookie).split(";");for(let T=0;T<C.length;T++){let b=C[T];for(;" "==b.charAt(0);)b=b.substring(1);if(0==b.indexOf(h))return b.substring(h.length,b.length)}return""}catch{return console.error("Error on getcookie"),""}}B=a,a.logLevel="INFO",a.packageLogsData=[],a.applicationLogsData=[],a.LOG_LEVELS=["DEBUG","INFO","WARNING","ERROR"],a.SYNC_INTERVAL_MS=6e4,a.nextSyncTime=null,a.appLogs="app",a.mftsccsBrowser="mftsccs",a.logApplicationActivationStatus=!1,a.logPackageActivationStatus=!1,a.autoSyncInterval=null,B.startAutoSync()},1412:(Re,ne,_)=>{function B(M=[],c=[]){}_.d(ne,{e:()=>B})},5898:(Re,ne,_)=>{_.d(ne,{w:()=>A,V:()=>N});var B=_(7139),M=_(1834);class c{constructor(){this.conceptId=0,this.connectionTypeId=0,this.connectionType="",this.count=0}}var f=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function A(r=[]){let d=[];if(r.length>0)for(let h=0;h<r.length;h++){let C=a(r[h]);d.push(C)}return d}function N(r){var d=arguments;return f(this,void 0,void 0,function*(){const h=M.Logger.logfunction("GetConnectionTypeForCount",d);let C={};for(let T=0;T<r.length;T++){let b=yield(0,B.r)(r[T].connectionTypeId);r[T].connectionType=b.characterValue,C[r[T].conceptId]=r[T]}return M.Logger.logUpdate(h),C})}function a(r){const d=r.split("_");if(3===d.length){let h=new c;return h.conceptId=Number(d[0]),h.connectionTypeId=Number(d[1]),h.count=Number(d[2]),h}throw new Error("Input string must contain exactly three parts separated by underscores.")}},1863:(Re,ne,_)=>{_.d(ne,{ER:()=>f,Mb:()=>A,ey:()=>N,ry:()=>c});var B=_(1834),M=_(7273);function c(a){if(B.Logger.log("ERROR",a.statusText,{code:a.status,data:a.statusText}),401==a.status||406==a.status){let r=new M.z(a.statusText,!1,a.status,"");throw r.setUrl(a.url),r}if(500==a.status){let r=new M.z(a.statusText,!1,a.status,"");throw r.setUrl(a.url),r}}function f(a,r={}){if(B.Logger.log("ERROR",r.statusText,{code:a.status,data:a.status}),401==a.status||406==a.status){let d=new M.z(r.statusText,!1,a.status,"");throw d.setUrl(a.url),d}if(500==a.status){let d=new M.z(r.statusText,!1,a.status,"");throw d.setUrl(a.url),d}}function A(a,r=""){if(B.Logger.log("ERROR",a.message,{code:a.status,data:a.stack}),a.status){let d=new M.z(a.message,!1,a.status,a.stack);throw d.setUrl(r),d}{let d=new M.z(a.message,!1,500,a.stack);throw d.setUrl(r),d}}function N(a,r,d){var h;try{if(!a)return void console.error(`Error in ${r}: logData is undefined`);const C=Date.now();a.startTime=null!==(h=a.startTime)&&void 0!==h?h:C,a.responseTime=C-a.startTime+" ms",a.level="ERROR",a.errorMessage=d?.message||"Unknown error occurred",console.error(`Error in function ${r}:`,d)}catch(C){console.error("Failed to handle package function error:",C)}}},176:(Re,ne,_)=>{_.d(ne,{F4:()=>f,P6:()=>N,dp:()=>A});var B=_(2155),M=_(7282),c=_(6416);function f(a){var r,d;const h=(0,c.u)();return h.id=a.id,h.ghostId=a.ghostId,h.userId=a.userId,h.accessId=a.accessId,h.categoryId=a.categoryId,h.characterValue=a.characterValue,h.entryTimeStamp=a.entryTimeStamp,h.typeId=a.typeId,h.type=a.type,h.isTemp=!1,h.typeCharacter=null!==(d=null===(r=a?.type)||void 0===r?void 0:r.characterValue)&&void 0!==d?d:"",h}function A(a){const r=(0,M.o)();return r.id=a.id,r.ghostId=a.ghostId,r.userId=a.userId,r.accessId=a.accessId,r.entryTimeStamp=a.entryTimeStamp,r.typeId=a.typeId,r.categoryId=a.categoryId,r}function N(a){const r=new B.N(0,0,0,0,0,0,0);return r.id=a.id,r.ghostId=a.ghostId,r.accessId=a.accessId,r.ofTheConceptId=a.ofTheConceptId,r.toTheConceptId=a.toTheConceptId,r.entryTimeStamp=a.entryTimeStamp,r.typeId=a.typeId,r.isTemp=!1,r}},5020:(Re,ne,_)=>{_.d(ne,{A:()=>A});var B=_(1834),M=_(9639),c=_(205),f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function A(){return f(this,void 0,void 0,function*(){try{let N=[];if(Array.isArray(N))for(let a=0;a<N.length;a++)M.I.AddConceptToMemory(N[a]);c.B.isDataLoaded=!0,c.B.isCharacterLoaded=!0,c.B.isTypeLoaded=!0}catch(N){throw yield(0,B.DelayFunctionExecution)(2e3,A()),{message:"Cannot create Binary Tree Concept",ok:!1,status:400,data:N}}})}},7282:(Re,ne,_)=>{_.d(ne,{o:()=>M});var B=_(2615);function M(){return new B.j(0,0,0,0,0,"0",0,!1,new Date,new Date,"0")}},1218:(Re,ne,_)=>{_.d(ne,{A:()=>N});var B=_(1834),M=_(7282),c=_(1666),f=_(8407),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};function N(a){return A(this,arguments,void 0,function*(r,d=null,h=null,C=null,T=null,b=null,m=null){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("CreateTheComposition",{json:r,ofTheConceptId:d,ofTheConceptUserId:h,mainKey:C,userId:T,accessId:b,sessionInformationId:m})).data}catch(w){console.error("CreateTheComposition sw error: ",w),(0,B.handleServiceWorkerException)(w)}let y=T??999,s=b??4,p=m??999,I=C??0,x=(0,M.o)();for(const w in r)if("string"!=typeof r[w]&&"number"!=typeof r[w])if(null==d&&null==h){let F=I,E=yield(0,f.A)(w,"",!0,y,s,p);x=E,F=E.id,I=E.id,yield N(r[w],E.id,E.userId,F,T,b,m)}else{let F=d??999,E=h??999,D=I,G=yield(0,f.A)(w,"",!0,y,s,p);x=G,yield(0,c.q)(F,E,G.id,D),yield N(r[w],G.id,G.userId,D,T,b,m)}else{let F=d??999,E=h??10267,D=I,G=yield(0,f.A)(w,r[w].toString(),!1,y,s,p);yield(0,c.q)(F,E,G.id,D)}return x})}},2212:(Re,ne,_)=>{_.d(ne,{Ay:()=>a,N:()=>r});var B=_(1167),M=_(2615),c=_(5976),f=_(442),A=_(1834),N=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};function a(d,h,C,T,b,m,y){return N(this,void 0,void 0,function*(){let s=yield c.B.getId(),x=new M.j(s,h,T,C,b,d,m,!0,new Date,new Date,y);return x.isTemp=!1,f.Y.AddConcept(x),x})}function r(d,h,C,T,b,m,y){return N(this,void 0,void 0,function*(){let s=yield c.B.getId(),x=new M.j(s,h,T,C,b,d,m,!1,new Date,new Date,y);return A.ConceptsData.AddConcept(x),(0,B.Y)([x]),x})}},1666:(Re,ne,_)=>{_.d(ne,{q:()=>f});var B=_(2155),M=_(442),c=_(1863);function f(A,N,a,r){var h=new B.N(0,A,a,N,r,1,4);if(A==a)return h.ofTheConceptId=0,h.toTheConceptId=1,h;try{h.isTemp=!0,h.id=Math.floor(1e8*Math.random()),M.Y.AddConnection(h)}catch(C){(0,c.Mb)(C)}return h}},1838:(Re,ne,_)=>{_.d(ne,{m:()=>d});var B=_(1834),M=_(9581),c=_(1863),f=_(3518),A=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})},N=_(5239),a=_(4864),r=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};function d(h){var C=arguments;return r(this,void 0,void 0,function*(){const T=B.Logger.logfunction("DeleteConnectionById",C);if(B.serviceWorker)try{return(yield(0,B.sendMessage)("DeleteConnectionById",{id:h})).data}catch(b){console.error("DeleteConnectionById sw error: ",b),(0,B.handleServiceWorkerException)(b)}h>0?(yield function(b){var m=arguments;return A(this,void 0,void 0,function*(){const y=B.Logger.logfunction("DeleteTheConnection",m);let s=!1;try{const p=new FormData;p.append("id",b.toString());let I=(0,f.BZ)();const x=yield fetch(M.B.DeleteTheConnectionUrl(),{method:"POST",headers:I,body:p,redirect:"follow"});B.Logger.logUpdate(y),x.ok?s=(yield x.json()).success:(console.log("Delete connection error status: ",x.status),(0,c.ry)(x)),s&&B.ConnectionData.AddNpConn(b)}catch(p){p instanceof Error?console.log("Delete connection error message: ",p.message):console.log("Delete connection unexpected error: ",p),(0,c.Mb)(p,M.B.DeleteTheConnectionUrl()),(0,c.ey)(y,"DeleteTheConnection",p)}return s})}(h),N.O.removeNodeFromTree(h)):a.G.RemoveConnectionById(h),B.Logger.logUpdate(T)})}},4364:(Re,ne,_)=>{_.d(ne,{s:()=>f});var B=_(1239),M=_(1834),c=function(A,N,a,r){return new(a||(a=Promise))(function(d,h){function C(m){try{b(r.next(m))}catch(y){h(y)}}function T(m){try{b(r.throw(m))}catch(y){h(y)}}function b(m){var y;m.done?d(m.value):(y=m.value,y instanceof a?y:new a(function(s){s(y)})).then(C,T)}b((r=r.apply(A,N||[])).next())})};function f(){return c(this,arguments,void 0,function*(A=[]){const N=M.Logger.logfunction("FindConceptsFromConnections",[A.length]);let a=[];if(A.length>0){for(let r=0;r<A.length;r++)a.includes(A[r].ofTheConceptId)||a.push(A[r].ofTheConceptId),a.includes(A[r].toTheConceptId)||a.push(A[r].toTheConceptId),a.includes(A[r].typeId)||a.push(A[r].typeId);yield(0,B.r)(a)}M.Logger.logUpdate(N)})}},5284:(Re,ne,_)=>{_.d(ne,{B:()=>A});var B=_(1834),M=_(8286),c=_(1863),f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function A(){return f(this,arguments,void 0,function*(N=[]){const a=B.Logger.logfunction("FindConnectionsOfCompositionsBulkInMemory",[N.length])||{};let r=[];try{if(B.serviceWorker){a.serviceWorker=!0;try{const d=yield(0,B.sendMessage)("FindConnectionsOfCompositionsBulkInMemory",{composition_ids:N});return B.Logger.logUpdate(a),d.data}catch(d){console.error("FindConnectionsOfCompositionsBulkInMemory sw error: ",d),(0,c.ey)(a,"FindConnectionsOfCompositionsBulkInMemory",d),(0,B.handleServiceWorkerException)(d)}}for(let d=0;d<N.length;d++){let h=yield M.d.GetConnectionsOfConcept(N[d]);r.push(...h)}return B.Logger.logUpdate(a),r}catch(d){return console.error("FindConnectionsOfCompositionsBulkInMemory error: ",d),(0,c.ey)(a,"FindConnectionsOfCompositionsBulkInMemory",d),r}})}},8939:(Re,ne,_)=>{_.d(ne,{$N:()=>x,$V:()=>h,Ez:()=>w,JA:()=>p,Mb:()=>b,Nj:()=>T,PT:()=>I,RW:()=>s,XI:()=>y,ay:()=>d,hL:()=>r,kx:()=>m,re:()=>C,yz:()=>F,zN:()=>G});var B=_(7139),M=_(2),c=_(9639),f=_(8286),A=_(1834),N=_(1863),a=function(W,z,P,$){return new(P||(P=Promise))(function(K,ge){function ae(me){try{ye($.next(me))}catch(Ee){ge(Ee)}}function _e(me){try{ye($.throw(me))}catch(Ee){ge(Ee)}}function ye(me){var Ee;me.done?K(me.value):(Ee=me.value,Ee instanceof P?Ee:new P(function(Ie){Ie(Ee)})).then(ae,_e)}ye(($=$.apply(W,z||[])).next())})};function r(W){return a(this,void 0,void 0,function*(){let z={connectionList:[],compositionList:[]};try{if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionById",{id:W})).data}catch($){console.error("GetCompositionById error sw: ",$),(0,A.handleServiceWorkerException)($)}let P=yield(0,M.s)(W);z.connectionList=P;for(let $=0;$<z.connectionList.length;$++)z.compositionList.includes(z.connectionList[$].ofTheConceptId)||z.compositionList.push(z.connectionList[$].ofTheConceptId);return z}catch(P){return console.error("GetCompositionById error: ",P),z}})}function d(W,z,P){return a(this,void 0,void 0,function*(){var $,K;let ge={},ae=yield c.I.GetConcept(W);0==ae.id&&null!=W&&null!=W&&(ae=yield(0,B.r)(W));let _e=yield G(W,z,P);return ge[null!==(K=null===($=ae?.type)||void 0===$?void 0:$.characterValue)&&void 0!==K?K:""]=_e,ge})}function h(W,z,P){return a(this,void 0,void 0,function*(){var $,K;let ge={},ae=yield c.I.GetConcept(W);0==ae.id&&null!=W&&null!=W&&(ae=yield(0,B.r)(W));let _e=yield G(W,z,P);ge[null!==(K=null===($=ae?.type)||void 0===$?void 0:$.characterValue)&&void 0!==K?K:""]=_e;let ye={};return ye.created_at=ae.entryTimeStamp,ye.data=ge,ye.id=W,ye})}function C(W,z,P){return a(this,void 0,void 0,function*(){var $,K;let ge={},ae=yield c.I.GetConcept(W);0==ae.id&&null!=W&&null!=W&&(ae=yield(0,B.r)(W));let _e=yield D(ae,z,P);return ge[null!==(K=null===($=ae?.type)||void 0===$?void 0:$.characterValue)&&void 0!==K?K:""]=_e,ge})}function T(W){return a(this,void 0,void 0,function*(){var z,P;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetComposition",{id:W})).data}catch(ye){console.error("GetComposition error sw: ",ye),(0,A.handleServiceWorkerException)(ye)}let $=[],K={};$=yield(0,M.s)(W);let ge=[];for(let ye=0;ye<$.length;ye++)ge.includes($[ye].ofTheConceptId)||ge.push($[ye].ofTheConceptId);let ae=yield c.I.GetConcept(W);0==ae.id&&null!=W&&null!=W&&(ae=yield(0,B.r)(W));let _e=yield G(W,$,ge);return K[null!==(P=null===(z=ae?.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:""]=_e,K})}function b(W){return a(this,void 0,void 0,function*(){var z,P;let $=[],K={};$=yield(0,M.s)(W);let ge=[];for(let ye=0;ye<$.length;ye++)ge.includes($[ye].ofTheConceptId)||ge.push($[ye].ofTheConceptId);let ae=yield c.I.GetConcept(W);0==ae.id&&null!=W&&null!=W&&(ae=yield(0,B.r)(W));let _e=yield Z(W,$,ge);return K[null!==(P=null===(z=ae?.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:""]=_e,K})}function m(W){return a(this,void 0,void 0,function*(){var z,P;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionFromMemory",{id:W})).data}catch(ye){console.error("GetCompositionFromMemory error sw: ",ye),(0,A.handleServiceWorkerException)(ye)}let $=[],K={};$=yield f.d.GetConnectionsOfCompositionLocal(W);let ge=[];for(let ye=0;ye<$.length;ye++)ge.includes($[ye].ofTheConceptId)||ge.push($[ye].ofTheConceptId);let ae=yield c.I.GetConcept(W);0==ae.id&&null!=W&&null!=W&&(ae=yield(0,B.r)(W));let _e=yield E(ae,$,ge);return K[null!==(P=null===(z=ae?.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:""]=_e,K})}function y(W){return a(this,void 0,void 0,function*(){var z,P;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionFromMemoryNormal",{id:W})).data}catch(ye){console.error("GetCompositionFromMemoryNormal error sw: ",ye),(0,A.handleServiceWorkerException)(ye)}let $=[],K={};$=yield f.d.GetConnectionsOfCompositionLocal(W);let ge=[];for(let ye=0;ye<$.length;ye++)ge.includes($[ye].ofTheConceptId)||ge.push($[ye].ofTheConceptId);let ae=yield c.I.GetConcept(W);0==ae.id&&null!=W&&null!=W&&(ae=yield(0,B.r)(W));let _e=yield D(ae,$,ge);return K[null!==(P=null===(z=ae?.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:""]=_e,K})}function s(W){var z=arguments;return a(this,void 0,void 0,function*(){var P,$;const K=A.Logger.logfunction("GetCompositionWithIdFromMemory",z)||{};if(A.serviceWorker){K.serviceWorker=!0;try{const ye=yield(0,A.sendMessage)("GetCompositionWithIdFromMemory",{id:W});return A.Logger.logUpdate(K),ye.data}catch(ye){console.error("GetCompositionWithIdFromMemory error sw: ",ye),(0,N.ey)(K,"GetCompositionWithIdFromMemory",ye),(0,A.handleServiceWorkerException)(ye)}}let ge={},ae=[],_e={};try{ae=yield f.d.GetConnectionsOfCompositionLocal(W);let ye=[];for(let Ie=0;Ie<ae.length;Ie++)ye.includes(ae[Ie].ofTheConceptId)||ye.push(ae[Ie].ofTheConceptId);let me=yield c.I.GetConcept(W);0==me.id&&null!=W&&null!=W&&(me=yield(0,B.r)(W));let Ee=yield E(me,ae,ye);_e[null!==($=null===(P=me?.type)||void 0===P?void 0:P.characterValue)&&void 0!==$?$:""]=Ee,ge.created_at=me.entryTimeStamp,ge.data=_e,ge.id=W}catch(ye){console.log("this is the exception in GetCompositionWithIdFromMemory",W),(0,N.ey)(K,"GetCompositionWithIdFromMemory",ye)}return A.Logger.logUpdate(K),ge})}function p(W,z){var P=arguments;return a(this,void 0,void 0,function*(){var $,K;const ge=A.Logger.logfunction("GetCompositionFromMemoryWithConnections",P)||{};if(A.serviceWorker){ge.serviceWorker=!0;try{const Ie=yield(0,A.sendMessage)("GetCompositionFromMemoryWithConnections",{id:W,connectionList:z});return A.Logger.logUpdate(ge),Ie.data}catch(Ie){console.error("GetCompositionFromMemoryWithConnections error sw: ",Ie),(0,N.ey)(ge,"GetCompositionFromMemoryWithConnections",Ie),(0,A.handleServiceWorkerException)(Ie)}}let ae={},_e=[];for(let Ie=0;Ie<z.length;Ie++)_e.includes(z[Ie].ofTheConceptId)||_e.push(z[Ie].ofTheConceptId);let ye=yield c.I.GetConcept(W);0==ye.id&&null!=W&&null!=W&&(ye=yield(0,B.r)(W));let me=yield E(ye,z,_e);ae[null!==(K=null===($=ye?.type)||void 0===$?void 0:$.characterValue)&&void 0!==K?K:""]=me;let Ee={};return Ee.created_at=ye.entryTimeStamp,Ee.data=ae,Ee.id=W,A.Logger.logUpdate(ge),Ee})}function I(W,z){return a(this,void 0,void 0,function*(){var P,$;const K=A.Logger.logfunction("GetCompositionWithIdFromMemoryFromConnection",[W])||{};if(A.serviceWorker){K.serviceWorker=!0;try{const Ee=yield(0,A.sendMessage)("GetCompositionWithIdFromMemory",{id:W});return A.Logger.logUpdate(K),Ee.data}catch(Ee){console.error("GetCompositionWithIdFromMemory error sw: ",Ee),(0,N.ey)(K,"GetCompositionWithIdFromMemoryFromConnection",Ee),(0,A.handleServiceWorkerException)(Ee)}}let ge={},ae=[];for(let Ee=0;Ee<z.length;Ee++)ae.includes(z[Ee].ofTheConceptId)||ae.push(z[Ee].ofTheConceptId);let _e=yield c.I.GetConcept(W);0==_e.id&&null!=W&&null!=W&&(_e=yield(0,B.r)(W));let ye=yield E(_e,z,ae);ge[null!==($=null===(P=_e?.type)||void 0===P?void 0:P.characterValue)&&void 0!==$?$:""]=ye;let me={};return me.created_at=_e.entryTimeStamp,me.data=ge,me.id=W,A.Logger.logUpdate(K),me})}function x(W){return a(this,void 0,void 0,function*(){if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionWithIdFromMemoryNew",{id:W})).data}catch(ye){console.error("GetCompositionWithIdFromMemoryNew error sw: ",ye),(0,A.handleServiceWorkerException)(ye)}let P=[],$={};P=yield f.d.GetConnectionsOfCompositionLocal(W);let K=[];for(let ye=0;ye<P.length;ye++)K.includes(P[ye].ofTheConceptId)||K.push(P[ye].ofTheConceptId);let ge=yield c.I.GetConcept(W);0==ge.id&&null!=W&&null!=W&&(console.log("this concept you cannot find ",W),ge=yield(0,B.r)(W)),(new Date).getTime();let ae=yield function(ye,me,Ee){return a(this,arguments,void 0,function*(Ie,de,we,ke=[]){var Oe,pt,st,Me,be,rt,Nt,Lt;let Ue={},yt=Ie.id,ze=((new Date).getTime(),null!==(pt=null===(Oe=Ie?.type)||void 0===Oe?void 0:Oe.characterValue)&&void 0!==pt?pt:"");if(!we.includes(yt))return{[ze]:Ie?.characterValue};if(ke.includes(yt))return"";ke.push(yt);for(let We=0;We<de.length;We++){let At=yield(0,A.GetTheConcept)(de[We].ofTheConceptId),Ne=yield(0,A.GetTheConcept)(de[We].toTheConceptId);de[We].ofConcept=At,de[We].toConcept=Ne;let Ke=At.id,Ye=(null!==(Me=null===(st=Ne?.type)||void 0===st?void 0:st.characterValue)&&void 0!==Me?Me:"").replace("the_","");null!=Ue[Ke]&&null!=Ue[Ke]||(Ue[Ke]={}),Ue[Ke][Ye]=Ne.characterValue}let qe={};for(let We=0;We<de.length;We++){let At=de[We].ofConcept,Ne=de[We].toConcept,Ke=null!==(rt=null===(be=At?.type)||void 0===be?void 0:be.characterValue)&&void 0!==rt?rt:"",Ye=(null!==(Lt=null===(Nt=Ne?.type)||void 0===Nt?void 0:Nt.characterValue)&&void 0!==Lt?Lt:"").replace("the_","");null!=qe[At.id]&&null!=qe[At.id]||(qe[At.id]={});let Ct=qe[At.id];null!=Ct[Ke]&&null!=Ct[Ke]||(Ct[Ke]={}),Ct[Ke][Ye]=null!=Ue[de[We].ofTheConceptId]&&null!=Ue[de[We].toTheConceptId]?Ue[Ne.id]:Ne.characterValue}return qe[Ie.id]})}(ge,P,K);$=ae;let _e={};return _e.created_at=ge.entryTimeStamp,_e.data=$,_e.id=W,_e})}function w(W){return a(this,void 0,void 0,function*(){var z,P;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionWithIdAndDateFromMemory",{id:W})).data}catch(me){console.error("GetCompositionWithIdAndDateFromMemory error sw: ",me),(0,A.handleServiceWorkerException)(me)}let $=[],K={};$=yield f.d.GetConnectionsOfCompositionLocal(W);let ge=[];for(let me=0;me<$.length;me++)ge.includes($[me].ofTheConceptId)||ge.push($[me].ofTheConceptId);let ae=yield c.I.GetConcept(W);0==ae.id&&null!=W&&null!=W&&(ae=yield(0,B.r)(W));let _e=yield G(W,$,ge);K[null!==(P=null===(z=ae?.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:""]=_e;let ye={};return ye.data=K,ye.id=W,ye.created_at=ae.entryTimeStamp,ye})}function F(W){var z=arguments;return a(this,void 0,void 0,function*(){var P,$;const K=A.Logger.logfunction("GetCompositionWithId",z)||{};if(A.serviceWorker){K.serviceWorker=!0;try{const Ie=yield(0,A.sendMessage)("GetCompositionWithId",{id:W});return A.Logger.logUpdate(K),Ie.data}catch(Ie){console.error("GetCompositionWithId error sw: ",Ie),(0,N.ey)(K,"GetCompositionWithId",Ie),(0,A.handleServiceWorkerException)(Ie)}}let ge=[],ae={};ge=yield(0,M.s)(W);let _e=[];for(let Ie=0;Ie<ge.length;Ie++)_e.includes(ge[Ie].ofTheConceptId)||_e.push(ge[Ie].ofTheConceptId);let ye=yield c.I.GetConcept(W);0==ye.id&&null!=W&&null!=W&&(ye=yield(0,B.r)(W));let me=yield G(W,ge,_e);ae[null!==($=null===(P=ye?.type)||void 0===P?void 0:P.characterValue)&&void 0!==$?$:""]=me;let Ee={};return Ee.data=ae,Ee.id=W,A.Logger.logUpdate(K),Ee})}function E(W,z,P){return a(this,arguments,void 0,function*($,K,ge,ae=[]){var ye,me;let Ee={},Ie=[],de=$.id;if(!ge.includes(de))return $?.characterValue;if(ae.includes(de))return"";ae.push(de);for(let we=0;we<K.length;we++)if(K[we].ofTheConceptId==de)if(de!=K[we].toTheConceptId){let ke=K[we].toTheConceptId,Oe=yield c.I.GetConcept(ke);if(null!=Oe&&0!=Oe.id||null==ke||null==ke||(Oe=yield(0,B.r)(ke)),0!=Oe.id&&null==Oe?.type){let Me=Oe.typeId,be=yield c.I.GetConcept(Me);Oe.type=be,null==be&&null!=Me&&null!=Me&&(be=yield(0,B.r)(Me),Oe.type=be)}let st=(null!==(me=null===(ye=Oe?.type)||void 0===ye?void 0:ye.characterValue)&&void 0!==me?me:"").replace("the_","");if(isNaN(Number(st))){if(st){const Me=yield E(Oe,K,ge,ae);Ee[st]=Me}}else{const Me=yield E(Oe,K,ge,ae);Ie[st]=Me,Ee=Ie}}else console.log("this is the faulty connection ",K[we]);return Ee})}function D(W,z,P){return a(this,arguments,void 0,function*($,K,ge,ae=[]){var ye,me;const Ee=A.Logger.logfunction("recursiveFetchConceptNormal",[$]);(new Date).getTime();let Ie={},de=[],we=$.id;if(Ie.id=we,!ge.includes(we))return $?.characterValue;if(ae.includes(we))return"";ae.push(we);for(let ke=0;ke<K.length;ke++)if(K[ke].ofTheConceptId==we)if(we!=K[ke].toTheConceptId){let Oe=K[ke].toTheConceptId,pt=yield c.I.GetConcept(Oe);if(null!=pt&&0!=pt.id||null==Oe||null==Oe||(pt=yield(0,B.r)(Oe)),0!=pt.id&&null==pt?.type){let be=pt.typeId,rt=yield c.I.GetConcept(be);pt.type=rt,null==rt&&null!=be&&null!=be&&(rt=yield(0,B.r)(be),pt.type=rt)}let Me=(null!==(me=null===(ye=pt?.type)||void 0===ye?void 0:ye.characterValue)&&void 0!==me?me:"").replace("the_","");if(isNaN(Number(Me))){if(Me){const be=yield E(pt,K,ge,ae);Ie[Me]=be}}else{const be=yield E(pt,K,ge,ae);de[Me]=be,Ie=de}}else console.log("this is the faulty connection ",K[ke]);return A.Logger.logUpdate(Ee),Ie})}function G(W,z,P){return a(this,arguments,void 0,function*($,K,ge,ae=[]){var ye,me;let Ee={},Ie=[];if(0==$)return null;let de=yield c.I.GetConcept($);if(null!=de&&0!=de.id||null==$||null==$||(de=yield(0,B.r)($)),0!=de.id&&null==de.type){let we=de.typeId,ke=yield c.I.GetConcept(we);de.type=ke,null==ke&&null!=we&&null!=we&&(ke=yield(0,B.r)(we),de.type=ke)}if(!ge.includes($))return de?.characterValue;if(ae.includes($))return"";ae.push($);for(let we=0;we<K.length;we++)if((new Date).getTime(),K[we].ofTheConceptId==$)if($!=K[we].toTheConceptId){let ke=K[we].toTheConceptId,Oe=yield c.I.GetConcept(ke);if(null!=Oe&&0!=Oe.id||null==ke||null==ke||(Oe=yield(0,B.r)(ke)),0!=Oe.id&&null==Oe?.type){let Me=Oe.typeId,be=yield c.I.GetConcept(Me);Oe.type=be,null==be&&null!=Me&&null!=Me&&(be=yield(0,B.r)(Me),Oe.type=be)}let st=(null!==(me=null===(ye=Oe?.type)||void 0===ye?void 0:ye.characterValue)&&void 0!==me?me:"").replace("the_","");if(isNaN(Number(st))){if(st){const Me=yield G(ke,K,ge,ae);Ee[st]=Me}}else{const Me=yield G(ke,K,ge,ae);Ie[st]=Me,Ee=Ie}}else console.log("this is the faulty connection ",K[we]);return Ee})}function Z(W,z,P){return a(this,arguments,void 0,function*($,K,ge,ae=[]){var ye,me;let Ee={},Ie=[];if(0==$)return null;let de=yield c.I.GetConcept($);if(null!=de&&0!=de.id||null==$||null==$||(de=yield(0,B.r)($)),0!=de.id&&null==de.type){let we=de.typeId,ke=yield c.I.GetConcept(we);de.type=ke,null==ke&&null!=we&&null!=we&&(ke=yield(0,B.r)(we),de.type=ke)}if(!ge.includes($))return de?.characterValue;if(ae.includes($))return"";ae.push($),Ee.id=$;for(let we=0;we<K.length;we++)if(K[we].ofTheConceptId==$){let ke=K[we].toTheConceptId,Oe=yield c.I.GetConcept(ke);if(null!=Oe&&0!=Oe.id||null==ke||null==ke||(Oe=yield(0,B.r)(ke)),Oe&&null==Oe?.type){let Me=Oe.typeId,be=yield c.I.GetConcept(Me);Oe.type=be,null==be&&null!=Me&&null!=Me&&(be=yield(0,B.r)(Me),Oe.type=be)}let st=(null!==(me=null===(ye=Oe?.type)||void 0===ye?void 0:ye.characterValue)&&void 0!==me?me:"").replace("the_","");if(isNaN(Number(st))){if(st){const Me=yield Z(ke,K,ge);Ee[st]=Me}}else{const Me=yield Z(ke,K,ge);Ie[st]=Me,Ee=Ie}}return Ee})}},6687:(Re,ne,_)=>{_.d(ne,{D:()=>x,MT:()=>I,Nt:()=>T,QL:()=>y,as:()=>b,cw:()=>d,dF:()=>r,hG:()=>m,km:()=>C,nr:()=>p,p8:()=>h,rv:()=>s});var B=_(8642),M=_(7467),c=_(1834),f=_(1863),A=_(5284),N=_(8939),a=function(w,F,E,D){return new(E||(E=Promise))(function(G,Z){function W($){try{P(D.next($))}catch(K){Z(K)}}function z($){try{P(D.throw($))}catch(K){Z(K)}}function P($){var K;$.done?G($.value):(K=$.value,K instanceof E?K:new E(function(ge){ge(K)})).then(W,z)}P((D=D.apply(w,F||[])).next())})};function r(){return a(this,arguments,void 0,function*(w=[]){yield(0,B.Y)(w);let F=[];for(let E=0;E<w.length;E++){let D=yield(0,N.kx)(w[E]);F.push(D)}return F})}function d(){return a(this,arguments,void 0,function*(w=[]){yield(0,B.Y)(w);let F=[];for(let E=0;E<w.length;E++){let D=yield(0,N.RW)(w[E]);F.push(D)}return F})}function h(){return a(this,arguments,void 0,function*(w=[],F=[]){const E=c.Logger.logfunction("GetCompositionFromConnectionsWithDataId",[w])||{};if(c.serviceWorker){E.serviceWorker=!0;try{const G=yield(0,c.sendMessage)("GetCompositionFromConnectionsWithDataId",{conceptIds:w,connectionIds:F});return c.Logger.logUpdate(E),G.data}catch(G){console.error("GetCompositionFromConnectionsWithDataId error sw: ",G),(0,f.ey)(E,"GetCompositionFromConnectionsWithDataId",G),(0,c.handleServiceWorkerException)(G)}}let D=[];for(let G=0;G<w.length;G++){let Z=yield(0,N.RW)(w[G]);D.push(Z)}return c.Logger.logUpdate(E),D})}function C(){var w=arguments;return a(this,arguments,void 0,function*(F=[],E=[]){const D=c.Logger.logfunction("GetCompositionFromConnectionsWithDataIdFromConnections",w)||{};if(c.serviceWorker){D.serviceWorker=!0;try{const W=yield(0,c.sendMessage)("GetCompositionFromConnectionsWithDataIdFromConnections",{conceptIds:F,connectionIds:E});return c.Logger.logUpdate(D),W.data}catch(W){console.error("GetCompositionFromConnectionsWithDataIdFromConnections error sw: ",W),(0,f.ey)(D,"GetCompositionFromConnectionsWithDataIdFromConnections",W),(0,c.handleServiceWorkerException)(W)}}let G=yield(0,M.j)(E),Z=[];for(let W=0;W<F.length;W++){let z=yield(0,N.PT)(F[W],G);Z.push(z)}return c.Logger.logUpdate(D),Z})}function T(){var w=arguments;return a(this,arguments,void 0,function*(F=[],E=[]){const D=c.Logger.logfunction("GetCompositionFromConnectionsWithDataIdIndex",w)||{};if(c.serviceWorker){D.serviceWorker=!0;try{const Z=yield(0,c.sendMessage)("GetCompositionFromConnectionsWithDataIdIndex",{conceptIds:F,connectionIds:E});return c.Logger.logUpdate(D),Z.data}catch(Z){console.error("GetCompositionFromConnectionsWithDataIdIndex error sw: ",Z),(0,f.ey)(D,"GetCompositionFromConnectionsWithDataIdIndex",Z),(0,c.handleServiceWorkerException)(Z)}}yield(0,M.j)(E),yield(0,A.B)(F);let G={};for(let Z=0;Z<F.length;Z++){let W=yield(0,N.RW)(F[Z]);G[F[Z]]=W}return c.Logger.logUpdate(D),G})}function b(){return a(this,arguments,void 0,function*(w=[],F=[]){yield(0,M.j)(F),yield(0,A.B)(w);let E={};for(let D=0;D<w.length;D++){let G=yield(0,N.kx)(w[D]);E[w[D]]=G}return E})}function m(){return a(this,arguments,void 0,function*(w=[],F=[]){if(c.serviceWorker)try{return(yield(0,c.sendMessage)("GetCompositionFromConnectionsWithIndexFromConnections",{conceptIds:w,connectionIds:F})).data}catch(G){console.error("GetCompositionFromConnectionsWithIndexFromConnections error sw: ",G),(0,c.handleServiceWorkerException)(G)}let E=yield(0,M.j)(F),D=[];for(let G=0;G<w.length;G++){let Z=yield(0,N.JA)(w[G],E);D[w[G]]=Z}return D})}function y(w){var F=arguments;return a(this,void 0,void 0,function*(){const E=c.Logger.logfunction("GetConnectionDataPrefetch",F)||{};if(c.serviceWorker){E.serviceWorker=!0;try{const P=yield(0,c.sendMessage)("GetConnectionDataPrefetch",{connectionIds:w});return c.Logger.logUpdate(E),P.data}catch(P){console.error("GetConnectionDataPrefetch error sw: ",P),(0,f.ey)(E,"GetConnectionDataPrefetch",P),(0,c.handleServiceWorkerException)(P)}}let D=[],G=[],Z={};for(let P=0;P<w.length;P++){let $=yield c.ConnectionData.GetConnection(w[P]);0==$.id?D.push(w[P]):G.push($)}for(let P=0;P<D.length;P++)Z[w[P]]=!1;let W=[],z=yield(0,M.j)(D);G=[...G,...z];for(let P=0;P<G.length;P++)W.push(G[P].ofTheConceptId),W.push(G[P].toTheConceptId),W.push(G[P].typeId);return yield(0,c.GetConceptBulk)(W),c.Logger.logUpdate(E),G})}function s(){var w=arguments;return a(this,arguments,void 0,function*(F=[],E=[]){const D=c.Logger.logfunction("GetCompositionFromConnectionsWithDataIdInObject",w);yield(0,M.j)(E);let G={};for(let Z=0;Z<F.length;Z++){let W=yield(0,N.RW)(F[Z]);G[F[Z]]=W}return c.Logger.logUpdate(D),G})}function p(){return a(this,arguments,void 0,function*(w=[],F=[]){yield(0,M.j)(F);let E={};for(let D=0;D<w.length;D++){let G=yield(0,N.$N)(w[D]);E[w[D]]=G}return E})}function I(){return a(this,arguments,void 0,function*(w=[],F=[]){yield(0,M.j)(F);let E={};for(let D=0;D<w.length;D++){let G=yield(0,N.kx)(w[D]);E[w[D]]=G}return E})}function x(){return a(this,arguments,void 0,function*(w=[],F=[]){yield(0,M.j)(F);let E={};for(let D=0;D<w.length;D++){let G=yield(0,N.XI)(w[D]);E[w[D]]=G,console.log("this is the normal data",w[D],G)}return E})}},2013:(Re,ne,_)=>{_.d(ne,{A:()=>N,w:()=>a});var B=_(8146),M=_(1834),c=_(9639),f=_(1863),A=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function N(r){var d=arguments;return A(this,void 0,void 0,function*(){const h=M.Logger.logfunction("GetConceptByCharacter",d)||{};if(M.serviceWorker){h.serviceWorker=!0;try{const b=yield(0,M.sendMessage)("GetConceptByCharacter",{characterValue:r});return M.Logger.logUpdate(h),b.data}catch(b){console.error("GetConceptByCharacter sw error: ",b),(0,f.ey)(h,"GetConceptByCharacter",b),(0,M.handleServiceWorkerException)(b)}}let C=yield c.I.GetConceptByCharacter(r);return null!=C&&0!=C?.id||!`${r}`||(yield(0,B.Y)(r),C=yield c.I.GetConceptByCharacterAndTypeLocal(r,51),0==C.id&&(C=yield c.I.GetConceptByCharacter(r))),M.Logger.logUpdate(h),C})}function a(r){var d=arguments;return A(this,void 0,void 0,function*(){const h=M.Logger.logfunction("GetConceptByCharacterUpdated",d)||{};if(M.serviceWorker){h.serviceWorker=!0;try{const b=yield(0,M.sendMessage)("GetConceptByCharacterUpdated",{characterValue:r});return M.Logger.logUpdate(h),b.data}catch(b){console.error("GetConceptByCharacterUpdated error sw: ",b),(0,f.ey)(h,"GetConceptByCharacterUpdated",b),(0,M.handleServiceWorkerException)(b)}}let C=yield c.I.GetConceptByCharacter(r);return null!=C&&0!=C?.id||!`${r}`||(yield(0,B.Y)(r),C=yield c.I.GetConceptByCharacter(r)),M.Logger.logUpdate(h),C})}},7887:(Re,ne,_)=>{_.d(ne,{a:()=>f,p:()=>A});var B=_(8286),M=_(4864),c=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function f(){return c(this,void 0,void 0,function*(){try{let N=[];if(Array.isArray(N))for(let a=0;a<N.length;a++)B.d.AddConnectionToMemory(N[a])}catch(N){throw{message:"Cannot create Connection Binary Tree Concept",ok:!1,status:400,data:N}}})}function A(){return c(this,void 0,void 0,function*(){try{let N=[];if(Array.isArray(N))for(let a=0;a<N.length;a++)M.G.AddConnectionToMemory(N[a])}catch(N){throw{message:"Cannot create Local Connection Binary Tree Concept",ok:!1,status:400,data:N}}})}},7876:(Re,ne,_)=>{_.d(ne,{A:()=>r,K:()=>d});var B=_(1735),M=_(7139),c=_(1834),f=_(9639),A=_(7282),N=function(h,C,T,b){return new(T||(T=Promise))(function(m,y){function s(x){try{I(b.next(x))}catch(w){y(w)}}function p(x){try{I(b.throw(x))}catch(w){y(w)}}function I(x){var w;x.done?m(x.value):(w=x.value,w instanceof T?w:new T(function(F){F(w)})).then(s,p)}I((b=b.apply(h,C||[])).next())})};const a=new Map;function r(h){return N(this,arguments,void 0,function*(C,T=999){let b=performance.now();if(B.J.activateStatus)try{B.J.incrementConcept(C)}catch{console.error("Error adding connection in access tracker"),c.Logger.log("ERROR","Error Adding Connection")}if(c.serviceWorker)try{return(yield(0,c.sendMessage)("GetTheConcept",{id:C,userId:T})).data}catch(s){console.error("GetTheConcept sw error: ",s),(0,c.handleServiceWorkerException)(s)}let m=(0,A.o)();if(a.has(C))return a.get(C)||m;const y=(()=>N(this,void 0,void 0,function*(){try{if(C<0)return yield c.LocalConceptsData.GetConceptByGhostId(C);if(m=yield f.I.GetConcept(C),(null==m||0==m.id)&&null!=C&&null!=C&&(m=yield(0,M.r)(C)),0!=m.id&&null==m.type&&null==(yield f.I.GetConcept(m.typeId))&&null!=m.typeId&&null!=m.typeId){let s=yield(0,M.r)(m.typeId);m.type=s}return m}catch(s){throw console.error("this is the error in the getting concept",s),c.Logger.logError(b,T,"read","unknown",void 0,500,s,"GetTheConcept",[C,T],"unknown",void 0),s}finally{a.delete(C)}}))();return a.set(C,y),y})}function d(h){return N(this,void 0,void 0,function*(){if(c.serviceWorker)try{return(yield(0,c.sendMessage)("AddTypeConcept",{concept:h})).data}catch(C){console.error("AddTypeConcept sw error: ",C),(0,c.handleServiceWorkerException)(C)}if(null==h.type){let C=yield f.I.GetConcept(h.typeId);if(0==C.id&&0!=h.typeId&&999!=h.typeId){let T=yield(0,M.r)(h.typeId);h.type=T}else h.type=C}})}},7869:(Re,ne,_)=>{_.d(ne,{_:()=>b,A:()=>T});var B=_(9581),M=_(9639),c=_(1863),f=_(3518),A=_(1834),N=function(m,y,s,p){return new(s||(s=Promise))(function(I,x){function w(D){try{E(p.next(D))}catch(G){x(G)}}function F(D){try{E(p.throw(D))}catch(G){x(G)}}function E(D){var G;D.done?I(D.value):(G=D.value,G instanceof s?G:new s(function(Z){Z(G)})).then(w,F)}E((p=p.apply(m,y||[])).next())})},a=_(2299);class r{}r.isUpdated=!1,r.isOnlineSync=!1;var d=_(3655),h=_(9003),C=function(m,y,s,p){return new(s||(s=Promise))(function(I,x){function w(D){try{E(p.next(D))}catch(G){x(G)}}function F(D){try{E(p.throw(D))}catch(G){x(G)}}function E(D){var G;D.done?I(D.value):(G=D.value,G instanceof s?G:new s(function(Z){Z(G)})).then(w,F)}E((p=p.apply(m,y||[])).next())})};function T(){return C(this,arguments,void 0,function*(m=!0){try{if(yield(0,d.qI)("concepts"),yield(0,h.qI)("concepts"),m){if((yield(0,d.b8)()).isOnlineSync)return!0;yield function(){return N(this,void 0,void 0,function*(){const y=A.Logger.logfunction("GetAiData");try{const I=(new Date).getTime();var s=(0,f.ab)("application/x-www-form-urlencoded");const x=yield fetch(B.B.GetAllAiData(),{method:"GET",headers:s});x.ok||(console.log("Ai Error Message: ","Cannot get response"),(0,c.ry)(x));const w=yield x.json();for(var p=0;p<w.length;p++)M.I.AddConcept(w[p]);b();let F=(new Date).getTime()-I;console.log("The time taken is ",F),A.Logger.logUpdate(y)}catch(I){I instanceof Error?console.log("Ai Error Message: ",I.message):console.log("Ai Error Message: ",I),(0,c.Mb)(I,B.B.GetAllAiData())}})}()}return!0}catch(y){return console.log({message:"cannot initlize the AI system",ok:!1,status:400,data:y}),!0}})}function b(){return C(this,void 0,void 0,function*(){r.isOnlineSync=!0;var m=new a.B(r.isOnlineSync);(0,d.El)(m)})}},8095:(Re,ne,_)=>{_.d(ne,{h:()=>A});var B=_(1834),M=_(9700),c=_(1863),f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function A(N,a,r){var d=arguments;return f(this,arguments,void 0,function*(h,C,T,b=!1,m={concepts:[],connections:[]}){var y,s,p,I,x,w;const F=M.V.logfunction("CreateConnectionBetweenTwoConceptsLocal",d)||{};let E=performance.now();try{if(B.serviceWorker){F.serviceWorker=!0;try{const z=yield(0,B.sendMessage)("CreateConnectionBetweenTwoConceptsLocal",{ofTheConcept:h,toTheConcept:C,linker:T,both:b,actions:m});return!(null===(s=null===(y=z?.actions)||void 0===y?void 0:y.concepts)||void 0===s)&&s.length&&(m.concepts=JSON.parse(JSON.stringify(z.actions.concepts))),!(null===(I=null===(p=z?.actions)||void 0===p?void 0:p.connections)||void 0===I)&&I.length&&(m.connections=JSON.parse(JSON.stringify(z.actions.connections))),M.V.logUpdate(F),z.data}catch(z){console.error("CreateConnectionBetweenTwoConceptsLocal sw error: ",z),(0,c.ey)(F,"CreateConnectionBetweenTwoConceptsLocal",z),(0,B.handleServiceWorkerException)(z)}}if(b){let z=(null===(x=C.type)||void 0===x?void 0:x.characterValue)+"_s_"+T+"_by";var D=yield(0,B.MakeTheInstanceConceptLocal)("connection",z,!1,999,999,999,0,m);yield(0,B.CreateTheConnectionLocal)(C.id,h.id,D.id,1e3,void 0,void 0,m)}let Z=(null===(w=h.type)||void 0===w?void 0:w.characterValue)+"_s_"+T+"_s";var G=yield(0,B.MakeTheInstanceConceptLocal)("connection",Z,!1,999,999,999,void 0,m);let W=yield(0,B.CreateTheConnectionLocal)(h.id,C.id,G.id,1e3,void 0,void 0,m);return M.V.logUpdate(F),W}catch(Z){throw M.V.logError(E,h.userId,"create",void 0,void 0,500,Z,"CreateConnectionBetweenTwoConceptsLocal",[h,C,T,b],void 0,void 0),(0,c.ey)(F,"CreateConnectionBetweenTwoConceptsLocal",Z),Z}})}},6416:(Re,ne,_)=>{_.d(ne,{u:()=>M});var B=_(2615);function M(){return new B.j(0,0,0,0,0,"0",0,!1,new Date,new Date,"0")}},3075:(Re,ne,_)=>{_.d(ne,{Ay:()=>r,EO:()=>d,xd:()=>h});var B=_(205),M=_(9736),c=_(5257),f=_(9003),A=_(1834),N=_(1863),a=function(C,T,b,m){return new(b||(b=Promise))(function(y,s){function p(w){try{x(m.next(w))}catch(F){s(F)}}function I(w){try{x(m.throw(w))}catch(F){s(F)}}function x(w){var F;w.done?y(w.value):(F=w.value,F instanceof b?F:new b(function(E){E(F)})).then(p,I)}x((m=m.apply(C,T||[])).next())})};function r(){return a(this,void 0,void 0,function*(){const C=A.Logger.logfunction("CreateLocalBinaryTreeFromIndexDb");try{let T=[];if(Array.isArray(T))for(let b=0;b<T.length;b++)M.v.AddConceptToMemory(T[b]);B.B.isLocalDataLoaded=!0,B.B.isLocalTypeLoaded=!0,B.B.isLocalCharacterLoaded=!0,A.Logger.logUpdate(C)}catch(T){yield(0,A.DelayFunctionExecution)(2e3,r());let b={message:"Cannot create local binary tree from index db",data:T,ok:!1,status:400};throw(0,N.ey)(C,"CreateLocalBinaryTreeFromIndexDb",T),b}})}function d(){return a(this,void 0,void 0,function*(){var C;const T=A.Logger.logfunction("PopulateTheLocalConceptsToMemory");try{yield null===(C=navigator.locks)||void 0===C?void 0:C.request("dblock",b=>a(this,void 0,void 0,function*(){let m=yield(0,f.S5)("localid");if(Array.isArray(m)&&m[0]){let y=m[0].value;if(y)c.R.AddConceptId(m[0]),yield(0,f.kH)("localid",{id:0,value:y-10});else{y=-Math.floor(1e8*Math.random());let p={id:0,value:y-10};c.R.AddConceptId({id:0,value:y}),yield(0,f.kH)("localid",p)}}})),A.Logger.logUpdate(T)}catch(b){let m={message:"Cannot populate Local Ids from the Index Db",data:b,ok:!1,status:400};throw(0,N.ey)(T,"PopulateTheLocalConceptsToMemory",b),m}})}function h(){return a(this,void 0,void 0,function*(){var C;const T=A.Logger.logfunction("PopulateTheLocalConnectionToMemory");try{yield null===(C=navigator.locks)||void 0===C?void 0:C.request("dblock",b=>a(this,void 0,void 0,function*(){let m=yield(0,f.S5)("localid");if(Array.isArray(m)&&m[1]){let y=m[1].value;if(y)c.R.AddConnectionId(m[1]),yield(0,f.kH)("localid",{id:1,value:y-10});else{y=-Math.floor(1e8*Math.random());let p={id:0,value:y-10};c.R.AddConnectionId({id:0,value:y}),yield(0,f.kH)("localid",p)}}})),A.Logger.logUpdate(T)}catch(b){let m={message:"Cannot populate Local Ids from the Index Db",data:b,ok:!1,status:400};throw(0,N.ey)(T,"PopulateTheLocalConnectionToMemory",b),m}})}},999:(Re,ne,_)=>{_.d(ne,{R:()=>a});var B=_(1834),M=_(1863),c=_(6416),f=_(4711),A=_(5868),N=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function a(r){return N(this,arguments,void 0,function*(d,h=null,C=null,T=null,b=null,m=null,y=null,s=!1,p={concepts:[],connections:[]}){var I,x,w,F;const E=B.Logger.logfunction("CreateTheCompositionLocal")||{};if(B.serviceWorker){E.serviceWorker=!0;try{const P=yield(0,B.sendMessage)("CreateTheCompositionLocal",{json:d,ofTheConceptId:h,ofTheConceptUserId:C,mainKey:T,userId:b,accessId:m,sessionInformationId:y,actions:p});return!(null===(x=null===(I=P?.actions)||void 0===I?void 0:I.concepts)||void 0===x)&&x.length&&(p.concepts=JSON.parse(JSON.stringify(P.actions.concepts))),!(null===(F=null===(w=P?.actions)||void 0===w?void 0:w.connections)||void 0===F)&&F.length&&(p.connections=JSON.parse(JSON.stringify(P.actions.connections))),B.Logger.logUpdate(E),P.data}catch(P){console.error("CreateTheCompositionLocal error sw: ",P),(0,M.ey)(E,"CreateTheCompositionLocal",P),(0,B.handleServiceWorkerException)(P)}}let D=b??999,G=m??999,Z=y??999,W=T??0,z=(0,c.u)();for(const P in d)if("string"!=typeof d[P]&&"number"!=typeof d[P])if(null==h&&null==C){let $=W,K=yield(0,A.k)(P,"",!0,D,G,Z,void 0,p);z=K,$=K.id,W=K.id,yield a(d[P],K.id,K.userId,$,b,m,y,void 0,p)}else{let $=h??999,K=W,ge=yield(0,A.k)(P,"",!0,D,G,Z,void 0,p);yield(0,f.F)($,ge.id,K,void 0,void 0,void 0,p),yield a(d[P],ge.id,ge.userId,K,b,m,y,void 0,p)}else{let $=h??999,K=W,ge=yield(0,A.k)(P,d[P].toString(),!1,D,G,Z,void 0,p);yield(0,f.F)($,ge.id,K,void 0,void 0,void 0,p)}return B.Logger.logUpdate(E),z})}},3077:(Re,ne,_)=>{_.d(ne,{A:()=>a});var B=_(1834),M=_(2615),c=_(9736),f=_(5257),A=_(9700),N=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function a(r,d,h,C,T,b){return N(this,arguments,void 0,function*(m,y,s,p,I,x,w=!1,F=0,E={concepts:[],connections:[]}){var D,G,Z,W;let z=performance.now();try{if(B.serviceWorker)try{const _e=yield(0,B.sendMessage)("CreateTheConceptLocal",{referent:m,typecharacter:y,userId:s,categoryId:p,typeId:I,accessId:x,isComposition:w,referentId:F});return!(null===(G=null===(D=_e?.actions)||void 0===D?void 0:D.concepts)||void 0===G)&&G.length&&(E.concepts=JSON.parse(JSON.stringify(_e.actions.concepts))),!(null===(W=null===(Z=_e?.actions)||void 0===Z?void 0:Z.connections)||void 0===W)&&W.length&&(E.connections=JSON.parse(JSON.stringify(_e.actions.connections))),_e.data}catch(_e){console.error("CreateTheConceptLocal error sw: ",_e),(0,B.handleServiceWorkerException)(_e)}let P=yield f.R.getConceptId(),$=!0,K=new Date,ge=new Date;if("the"==m)return new M.j(1,999,5,5,F,m,x,$,K,ge,y);let ae=new M.j(P,s,I,p,F,m,x,$,K,ge,y);return ae.isTemp=!0,ae.isComposition=w,c.v.AddConcept(ae),E.concepts.push(ae),ae}catch(P){throw A.V.logError(z,s,"create","unknown","unknown",500,void 0,"createTheConceptLocal",[m,y,s,p,I,x,w],void 0),P}})}},4711:(Re,ne,_)=>{_.d(ne,{F:()=>a,d:()=>r});var B=_(2155),M=_(4864),c=_(5257),f=_(9700),A=_(1834),N=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};function a(d,h,C){return N(this,arguments,void 0,function*(T,b,m,y=1,s="",p=999,I={concepts:[],connections:[]}){var x,w,F,E;let D=performance.now();if(A.serviceWorker)try{const G=yield(0,A.sendMessage)("CreateTheConnectionLocal",{ofTheConceptId:T,toTheConceptId:b,typeId:m,orderId:y,typeString:s,userId:p,actions:I});return!(null===(w=null===(x=G?.actions)||void 0===x?void 0:x.concepts)||void 0===w)&&w.length&&(I.concepts=JSON.parse(JSON.stringify(G.actions.concepts))),!(null===(E=null===(F=G?.actions)||void 0===F?void 0:F.connections)||void 0===E)&&E.length&&(I.connections=JSON.parse(JSON.stringify(G.actions.connections))),G.data}catch(G){console.log("CreateTheConnectionLocal error sw: ",G),(0,A.handleServiceWorkerException)(G)}try{let G=4,Z=yield c.R.getConnectionId(),W=0,z=0,P=0;W=T,z=b,P=m;let $=new B.N(0,0,0,0,0,0,0);return T!=b&&($=new B.N(Z,W,z,p,m,y,G),$.isTemp=!0,$.typeCharacter=s,A.LocalSyncData.AddConnection($),M.G.AddConnection($),I.connections.push($)),$}catch(G){throw f.V.logError(D,p,"create","Unknown","Unknown",500,void 0,"CreateTheConnectionLocal",[T,b,m,y,s,p],"UnknownUserAgent",[]),G}})}function r(d,h,C){return N(this,arguments,void 0,function*(T,b,m,y={concepts:[],connections:[]}){var s,p,I,x;if(A.serviceWorker)try{const E=yield(0,A.sendMessage)("CreateConnection",{ofTheConcept:T,toTheConcept:b,connectionTypeString:m,actions:y});return!(null===(p=null===(s=E?.actions)||void 0===s?void 0:s.concepts)||void 0===p)&&p.length&&(y.concepts=JSON.parse(JSON.stringify(E.actions.concepts))),!(null===(x=null===(I=E?.actions)||void 0===I?void 0:I.connections)||void 0===x)&&x.length&&(y.connections=JSON.parse(JSON.stringify(E.actions.connections))),E.data}catch(E){console.log("CreateConnection error sw: ",E),(0,A.handleServiceWorkerException)(E)}let w=yield(0,A.MakeTheTypeConceptLocal)(m,999,999,999),F=T.userId;return yield a(T.id,b.id,w.id,1e3,m,F,y)})}},8064:(Re,ne,_)=>{_.d(ne,{$I:()=>A,Ay:()=>f});var B=_(9736),M=(_(9581),_(3518),_(1834));_(1863);var c=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function f(N){return c(this,void 0,void 0,function*(){return yield B.v.GetConceptByCharacterAndTypeLocal(N,51)})}function A(N){return c(this,void 0,void 0,function*(){if(M.serviceWorker)try{return(yield(0,M.sendMessage)("GetConceptByCharacterAndCategoryLocal",{character:N})).data}catch(d){console.error("GetConceptByCharacterAndCategoryLocal error sw: ",d),(0,M.handleServiceWorkerException)(d)}let a=(0,M.CreateDefaultLConcept)();if("the"==N)return a.id=1,a.typeId=5,a.characterValue="the",a;let r=(0,M.SplitStrings)(N);if(r.length>1){let d=1,h=yield A(r[0]);0!=h.id&&(d=h.id),a=yield function(C,T){return c(this,void 0,void 0,function*(){return B.v.GetConceptByCharacterAndCategoryLocal(C,T)})}(N,d)}else r[0]==N&&(a=yield f(N));return a})}},1213:(Re,ne,_)=>{_.d(ne,{f:()=>N});var B=_(9736),M=_(7820),c=_(1834),f=_(176),A=function(a,r,d,h){return new(d||(d=Promise))(function(C,T){function b(s){try{y(h.next(s))}catch(p){T(p)}}function m(s){try{y(h.throw(s))}catch(p){T(p)}}function y(s){var p;s.done?C(s.value):(p=s.value,p instanceof d?p:new d(function(I){I(p)})).then(b,m)}y((h=h.apply(a,r||[])).next())})};function N(a){return A(this,void 0,void 0,function*(){let r=performance.now();try{if(c.serviceWorker)try{return(yield(0,c.sendMessage)("GetTheConceptLocal",{id:a})).data}catch(h){console.error("GetTheConceptLocal error sw: ",h),(0,c.handleServiceWorkerException)(h)}let d=(0,c.CreateDefaultLConcept)();if(a<0){if(d=yield B.v.GetConcept(a),0==d.id){let h=yield M.G.getNodeFromTree(a);if(h?.value){let C=h.value;C&&(d=C)}}}else{let h=yield(0,c.GetTheConcept)(a);d=(0,f.F4)(h)}return d}catch(d){throw c.Logger.logError(r,"unknown","read","unknown",void 0,200,void 0,"GetTheConceptLocal",[a],"unknown",void 0),d}})}},9975:(Re,ne,_)=>{_.d(ne,{A:()=>A});var B=_(1834),M=_(9736),c=_(3077),f=function(N,a,r,d){return new(r||(r=Promise))(function(h,C){function T(y){try{m(d.next(y))}catch(s){C(s)}}function b(y){try{m(d.throw(y))}catch(s){C(s)}}function m(y){var s;y.done?h(y.value):(s=y.value,s instanceof r?s:new r(function(p){p(s)})).then(T,b)}m((d=d.apply(N,a||[])).next())})};function A(N,a,r,d,h){return f(this,arguments,void 0,function*(C,T,b,m,y,s={concepts:[],connections:[]}){var p,I,x,w;if(B.serviceWorker)try{const D=yield(0,B.sendMessage)("MakeTheConceptLocal",{referent:C,typeCharacter:T,userId:b,categoryId:m,typeId:y,actions:s});return!(null===(I=null===(p=D?.actions)||void 0===p?void 0:p.concepts)||void 0===I)&&I.length&&(s.concepts=JSON.parse(JSON.stringify(D.actions.concepts))),!(null===(w=null===(x=D?.actions)||void 0===x?void 0:x.connections)||void 0===w)&&w.length&&(s.connections=JSON.parse(JSON.stringify(D.actions.connections))),D.data}catch(D){console.error("MakeTheConceptLocal error sw: ",D),(0,B.handleServiceWorkerException)(D)}let F=yield M.v.GetConceptByCharacterAndTypeLocal(C,y),E=F;return"the"==T&&(m=1),0==E.id&&(F=yield(0,c.A)(C,T,b,m,y,4,void 0,null,s),E=F),E})}},5868:(Re,ne,_)=>{_.d(ne,{k:()=>a});var B=_(3077),M=_(8357),c=_(9736),f=_(1834),A=_(1863),N=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};function a(r,d){var h=arguments;return N(this,arguments,void 0,function*(C,T,b=!1,m,y,s=999,p=0,I={concepts:[],connections:[]}){var x,w,F,E;const D=f.Logger.logfunction("MakeTheInstanceConceptLocal",h)||{};if(f.serviceWorker){D.serviceWorker=!0;try{const G=yield(0,f.sendMessage)("MakeTheInstanceConceptLocal",{type:C,referent:T,composition:b,userId:m,accessId:y,sessionInformationId:s,referentId:p,actions:I});return!(null===(w=null===(x=G?.actions)||void 0===x?void 0:x.concepts)||void 0===w)&&w.length&&(I.concepts=JSON.parse(JSON.stringify(G.actions.concepts))),!(null===(E=null===(F=G?.actions)||void 0===F?void 0:F.connections)||void 0===E)&&E.length&&(I.connections=JSON.parse(JSON.stringify(G.actions.connections))),f.Logger.logUpdate(D),G.data}catch(G){console.error("MakeTheInstanceConceptLocal error sw: ",G),(0,A.ey)(D,"MakeTheInstanceConceptLocal",G),(0,f.handleServiceWorkerException)(G)}}try{let G,Z,W=999,z=4,P=m,$=4,K="",ge=T.length;if(K=C.startsWith("the_")?C:"the_"+C,b)G=yield(0,M.$)(C,W,m,m,I),Z=yield(0,B.A)(T,C,m,z,G.id,$,!0,p,I);else if(ge>255)G=yield(0,M.$)(K,W,P,m,I),Z=yield(0,B.A)(T,K,m,z,G.id,$,void 0,void 0,I);else{G=yield(0,M.$)(K,W,P,m,I);let ae=yield c.v.GetConceptByCharacterAndTypeLocal(T,G.id);Z=ae,0==ae.id&&0==ae.userId&&(Z=yield(0,B.A)(T,K,m,z,G.id,$,void 0,void 0,I))}return Z.type=G,f.LocalSyncData.AddConcept(Z),I.concepts.push(Z),f.Logger.logUpdate(D),Z}catch(G){throw(0,A.ey)(D,"MakeTheInstanceConceptLocal",G),G}})}},8357:(Re,ne,_)=>{_.d(ne,{$:()=>r});var B=_(3077),M=_(8064),c=_(6467),f=_(9975),A=_(1834),N=_(1863),a=function(d,h,C,T){return new(C||(C=Promise))(function(b,m){function y(I){try{p(T.next(I))}catch(x){m(x)}}function s(I){try{p(T.throw(I))}catch(x){m(x)}}function p(I){var x;I.done?b(I.value):(x=I.value,x instanceof C?x:new C(function(w){w(x)})).then(y,s)}p((T=T.apply(d,h||[])).next())})};function r(d,h,C,T){var b=arguments;return a(this,arguments,void 0,function*(m,y,s,p,I={concepts:[],connections:[]}){var x,w,F,E;const D=A.Logger.logfunction("MakeTheTypeConceptLocal",b)||{};if(A.serviceWorker){D.serviceWorker=!0;try{const Z=yield(0,A.sendMessage)("MakeTheTypeConceptLocal",{typeString:m,sessionId:y,sessionUserId:s,userId:p,actions:I});return!(null===(w=null===(x=Z?.actions)||void 0===x?void 0:x.concepts)||void 0===w)&&w.length&&(I.concepts=JSON.parse(JSON.stringify(Z.actions.concepts))),!(null===(E=null===(F=Z?.actions)||void 0===F?void 0:F.connections)||void 0===E)&&E.length&&(I.connections=JSON.parse(JSON.stringify(Z.actions.connections))),A.Logger.logUpdate(D),Z.data}catch(Z){console.error("MakeTheTypeConceptLocal error sw: ",Z),(0,N.ey)(D,"MakeTheTypeConceptLocal",Z),(0,A.handleServiceWorkerException)(Z)}}let G=yield(0,M.$I)(m);if(G&&(0==G.id||0==G.userId)){let Z=(0,c.f)(m);if(Z[0]==m)G=yield(0,f.A)(m,"the",p,1,51,I);else{let W=yield r(Z[0],y,s,p,I),z=yield r(Z[1],y,s,p,I);G=yield(0,B.A)(m,Z[1],p,W.id,z.id,4,void 0,null,I)}}return A.Logger.logUpdate(D),G})}},3729:(Re,ne,_)=>{_.d(ne,{D:()=>C});var B=_(9934),M=_(4485),c=_(2),f=_(7876),A=_(1838),N=_(999),a=_(5868),r=_(1834),d=_(176),h=function(T,b,m,y){return new(m||(m=Promise))(function(s,p){function I(F){try{w(y.next(F))}catch(E){p(E)}}function x(F){try{w(y.throw(F))}catch(E){p(E)}}function w(F){var E;F.done?s(F.value):(E=F.value,E instanceof m?E:new m(function(D){D(E)})).then(I,x)}w((y=y.apply(T,b||[])).next())})};function C(T){return h(this,arguments,void 0,function*(b,m={concepts:[],connections:[]}){var y,s,p,I;if(performance.now(),r.serviceWorker)try{const me=yield(0,r.sendMessage)("UpdateCompositionLocal",{patcherStructure:b,actions:m});return!(null===(s=null===(y=me?.actions)||void 0===y?void 0:y.concepts)||void 0===s)&&s.length&&(m.concepts=JSON.parse(JSON.stringify(me.actions.concepts))),!(null===(I=null===(p=me?.actions)||void 0===p?void 0:p.connections)||void 0===I)&&I.length&&(m.connections=JSON.parse(JSON.stringify(me.actions.connections))),me.data}catch(me){console.error("UpdateCompositionLocal error sw: ",me),(0,r.handleServiceWorkerException)(me)}const x=b.userId,w=b.sessionId,F=b.accessId;let E=[];const D=[];let G=(0,r.CreateDefaultLConcept)(),Z=(0,r.CreateDefaultLConcept)();const W=[],z=b.compositionId,P=b.ofTheCompositionId;let $=[],K=yield(0,c.s)(z);for(let me=0;me<K.length;me++)E.push((0,d.P6)(K[me]));const ge=[],ae=[];let _e=[];for(let me=0;me<E.length;me++)(0,B.A)(ae,E[me].ofTheConceptId),(0,B.A)(ge,E[me].ofTheConceptId),(0,B.A)(ge,E[me].toTheConceptId),_e.push(E[me].ofTheConceptId);for(let me=0;me<ge.length;me++){const Ee=yield(0,f.A)(ge[me]);z==ge[me]&&(G=(0,d.F4)(Ee)),P==ge[me]&&(Z=(0,d.F4)(Ee)),D.push((0,d.F4)(Ee))}const ye=b.patchObject;for(const me in ye){let Ee=(0,r.CreateDefaultLConcept)();const Ie=ye[me];let de=G;Z.id>0&&(de=Z),Array.isArray(Ie)||"object"==typeof Ie?(Ee=yield(0,a.k)(me,"",!0,G.userId,4,999,void 0,m),yield(0,N.R)(ye[me],Ee.id,Ee.userId,G.id,G.userId,4,999,void 0,m)):Ee=yield(0,a.k)(me,Ie,!1,x,F,w,void 0,m);const we=(0,M.nm)(D,Ee);for(let ke=0;ke<we.length;ke++)if(we[ke].id>0){const Oe=(0,M.gt)(E,we[ke].id);$=$.concat(Oe),W.push(we[ke])}yield(0,r.CreateTheConnectionLocal)(de.id,Ee.id,G.id,2,void 0,void 0,m),D.push(Ee)}for(let me=0;me<$.length;me++)yield(0,A.m)($[me].id);yield r.LocalSyncData.SyncDataOnline(void 0,m)})}},8407:(Re,ne,_)=>{_.d(ne,{A:()=>T});var B=_(9581),M=_(3518),c=_(1863),f=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})},A=_(4402),N=_(1834),a=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})};class r{constructor(m,y,s,p,I,x,w,F,E,D){this.id=0,this.userId=m,this.data=y,this.securityId=s,this.securityUserId=p,this.accessId=I,this.accessUserId=x,this.sessionId=w,this.sessionUserId=F,this.entryTimestamp=E,this.isNew=D}}var d=_(7282),h=_(2212),C=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})};function T(b,m){var y=arguments;return C(this,arguments,void 0,function*(s,p,I=!1,x,w=4,F=999,E=0){const D=N.Logger.logfunction("MakeTheInstanceConcept",y)||{};if(N.serviceWorker){D.serviceWorker=!0;try{const _e=yield(0,N.sendMessage)("MakeTheInstanceConcept",{type:s,referent:p,composition:I,userId:x,passedAccessId:w,passedSessionId:F,referentId:E});return N.Logger.logUpdate(D),_e.data}catch(_e){console.error("MakeTheInstanceConcept sw error: ",_e),(0,c.ey)(D,"MakeTheInstanceConcept",_e),(0,N.handleServiceWorkerException)(_e)}}let G,Z=F,W=x,z=x,P=w,$=x,K="",ge=p.length,ae=(0,d.o)();if(K=s.startsWith("the_")?s:"the_"+s,I)ae=yield(0,N.MakeTheTypeConceptApi)(s,x),G=yield(0,h.Ay)(p,x,4,ae.id,E,P,s);else if(ge>255)ae=yield(0,N.MakeTheTypeConceptApi)(K,x),G=yield(0,h.Ay)(p,x,4,ae.id,E,P,K),function(_e){f(this,void 0,void 0,function*(){try{var ye=(0,M.Xr)();const me=yield fetch(B.B.CreateTheTextDataUrl(),{method:"POST",headers:ye,body:JSON.stringify(_e)});if(!me.ok)throw(0,c.ry)(me),new Error(`Error! status: ${me.status}`);return yield me.json()}catch(me){throw me instanceof Error?console.log("Create the text error message: ",me.message):console.log("Create the text unexpected error: ",me),me}})}(new r(x,p,999,W,P,$,Z,z,Date.now().toString(),!0));else{ae=yield(0,N.MakeTheTypeConceptApi)(K,x);let _e=yield(0,A.A)(p,ae.id);G=_e,0==_e.id&&0==_e.userId&&(G=yield(0,h.N)(p,x,4,ae.id,12,P,K),function(ye,me,Ee,Ie){var de=arguments;a(this,void 0,void 0,function*(){const we=N.Logger.logfunction("MakeTheNameInBackend",de);try{let ke={newConceptId:ye,referent:me,typeId:Ee,typeUserId:Ie},Oe=(0,M.Xr)(),pt=JSON.stringify(ke);const st=yield fetch(B.B.MakeTheNameInBackendUrl(),{method:"POST",headers:Oe,body:pt});N.Logger.logUpdate(we),st.ok||(0,c.ry)(st)}catch(ke){ke instanceof Error?console.log("make the name in backend error message: ",ke.message):console.log("make the name in backend unexpected error: ",ke),(0,c.Mb)(ke,B.B.MakeTheNameInBackendUrl()),(0,c.ey)(we,"MakeTheNameInBackend",ke)}})}(G.id,`${p}`,ae.id,x))}return G.type=ae,N.Logger.logUpdate(D),G})}},5312:(Re,ne,_)=>{_.d(ne,{NK:()=>h,Ve:()=>C,cf:()=>r,vw:()=>T,y8:()=>d});var B=_(2832),M=_(3130),c=_(1834),f=_(1863),A=_(6687),N=_(7106),a=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})};function r(b){var m=arguments;return a(this,arguments,void 0,function*(y,s="",p=null,I=M.y0){var x,w,F,E,D,G,Z,W;const z=c.Logger.logfunction("SearchLinkMultipleAll",m)||{};try{try{if(c.serviceWorker){z.serviceWorker=!0;const Ee=yield(0,c.sendMessage)("SearchLinkMultipleAll",{searchQuery:y,token:s,caller:p,format:I});return c.Logger.logUpdate(z),Ee.data}}catch(Ee){console.error("SearchLinkMultipleAll error sw: ",Ee),(0,f.ey)(z,"SearchLinkMultipleAll",Ee),(0,c.handleServiceWorkerException)(Ee)}let P=[],$=[],K=[],ge=[],ae=y[0].composition,_e={},ye={};p?.isDataLoaded?(_e.compositionIds=null===(x=p.conceptIds)||void 0===x?void 0:x.slice(),_e.internalConnections=null===(w=p.internalConnections)||void 0===w?void 0:w.slice(),_e.linkers=null===(F=p.linkers)||void 0===F?void 0:F.slice(),_e.reverse=null===(E=p.reverse)||void 0===E?void 0:E.slice(),ye=_e,P=ye.compositionIds,K=ye.internalConnections,$=ye.linkers,ge=ye.reverse):(_e=yield(0,B.j)(y,s),p&&(p.conceptIds=null===(D=_e.compositionIds)||void 0===D?void 0:D.slice(),p.internalConnections=null===(G=_e.internalConnections)||void 0===G?void 0:G.slice(),p.linkers=null===(Z=_e.linkers)||void 0===Z?void 0:Z.slice(),p.reverse=null===(W=_e.reverse)||void 0===W?void 0:W.slice(),p.isDataLoaded=!0),ye=_e,P=ye.compositionIds,K=ye.internalConnections,$=ye.linkers,ge=ye.reverse);let me=yield function(Ee,Ie,de,we,ke,Oe){return a(this,arguments,void 0,function*(pt,st,Me,be,rt,Nt,Lt=M.y0){try{let Ue,yt,ze=yield(0,A.QL)(pt);return Lt==M.ZJ?(Ue=yield(0,A.MT)(st,Me),yt=yield T(pt,Ue,rt,be)):Lt==M.yv?(Ue=yield(0,A.D)(st,Me),yt=yield T(pt,Ue,rt,be)):100==Lt?(Ue=yield(0,A.nr)(st,Me),yt=yield d(ze,Ue,rt,be)):Lt==M.SL?yt=yield(0,N._W)(pt,st,Me,Nt.ofCompositions,be):(Ue=yield(0,A.rv)(st,Me),yt=yield d(ze,Ue,rt,be)),yt}catch(Ue){return void console.log("Error Occured in build layer",Ue)}})}($,P,K,ge,ae,y[0],I);return c.Logger.logUpdate(z),me}catch(P){throw console.log("this is the error in the search link multiple",P),(0,f.ey)(z,"SearchLinkMultipleAll",P),P}})}function d(b,m,y){return a(this,arguments,void 0,function*(s,p,I,x=[]){(new Date).getTime();let w={},F=[];for(let E=0;E<s.length;E++)F.push(s[E].toTheConceptId),F.push(s[E].ofTheConceptId),F.push(s[E].typeId);s.sort(function(E,D){return D.id-E.id});for(let E=0;E<s.length;E++){let D=!1;if(x.includes(s[E].id)&&(D=!0),1==D){if(p[s[E].ofTheConceptId]&&p[s[E].toTheConceptId]){let G=p[s[E].toTheConceptId],Z=yield(0,c.GetTheConcept)(s[E].typeId),W=G?.data,z=Object.keys(W)[0];try{let P=Z.characterValue+"_reverse";"string"==typeof W&&(W={}),Array.isArray(W[z][P])||("string"==typeof W[z]&&(W[z]={}),W[z][P]=[]),W[z][P].push(p[s[E].ofTheConceptId])}catch(P){console.log("this is error",P)}}}else if(p[s[E].ofTheConceptId]&&p[s[E].toTheConceptId]){let G=p[s[E].ofTheConceptId],Z=yield(0,c.GetTheConcept)(s[E].typeId),W=G?.data,z=Object.keys(W)[0];try{"string"==typeof W&&(W={}),Array.isArray(W[z][Z.characterValue])||("string"==typeof W[z]&&(W[z]={}),W[z][Z.characterValue]=[]),W[z][Z.characterValue].push(p[s[E].toTheConceptId])}catch(P){console.log("this is error",P)}}}return w=p[I],w})}function h(b,m,y){return a(this,arguments,void 0,function*(s,p,I,x=[]){let w=[],F=[];for(let E=0;E<s.length;E++)F.push(s[E].toTheConceptId),F.push(s[E].ofTheConceptId),F.push(s[E].typeId);s.sort(function(E,D){return D.id-E.id});for(let E=0;E<s.length;E++){let D=!1;if(x.includes(s[E].id)&&(D=!0),1==D){if(p[s[E].ofTheConceptId]&&p[s[E].toTheConceptId]){let G=p[s[E].toTheConceptId],Z=yield(0,c.GetTheConcept)(s[E].typeId),W=Object.keys(G)[0];try{let z=Z.characterValue+"_reverse";"string"==typeof G&&(G={}),Array.isArray(G[W][z])||("string"==typeof G[W]&&(G[W]={}),G[W][z]=[]),G[W][z].push(p[s[E].ofTheConceptId])}catch(z){console.log("this is error",z)}}}else if(p[s[E].ofTheConceptId]&&p[s[E].toTheConceptId]){let G=p[s[E].ofTheConceptId],Z=yield(0,c.GetTheConcept)(s[E].typeId),W=Object.keys(G)[0];try{"string"==typeof G&&(G={}),Array.isArray(G[W][Z.characterValue])||("string"==typeof G[W]&&(G[W]={}),G[W][Z.characterValue]=[]),G[W][Z.characterValue].push(p[s[E].toTheConceptId])}catch(z){console.log("this is error",z)}}}for(let E=0;E<I.length;E++){let D=p[I[E]];D&&w.push(D)}return w})}function C(b,m,y,s){return a(this,arguments,void 0,function*(p,I,x,w,F=[]){(new Date).getTime();let E=[],D=[];for(let G=0;G<p.length;G++)D.push(p[G].toTheConceptId),D.push(p[G].ofTheConceptId),D.push(p[G].typeId);p.sort(function(G,Z){return Z.id-G.id});for(let G=0;G<p.length;G++){let Z=!1;if(F.includes(p[G].id)&&(Z=!0),1==Z){if(I[p[G].ofTheConceptId]&&I[p[G].toTheConceptId]){let W=I[p[G].toTheConceptId],z=yield(0,c.GetTheConcept)(p[G].typeId),P=W?.data,$=Object.keys(P)[0];try{let K=z.characterValue+"_reverse";"string"==typeof P&&(P={}),Array.isArray(P[$][K])||("string"==typeof P[$]&&(P[$]={}),P[$][K]=[]),P[$][K].push(I[p[G].ofTheConceptId])}catch(K){console.log("this is error",K)}}}else if(I[p[G].ofTheConceptId]&&I[p[G].toTheConceptId]){let W=I[p[G].ofTheConceptId],z=yield(0,c.GetTheConcept)(p[G].typeId),P=W?.data,$=Object.keys(P)[0];try{"string"==typeof P&&(P={}),Array.isArray(P[$][z.characterValue])||("string"==typeof P[$]&&(P[$]={}),P[$][z.characterValue]=[]),P[$][z.characterValue].push(I[p[G].toTheConceptId])}catch(K){console.log("this is error",K)}}}for(let G=0;G<w.length;G++){let Z=I[w[G]];Z&&E.push(Z)}return E})}function T(b,m,y){return a(this,arguments,void 0,function*(s,p,I,x=[]){let w={},F=yield(0,c.GetConnectionBulk)(s),E=[];for(let D=0;D<F.length;D++)E.push(F[D].toTheConceptId),E.push(F[D].ofTheConceptId),E.push(F[D].typeId);yield(0,c.GetConceptBulk)(E),F.sort(function(D,G){return G.id-D.id});for(let D=0;D<F.length;D++){let G=!1;if(x.includes(F[D].id)&&(G=!0),1==G){if(p[F[D].ofTheConceptId]&&p[F[D].toTheConceptId]){let Z=p[F[D].toTheConceptId],W=yield(0,c.GetTheConcept)(F[D].typeId),z=Z,P=Object.keys(z)[0];try{let $=W.characterValue+"_reverse";"string"==typeof z&&(z={}),Array.isArray(z[P][$])||("string"==typeof z[P]&&(z[P]={}),z[P][$]=[]),z[P][$].push(p[F[D].ofTheConceptId])}catch($){console.log("this is error",$)}}}else if(p[F[D].ofTheConceptId]&&p[F[D].toTheConceptId]){let Z=p[F[D].ofTheConceptId],W=yield(0,c.GetTheConcept)(F[D].typeId),z=Z,P=Object.keys(z)[0];try{"string"==typeof z&&(z={}),Array.isArray(z[P][W.characterValue])||("string"==typeof z[P]&&(z[P]={}),z[P][W.characterValue]=[]),z[P][W.characterValue].push(p[F[D].toTheConceptId])}catch($){console.log("this is error",$)}}}return w=p[I],w})}},7106:(Re,ne,_)=>{_.d(ne,{zl:()=>m,b6:()=>p,e$:()=>x,y6:()=>I,yV:()=>y,_W:()=>s});var B=_(1834),M=_(6687);function c(w){return w.startsWith("the_")?w.slice(4):w}var f=function(w,F,E,D){return new(E||(E=Promise))(function(G,Z){function W($){try{P(D.next($))}catch(K){Z(K)}}function z($){try{P(D.throw($))}catch(K){Z(K)}}function P($){var K;$.done?G($.value):(K=$.value,K instanceof E?K:new E(function(ge){ge(K)})).then(W,z)}P((D=D.apply(w,F||[])).next())})};function A(w,F,E){return f(this,void 0,void 0,function*(){var D,G,Z,W,z,P,$,K;let ge=[];for(let ae=0;ae<w.length;ae++)ge.push(w[ae].toTheConceptId),ge.push(w[ae].ofTheConceptId),ge.push(w[ae].typeId);for(let ae=0;ae<w.length;ae++){let _e=!1;E.includes(w[ae].id)&&(_e=!0);let ye=yield(0,B.GetTheConcept)(w[ae].ofTheConceptId),me=yield(0,B.GetTheConcept)(w[ae].toTheConceptId);if(1==_e&&0!=ye.id&&0!=me.id){let Ee,Ie=null!==(G=null===(D=me.type)||void 0===D?void 0:D.characterValue)&&void 0!==G?G:"self";w[ae].toTheConceptId in F?Ee=F[w[ae].toTheConceptId]:(Ee={},Ee[Ie]={},F[w[ae].toTheConceptId]=Ee);let de=yield(0,B.GetTheConcept)(w[ae].typeId);try{let we=null!==(W=null===(Z=ye?.type)||void 0===Z?void 0:Z.characterValue)&&void 0!==W?W:"none",ke=ye.characterValue;de.characterValue.includes("_s_")&&(ye.id in F||(F[ye.id]={}),F[ye.id][we]=ke),F[me.id]={}}catch(we){console.log("this is error",we)}}if(0!=ye.id&&0!=me.id){let Ee,Ie=null!==(P=null===(z=ye.type)||void 0===z?void 0:z.characterValue)&&void 0!==P?P:"self";w[ae].ofTheConceptId in F?Ee=F[w[ae].ofTheConceptId]:(Ee={},Ee[Ie]={},F[w[ae].ofTheConceptId]=Ee);let de=yield(0,B.GetTheConcept)(w[ae].typeId);try{let we=null!==(K=null===($=me?.type)||void 0===$?void 0:$.characterValue)&&void 0!==K?K:"none",ke=me.characterValue;de.characterValue.includes("_s_")&&(me.id in F||(F[me.id]={}),F[me.id][we]=ke),F[ye.id]={}}catch(we){console.log("this is error",we)}}}return F})}var N=_(5312),a=_(7876),r=function(w,F,E,D){return new(E||(E=Promise))(function(G,Z){function W($){try{P(D.next($))}catch(K){Z(K)}}function z($){try{P(D.throw($))}catch(K){Z(K)}}function P($){var K;$.done?G($.value):(K=$.value,K instanceof E?K:new E(function(ge){ge(K)})).then(W,z)}P((D=D.apply(w,F||[])).next())})};function d(w,F,E){if(w in F){let D=F[w];D&&(E[D.connectionType+"_count"]=D.count)}}var h=function(w,F,E,D){return new(E||(E=Promise))(function(G,Z){function W($){try{P(D.next($))}catch(K){Z(K)}}function z($){try{P(D.throw($))}catch(K){Z(K)}}function P($){var K;$.done?G($.value):(K=$.value,K instanceof E?K:new E(function(ge){ge(K)})).then(W,z)}P((D=D.apply(w,F||[])).next())})},C=_(5898);function T(w,F="DESC"){return w.sort("ASC"==F?function(E,D){return E.id-D.id}:function(E,D){return D.id-E.id}),w}var b=function(w,F,E,D){return new(E||(E=Promise))(function(G,Z){function W($){try{P(D.next($))}catch(K){Z(K)}}function z($){try{P(D.throw($))}catch(K){Z(K)}}function P($){var K;$.done?G($.value):(K=$.value,K instanceof E?K:new E(function(ge){ge(K)})).then(W,z)}P((D=D.apply(w,F||[])).next())})};function m(w,F){return b(this,arguments,void 0,function*(E,D,G=""){let Z=yield(0,B.SearchWithTypeAndLinkerApi)(E,D,G),W=Z.compositionIds,z=Z.internalConnections,P=Z.linkers,$=Z.reverse,K=Z.mainCompositionIds,ge=yield(0,M.QL)(P),ae=yield(0,M.MT)(W,z);return yield(0,N.NK)(ge,ae,K,$)})}function y(w,F,E,D,G){return b(this,void 0,void 0,function*(){let Z=yield(0,M.QL)(w),W=yield(0,M.rv)(F,E);return yield(0,N.Ve)(Z,W,F,D,G)})}function s(w,F,E,D,G){return b(this,void 0,void 0,function*(){let Z=yield(0,M.QL)(w),W=yield(0,M.D)(F,E);return yield(0,N.NK)(Z,W,D,G)})}function p(w,F,E,D,G){return b(this,void 0,void 0,function*(){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("formatConnections",{linkers:w,conceptIds:F,mainCompositionIds:E,reverse:D,countInfos:G})).data}catch(P){console.error("formatConnections error sw: ",P),(0,B.handleServiceWorkerException)(P)}let Z=yield(0,M.QL)(w);Z=T(Z);let W=[];return W=yield A(Z,W,D),W=yield function(P,$,K){return f(this,void 0,void 0,function*(){var ge,ae,_e,ye,me,Ee,Ie,de;let we=[];for(let ke=0;ke<P.length;ke++)we.push(P[ke].toTheConceptId),we.push(P[ke].ofTheConceptId),we.push(P[ke].typeId);P.sort(function(ke,Oe){return Oe.id-ke.id});for(let ke=0;ke<P.length;ke++){let Oe=!1;K.includes(P[ke].id)&&(Oe=!0);let pt=yield(0,B.GetTheConcept)(P[ke].ofTheConceptId),st=yield(0,B.GetTheConcept)(P[ke].toTheConceptId);if(1==Oe&&0!=pt.id&&0!=st.id){let Me,be=null!==(ae=null===(ge=st.type)||void 0===ge?void 0:ge.characterValue)&&void 0!==ae?ae:"self";P[ke].toTheConceptId in $?(Me=$[P[ke].toTheConceptId],be in Me||(Me[be]={})):(Me={},Me[be]={},$[P[ke].toTheConceptId]=Me);let rt=yield(0,B.GetTheConcept)(P[ke].typeId);try{let Nt=null!==(ye=null===(_e=pt?.type)||void 0===_e?void 0:_e.characterValue)&&void 0!==ye?ye:"none",Lt=pt.characterValue,Ue=rt.characterValue;""==Ue&&(Ue=Nt,Ue=c(Ue));let yt={[Nt]:Lt},ze=Ue+"_reverse";rt.characterValue.includes("_s_")||("string"==typeof Me[be]&&(Me[be]={}),Me[be][ze]=yt)}catch(Nt){console.log("this is error",Nt)}}if(0!=pt.id&&0!=st.id){let Me,be=null!==(Ee=null===(me=pt.type)||void 0===me?void 0:me.characterValue)&&void 0!==Ee?Ee:"self";P[ke].ofTheConceptId in $?(Me=$[P[ke].ofTheConceptId],be in Me||(Me[be]={})):(Me={},Me[be]={},$[P[ke].ofTheConceptId]=Me);let rt=yield(0,B.GetTheConcept)(P[ke].typeId);try{let Nt=null!==(de=null===(Ie=st?.type)||void 0===Ie?void 0:Ie.characterValue)&&void 0!==de?de:"none",Lt=st.characterValue,Ue=rt.characterValue,yt=!1;""==Ue&&(Ue=Nt,Ue=c(Ue),yt=!0);let ze={[Nt]:Lt};isNaN(Number(Ue))?rt.characterValue.includes("_s_")||("string"==typeof Me[be]&&(Me[be]={}),Me[be][Ue]=yt?Lt:ze):(Array.isArray(Me[be])||(Me[be]=[]),Me[be].push(Lt))}catch(Nt){console.log("this is error",Nt)}}}return $})}(Z,W,D),yield function(P,$,K,ge){return f(this,arguments,void 0,function*(ae,_e,ye,me,Ee=[]){var Ie,de,we,ke,Oe,pt;let st=[],Me=[];for(let be=0;be<ae.length;be++)Me.push(ae[be].toTheConceptId),Me.push(ae[be].ofTheConceptId),Me.push(ae[be].typeId);ae.sort(function(be,rt){return rt.id-be.id});for(let be=0;be<ae.length;be++){let rt=!1;Ee.includes(ae[be].id)&&(rt=!0);let Nt=yield(0,B.GetTheConcept)(ae[be].ofTheConceptId),Lt=yield(0,B.GetTheConcept)(ae[be].toTheConceptId);if(1==rt&&0!=Nt.id&&0!=Lt.id&&Lt.id in _e){let Ue,yt=null!==(de=null===(Ie=Lt.type)||void 0===Ie?void 0:Ie.characterValue)&&void 0!==de?de:"self";ae[be].toTheConceptId in _e?Ue=_e[ae[be].toTheConceptId]:(Ue={},Ue[yt]={},_e[ae[be].toTheConceptId]=Ue);let ze=yield(0,B.GetTheConcept)(ae[be].typeId);try{let qe=ze.characterValue+"_reverse",We=_e[ae[be].ofTheConceptId];We&&(Array.isArray(Ue[yt][qe])?Ue[yt][qe].push(We):ze.characterValue.includes("_s_")?(Ue[yt][qe]=[],Ue[yt][qe].push(We)):Ue[yt][qe]=We)}catch(qe){console.log("this is error",qe)}}if(0!=Nt.id&&0!=Lt.id&&Nt.id in _e){let Ue,yt=null!==(ke=null===(we=Nt.type)||void 0===we?void 0:we.characterValue)&&void 0!==ke?ke:"self";ae[be].ofTheConceptId in _e?(Ue=_e[ae[be].ofTheConceptId],"string"==typeof Ue[yt]&&(Ue[yt]={})):(Ue={},Ue[yt]={},_e[ae[be].ofTheConceptId]=Ue);let ze=!1,qe=(yield(0,B.GetTheConcept)(ae[be].typeId)).characterValue;""==qe&&(qe=Lt.characterValue,ze=!0),""==qe&&(qe=null!==(pt=null===(Oe=Lt?.type)||void 0===Oe?void 0:Oe.characterValue)&&void 0!==pt?pt:"");try{let We=_e[ae[be].toTheConceptId];We&&(Array.isArray(Ue[yt])?Ue[yt].push(ze?We[qe]:We):Array.isArray(Ue[yt][qe])?Ue[yt][qe].push(We):qe.includes("_s_")?(Ue[yt][qe]=[],Ue[yt][qe].push(ze?We[qe]:We)):Ue[yt][qe]=ze?We[qe]:We)}catch(We){console.log("this is error",We)}}}for(let be=0;be<ye.length;be++){let rt=_e[ye[be]];rt?(rt.id=ye[be],st.push(rt)):0!=(yield B.ConceptsData.GetConcept(ye[be])).id&&(rt={},rt.id=ye[be],st.push(rt))}return st})}(Z,W,E,[],D)})}function I(w,F,E,D,G){return b(this,arguments,void 0,function*(Z,W,z,P,$,K="DESC"){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("formatConnectionsJustId",{linkers:Z,conceptIds:W,mainCompositionIds:z,reverse:P,countInfos:$,order:K})).data}catch(me){console.error("formatConnectionsJustId error sw: ",me),(0,B.handleServiceWorkerException)(me)}let ge=yield(0,M.QL)(Z),ae=yield(0,C.V)($);ge=T(ge,K);let _e=[];return _e=yield A(ge,_e,P),_e=yield function(me,Ee){return r(this,arguments,void 0,function*(Ie,de,we=[]){var ke,Oe,pt,st,Me,be,rt,Nt;let Lt=[];for(let Ue=0;Ue<Ie.length;Ue++)Lt.push(Ie[Ue].toTheConceptId),Lt.push(Ie[Ue].ofTheConceptId),Lt.push(Ie[Ue].typeId);for(let Ue=0;Ue<Ie.length;Ue++){let yt=!1,ze=yield(0,a.A)(Ie[Ue].ofTheConceptId),qe=yield(0,a.A)(Ie[Ue].toTheConceptId);if(we.includes(Ie[Ue].id)&&(yt=!0),1==yt&&0!=ze.id&&0!=qe.id){let We,At=yield(0,a.A)(Ie[Ue].typeId),Ne=null!==(Oe=null===(ke=qe.type)||void 0===ke?void 0:ke.characterValue)&&void 0!==Oe?Oe:"self";Ie[Ue].toTheConceptId in de?(We=de[Ie[Ue].toTheConceptId],Ne in We||(We[Ne]={})):(We={},We[Ne]={},de[Ie[Ue].toTheConceptId]=We);try{let Ke=null!==(st=null===(pt=ze?.type)||void 0===pt?void 0:pt.characterValue)&&void 0!==st?st:"none",kt=ze.characterValue,Ye=At.characterValue;""==Ye&&(Ye=Ke,Ye=c(Ye));let Ct={id:ze.id,[Ke]:kt,created_on:Ie[Ue].entryTimeStamp},St=Ye+"_reverse";St.includes("_s_")||("string"==typeof We[Ne]&&(We[Ne]={}),We[Ne][St]=Ct)}catch(Ke){console.log("this is error",Ke)}}if(0!=ze.id&&0!=qe.id){let We,At=yield(0,a.A)(Ie[Ue].typeId),Ne=null!==(be=null===(Me=ze.type)||void 0===Me?void 0:Me.characterValue)&&void 0!==be?be:"self";Ie[Ue].ofTheConceptId in de?(We=de[Ie[Ue].ofTheConceptId],Ne in We||(We[Ne]={})):(We={},We[Ne]={},de[Ie[Ue].ofTheConceptId]=We);try{let Ke=null!==(Nt=null===(rt=qe?.type)||void 0===rt?void 0:rt.characterValue)&&void 0!==Nt?Nt:"none",kt=qe.characterValue,Ye=At.characterValue,Ct=!1;""==Ye&&(Ye=Ke,Ye=c(Ye),Ct=!0);let St={};St[Ke]={id:qe.id,data:kt,created_on:Ie[Ue].entryTimeStamp},isNaN(Number(Ye))?Ye.includes("_s_")||("string"==typeof We[Ne]&&(We[Ne]={}),We[Ne][Ye]=Ct?St[Ke]:St):(Array.isArray(We[Ne])||(We[Ne]=[]),We[Ne].push(St[Ke]))}catch(Ke){console.log("this is error",Ke)}}}return de})}(ge,_e,P),yield function(me,Ee,Ie){return r(this,arguments,void 0,function*(de,we,ke,Oe=[],pt){var st,Me,be,rt,Nt,Lt,Ue;(new Date).getTime();let yt=[],ze=[];for(let qe=0;qe<de.length;qe++)ze.push(de[qe].toTheConceptId),ze.push(de[qe].ofTheConceptId),ze.push(de[qe].typeId);for(let qe=0;qe<de.length;qe++){let We=!1,At=yield(0,a.A)(de[qe].ofTheConceptId),Ne=yield(0,a.A)(de[qe].toTheConceptId);if(Oe.includes(de[qe].id)&&(We=!0),1==We&&0!=At.id&&0!=Ne.id&&Ne.id in we){let Ke,kt=yield(0,a.A)(de[qe].typeId),Ye=null!==(Me=null===(st=Ne.type)||void 0===st?void 0:st.characterValue)&&void 0!==Me?Me:"self",Ct=!1;de[qe].toTheConceptId in we&&(Ct=!0),de[qe].toTheConceptId in we?(Ke=we[de[qe].toTheConceptId],"string"==typeof Ke[Ye]&&(Ke[Ye]={})):(Ke={},Ke[Ye]={},we[de[qe].toTheConceptId]=Ke);try{if(we[de[qe].ofTheConceptId]){let St=we[de[qe].ofTheConceptId];St&&(St.id=At.id,St.created_on=At.entryTimeStamp);let Tt=kt.characterValue+"_reverse";Array.isArray(Ke[Ye][Tt])?Ke[Ye][Tt].push(St):Tt.includes("_s_")?(Ke[Ye][Tt]=[],Ke[Ye][Tt].push(St)):Ke[Ye][Tt]=St}}catch(St){console.log("this is error",St)}}if(0!=At.id&&0!=Ne.id&&At.id in we){let Ke,kt=yield(0,a.A)(de[qe].typeId),Ye=null!==(rt=null===(be=At.type)||void 0===be?void 0:be.characterValue)&&void 0!==rt?rt:"self",Ct=!1;de[qe].toTheConceptId in we&&(Ct=!0),de[qe].ofTheConceptId in we?(Ke=we[de[qe].ofTheConceptId],"string"==typeof Ke[Ye]&&(Ke[Ye]={})):(Ke={},Ke[Ye]={},we[de[qe].ofTheConceptId]=Ke),d(At.id,pt,Ke);let St=!1,Tt=kt.characterValue;""==Tt&&(Tt=Ne.characterValue,St=!0),""==Tt&&(Tt=(null===(Nt=Ne?.type)||void 0===Nt?void 0:Nt.characterValue)||"");try{let ln=null!==(Ue=null===(Lt=Ne?.type)||void 0===Lt?void 0:Lt.characterValue)&&void 0!==Ue?Ue:"none",mn=we[de[qe].toTheConceptId];if(mn){let qt={};qt[ln]={data:mn[ln],id:Ne.id,created_on:de[qe].entryTimeStamp},Array.isArray(Ke[Ye])?Ke[Ye].push(St?mn[Tt]:mn):Array.isArray(Ke[Ye][Tt])?Ke[Ye][Tt].push(qt):Tt.includes("_s_")?(Ke[Ye][Tt]=[],Ke[Ye][Tt].push(St?qt[ln]:qt)):Ke[Ye][Tt]=St?qt[ln]:qt,d(Ne.id,pt,qt)}}catch(ln){console.log("this is error",ln)}}}for(let qe=0;qe<ke.length;qe++){let We={};We=we[ke[qe]],We?We.id=ke[qe]:0!=(yield B.ConceptsData.GetConcept(ke[qe])).id&&(We={},We.id=ke[qe]),yt.push(We)}return yt})}(ge,_e,z,P,ae)})}function x(w,F,E,D,G){return b(this,arguments,void 0,function*(Z,W,z,P,$,K="DESC"){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("formatConnectionsDataId",{linkers:Z,conceptIds:W,mainCompositionIds:z,reverse:P,countInfos:$,order:K})).data}catch(me){console.error("GetConnectionDataPrefetch error sw: ",me),(0,B.handleServiceWorkerException)(me)}let ge=yield(0,M.QL)(Z),ae=yield(0,C.V)($);ge=T(ge,K);let _e=[];return _e=yield function(me,Ee){var Ie=arguments;return h(this,arguments,void 0,function*(de,we,ke=[]){var Oe,pt,st,Me,be,rt,Nt,Lt;const Ue=B.Logger.logfunction("FormatFunctionData",Ie);let yt=[];for(let ze=0;ze<de.length;ze++)yt.push(de[ze].toTheConceptId),yt.push(de[ze].ofTheConceptId),yt.push(de[ze].typeId);for(let ze=0;ze<de.length;ze++){let qe=!1,We=yield(0,B.GetTheConcept)(de[ze].ofTheConceptId),At=yield(0,B.GetTheConcept)(de[ze].toTheConceptId);if(ke.includes(de[ze].id)&&(qe=!0),1==qe&&0!=We.id&&0!=At.id){let Ne,Ke=yield(0,B.GetTheConcept)(de[ze].typeId),kt=null!==(pt=null===(Oe=At.type)||void 0===Oe?void 0:Oe.characterValue)&&void 0!==pt?pt:"self";de[ze].toTheConceptId in we?Ne=we[de[ze].toTheConceptId]:(Ne={},Ne[kt]={},we[de[ze].toTheConceptId]=Ne);try{let Ye=null!==(Me=null===(st=We?.type)||void 0===st?void 0:st.characterValue)&&void 0!==Me?Me:"none",Ct=We.characterValue;(Ke.characterValue+"_reverse").includes("_s_")&&(We.id in we||(we[We.id]={}),we[We.id][Ye]=Ct),we[At.id]={}}catch(Ye){console.log("this is error",Ye)}}if(0!=We.id&&0!=At.id){let Ne,Ke=yield(0,B.GetTheConcept)(de[ze].typeId),kt=null!==(rt=null===(be=We.type)||void 0===be?void 0:be.characterValue)&&void 0!==rt?rt:"self";de[ze].ofTheConceptId in we?Ne=we[de[ze].ofTheConceptId]:(Ne={},Ne[kt]={},we[de[ze].ofTheConceptId]=Ne);try{let Ye=null!==(Lt=null===(Nt=At?.type)||void 0===Nt?void 0:Nt.characterValue)&&void 0!==Lt?Lt:"none",Ct=At.characterValue;Ke.characterValue.includes("_s_")&&(At.id in we||(we[At.id]={}),we[At.id][Ye]=Ct),we[We.id]={}}catch(Ye){console.log("this is error",Ye)}}}return B.Logger.logUpdate(Ue),we})}(ge,_e,P),_e=yield function(me,Ee){var Ie=arguments;return h(this,arguments,void 0,function*(de,we,ke=[]){var Oe,pt,st,Me,be,rt,Nt,Lt;const Ue=B.Logger.logfunction("FormatFunctionDataForData",Ie);let yt=[];for(let ze=0;ze<de.length;ze++)yt.push(de[ze].toTheConceptId),yt.push(de[ze].ofTheConceptId),yt.push(de[ze].typeId);for(let ze=0;ze<de.length;ze++){let qe=!1,We=yield(0,B.GetTheConcept)(de[ze].ofTheConceptId),At=yield(0,B.GetTheConcept)(de[ze].toTheConceptId);if(ke.includes(de[ze].id)&&(qe=!0),1==qe&&0!=We.id&&0!=At.id){let Ne,Ke=yield(0,B.GetTheConcept)(de[ze].typeId),kt=null!==(pt=null===(Oe=At.type)||void 0===Oe?void 0:Oe.characterValue)&&void 0!==pt?pt:"self";de[ze].toTheConceptId in we?(Ne=we[de[ze].toTheConceptId],kt in Ne||(Ne[kt]={})):(Ne={},Ne[kt]={},we[de[ze].toTheConceptId]=Ne);try{let Ye=null!==(Me=null===(st=We?.type)||void 0===st?void 0:st.characterValue)&&void 0!==Me?Me:"none",Ct=We.characterValue,St=Ke.characterValue;""==St&&(St=Ye,St=c(St));let Tt={id:We.id,data:{[Ye]:Ct}},ln=St+"_reverse";ln.includes("_s_")||("string"==typeof Ne[kt]&&(Ne[kt]={}),Ne[kt][ln]=Tt)}catch(Ye){console.log("this is error",Ye)}}if(0!=We.id&&0!=At.id){let Ne,Ke=yield(0,B.GetTheConcept)(de[ze].typeId),kt=null!==(rt=null===(be=We.type)||void 0===be?void 0:be.characterValue)&&void 0!==rt?rt:"self";de[ze].ofTheConceptId in we?(Ne=we[de[ze].ofTheConceptId],kt in Ne||(Ne[kt]={})):(Ne={},Ne[kt]={},we[de[ze].ofTheConceptId]=Ne);try{let Ye=null!==(Lt=null===(Nt=At?.type)||void 0===Nt?void 0:Nt.characterValue)&&void 0!==Lt?Lt:"none",Ct=At.characterValue,St=Ke.characterValue,Tt=!1;""==St&&(St=Ye,St=c(St),Tt=!0);let ln={id:At.id,data:{[Ye]:Ct}};isNaN(Number(St))?St.includes("_s_")||("string"==typeof Ne[kt]&&(Ne[kt]={}),Ne[kt][St]=ln):(Array.isArray(Ne[kt])||(Ne[kt]=[]),Ne[kt].push(ln))}catch(Ye){console.log("this is error",Ye)}}}return B.Logger.logUpdate(Ue),we})}(ge,_e,P),yield function(me,Ee,Ie,de){var we=arguments;return h(this,arguments,void 0,function*(ke,Oe,pt,st,Me=[],be){var rt,Nt,Lt,Ue,yt;const qe=B.Logger.logfunction("FormatFromConnectionsAlteredArrayExternal",we);let We=[],At=[];for(let Ne=0;Ne<ke.length;Ne++)At.push(ke[Ne].toTheConceptId),At.push(ke[Ne].ofTheConceptId),At.push(ke[Ne].typeId);for(let Ne=0;Ne<ke.length;Ne++){let Ke=!1,kt=yield(0,B.GetTheConcept)(ke[Ne].ofTheConceptId),Ye=yield(0,B.GetTheConcept)(ke[Ne].toTheConceptId);if(Me.includes(ke[Ne].id)&&(Ke=!0),1==Ke&&0!=kt.id&&0!=Ye.id&&Ye.id in Oe){let Ct,St=yield(0,B.GetTheConcept)(ke[Ne].typeId),Tt=null!==(Nt=null===(rt=Ye.type)||void 0===rt?void 0:rt.characterValue)&&void 0!==Nt?Nt:"self",ln=!1;ke[Ne].toTheConceptId in Oe&&(ln=!0),ke[Ne].toTheConceptId in Oe?(Ct=Oe[ke[Ne].toTheConceptId],"string"==typeof Ct[Tt]&&(Ct[Tt]={})):(Ct={},Ct[Tt]={},Oe[ke[Ne].toTheConceptId]=Ct);try{if(Oe[ke[Ne].ofTheConceptId]){let mn={id:kt.id,data:Oe[ke[Ne].ofTheConceptId],created_on:ke[Ne].entryTimeStamp},qt=St.characterValue+"_reverse";Array.isArray(Ct[Tt][qt])?Ct[Tt][qt].push(mn):qt.includes("_s_")?(Ct[Tt][qt]=[],Ct[Tt][qt].push(mn)):Ct[Tt][qt]=mn}}catch(mn){console.log("this is error",mn)}}if(0!=kt.id&&0!=Ye.id&&kt.id in Oe){let Ct,St=yield(0,B.GetTheConcept)(ke[Ne].typeId),Tt=null!==(Ue=null===(Lt=kt.type)||void 0===Lt?void 0:Lt.characterValue)&&void 0!==Ue?Ue:"self",ln=!1;ke[Ne].toTheConceptId in Oe&&(ln=!0),ke[Ne].ofTheConceptId in Oe?(Ct=Oe[ke[Ne].ofTheConceptId],"string"==typeof Ct[Tt]&&(Ct[Tt]={})):(Ct={},Ct[Tt]={},Oe[ke[Ne].ofTheConceptId]=Ct),d(kt.id,be,Ct);let mn=!0,qt=St.characterValue;""==qt&&(qt=Ye.characterValue,mn=!0),""==qt&&(qt=(null===(yt=Ye?.type)||void 0===yt?void 0:yt.characterValue)||"");try{let Zn=Oe[ke[Ne].toTheConceptId];if(Zn){let io={id:Ye.id,data:Oe[ke[Ne].toTheConceptId],created_on:ke[Ne].entryTimeStamp};Array.isArray(Ct[Tt])?Ct[Tt].push(Zn):Array.isArray(Ct[Tt][qt])?Ct[Tt][St.characterValue].push(io):qt.includes("_s_")?(Ct[Tt][qt]=[],Ct[Tt][qt].push(io)):Ct[Tt][qt]=io,d(Ye.id,be,io)}}catch(Zn){console.log("this is error",Zn)}}}for(let Ne=0;Ne<st.length;Ne++){let Ke={};Ke.id=st[Ne];let kt=yield(0,B.GetTheConcept)(Ke.id);Ke.data=Oe[st[Ne]],Ke.created_on=kt.entryTimeStamp,We.push(Ke)}return B.Logger.logUpdate(qe),We})}(ge,_e,[],z,P,ae)})}},3518:(Re,ne,_)=>{_.d(ne,{BZ:()=>f,Xr:()=>M,ab:()=>c});var B=_(3278);function M(A="application/json",N="application/json"){let a={};return a=""!=B.b.BearerAccessToken?{"Content-Type":A,Authorization:"Bearer "+B.b.BearerAccessToken,Accept:N}:{"Content-Type":A,Accept:N},a}function c(A="application/json",N="",a="application/json"){""==N&&(N=B.b.BearerAccessToken);let r={};return r=""!=N?{"Content-Type":A,Authorization:"Bearer "+N,Accept:a}:{"Content-Type":A,Accept:a},r}function f(){let A=B.b.BearerAccessToken;const N=new Headers;return N.append("Authorization","Bearer "+A),N}},6467:(Re,ne,_)=>{function B(M){const c=M.lastIndexOf("_");let f=[];return f=c>0?[M.substring(0,c),M.substring(c+1,M.length)]:[M],f}_.d(ne,{f:()=>B})},1596:(Re,ne,_)=>{_.d(ne,{g:()=>c});var B=_(1834),M=function(f,A,N,a){return new(N||(N=Promise))(function(r,d){function h(b){try{T(a.next(b))}catch(m){d(m)}}function C(b){try{T(a.throw(b))}catch(m){d(m)}}function T(b){var m;b.done?r(b.value):(m=b.value,m instanceof N?m:new N(function(y){y(m)})).then(h,C)}T((a=a.apply(f,A||[])).next())})};function c(f,A){return M(this,void 0,void 0,function*(){if(typeof self<"u"&&typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope)throw new Error("Cannot switch server from service worker");try{!function(){const N=B.BaseUrl.NODE_CACHE_URL;if(N===B.BaseUrl.BASE_URL)throw new Error("Base Server Down");let a=sessionStorage.getItem("cacheServers");a=JSON.parse(a);const r=a.indexOf(N);a.includes(N)&&-1!==r&&a.splice(r,1),sessionStorage.setItem("cacheServers",JSON.stringify(a)),B.BaseUrl.NODE_CACHE_URL=a.length?a[0]:B.BaseUrl.BASE_URL,navigator.serviceWorker&&navigator.serviceWorker.controller&&(0,B.sendMessage)("SESSION_DATA",{type:"SESSION_DATA",data:B.BaseUrl.NODE_CACHE_URL})}();try{return yield fetch(`${B.BaseUrl.NODE_CACHE_URL}${A}`,f)}catch{return yield c(f,A)}}catch(N){throw N}})}},4310:(Re,ne,_)=>{_.d(ne,{Cp:()=>h,ix:()=>T,qj:()=>C});var B=_(1834),M=_(1596),c=_(5898),f=_(1863),A=_(7106),N=_(3518),a=function(b,m,y,s){return new(y||(y=Promise))(function(p,I){function x(E){try{F(s.next(E))}catch(D){I(D)}}function w(E){try{F(s.throw(E))}catch(D){I(D)}}function F(E){var D;E.done?p(E.value):(D=E.value,D instanceof y?D:new y(function(G){G(D)})).then(x,w)}F((s=s.apply(b,m||[])).next())})};const r=new Map,d=new Map;function h(b){var m=arguments;return a(this,void 0,void 0,function*(){B.Logger.logfunction("BuildWidgetFromId",m);try{if(B.serviceWorker)return(yield(0,B.sendMessage)("BuildWidgetFromId",{id:b})).data}catch(p){console.error("BuildWidgetFromId error sw: ",p),(0,B.handleServiceWorkerException)(p)}let y={};if(r.has(b))return r.get(b)||y;const s=(()=>a(this,void 0,void 0,function*(){try{let p=[],I=[],x=[],w=[],F="DESC",E=[],D={},G=(0,N.Xr)("application/json"),Z=B.BaseUrl.getWidgetData()+"?id="+b;const W=yield fetch(Z,{method:"GET",headers:G});if(!W.ok)return(0,f.ry)(W),console.log("This is the BuildWidgetFromId error",W.status),[];D=yield W.json(),p=D.conceptIds,I=D.linkers,x=D.reverse,w=D.mainCompositionIds,E=D.countinfo;let z=(0,c.w)(E);return y=yield(0,A.e$)(I,p,w,x,z,F),y}catch(p){throw console.log("this is the error in the build widget",p),p}finally{r.delete(b)}}))();return r.set(b,s),s})}function C(b){var m=arguments;return a(this,void 0,void 0,function*(){B.Logger.logfunction("BuildWidgetFromIdForLatest",m);try{if(B.serviceWorker)return(yield(0,B.sendMessage)("BuildWidgetFromIdForLatest",{id:b})).data}catch(p){console.error("BuildWidgetFromIdForLatest error sw: ",p),(0,B.handleServiceWorkerException)(p)}let y={};if(d.has(b))return d.get(b)||y;const s=(()=>a(this,void 0,void 0,function*(){try{let p,I=[],x=[],w=[],F=[],E="DESC",D=[],G={},Z=(0,N.Xr)("application/json");try{let z=B.BaseUrl.getLatestWidgetData()+"?id="+b;p=yield fetch(z,{method:"GET",headers:Z})}catch{p=yield(0,M.g)({method:"GET",headers:Z},"?id="+b)}if(!p.ok)return(0,f.ry)(p),console.log("This is the BuildWidgetFromId error",p.status),[];G=yield p.json(),I=G.conceptIds,x=G.linkers,w=G.reverse,F=G.mainCompositionIds,D=G.countinfo;let W=(0,c.w)(D);return y=yield(0,A.e$)(x,I,F,w,W,E),{data:y,mainId:G.mainId}}catch(p){throw console.log("this is the error in the build widget",p),p}finally{d.delete(b)}}))();return d.set(b,s),s})}function T(b,m){for(let y=0;y<b.length;y++)if(b[y].id==m)return b[y]}},4287:(Re,ne,_)=>{_.d(ne,{w:()=>f});var B=_(1834),M=_(3130),c=function(A,N,a,r){return new(a||(a=Promise))(function(d,h){function C(m){try{b(r.next(m))}catch(y){h(y)}}function T(m){try{b(r.throw(m))}catch(y){h(y)}}function b(m){var y;m.done?d(m.value):(y=m.value,y instanceof a?y:new a(function(s){s(y)})).then(C,T)}b((r=r.apply(A,N||[])).next())})};class f{constructor(){this.subscribers=[],this.mainConcept=0,this.compositionIds=[],this.conceptIds=[],this.internalConnections=[],this.reverse=[],this.linkers=[],this.newIds=[],this.dependency=[],this.isDataLoaded=!1,this.isUpdating=!1,this.fetched=!1,this.format=M.yv,this.eventHandlers={}}listenToEventType(N){if(this.eventHandlers[N])return;const a=r=>c(this,void 0,void 0,function*(){if(this.isUpdating)console.log("rejected this",N);else{this.isUpdating=!0;let d=this;setTimeout(function(){return c(this,void 0,void 0,function*(){let h=r;if(!d.compositionIds.includes(h?.detail)){d.compositionIds.unshift(h?.detail),d.listenToEvent(h?.detail);let C=h?.detail,T=yield B.ConnectionData.GetConnectionByOfTheConceptAndType(C,C);for(let b=0;b<T.length;b++)yield B.ConnectionData.GetConnection(T[b]).then(m=>{m.typeId==d.mainConcept?d.internalConnections.includes(m.id)||d.internalConnections.push(m.id):d.linkers.includes(m.id)||d.linkers.push(m.id),d.conceptIds.includes(m.toTheConceptId)||d.conceptIds.push(m.toTheConceptId),d.compositionIds.includes(m.ofTheConceptId)||d.compositionIds.push(m.ofTheConceptId)})}d.isUpdating=!1,yield d.bind(),d.notify()})},200)}});this.eventHandlers[N]=a,console.log("added listener",N),window.addEventListener(`${N}`,a)}listenToEvent(N){if(this.eventHandlers[N])return;const a=r=>c(this,void 0,void 0,function*(){if(this.isUpdating)console.log("rejected this",N);else{this.isUpdating=!0;let d=this;setTimeout(function(){return c(this,void 0,void 0,function*(){let h=yield B.ConnectionData.GetConnectionByOfTheConceptAndType(N,N);for(let C=0;C<h.length;C++)yield B.ConnectionData.GetConnection(h[C]).then(T=>{T.typeId==d.mainConcept?d.internalConnections.includes(T.id)||d.internalConnections.push(T.id):d.linkers.includes(T.id)||d.linkers.push(T.id),d.conceptIds.includes(T.toTheConceptId)||d.conceptIds.push(T.toTheConceptId),d.compositionIds.includes(T.ofTheConceptId)||(d.compositionIds.push(T.ofTheConceptId),d.newIds.includes(T.ofTheConceptId)||d.newIds.push(T.ofTheConceptId))});d.isUpdating=!1,yield d.bind(),d.notify()})},200)}});this.eventHandlers[N]=a,window.addEventListener(`${N}`,a)}removeListenToEvent(N){const a=this.eventHandlers[N];a&&(window.removeEventListener(`${N}`,a),delete this.eventHandlers[N])}listenToEventConnectionType(N,a){window.addEventListener(`${N}`,r=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let d=this;setTimeout(function(){return c(this,void 0,void 0,function*(){let h=yield B.ConnectionData.GetConnectionByOfTheConceptAndType(N,N);for(let C=0;C<h.length;C++)h.typeId==a&&(yield B.ConnectionData.GetConnection(h[C]).then(T=>{T.typeId==d.mainConcept?d.internalConnections.includes(T.id)||d.internalConnections.push(T.id):d.linkers.includes(T.id)||d.linkers.push(T.id),d.conceptIds.includes(T.toTheConceptId)||d.conceptIds.push(T.toTheConceptId),d.compositionIds.includes(T.ofTheConceptId)||d.compositionIds.push(T.ofTheConceptId)}));d.isUpdating=!1,yield d.bind(),d.notify()})},200)}})}bind(){return c(this,void 0,void 0,function*(){console.log("this is the old execute data")})}run(){return c(this,void 0,void 0,function*(){console.log("this is non subscriber data")})}update(){return c(this,void 0,void 0,function*(){this.isDataLoaded=!1,yield this.bind(),this.notify()})}subscribe(N){return c(this,void 0,void 0,function*(){return this.subscribers.push(N),console.log("again executing data"),yield this.bind(),N(this.data,this)})}execute(){return c(this,void 0,void 0,function*(){return yield this.run()})}unsubscribe(N){return this.subscribers.filter(a=>a!=N),this.subscribers.length}notify(){console.log("notifiers",this.subscribers),this.subscribers.map(N=>{console.log("notify"),N(this.data,this)})}}},5328:(Re,ne,_)=>{_.d(ne,{d:()=>a});var B=_(1834),M=_(3130),c=_(8939),f=_(4287),A=function(r,d,h,C){return new(h||(h=Promise))(function(T,b){function m(p){try{s(C.next(p))}catch(I){b(I)}}function y(p){try{s(C.throw(p))}catch(I){b(I)}}function s(p){var I;p.done?T(p.value):(I=p.value,I instanceof h?I:new h(function(x){x(I)})).then(m,y)}s((C=C.apply(r,d||[])).next())})};class N extends f.w{constructor(d,h,C,T,b){super(),this.connections=[],this.data=[],this.mainConcept=d,this.linker=h,this.inpage=C,this.page=T,this.format=b}bind(){return A(this,void 0,void 0,function*(){var d;if(!this.isDataLoaded){let T=yield(0,B.GetTheConcept)(this.mainConcept),b=(null===(d=T.type)||void 0===d?void 0:d.characterValue)+"_s_"+this.linker,m=yield(0,B.GetConceptByCharacterAndType)(b,16);if(m.id>0){let y=yield(0,B.GetConnectionOfTheConcept)(m.id,T.id,T.userId,this.inpage,this.page);this.connections=y;for(var h=[],C=0;C<this.connections.length;C++)h.push(this.connections[C].toTheConceptId),this.linkers.push(this.connections[C].id),this.listenToEvent(this.connections[C].toTheConceptId);yield(0,B.GetAllConnectionsOfCompositionBulk)(h)}this.isDataLoaded=!0,this.listenToEvent(this.mainConcept)}return yield this.build()})}build(){return A(this,void 0,void 0,function*(){this.data=[],this.connections=yield(0,B.GetConnectionBulk)(this.linkers);for(var d=0;d<this.connections.length;d++){let h=this.connections[d].toTheConceptId,C=yield(0,B.GetTheConcept)(h);if(console.log("this is the format",this.format),this.format==M.yv){let T=yield(0,c.RW)(C.id);this.data.push(T)}else if(this.format==M.ZJ){let T=yield(0,c.kx)(C.id);this.data.push(T)}else if(this.format==M.iw){let T=yield(0,B.GetCompositionWithIdAndDateFromMemory)(C.id);this.data.push(T)}else{let T=yield(0,B.GetCompositionWithIdAndDateFromMemory)(C.id);this.data.push(T)}}return this.data})}}function a(r,d,h,C,T=M.yv){return new N(r,d,h,C,T)}},1834:(Re,ne,_)=>{_.r(ne),_.d(ne,{ADMIN:()=>jr,ALLID:()=>Et.BG,AccessTracker:()=>Eo.J,AddGhostConcept:()=>Br,Anomaly:()=>Yt,BaseUrl:()=>a.B,BinaryTree:()=>ci.W,BuildWidgetFromId:()=>Lo.Cp,BuilderStatefulWidget:()=>Ro,Composition:()=>Do,CompositionBinaryTree:()=>co,CompositionNode:()=>vi,Concept:()=>ta.j,ConceptsData:()=>N.I,Connection:()=>Ie.N,ConnectionData:()=>In.d,CreateComposition:()=>_e.A,CreateConnection:()=>jn.d,CreateConnectionBetweenEntityLocal:()=>Gi,CreateConnectionBetweenTwoConcepts:()=>Lt,CreateConnectionBetweenTwoConceptsGeneral:()=>yt,CreateConnectionBetweenTwoConceptsLocal:()=>Ai.h,CreateData:()=>Yo,CreateDefaultConcept:()=>we.o,CreateDefaultLConcept:()=>Ti.u,CreateSession:()=>Ar,CreateSessionVisit:()=>Lr,CreateTheCompositionLocal:()=>ye.R,CreateTheCompositionWithCache:()=>Go,CreateTheConnection:()=>Ke.q,CreateTheConnectionGeneral:()=>st,CreateTheConnectionLocal:()=>jn.F,DATAID:()=>Et.y0,DATAIDDATE:()=>Et.iw,DelayFunctionExecution:()=>$r,DeleteConceptById:()=>si,DeleteConceptLocal:()=>Pr,DeleteConnectionById:()=>Me.m,DeleteConnectionByType:()=>ga,DeleteUser:()=>or,DependencyObserver:()=>to.w,FilterSearch:()=>zo,FormatFromConnections:()=>so.vw,FormatFromConnectionsAltered:()=>so.y8,FreeschemaQuery:()=>En,FreeschemaQueryApi:()=>Qo,GetAllConnectionsOfComposition:()=>ae.s,GetAllConnectionsOfCompositionBulk:()=>T.Y,GetAllTheConnectionsByTypeAndOfTheConcept:()=>va,GetComposition:()=>m.Nj,GetCompositionBulk:()=>on.dF,GetCompositionBulkWithDataId:()=>on.cw,GetCompositionFromConnectionsWithDataId:()=>on.p8,GetCompositionFromConnectionsWithDataIdFromConnections:()=>on.km,GetCompositionFromConnectionsWithDataIdInObject:()=>on.rv,GetCompositionFromConnectionsWithDataIdIndex:()=>on.Nt,GetCompositionFromConnectionsWithIndex:()=>on.as,GetCompositionFromConnectionsWithIndexFromConnections:()=>on.hG,GetCompositionFromMemoryWithConnections:()=>m.JA,GetCompositionList:()=>I,GetCompositionListAll:()=>x,GetCompositionListAllWithId:()=>w,GetCompositionListListener:()=>Kr,GetCompositionListLocal:()=>K,GetCompositionListLocalWithId:()=>ge,GetCompositionListWithId:()=>F,GetCompositionListWithIdUpdated:()=>E,GetCompositionListener:()=>Zr,GetCompositionLocal:()=>W,GetCompositionLocalWithId:()=>z,GetCompositionWithAllIds:()=>m.Mb,GetCompositionWithCache:()=>wr,GetCompositionWithDataIdBulk:()=>kr,GetCompositionWithDataIdWithCache:()=>Ci,GetCompositionWithId:()=>m.yz,GetCompositionWithIdAndDateFromMemory:()=>m.Ez,GetConceptBulk:()=>Io.r,GetConceptByCharacter:()=>y.A,GetConceptByCharacterAndCategoryLocal:()=>s.$I,GetConceptByCharacterAndType:()=>kt.A,GetConnectionBetweenTwoConceptsLinker:()=>Vr,GetConnectionBulk:()=>jo.j,GetConnectionById:()=>ar,GetConnectionDataPrefetch:()=>on.QL,GetConnectionOfTheConcept:()=>Ee,GetLink:()=>Ct,GetLinkListListener:()=>ea,GetLinkListener:()=>Yr.d,GetLinkRaw:()=>St,GetLinkerConnectionFromConcepts:()=>er,GetLinkerConnectionToConcepts:()=>tr,GetRelation:()=>_i,GetRelationLocal:()=>Gr,GetRelationRaw:()=>xr,GetTheConcept:()=>be.A,GetTheConceptLocal:()=>Ii.f,GetUserGhostId:()=>Er,JUSTDATA:()=>Et.ZJ,LConcept:()=>na,LConnection:()=>oa,LISTNORMAL:()=>Et.SL,LocalConceptsData:()=>b.v,LocalSyncData:()=>bo.H,LocalTransaction:()=>Fi,Logger:()=>Ce.V,LoginToBackend:()=>pr,MakeTheInstanceConcept:()=>rt.A,MakeTheInstanceConceptLocal:()=>ze.k,MakeTheTimestamp:()=>cr,MakeTheTypeConceptApi:()=>ro,MakeTheTypeConceptLocal:()=>Tt.$,NORMAL:()=>Et.yv,PRIVATE:()=>Hr,PUBLIC:()=>qr,PatcherStructure:()=>ia,Prototype:()=>xa,RAW:()=>Et.XZ,RecursiveSearchApi:()=>sr,RecursiveSearchApiNewRawFullLinker:()=>ur,RecursiveSearchApiRaw:()=>li,RecursiveSearchApiRawFullLinker:()=>dr,RecursiveSearchApiWithInternalConnections:()=>lr,RecursiveSearchListener:()=>Xr,SchemaQuery:()=>Ca,SchemaQueryListener:()=>Oo,SearchAllConcepts:()=>Cr,SearchLinkInternal:()=>Or,SearchLinkInternalAll:()=>Mr,SearchLinkMultipleAll:()=>so.cf,SearchLinkMultipleAllObservable:()=>Ni,SearchLinkMultipleApi:()=>f.j,SearchQuery:()=>ao,SearchStructure:()=>aa,SearchWithLinker:()=>_r,SearchWithTypeAndLinker:()=>lo.zl,SearchWithTypeAndLinkerApi:()=>Li,Selector:()=>_a,SessionData:()=>ra,Signin:()=>gr,Signup:()=>fr,SignupEntity:()=>yr,SplitStrings:()=>A.f,StatefulWidget:()=>Zo,SyncData:()=>de.Y,TrashTheConcept:()=>ir,UpdateComposition:()=>mr,UpdateCompositionLocal:()=>Dr.D,UserBinaryTree:()=>qo,Validator:()=>pa,ViewInternalData:()=>bi,ViewInternalDataApi:()=>ki,WidgetTree:()=>Di,convertFromConceptToLConcept:()=>Jo.F4,convertFromLConceptToConcept:()=>Jo.dp,convertWidgetTreeToWidget:()=>Ko,convertWidgetTreeToWidgetWithWrapper:()=>Oi,createFormFieldData:()=>fa,createPrototypeLocal:()=>Pi,dispatchIdEvent:()=>Ua,getFromDatabaseWithType:()=>At,getObjectsFromIndexDb:()=>Ne,getWidgetBulkFromId:()=>Mo,getWidgetFromId:()=>ba,handleServiceWorkerException:()=>Wt,hasActivatedSW:()=>Vi,init:()=>Da,recursiveFetch:()=>m.zN,recursiveFetchNew:()=>ko,removeAllChildren:()=>Ui,renderLatestWidget:()=>Ia,renderPage:()=>wa,renderWidget:()=>Ri,searchLinkMultipleListener:()=>Jr,sendEmail:()=>ua,sendMessage:()=>Bt,serviceWorker:()=>wt,setHasActivatedSW:()=>Ba,storeToDatabase:()=>We,subscribedListeners:()=>Wi,unwrapContainers:()=>Mi,updateAccessToken:()=>$i,uploadAttachment:()=>hr,uploadFile:()=>fi,uploadImage:()=>pi,validDocumentFormats:()=>hi,validImageFormats:()=>ui});var B={};_.r(B),_.d(B,{ADMIN:()=>jr,ALLID:()=>Et.BG,AccessTracker:()=>Eo.J,AddGhostConcept:()=>Br,Anomaly:()=>Yt,BaseUrl:()=>a.B,BinaryTree:()=>ci.W,BuildWidgetFromId:()=>Lo.Cp,BuilderStatefulWidget:()=>Ro,Composition:()=>Do,CompositionBinaryTree:()=>co,CompositionNode:()=>vi,Concept:()=>ta.j,ConceptsData:()=>N.I,Connection:()=>Ie.N,ConnectionData:()=>In.d,CreateComposition:()=>_e.A,CreateConnection:()=>jn.d,CreateConnectionBetweenEntityLocal:()=>Gi,CreateConnectionBetweenTwoConcepts:()=>Lt,CreateConnectionBetweenTwoConceptsGeneral:()=>yt,CreateConnectionBetweenTwoConceptsLocal:()=>Ai.h,CreateData:()=>Yo,CreateDefaultConcept:()=>we.o,CreateDefaultLConcept:()=>Ti.u,CreateSession:()=>Ar,CreateSessionVisit:()=>Lr,CreateTheCompositionLocal:()=>ye.R,CreateTheCompositionWithCache:()=>Go,CreateTheConnection:()=>Ke.q,CreateTheConnectionGeneral:()=>st,CreateTheConnectionLocal:()=>jn.F,DATAID:()=>Et.y0,DATAIDDATE:()=>Et.iw,DelayFunctionExecution:()=>$r,DeleteConceptById:()=>si,DeleteConceptLocal:()=>Pr,DeleteConnectionById:()=>Me.m,DeleteConnectionByType:()=>ga,DeleteUser:()=>or,DependencyObserver:()=>to.w,FilterSearch:()=>zo,FormatFromConnections:()=>so.vw,FormatFromConnectionsAltered:()=>so.y8,FreeschemaQuery:()=>En,FreeschemaQueryApi:()=>Qo,GetAllConnectionsOfComposition:()=>ae.s,GetAllConnectionsOfCompositionBulk:()=>T.Y,GetAllTheConnectionsByTypeAndOfTheConcept:()=>va,GetComposition:()=>m.Nj,GetCompositionBulk:()=>on.dF,GetCompositionBulkWithDataId:()=>on.cw,GetCompositionFromConnectionsWithDataId:()=>on.p8,GetCompositionFromConnectionsWithDataIdFromConnections:()=>on.km,GetCompositionFromConnectionsWithDataIdInObject:()=>on.rv,GetCompositionFromConnectionsWithDataIdIndex:()=>on.Nt,GetCompositionFromConnectionsWithIndex:()=>on.as,GetCompositionFromConnectionsWithIndexFromConnections:()=>on.hG,GetCompositionFromMemoryWithConnections:()=>m.JA,GetCompositionList:()=>I,GetCompositionListAll:()=>x,GetCompositionListAllWithId:()=>w,GetCompositionListListener:()=>Kr,GetCompositionListLocal:()=>K,GetCompositionListLocalWithId:()=>ge,GetCompositionListWithId:()=>F,GetCompositionListWithIdUpdated:()=>E,GetCompositionListener:()=>Zr,GetCompositionLocal:()=>W,GetCompositionLocalWithId:()=>z,GetCompositionWithAllIds:()=>m.Mb,GetCompositionWithCache:()=>wr,GetCompositionWithDataIdBulk:()=>kr,GetCompositionWithDataIdWithCache:()=>Ci,GetCompositionWithId:()=>m.yz,GetCompositionWithIdAndDateFromMemory:()=>m.Ez,GetConceptBulk:()=>Io.r,GetConceptByCharacter:()=>y.A,GetConceptByCharacterAndCategoryLocal:()=>s.$I,GetConceptByCharacterAndType:()=>kt.A,GetConnectionBetweenTwoConceptsLinker:()=>Vr,GetConnectionBulk:()=>jo.j,GetConnectionById:()=>ar,GetConnectionDataPrefetch:()=>on.QL,GetConnectionOfTheConcept:()=>Ee,GetLink:()=>Ct,GetLinkListListener:()=>ea,GetLinkListener:()=>Yr.d,GetLinkRaw:()=>St,GetLinkerConnectionFromConcepts:()=>er,GetLinkerConnectionToConcepts:()=>tr,GetRelation:()=>_i,GetRelationLocal:()=>Gr,GetRelationRaw:()=>xr,GetTheConcept:()=>be.A,GetTheConceptLocal:()=>Ii.f,GetUserGhostId:()=>Er,JUSTDATA:()=>Et.ZJ,LConcept:()=>na,LConnection:()=>oa,LISTNORMAL:()=>Et.SL,LocalConceptsData:()=>b.v,LocalSyncData:()=>bo.H,LocalTransaction:()=>Fi,Logger:()=>Ce.V,LoginToBackend:()=>pr,MakeTheInstanceConcept:()=>rt.A,MakeTheInstanceConceptLocal:()=>ze.k,MakeTheTimestamp:()=>cr,MakeTheTypeConceptApi:()=>ro,MakeTheTypeConceptLocal:()=>Tt.$,NORMAL:()=>Et.yv,PRIVATE:()=>Hr,PUBLIC:()=>qr,PatcherStructure:()=>ia,Prototype:()=>xa,RAW:()=>Et.XZ,RecursiveSearchApi:()=>sr,RecursiveSearchApiNewRawFullLinker:()=>ur,RecursiveSearchApiRaw:()=>li,RecursiveSearchApiRawFullLinker:()=>dr,RecursiveSearchApiWithInternalConnections:()=>lr,RecursiveSearchListener:()=>Xr,SchemaQuery:()=>Ca,SchemaQueryListener:()=>Oo,SearchAllConcepts:()=>Cr,SearchLinkInternal:()=>Or,SearchLinkInternalAll:()=>Mr,SearchLinkMultipleAll:()=>so.cf,SearchLinkMultipleAllObservable:()=>Ni,SearchLinkMultipleApi:()=>f.j,SearchQuery:()=>ao,SearchStructure:()=>aa,SearchWithLinker:()=>_r,SearchWithTypeAndLinker:()=>lo.zl,SearchWithTypeAndLinkerApi:()=>Li,Selector:()=>_a,SessionData:()=>ra,Signin:()=>gr,Signup:()=>fr,SignupEntity:()=>yr,SplitStrings:()=>A.f,StatefulWidget:()=>Zo,SyncData:()=>de.Y,TrashTheConcept:()=>ir,UpdateComposition:()=>mr,UpdateCompositionLocal:()=>Dr.D,UserBinaryTree:()=>qo,Validator:()=>pa,ViewInternalData:()=>bi,ViewInternalDataApi:()=>ki,WidgetTree:()=>Di,convertFromConceptToLConcept:()=>Jo.F4,convertFromLConceptToConcept:()=>Jo.dp,convertWidgetTreeToWidget:()=>Ko,convertWidgetTreeToWidgetWithWrapper:()=>Oi,createFormFieldData:()=>fa,createPrototypeLocal:()=>Pi,dispatchIdEvent:()=>Ua,getFromDatabaseWithType:()=>At,getObjectsFromIndexDb:()=>Ne,getWidgetBulkFromId:()=>Mo,getWidgetFromId:()=>ba,handleServiceWorkerException:()=>Wt,hasActivatedSW:()=>Vi,init:()=>Da,recursiveFetch:()=>m.zN,recursiveFetchNew:()=>ko,removeAllChildren:()=>Ui,renderLatestWidget:()=>Ia,renderPage:()=>wa,renderWidget:()=>Ri,searchLinkMultipleListener:()=>Jr,sendEmail:()=>ua,sendMessage:()=>Bt,serviceWorker:()=>wt,setHasActivatedSW:()=>Ba,storeToDatabase:()=>We,subscribedListeners:()=>Wi,unwrapContainers:()=>Mi,updateAccessToken:()=>$i,uploadAttachment:()=>hr,uploadFile:()=>fi,uploadImage:()=>pi,validDocumentFormats:()=>hi,validImageFormats:()=>ui});var M=_(5020),c=_(205),f=_(2832),A=_(6467),N=_(9639),a=_(9581),r=_(3518),d=_(1863),h=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function C(k,o){var e=arguments;return h(this,void 0,void 0,function*(){const t=Ce.V.logfunction("GetAllConceptsByType",e);try{var l=new URLSearchParams;l.append("type",k),l.append("user_id",o.toString());var u=(0,r.Xr)("application/x-www-form-urlencoded");const L=yield fetch(a.B.GetAllConceptsByTypeUrl(),{method:"POST",headers:u,body:l});if(L.ok){const g=yield L.json();for(var v=0;v<g.length;v++)N.I.AddConcept(g[v])}else console.log("GetAllConceptsByType error",L.status),(0,d.ry)(L)}catch(L){L instanceof Error?console.log("GetAllConceptsByType error message: ",L.message):console.log("GetAllConceptsByType unexpected error: ",L),(0,d.Mb)(L,a.B.GetAllConceptsByTypeUrl()),(0,d.ey)(t,"GetAllConceptsByType",L)}})}var T=_(8642),b=_(9736),m=_(8939),y=_(2013),s=_(8064),p=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function I(k,o){var e=arguments;return p(this,arguments,void 0,function*(t,l,u=10,v=1){const L=Ce.V.logfunction("GetCompositionList",e)||{};if(wt){L.serviceWorker=!0;try{const n=yield Bt("GetCompositionList",{compositionName:t,userId:l,inpage:u,page:v});return Ce.V.logUpdate(L),n.data}catch(n){console.error("GetCompositionList sw error: ",n),(0,d.ey)(L,"GetCompositionList",n),Wt(n)}}let g=yield(0,y.A)(t),i=[];if(g){yield C(t,l);let n=yield N.I.GetConceptsByTypeIdAndUser(g.id,l),S=u*(v-1),R=[];for(let Q=S;Q<S+u;Q++)n[Q]&&R.push(n[Q].id);yield(0,T.Y)(R);for(let Q=S;Q<S+u;Q++)if(n[Q]){let V=yield(0,m.kx)(n[Q].id);i.push(V)}}return Ce.V.logUpdate(L),i})}function x(k,o){return p(this,arguments,void 0,function*(e,t,l=10,u=1){let v=K(e,t),L=I(e,t),g=[];return Promise.race([v,L]).then(i=>{console.log("Promise result",i),g.push(...i)}).catch(i=>{console.log("error in handling",i)}),L.then(i=>{console.log("This is the second promise result",i),g.push(...i)}),g})}function w(k,o){return p(this,arguments,void 0,function*(e,t,l=10,u=1){if(wt)try{return(yield Bt("GetCompositionListAllWithId",{compositionName:e,userId:t,inpage:l,page:u})).data}catch(Q){console.error("GetCompositionListAllWithId sw error: ",Q),Wt(Q)}let v=yield(0,s.Ay)(e),L=yield(0,y.A)(e),g=[],i=[],n=[],S=[];0!=v.id&&(i=yield b.v.GetConceptsByTypeIdAndUser(v.id,t)),0!=L.id&&(yield C(e,t),S=yield N.I.GetConceptsByTypeIdAndUser(L.id,t),g=S);for(let Q=0;Q<i.length;Q++){let V=!1;for(let te=0;te<S.length;te++)i[Q].ghostId==S[te].ghostId&&(V=!0);V||n.push(i[Q])}console.log("This is the all list",n);let R=[];return R=yield function(Q,V){return p(this,arguments,void 0,function*(te,Te,Be=10,Xe=1){let xe=[],ut=Be*(Xe-1),xt=[],$t=Te.length;for(let Zt=ut;Zt<ut+Be-$t;Zt++)te[Zt]&&xt.push(te[Zt].id);for(let Zt=0;Zt<Te.length;Zt++){let tn=yield z(Te[Zt].id);xe.push(tn)}yield(0,T.Y)(xt);for(let Zt=ut;Zt<ut+Be-$t;Zt++)if(te[Zt]){let tn=yield(0,m.RW)(te[Zt].id);xe.push(tn)}return xe})}(g,n,l,u),R})}function F(k,o){return p(this,arguments,void 0,function*(e,t,l=10,u=1){if(wt)try{return(yield Bt("GetCompositionListWithId",{compositionName:e,userId:t,inpage:l,page:u})).data}catch(g){console.error("GetCompositionListWithId sw error: ",g),Wt(g)}let v=yield(0,y.A)(e),L=[];if(v){yield C(e,t);let g=yield N.I.GetConceptsByTypeIdAndUser(v.id,t),i=l*(u-1),n=[];for(let S=i;S<i+l;S++)g[S]&&n.push(g[S].id);yield(0,T.Y)(n);for(let S=i;S<i+l;S++)if(g[S]){let R=yield(0,m.RW)(g[S].id);L.push(R)}}return L})}function E(k,o){return p(this,arguments,void 0,function*(e,t,l=10,u=1){let v=yield(0,y.w)(e),L=[];if(v){yield C(e,t);let g=yield N.I.GetConceptsByTypeIdAndUser(v.id,t),i=l*(u-1),n=[];for(let S=i;S<i+l;S++)g[S]&&n.push(g[S].id);yield(0,T.Y)(n);for(let S=i;S<i+l;S++)if(g[S]){let R=yield(0,m.RW)(g[S].id);L.push(R)}}return L})}var D=_(4864),G=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},Z=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function W(k){return Z(this,void 0,void 0,function*(){var o,e;try{if(wt)try{return(yield Bt("GetCompositionLocal",{id:k})).data}catch(g){console.error("GetCompositionLocal error sw: ",g),Wt(g)}let t=[],l={};t=yield D.G.GetConnectionsOfCompositionLocal(k);let u=[];for(let g=0;g<t.length;g++)u.includes(t[g].ofTheConceptId)||u.push(t[g].ofTheConceptId);let v=yield b.v.GetConcept(k);if(0==v.id){let g=yield function(i){var n=arguments;return G(this,void 0,void 0,function*(){const S=Ce.V.logfunction("TranslateLocalToReal",n);let R=(0,we.o)();try{var Q=(0,r.ab)("application/x-www-form-urlencoded");const V=yield fetch(a.B.GetRealConceptById(),{method:"POST",headers:Q,body:`id=${i}`});if(V.ok)return R=yield V.json(),R.id>0&&N.I.AddConcept(R),R;console.log("Error in Getting Translating concept Error",V.status),(0,d.ry)(V),Ce.V.logUpdate(S)}catch(V){V instanceof Error?console.log("Error in Getting Translating concept error message: ",V):console.log("Error in Getting Translating concept unexpected error: ",V),(0,d.Mb)(V,a.B.GetRealConceptById()),(0,d.ey)(S,"TranslateLocalToReal",V)}return R})}(k);if(g.id>0)return yield(0,m.Nj)(g.id)}let L=yield P(k,t,u);return l[null!==(e=null===(o=v?.type)||void 0===o?void 0:o.characterValue)&&void 0!==e?e:"top"]=L,l}catch(t){throw t}})}function z(k){return Z(this,void 0,void 0,function*(){var o,e;try{if(wt)try{return(yield Bt("GetCompositionLocalWithId",{id:k})).data}catch(g){console.error("GetCompositionLocalWithId error sw: ",g),Wt(g)}let t=[],l={},u={};t=yield D.G.GetConnectionsOfCompositionLocal(k);let v=[];for(let g=0;g<t.length;g++)v.includes(t[g].ofTheConceptId)||v.push(t[g].ofTheConceptId);let L=yield b.v.GetConcept(k);if(0!=L.id){let g=yield P(k,t,v);l[null!==(e=null===(o=L?.type)||void 0===o?void 0:o.characterValue)&&void 0!==e?e:"top"]=g}return u.data=l,u.id=k,u}catch(t){throw t}})}function P(k,o,e){return Z(this,arguments,void 0,function*(t,l,u,v=[]){var g,i;let n={},S=[],R=yield b.v.GetConcept(t);if(0!=R.id&&null==R.type){let Q=R.typeId,V=yield b.v.GetConcept(Q);R.type=V}if(!u.includes(t))return R?.characterValue;if(v.includes(t))return"";v.push(t);for(let Q=0;Q<l.length;Q++)if(l[Q].ofTheConceptId==t){let V=l[Q].toTheConceptId,te=yield b.v.GetConcept(V);if(0!=te.id&&null==te?.type){let Xe=te.typeId,xe=yield b.v.GetConcept(Xe);te.type=xe}let Be=(null!==(i=null===(g=te?.type)||void 0===g?void 0:g.characterValue)&&void 0!==i?i:"top").replace("the_","");if(isNaN(Number(Be))){if(Be){const Xe=yield P(V,l,u);n[Be]=Xe}}else{const Xe=yield P(V,l,u);S[Be]=Xe,n=S}}return n})}var $=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function K(k,o){return $(this,void 0,void 0,function*(){if(wt)try{return(yield Bt("GetCompositionListLocal",{compositionName:k,userId:o})).data}catch(e){console.error("GetCompositionListLocal error sw: ",e),Wt(e)}try{let e=yield(0,s.Ay)(k),t=[];if(0!=e.id){let l=yield b.v.GetConceptsByTypeIdAndUser(e.id,o);for(let u=0;u<l.length;u++){let v=yield W(l[u].id);t.push(v)}}return t}catch(e){throw e}})}function ge(k,o){return $(this,void 0,void 0,function*(){if(wt)try{return(yield Bt("GetCompositionListLocalWithId",{compositionName:k,userId:o})).data}catch(e){console.error("GetCompositionListLocalWithId error sw: ",e),Wt(e)}try{let e=yield(0,s.Ay)(k),t=[];if(0!=e.id){let l=yield b.v.GetConceptsByTypeIdAndUser(e.id,o);for(let u=0;u<l.length;u++){let v=yield z(l[u].id);t.push(v)}}return t}catch(e){throw e}})}var ae=_(2),_e=_(1218),ye=_(999),me=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Ee(k,o,e){var t=arguments;return me(this,arguments,void 0,function*(l,u,v,L=10,g=1){const i=Ce.V.logfunction("GetConnectionOfTheConcept",t)||{};let n=[];try{if(wt){i.serviceWorker=!0;try{const V=yield Bt("GetConnectionOfTheConcept",{typeId:l,ofTheConceptId:u,userId:v,inpage:L,page:g});return Ce.V.logUpdate(i),V.data}catch(V){console.error("GetConnectionOfTheConcept sw error: ",V),(0,d.ey)(i,"GetConnectionOfTheConcept",V),Wt(V)}}let S=new URLSearchParams;S.append("typeId",`${l}`),S.append("ofTheConceptId",`${u}`),S.append("userId",`${v}`),S.append("inpage",`${L}`),S.append("page",`${g}`);let R=(0,r.Xr)("application/x-www-form-urlencoded");const Q=yield fetch(a.B.GetAllConnectionsOfConceptUrl(),{method:"POST",headers:R,body:S});return Q.ok?n=yield Q.json():((0,d.ey)(i,"GetConnectionOfTheConcept",Q.status),(0,d.ry)(Q),console.log("Get connection of concept error",Q.status)),Ce.V.logUpdate(i),n}catch(S){S instanceof Error?console.log("Get connection of concept  error message: ",S.message):console.log("Get connection of concept unexpected error: ",S),(0,d.Mb)(S,a.B.GetAllConnectionsOfConceptUrl()),(0,d.ey)(i,"GetConnectionOfTheConcept",S)}})}var Ie=_(2155),de=_(442),we=_(7282),ke=_(5976),Oe=_(7273),pt=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function st(k,o,e,t){return pt(this,arguments,void 0,function*(l,u,v,L,g=1,i=4){if(l>0&&v>0){var n=u,S=yield ke.p.getId(),R=new Ie.N(S,l,v,n,L,g,i);return l==v?(R.ofTheConceptId=0,R.toTheConceptId=1,R):(R.toUpdate=!0,R.isTemp=!1,de.Y.AddConnection(R),R)}throw new Oe.z("cannot create connection because id are negative ",!1,400,"")})}var Me=_(1838),be=_(7876),rt=_(8407),Nt=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Lt(k,o,e){return Nt(this,arguments,void 0,function*(t,l,u,v=!1,L=!1){var g,i;if(wt)try{return(yield Bt("CreateConnectionBetweenTwoConcepts",{ofTheConcept:t,toTheConcept:l,linker:u,both:v,count:L})).data}catch(te){console.error("CreateConnectionBetweenTwoConcepts sw error: ",te),Wt(te)}let n=t.userId;if(v){let te=u+"_by",Te=(null===(g=l.type)||void 0===g?void 0:g.characterValue)+"_s_"+te;L&&(yield Ue(te,l,n));let Be=yield(0,rt.A)("connection",Te,!1,999,999,999),Xe=new Ie.N(0,l.id,t.id,n,Be.id,1e3,4);de.Y.AddConnection(Xe)}let S=u+"_s",R=(null===(i=t.type)||void 0===i?void 0:i.characterValue)+"_s_"+S;L&&(yield Ue(S,t,n));let Q=yield(0,rt.A)("connection",R,!1,999,999,999),V=new Ie.N(0,t.id,l.id,n,Q.id,1e3,4);return de.Y.AddConnection(V),V})}function Ue(k,o){return Nt(this,arguments,void 0,function*(e,t,l=null){var u;let v=t,L=l??t.userId,i=(null===(u=t.type)||void 0===u?void 0:u.characterValue)+"_s_"+e+"_count",n=yield(0,rt.A)("connection",i,!1,L,4,999),S=yield Ee(n.id,t.id,L,10,1),R=[],Q=(0,we.o)();for(let te=0;te<S.length;te++){let Te=yield(0,be.A)(S[te].toTheConceptId);R.push(Te)}if(R.length<1)Q=yield(0,rt.A)("count","1",!1,L,4,999);else{let te=R[0],Te=0;try{Te=Number(te.characterValue)}catch{Te=0}Te+=1,Q=yield(0,rt.A)("count",Te.toString(),!1,L,4,999);for(let Be=0;Be<S.length;Be++)(0,Me.m)(S[Be].id)}let V=new Ie.N(0,v.id,Q.id,v.userId,n.id,1e3,4);yield de.Y.AddConnection(V)})}function yt(k,o,e){return Nt(this,arguments,void 0,function*(t,l,u,v=!1,L=!1){var g,i;let n=t.userId;if(v){let V=u+"_by",te=(null===(g=l.type)||void 0===g?void 0:g.characterValue)+"_s_"+V;L&&(yield Ue(V,l,n));let Te=yield(0,rt.A)("connection",te,!1,999,999,999),Be=new Ie.N(0,l.id,t.id,n,Te.id,1e3,4);de.Y.AddConnection(Be)}let S=u+"_s",R=(null===(i=t.type)||void 0===i?void 0:i.characterValue)+"_s_"+S;L&&(yield Ue(S,t,n));let Q=yield(0,rt.A)("connection",R,!1,999,999,999);return yield st(t.id,t.userId,l.id,Q.id,1e3,4)})}var ze=_(5868),qe=(_(3655),function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})});function We(k,o){const e=Ce.V.logfunction("storeToDatabase",[k,"noindexdb"]);Ce.V.logUpdate(e)}function At(k,o,e){return qe(this,void 0,void 0,function*(){const t=Ce.V.logfunction("getFromDatabaseWithType",[k,"noindexdb"]);Ce.V.logUpdate(t)})}function Ne(k){return qe(this,void 0,void 0,function*(){const o=Ce.V.logfunction("getObjectsFromIndexDb",[k,"noindexdb"]);Ce.V.logUpdate(o)})}var Ke=_(1666),kt=_(4402),Ye=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Ct(k,o){var e=arguments;return Ye(this,arguments,void 0,function*(t,l,u=10,v=1){var L;const g=Ce.V.logfunction("GetLink",e)||{};if(wt){g.serviceWorker=!0;try{const Q=yield Bt("GetLink",{id:t,linker:l,inpage:u,page:v});return Ce.V.logUpdate(g),Q.data}catch(Q){console.error("GetLink sw error: ",Q),(0,d.ey)(g,"GetLink",Q),Wt(Q)}}let i=[],n=yield(0,be.A)(t),S=(null===(L=n.type)||void 0===L?void 0:L.characterValue)+"_s_"+l,R=yield(0,kt.A)(S,16);if(R.id>0){let Q=yield Ee(R.id,n.id,n.userId,u,v),V=[];for(let te=0;te<Q.length;te++)V.push(Q[te].toTheConceptId);yield(0,T.Y)(V);for(let te=0;te<Q.length;te++){let Te=Q[te].toTheConceptId,Be=yield(0,be.A)(Te),Xe=yield(0,m.Ez)(Be.id);i.push(Xe)}}return Ce.V.logUpdate(g),i})}function St(k,o){var e=arguments;return Ye(this,arguments,void 0,function*(t,l,u=10,v=1){var L;const g=Ce.V.logfunction("GetLinkRaw",e);let i=[],n=yield(0,be.A)(t),S=(null===(L=n.type)||void 0===L?void 0:L.characterValue)+"_s_"+l,R=yield(0,kt.A)(S,16);if(R.id>0){let Q=yield Ee(R.id,n.id,n.userId,u,v),V=[];for(let te=0;te<Q.length;te++)V.push(Q[te].toTheConceptId);for(let te=0;te<Q.length;te++){let Te=Q[te].toTheConceptId,Be=yield(0,be.A)(Te);i.push(Be)}}return Ce.V.logUpdate(g),i})}var Tt=_(8357),ln=_(8146),mn=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},qt=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Zn(k){return qt(this,void 0,void 0,function*(){const o=Ce.V.logfunction("GetConceptByCharacterAndCategory",k);let e=(0,we.o)();if("the"==k)return e.id=1,e.typeId=5,e.characterValue="the",e;let t=(0,A.f)(k);if(t.length>1){let l=1,u=yield Zn(t[0]);0!=u.id&&(l=u.id),e=yield function(v,L){var g=arguments;return qt(this,void 0,void 0,function*(){const i=Ce.V.logfunction("GetConceptByCharacterAndCategoryFromMemory",g);let n=yield N.I.GetConceptByCharacterAndCategoryLocal(v,L);return 0==n.id&&(n=yield function(S,R){var Q=arguments;return mn(this,void 0,void 0,function*(){const V=Ce.V.logfunction("GetConceptByCharacterAndCategoryDirectApi",Q);let te=(0,we.o)();try{var Te=(0,r.Xr)("application/x-www-form-urlencoded");const Be=yield fetch(a.B.GetConceptByCharacterAndCategoryDirectUrl(),{method:"POST",headers:Te,body:`character_value=${S}&category_id=${R}`});Be.ok?(te=yield Be.json(),(0,be.K)(te).then(()=>{N.I.AddConcept(te)})):(console.log("This is the concept by category and character error",Be.status),(0,d.ry)(Be)),Ce.V.logUpdate(V)}catch(Be){Be instanceof Error?console.log(" This is the concept by category and character error message: ",Be.message):console.log(" This is the concept by category and character unexpected error: ",Be),(0,d.Mb)(Be,a.B.GetConceptByCharacterAndCategoryDirectUrl()),(0,d.ey)(V,"GetConceptByCharacterAndCategoryDirectApi",Be)}return te})}(v,L)),Ce.V.logUpdate(i),n})}(k,l)}else t[0]==k&&(e=yield function(l){var u=arguments;return qt(this,void 0,void 0,function*(){const v=Ce.V.logfunction("GetConceptByCharacter",u);let L=yield N.I.GetConceptByCharacterAndTypeLocal(l,51);return 0==L.id&&(L=yield(0,ln.Y)(l)),Ce.V.logUpdate(v),L})}(k));return Ce.V.logUpdate(o),e})}var io=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};const $o=new Map;function ro(k,o){var e=arguments;return io(this,void 0,void 0,function*(){const t=Ce.V.logfunction("MakeTheTypeConceptApi",e);let l=(0,we.o)();if($o.has(k))return $o.get(k)||l;const u=(()=>io(this,void 0,void 0,function*(){try{if(l=yield Zn(k),0==l.id||4==l.typeId){let v=(0,r.Xr)("application/x-www-form-urlencoded");const L=yield fetch(a.B.MakeTheTypeConceptUrl(),{method:"POST",headers:v,body:`type=${k}`});if(!L.ok)throw(0,d.ry)(L),new Error(`Error! status: ${L.status}`);l=yield L.json(),Ce.V.logUpdate(t)}}catch(v){v instanceof Error?console.log("Make The Type Concept Api error : ",v.message):console.log("Make The Type Concept Api error : ",v),(0,d.Mb)(v,a.B.MakeTheTypeConceptUrl()),(0,d.ey)(t,"MakeTheTypeConceptApi",v)}finally{$o.delete(k)}return l}))();return $o.set(k,u),u})}var rl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ai(k){var o=arguments;return rl(this,void 0,void 0,function*(){Ce.V.logfunction("GetAllLinkerConnectionsFromTheConcept",o);var e=[];try{(new Date).getTime();var t=(0,r.Xr)("application/x-www-form-urlencoded");const v=yield fetch(a.B.GetAllLinkerConnectionOfConceptUrl()+`?conceptId=${k}`,{method:"GET",headers:t});if(v.ok){const L=yield v.json();for(var l=0;l<L.length;l++)e.push(L[l])}else console.log("Get all linker connection from the concepts error","cannot get respone"),(0,d.ry)(v)}catch(v){v instanceof Error?console.log("Get all linker connection from the concepts error: ",v.message):console.log("Get all linker connection from the concepts error(Unexpected): ",v),(0,d.Mb)(v,a.B.GetAllLinkerConnectionOfConceptUrl())}return e})}var al=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Yi(k){var o=arguments;return al(this,void 0,void 0,function*(){const e=Ce.V.logfunction("GetAllLinkerConnectionsToTheConcept",o);var t=[];try{(new Date).getTime();var l=(0,r.Xr)("application/x-www-form-urlencoded");const L=yield fetch(a.B.GetAllLinkerConnectionToConceptUrl()+`?conceptId=${k}`,{method:"GET",headers:l});if(L.ok){const g=yield L.json();for(var u=0;u<g.length;u++)t.push(g[u]);Ce.V.logUpdate(e)}else console.log("Get all linker connection To the concepts error","cannot get respone"),(0,d.ry)(L)}catch(L){L instanceof Error?console.log("Get all linker connection To the concepts error: ",L.message):console.log("Get all linker connection To the concepts error(Unexpected): ",L),(0,d.Mb)(L,a.B.GetAllLinkerConnectionToConceptUrl()),(0,d.ey)(e,"GetAllLinkerConnectionsToTheConcept",L)}return t})}var Xi=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function er(k){var o=arguments;return Xi(this,void 0,void 0,function*(){const e=Ce.V.logfunction("GetLinkerConnectionFromConcepts",o);let t=yield ai(k);for(let l=0;l<t.length;l++){let u=t[l],v=u.typeId,L=yield(0,be.A)(v);u.type=L}return Ce.V.logUpdate(e),t})}function tr(k){var o=arguments;return Xi(this,void 0,void 0,function*(){const e=Ce.V.logfunction("GetLinkerConnectionToConcepts",o);let t=yield Yi(k);for(let l=0;l<t.length;l++){let u=t[l],v=u.typeId,L=yield(0,be.A)(v);u.type=L}return Ce.V.logUpdate(e),t})}var cl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},sl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},ll=_(6963),ci=_(2202),dl=_(5457),ul=_(991),nr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function si(k){var o=arguments;return nr(this,void 0,void 0,function*(){const e=Ce.V.logfunction("DeleteConceptById",o);if(wt)try{return(yield Bt("DeleteConceptById",{id:k})).data}catch(v){console.error("DeleteConceptById sw error: ",v),Wt(v)}if(k>0){var t=yield N.I.GetConcept(k);if(t.id>0){var l=t.typeId,u=t.characterValue;yield dl.c.removeTypeConcept(l,k),yield ll.f.removeNodeByCharacter(u,k),yield function(v){var L=arguments;return sl(this,void 0,void 0,function*(){let g=!1;const i=Ce.V.logfunction("DeleteTheConcept",L);try{const n=new FormData;n.append("id",v.toString());let S=(0,r.BZ)();const R=yield fetch(a.B.DeleteConceptUrl(),{method:"POST",headers:S,body:n});R.ok?g=(yield R.json()).success:(console.log("Delete concept error",R.status),(0,d.ry)(R)),g&&N.I.AddNpc(v),Ce.V.logUpdate(i)}catch(n){n instanceof Error?console.log("Delete concept error message: ",n.message):console.log("Delete concept unexpected error: ",n),(0,d.Mb)(n,a.B.DeleteConceptUrl()),(0,d.ey)(i,"DeleteTheConcept",n)}return g})}(k),yield ci.W.removeNodeFromTree(k),yield ul.H.removeNodeFromTree(k)}}else b.v.RemoveConceptById(k);Ce.V.logUpdate(e)})}function or(k){return nr(this,void 0,void 0,function*(){if(wt)try{return(yield Bt("DeleteUser",{id:k})).data}catch(o){console.error("DeleteUser sw error: ",o),Wt(o)}k>0?function(o){var e=arguments;cl(this,void 0,void 0,function*(){const t=Ce.V.logfunction("DeleteUserInBackend",e);try{var l=(0,r.ab)("application/json","");let u=a.B.DeleteUserUrl();u=u+"?conceptId="+o+"&apiKey=freeschema";const v=yield fetch(u,{method:"POST",headers:l});if(v.ok){let L=yield v.json(),g=Number(L.data);return console.log("this is the delete email concept",g),si(g),Ce.V.logUpdate(t),g}throw(0,d.ry)(v),new Error(`Delete composition Error! status: ${v.status}`)}catch(u){u instanceof Error?console.log("Delete composition error message: ",u.message):console.log("Delete composition unexpected error: ",u),(0,d.Mb)(u,a.B.DeleteConceptUrl()),(0,d.ey)(t,"DeleteUserInBackend",u)}})}(k):b.v.RemoveConceptById(k)})}var hl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ir(k,o){return hl(this,void 0,void 0,function*(){try{const e=new Headers;e.append("Authorization","Bearer "+o);const t=new FormData;t.append("id",k.toString());const l=yield fetch(a.B.DeleteConceptUrl(),{method:"POST",body:t,headers:e});if(!l.ok)throw(0,d.ry)(l),new Error(`Delete composition Error! status: ${l.status}`)}catch(e){e instanceof Error?console.log("Delete composition error message: ",e.message):console.log("Delete composition unexpected error: ",e),(0,d.Mb)(e,a.B.DeleteConceptUrl())}})}var Eo=_(1735),In=_(8286),pl=_(1596),dn=_(3278),rr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},fl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ar(k){var o=arguments;return fl(this,void 0,void 0,function*(){const e=Ce.V.logfunction("GetConnectionById",o);if(console.log("AccessTracker activation status from GetConnectionById"),!0===Eo.J.activateStatus)try{Eo.J.incrementConnection(k)}catch{console.error("Error adding connection in access tracker"),Ce.V.log("ERROR","Error Adding Connection")}if(wt)try{return(yield Bt("GetConnectionById",{id:k})).data}catch(l){console.error("GetConnectionById sw error: ",l),Wt(l)}let t=yield In.d.GetConnection(k);return null!=t&&0!=t.id||null==k||null==k||(t=yield function(l){var u=arguments;return rr(this,void 0,void 0,function*(){const v=Ce.V.logfunction("GetConnection",u);let L=yield In.d.GetConnection(l);try{if(0!=L.id)return L;{const g=new FormData;g.append("id",l.toString());const i={method:"POST",headers:{Authorization:"Bearer "+dn.b.BearerAccessToken},body:g};let n;try{n=yield fetch(a.B.GetConnectionUrl(),i)}catch{n=yield(0,pl.g)(i,"/api/get-connection-by-id")}return yield function(S,R){return rr(this,void 0,void 0,function*(){S.ok?(R=yield S.json(),In.d.AddConnection(R)):((0,d.ry)(S),console.log("Get Connection Error",S.status))})}(n,L),Ce.V.logUpdate(v),L}}catch(g){g instanceof Error?console.log("Get Connection error message: ",g.message):console.log("Get Connection unexpected error: ",g),(0,d.Mb)(g,a.B.GetConnectionUrl()),(0,d.ey)(v,"GetConnection",g)}})}(k)),Ce.V.logUpdate(e),t})}var yl=_(2212),gl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},vl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function cr(k,o,e){return vl(this,arguments,void 0,function*(t,l,u,v=4,L=999){const g=Ce.V.logfunction("MakeTheTimestamp")||{};if(wt){g.serviceWorker=!0;try{const V=yield Bt("MakeTheTimestamp",{type:t,referent:l,userId:u,accessId:v,sessionInformationId:L});return Ce.V.logUpdate(g),V.data}catch(V){console.error("MakeTheTimestamp sw error: ",V),(0,d.ey)(g,"MakeTheTimestamp",V),Wt(V)}}let i,n="",S=t.startsWith("the_"),R=(0,we.o)();return n=S?t:"the_"+t,R=yield ro(n,u),i=yield function(V,te,Te,Be,Xe,xe,ut){return gl(this,void 0,void 0,function*(){let xt=yield(0,kt.A)(V,Be),$t=xt;return 0==$t.id&&(xt=yield(0,yl.Ay)(V,te,4,Be,0,xe,ut),$t=xt),$t})}(l,u,0,R.id,0,v,n),Ce.V.logUpdate(g),i})}class ao{constructor(){this.composition=0,this.type="",this.linker="",this.inpage=10,this.page=1,this.listLinkers=[],this.fullLinkers=[],this.textSearch="",this.logic="or",this.reverse=!1,this.doFilter=!1,this.filterSearches=[],this.selectors=[],this.ofCompositions=[]}}var on=_(6687),Bo=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function sr(){var k=arguments;return Bo(this,arguments,void 0,function*(o=0,e=[],t="",l=[]){const u=Ce.V.logfunction("RecursiveSearchApi",k)||{};let v=[];try{if(wt){u.serviceWorker=!0;try{const S=yield Bt("RecursiveSearchApi",{composition:o,listLinkers:e,textSearch:t,fullLinkers:l});return Ce.V.logUpdate(u),S.data}catch(S){console.error("RecursiveSearchApi sw error: ",S),(0,d.ey)(u,"RecursiveSearchApi",S),Wt(S)}}let L=new ao;L.composition=o,L.listLinkers=e,L.fullLinkers=l,L.textSearch=t;let g=JSON.stringify(L),i=(0,r.Xr)();const n=yield fetch(a.B.RecursiveSearchUrl(),{method:"POST",headers:i,body:g});if(n.ok){const S=yield n.json();let R=S.compositionIds,Q=S.internalConnections;v=yield(0,on.p8)(R,Q)}else console.log("recursive search error ",n.status),(0,d.ey)(u,"RecursiveSearchApi",n.status),(0,d.ry)(n);Ce.V.logUpdate(u)}catch(L){L instanceof Error?console.log("recursive search error message: ",L.message):console.log("recursive search unexpected error: ",L),(0,d.ey)(u,"RecursiveSearchApi",L),(0,d.Mb)(L,a.B.RecursiveSearchUrl())}return v})}function lr(){var k=arguments;return Bo(this,arguments,void 0,function*(o=0,e=[],t=""){const l=Ce.V.logfunction("RecursiveSearchApiWithInternalConnections",k)||{};let u=[];try{if(wt){l.serviceWorker=!0;try{const n=yield Bt("RecursiveSearchApiWithInternalConnections",{composition:o,listLinkers:e,textSearch:t});return Ce.V.logUpdate(l),n.data}catch(n){console.error("RecursiveSearchApiWithInternalConnections sw error: ",n),(0,d.ey)(l,"RecursiveSearchApiWithInternalConnections",n),Wt(n)}}let v=new ao;v.composition=o,v.listLinkers=e,v.textSearch=t;let L=JSON.stringify(v),g=(0,r.Xr)();const i=yield fetch(a.B.RecursiveSearchUrl(),{method:"POST",headers:g,body:L});if(i.ok){const n=yield i.json();let S=n.compositionIds,R=n.internalConnections;u=yield(0,on.km)(S,R),Ce.V.logUpdate(l)}else console.log("recursive search error ",i.status),(0,d.ey)(l,"GetCompositionConnectionsBetweenTwoConcepts",i.status),(0,d.ry)(i)}catch(v){v instanceof Error?console.log("recursive search error message: ",v.message):console.log("recursive search unexpected error: ",v),(0,d.ey)(l,"GetCompositionConnectionsBetweenTwoConcepts",v),(0,d.Mb)(v,a.B.RecursiveSearchUrl())}return u})}function li(){var k=arguments;return Bo(this,arguments,void 0,function*(o=0,e=[],t="",l=[]){const u=Ce.V.logfunction("RecursiveSearchApiRaw",k)||{};try{if(wt){u.serviceWorker=!0;try{const n=yield Bt("RecursiveSearchApiRaw",{composition:o,listLinkers:e,textSearch:t,fullLinkers:l});return Ce.V.logUpdate(u),n.data}catch(n){console.error("RecursiveSearchApiRaw sw error: ",n),(0,d.ey)(u,"RecursiveSearchApiRaw",n),Wt(n)}}let v=new ao;v.composition=o,v.listLinkers=e,v.textSearch=t,v.fullLinkers=l;let L=JSON.stringify(v),g=(0,r.Xr)();const i=yield fetch(a.B.RecursiveSearchUrl(),{method:"POST",headers:g,body:L});if(i.ok){const n=yield i.json();return Ce.V.logUpdate(u),n}return console.log("recursive search error ",i.status),(0,d.ey)(u,"RecursiveSearchApiRaw",i.status),(0,d.ry)(i),Ce.V.logUpdate(u),[]}catch(v){v instanceof Error?console.log("recursive search error message: ",v.message):console.log("recursive search unexpected error: ",v),(0,d.ey)(u,"RecursiveSearchApiRaw",v),(0,d.Mb)(v,a.B.RecursiveSearchUrl())}})}function dr(){var k=arguments;return Bo(this,arguments,void 0,function*(o=0,e=[],t=""){const l=Ce.V.logfunction("RecursiveSearchApiRawFullLinker",k)||{};try{if(wt){l.serviceWorker=!0;try{const i=yield Bt("RecursiveSearchApiRawFullLinker",{composition:o,fullLinkers:e,textSearch:t});return Ce.V.logUpdate(l),i.data}catch(i){console.error("RecursiveSearchApiRawFullLinker sw error: ",i),(0,d.ey)(l,"RecursiveSearchApiRawFullLinker",i),Wt(i)}}let u=new ao;u.composition=o,u.fullLinkers=e,u.textSearch=t;let v=JSON.stringify(u),L=(0,r.Xr)();const g=yield fetch(a.B.RecursiveSearchUrl(),{method:"POST",headers:L,body:v});if(g.ok){const i=yield g.json();return Ce.V.logUpdate(l),i}return console.log("recursive search error ",g.status),(0,d.ey)(l,"RecursiveSearchApiRawFullLinker",g.status),(0,d.ry)(g),Ce.V.logUpdate(l),[]}catch(u){u instanceof Error?console.log("recursive search error message: ",u.message):console.log("recursive search unexpected error: ",u),(0,d.Mb)(u,a.B.RecursiveSearchUrl()),(0,d.ey)(l,"RecursiveSearchApiRawFullLinker",u)}})}function ur(){var k=arguments;return Bo(this,arguments,void 0,function*(o=0,e=[],t=""){const l=Ce.V.logfunction("RecursiveSearchApiRawFullLinker",k)||{};try{if(wt)try{l.serviceWorker=!0;const i=yield Bt("RecursiveSearchApiNewRawFullLinker",{composition:o,fullLinkers:e,textSearch:t});return Ce.V.logUpdate(l),i.data}catch(i){console.error("RecursiveSearchApiNewRawFullLinker sw error: ",i),(0,d.ey)(l,"RecursiveSearchApiNewRawFullLinker",i),Wt(i)}let u=new ao;u.composition=o,u.fullLinkers=e,u.textSearch=t;let v=JSON.stringify(u),L=(0,r.Xr)();const g=yield fetch(a.B.RecursiveSearchUrl(),{method:"POST",headers:L,body:v});if(g.ok){const i=yield g.json();return Ce.V.logUpdate(l),i}return console.log("recursive search error ",g.status),(0,d.ey)(l,"RecursiveSearchApiNewRawFullLinker",g.status),(0,d.ry)(g),Ce.V.logUpdate(l),[]}catch(u){u instanceof Error?console.log("recursive search error message: ",u.message):console.log("recursive search unexpected error: ",u),(0,d.Mb)(u,a.B.RecursiveSearchUrl()),(0,d.ey)(l,"RecursiveSearchApiNewRawFullLinker",u)}})}var di=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};const ui=["image/jpeg","image/jpg","image/png","image/webp"],hi=["application/msword","application/vnd.ms-excel","application/vnd.ms-powerpoint","text/plain","application/pdf"];function hr(k,o){return di(this,void 0,void 0,function*(){const e=Ce.V.logfunction("uploadAttachment");try{console.log("File Type",k.type);const t=new FormData;let l;if(hi.includes(k.type))t.append("file",k,k.name),l=yield fi(t,o);else{if(!ui.includes(k.type))return{message:"Invalid File Format",success:!1};t.append("image",k,k.name),l=yield pi(t,o)}return l?.data?(Ce.V.logUpdate(e),{message:"Upload Success",success:!0,url:l.data}):{message:"File Upload Failed",success:!1}}catch(t){throw console.error(t),(0,d.ey)(e,"uploadAttachment",t),t}})}function pi(k){return di(this,arguments,void 0,function*(o,e=""){const t=Ce.V.logfunction("uploadImage");try{const l=yield fetch(a.B.uploadImageUrl(),{method:"POST",body:o,headers:{Authorization:`Bearer ${e}`}});if(!l.ok){const u=l.headers.get("content-type");u&&u.includes("text/plain")&&console.info(l?.text());const v=yield l?.text();return console.error(`${l.status} ${v}`),Ce.V.logUpdate(t),null}return yield l.json()}catch(l){return console.error(l),(0,d.ey)(t,"uploadImage",l),null}})}function fi(k){return di(this,arguments,void 0,function*(o,e=""){const t=Ce.V.logfunction("uploadFile");try{const l=yield fetch(a.B.uploadFileUrl(),{method:"POST",body:o,headers:{Authorization:`Bearer ${e}`}});if(!l.ok){const u=l.headers.get("content-type");u&&u.includes("text/plain")&&console.info(l.text());const v=yield l.text();return console.error(`${l.status} ${v}`),null}return Ce.V.logUpdate(t),yield l.json()}catch(l){return console.error(l),(0,d.ey)(t,"uploadFile",l),null}})}var Io=_(1239),jo=_(7467),ml=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function pr(k,o){var e=arguments;return ml(this,void 0,void 0,function*(){const t=Ce.V.logfunction("LoginToBackend",e);try{let l={email:k,password:o},u=new Headers;u.append("Content-Type","application/json");let v=JSON.stringify(l);const L=yield fetch(a.B.LoginUrl(),{method:"POST",headers:u,body:v}),g=yield L.json();if(L.ok)return dn.b.BearerAccessToken=g.data.token,Ce.V.logUpdate(t),g;console.log("Login tsccs error message: ",L.status),(0,d.ER)(L,g)}catch(l){l instanceof Error?console.log("Login tsccs error message: ",l.message):console.log(" Login tsccs  unexpected error: ",l),(0,d.Mb)(l,a.B.LoginUrl()),(0,d.ey)(t,"LoginToBackend",l)}})}var yi=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function fr(k){return yi(this,void 0,void 0,function*(){return yield function(){return yi(this,arguments,void 0,function*(e="",t={}){let l={message:"success",status:!1,statusCode:200,data:"cannot signup"};try{const u=yield fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(t)}),v=yield u.json();return u.ok?l={message:"success",status:!0,statusCode:200,data:v}:(0,d.ER)(u,v),l}catch(u){console.log("Signup Error: ",u),(0,d.Mb)(u,e)}})}(a.B.SignupUrl(),k)})}function yr(k){return yi(this,void 0,void 0,function*(){const o=a.B.NODE_URL,e=yield fetch(`${o}/api/v1/entity/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)});if(e.ok)return e.json();throw 404===e.status?new Error("404, Not found"):500===e.status?new Error("500, internal server error"):new Error(e.status)})}var Cl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function gr(k){return Cl(this,void 0,void 0,function*(){const o=JSON.stringify({email:k.email,password:k.password});let e={message:"success",status:!1,statusCode:200,data:""};const t=new Headers;t.append("Content-Type","application/json");const l=a.B.LoginUrl();try{const u=yield fetch(l,{method:"POST",headers:t,body:o,redirect:"follow"}),v=yield u.json();return u.ok?e={message:"success",status:!0,statusCode:200,data:v?.data}:(0,d.ER)(u,v),e}catch(u){console.log("Sign in api error",u),(0,d.Mb)(u,l)}})}var gi=_(9934),Ho=_(4485);function _l(k=[],o){Array.isArray(k)&&k.splice(k.findIndex(function(e){return e.id===o.id}),1)}function Tl(k=[],o){Array.isArray(k)&&k.splice(k.findIndex(function(e){return e.id===o.id}),1)}class vi{constructor(o,e,t,l){this.expiryTime=new Date(Date.now()+6e5),this.height=1,this.key=o,this.value=e,this.leftNode=t,this.rightNode=l}isValid(){const o=new Date(Date.now());return!(this.expiryTime<o&&(co.removeNodeFromTree(this.key),1))}saveToCache(o){this.value.cached=o}addNode(o,e,t){if(null==e)return o;const u=e.rightNode;if(e.key>o.key)e.leftNode=this.addNode(o,e.leftNode,t);else{if(!(e.key<o.key))return this.isValid(),o;e.rightNode=this.addNode(o,u,t)}e.height=1+Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode));const v=this.getBalanceFactor(e);if(v>1&&e.leftNode){if(o.key<e.leftNode.key)return this.rightRotate(e);if(o.key>e.leftNode.key)return e.leftNode=this.leftRotate(e.leftNode),this.rightRotate(e)}if(v<-1&&e.rightNode){if(o.key>e.rightNode.key)return this.leftRotate(e);if(o.key<e.rightNode.key)return e.rightNode=this.rightRotate(e.rightNode),this.leftRotate(e)}return this.isValid(),e}rightRotate(o){if(o){const e=o.leftNode;if(e)return o.leftNode=e.rightNode,e.rightNode=o,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,e}return o}leftRotate(o){if(o){const e=o.rightNode;if(e){const t=e.leftNode;return e.leftNode=o,o.rightNode=t,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(o.rightNode))+1,e}}return o}getHeight(o){return o?o.height:0}getBalanceFactor(o){return null==o?0:this.getHeight(o.leftNode)-this.getHeight(o.rightNode)}getFromNode(o,e){return e&&(o==e.key&&e.isValid()?e:o<e.key?this.getFromNode(o,e.leftNode):o>e.key?this.getFromNode(o,e.rightNode):e)}removeNode(o,e){if(null==o)return o;if(o.key>e)return o.leftNode=this.removeNode(o.leftNode,e),o;if(o.key<e)return o.rightNode=this.removeNode(o.rightNode,e),o;if(null==o.leftNode){const t=o.rightNode;return o=null,t}if(null==o.rightNode){const t=o.leftNode;return o=null,t}{const t=this.inOrderSuccessor(o.rightNode);return o.value=t.value,o.key=t.key,o.rightNode=this.removeNode(o.rightNode,t.key),o}}countNodeBelow(o){return null==o?0:1+this.countNodeBelow(o.leftNode)+this.countNodeBelow(o.rightNode)}inOrderSuccessor(o){for(;null!=o.leftNode;)o=o.leftNode;return o}}var vr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};let co=(()=>{class k{static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static addCompositionToTree(e){const t=new vi(e.id,e,null,null);this.addNodeToTree(t)}static getNodeFromTree(e){return vr(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(e,this.root):null})}static removeNodeFromTree(e){return vr(this,void 0,void 0,function*(){this.root&&(this.root=this.root.removeNode(this.root,e))})}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}return k.root=null,k})();var wl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ko(k,o,e,t){return wl(this,arguments,void 0,function*(l,u,v,L,g=[]){var i,n;let S={};const R=[];if(0==l)return"";let Q=mi(v,l);if(null!=Q&&0!=Q.id||null==l||null==l||(Q=yield(0,be.A)(l)),0!=Q.id&&null==Q.type){const V=Q.typeId;let te=mi(v,V);Q.type=te,null==te&&null!=V&&null!=V&&(te=yield(0,be.A)(V),Q.type=te)}if(!L.includes(l))return Q?.characterValue;if(g.includes(l))return"";g.push(l);for(let V=0;V<u.length;V++)if(u[V].ofTheConceptId==l){const te=u[V].toTheConceptId;if(L.includes(l)){let Te=mi(v,te);if(null!=Te&&0!=Te.id||null==te||null==te||(Te=yield(0,be.A)(te)),0!=Te.id&&null==Te?.type){const xe=Te.typeId;let ut=yield N.I.GetConcept(xe);Te.type=ut,null==ut&&null!=xe&&null!=xe&&(ut=yield(0,be.A)(xe),Te.type=ut)}const Xe=(null!==(n=null===(i=Te?.type)||void 0===i?void 0:i.characterValue)&&void 0!==n?n:"").replace("the_","");if(isNaN(Number(Xe))){if(Xe){const xe=yield ko(te,u,v,L,g);S[Xe]=xe}}else{const xe=yield ko(te,u,v,L,g);R[Xe]=xe,S=R}}}return S})}function mi(k,o){let e=(0,we.o)();for(let t=0;t<k.length;t++)if(o==k[t].id)return e=k[t],e;return e}class Do{constructor(){this.id=0,this.mainConcept=(0,we.o)(),this.connections=[],this.concepts=[],this.subcompositions=[],this.cached={}}updateCache(){return o=this,t=function*(){if(0==this.mainConcept.id)for(let l=0;l<this.concepts.length;l++)this.concepts[l].id==this.id&&(this.mainConcept=this.concepts[l]);this.cached=yield ko(this.id,this.connections,this.concepts,this.subcompositions,[])},new((e=void 0)||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(o,[])).next())});var o,e,t}UpdateAcrossDistributedSystem(){var o,e;try{0!=this.id&&(e=null===(o=this.id)||void 0===o?void 0:o.toString(),a.B.MQTT_CONNECTION&&a.B.MQTT_CONNECTION.publish("compositionUpdate",e))}catch(t){console.log("Error while publishing message",t)}}isUpdating(){this.UpdateAcrossDistributedSystem()}GetDataCache(){var o,e,t;const l={};l[null!==(t=null===(e=null===(o=this.mainConcept)||void 0===o?void 0:o.type)||void 0===e?void 0:e.characterValue)&&void 0!==t?t:""]=this.cached;const u={};return u.data=l,u.id=this.id,u}}var Il=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Go(k){return Il(this,arguments,void 0,function*(o,e=null,t=null,l=null,u=null,v=null,L=null,g=null){const i=u??999,n=v??4,S=L??999;let R=l??0,Q=(0,we.o)();null==g&&(g=new Do);for(const V in o)if("object"==typeof o[V]||Array.isArray(o[V])){const te=yield(0,rt.A)(V,"",!0,i,n,S);if(null==e&&null==t){let Te=R;Q=te,Te=te.id,R=te.id,g.concepts.push(te),g.id=te.id,yield Go(o[V],te.id,te.userId,Te,u,v,L,g)}else{const Te=e??999,Be=t??999,Xe=R;Q=te,g.concepts.push(te);const xe=yield(0,Ke.q)(Te,Be,te.id,Xe);g.connections.push(xe),yield Go(o[V],te.id,te.userId,Xe,u,v,L,g)}null!=o[V]&&null!=o[V]&&g.subcompositions.push(te.id)}else{const te=e??999,Te=t??999,Be=R,Xe=yield(0,rt.A)(V,o[V],!1,i,n,S);g.concepts.push(Xe);const xe=yield(0,Ke.q)(te,Te,Xe.id,Be);g.connections.push(xe)}return Q})}var kl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function mr(k){return kl(this,void 0,void 0,function*(){const o=Ce.V.logfunction("UpdateComposition")||{};if(wt){o.serviceWorker=!0;try{const xe=yield Bt("UpdateComposition",{patcherStructure:k});return Ce.V.logUpdate(o),xe.data}catch(xe){console.error("UpdateComposition sw error: ",xe),(0,d.ey)(o,"UpdateComposition",xe),Wt(xe)}}const e=k.userId,t=k.sessionId,l=k.accessId;let u=[];const v=[];let L=(0,we.o)(),g=(0,we.o)();const i=[];let n=k.compositionId;const S=k.ofTheCompositionId;let R=[];if(n<0){let xe=yield(0,be.A)(n,e);if(!(xe.id>0))return null;n=xe.id}u=yield(0,ae.s)(n);const Q=[],V=new Do,te=[];V.id=n,V.isUpdating();let Te=[];for(let xe=0;xe<u.length;xe++)(0,gi.A)(te,u[xe].ofTheConceptId),(0,gi.A)(Q,u[xe].ofTheConceptId),(0,gi.A)(Q,u[xe].toTheConceptId),Te.push(u[xe].ofTheConceptId);V.subcompositions=te,V.connections=u;for(let xe=0;xe<Q.length;xe++){const ut=yield(0,be.A)(Q[xe]);n==Q[xe]&&(L=ut),S==Q[xe]&&(g=ut),v.push(ut)}const Be=k.patchObject;for(const xe in Be){let ut=(0,we.o)();const xt=Be[xe];let $t=L;if(g.id>0&&($t=g),Array.isArray(xt)||"object"==typeof xt){ut=yield(0,rt.A)(xe,"",!0,L.userId,4,999),V.subcompositions.push(ut.id);const tn=(0,Ho.vo)(v,ut);for(let cn=0;cn<tn.length;cn++)if(tn[cn].id>0){const Bn=(0,Ho.wS)(V.connections,tn[cn].id);R=R.concat(Bn),i.push(tn[cn])}yield Go(Be[xe],ut.id,ut.userId,L.id,L.userId,4,999,V)}else{ut=yield(0,rt.A)(xe,xt,!1,e,l,t);const tn=(0,Ho.vo)(v,ut);for(let cn=0;cn<tn.length;cn++)if(tn[cn].id>0){const Bn=(0,Ho.wS)(V.connections,tn[cn].id);R=R.concat(Bn),i.push(tn[cn])}}const Zt=(0,Ke.q)($t.id,$t.userId,ut.id,L.id);v.push(ut),V.connections.push(Zt)}for(let xe=0;xe<R.length;xe++)Tl(V.connections,R[xe]),(0,Me.m)(R[xe].id);for(let xe=0;xe<i.length;xe++)_l(v,i[xe]);V.concepts=V.concepts.concat(v),V.mainConcept=L,V.id=L.id,yield V.updateCache(),co.addCompositionToTree(V),de.Y.SyncDataOnline();let Xe=V.GetDataCache();return Ce.V.logUpdate(o),Xe})}var bl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Cr(k,o,e,t){return bl(this,arguments,void 0,function*(l,u,v,L,g=10,i=1){var n=(0,r.ab)("application/x-www-form-urlencoded",L),S=new URLSearchParams;S.append("type",l),S.append("search",u),S.append("composition",v),S.append("inpage",g.toString()),S.append("page",i.toString());const R=a.B.SearchCompositionsUrl()+"?"+S.toString();try{const Q=yield fetch(R,{method:"GET",headers:n});return Q.ok?yield Q.json():((0,d.ry)(Q),[])}catch(Q){console.log("This is the searching error",Q),(0,d.Mb)(Q,R)}})}var Al=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function _r(k){return Al(this,arguments,void 0,function*(o,e=""){var t=(0,r.ab)("application/json",e);const l=a.B.SearchLinkMultipleAll(),u=JSON.stringify(o);try{const v=yield fetch(l,{method:"POST",headers:t,body:u});return v.ok?yield v.json():(console.log("This is the searching error",v.status),(0,d.ry)(v),[])}catch(v){console.log("This is the searching error",v),(0,d.Mb)(v,l)}})}var Tr=_(7139),Uo=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function wr(k){return Uo(this,arguments,void 0,function*(o,e=[]){var t,l;let u=[];const v=[];let L={},g={};const i=yield co.getNodeFromTree(o),n=[];let S=yield N.I.GetConcept(o);if(0==S.id&&null!=o&&null!=o&&(S=yield(0,Tr.r)(o)),null==i){let R=[];R=e.length>0?Ir(o,e):yield(0,ae.s)(o),u=R;for(let V=0;V<u.length;V++)n.includes(u[V].ofTheConceptId)||(n.push(u[V].ofTheConceptId),v.push(u[V].ofTheConceptId)),v.includes(u[V].toTheConceptId)||v.push(u[V].toTheConceptId);br(S,u,v,n);let Q=[];g=yield(0,m.zN)(o,u,n,Q),L[null!==(l=null===(t=S?.type)||void 0===t?void 0:t.characterValue)&&void 0!==l?l:""]=g}else g=i.value.GetDataCache(),L=g;return 0==S.id?"":L})}function Ir(k,o){const e=[];for(let t=0;t<o.length;t++)o[t].typeId==k&&e.push(o[t]);return e}function Ci(k){return Uo(this,arguments,void 0,function*(o,e=[]){var t,l;let u={},v=[];const L=[];let g;const i={},n=yield co.getNodeFromTree(o),S=[];let R=yield N.I.GetConcept(o);if(0==R.id&&null!=o&&null!=o&&(R=yield(0,Tr.r)(o)),null==n){let Q=[];Q=e.length>0?Ir(o,e):yield(0,ae.s)(o),v=Q;for(let V=0;V<v.length;V++)S.includes(v[V].ofTheConceptId)||(S.push(v[V].ofTheConceptId),L.push(v[V].ofTheConceptId)),L.includes(v[V].toTheConceptId)||L.push(v[V].toTheConceptId);br(R,v,L,S),g=yield(0,m.zN)(o,v,S),i[null!==(l=null===(t=R?.type)||void 0===t?void 0:t.characterValue)&&void 0!==l?l:""]=g,u.created_at=R.entryTimeStamp,u.data=i,u.id=o}else g=n.value.GetDataCache(),u=g;return 0==R.id?"":u})}function kr(k,o){return Uo(this,void 0,void 0,function*(){let e=[];const t=[];e=yield(0,jo.j)(o);for(let l=0;l<k.length;l++){const u=yield Ci(k[l],e);u&&t.push(u)}return t})}function br(k,o,e,t){return Uo(this,void 0,void 0,function*(){const l=new Do,u=yield function(L){return Uo(this,void 0,void 0,function*(){let g=[];const i=[];for(let n=0;n<L?.length;n++){const S=yield N.I.GetConcept(L[n]);0==S.id?i.push(L[n]):g.push(S)}return 0==i?.length||(g=yield(0,Io.I)(i)),g})}(e);l.connections=o,l.concepts=u,l.id=k.id,l.subcompositions=t,l.mainConcept=k;const v=yield ko(k.id,o,u,t,[]);l.cached=v,co.addCompositionToTree(l)})}var Ll=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Ar(k){return Ll(this,void 0,void 0,function*(){try{var o=(0,r.Xr)();const e=JSON.stringify(k),t=yield fetch(a.B.CreateSessionId(),{method:"POST",headers:o,body:e});return t.ok?t.json():(console.log("Creating session failed",yield t.json()),(0,d.ry)(t),null)}catch(e){console.log("Creating session failed",e),(0,d.Mb)(e,a.B.CreateSessionId())}})}var Nl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Lr(k,o){return Nl(this,void 0,void 0,function*(){try{var e=(0,r.Xr)("application/x-www-form-urlencoded");const t=new URLSearchParams;t.append("sessionId",k.toString()),t.append("url",o);const l=yield fetch(a.B.CreateSessionVisitUrl(),{method:"POST",headers:e,body:t});return l.ok?l.json():(console.log("Creating session url failed",yield l.json()),(0,d.ry)(l),null)}catch(t){console.log("Creating session url failed",t),(0,d.Mb)(t,a.B.CreateSessionVisitUrl())}})}var Sl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Nr(k,o,e){return Sl(this,arguments,void 0,function*(t,l,u,v=10,L=1){let g=[];try{var i=new URLSearchParams;i.append("typeId",`${t}`),i.append("toTheConceptId",`${l}`),i.append("userId",`${u}`),i.append("inpage",`${v}`),i.append("page",`${L}`);var n=(0,r.Xr)("application/x-www-form-urlencoded");const S=yield fetch(a.B.GetAllConnectionsToConceptUrl(),{method:"POST",headers:n,body:i});return S.ok?g=yield S.json():(console.log("Get connection of concept error",S.status),(0,d.ry)(S)),g}catch(S){throw S instanceof Error?console.log("Get connection of concept  error message: ",S.message):console.log("Get connection of concept unexpected error: ",S),S}})}var Sr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function _i(k,o){var e=arguments;return Sr(this,arguments,void 0,function*(t,l,u=10,v=1,L=!1){const g=Ce.V.logfunction("GetRelation",e)||{};if(wt){g.serviceWorker=!0;try{const V=yield Bt("GetRelation",{id:t,relation:l,inpage:u,page:v,reverse:L});return Ce.V.logUpdate(g),V.data}catch(V){console.error("GetRelation error sw: ",V),(0,d.ey)(g,"GetRelation",V),Wt(V)}}let i=[],n=yield(0,be.A)(t),S=yield Zn(l),R=[];if(S.id>0)if(L){R=yield Nr(S.id,n.id,n.userId,u,v);let V=[];for(var Q=0;Q<R.length;Q++)V.push(R[Q].ofTheConceptId);yield(0,T.Y)(V);for(let te=0;te<R.length;te++){let Te=R[te].ofTheConceptId,Be=yield(0,be.A)(Te),Xe=yield(0,m.Ez)(Be.id);i.push(Xe)}}else{R=yield Ee(S.id,n.id,n.userId,u,v);let V=[];for(let te=0;te<R.length;te++)V.push(R[te].toTheConceptId);yield(0,T.Y)(V);for(let te=0;te<R.length;te++){let Te=R[te].toTheConceptId,Be=yield(0,be.A)(Te),Xe=yield(0,m.Ez)(Be.id);i.push(Xe)}}return Ce.V.logUpdate(g),i})}function xr(k,o){var e=arguments;return Sr(this,arguments,void 0,function*(t,l,u=10,v=1,L=!1){const g=Ce.V.logfunction("GetRelationRaw",e)||{};if(wt){g.serviceWorker=!0;try{const te=yield Bt("GetRelationRaw",{id:t,relation:l,inpage:u,page:v,reverse:L});return Ce.V.logUpdate(g),te.data}catch(te){console.error("GetRelationRaw error sw: ",te),(0,d.ey)(g,"GetRelationRaw",te),Wt(te)}}let i=[],n=yield(0,be.A)(t),S=yield Zn(l),R=[],Q=[];if(S.id>0){if(L){R=yield Nr(S.id,n.id,n.userId,u,v);for(var V=0;V<R.length;V++)Q.push(R[V].ofTheConceptId)}else{R=yield Ee(S.id,n.id,n.userId,u,v);for(let te=0;te<R.length;te++)Q.push(R[te].toTheConceptId)}i=yield(0,Io.r)(Q)}return Ce.V.logUpdate(g),i})}var Ti=_(6416),jn=_(4711);class xl{constructor(o,e,t,l){this.value=[],this.height=1,this.key=o,this.value.push(e),this.leftNode=t,this.rightNode=l}addNode(o,e,t){if(null==e)return o;var u=e.rightNode;if(e.key>o.key)e.leftNode=this.addNode(o,e.leftNode,t);else{if(!(e.key<o.key))return e.value.push(...o.value),e;e.rightNode=this.addNode(o,u,t)}e.height=1+Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode));let v=this.getBalanceFactor(e);if(v>1&&e.leftNode){if(o.key<e.leftNode.key)return this.rightRotate(e);if(o.key>e.leftNode.key)return e.leftNode=this.leftRotate(e.leftNode),this.rightRotate(e)}if(v<-1&&e.rightNode){if(o.key>e.rightNode.key)return this.leftRotate(e);if(o.key<e.rightNode.key)return e.rightNode=this.rightRotate(e.rightNode),this.leftRotate(e)}return e}rightRotate(o){if(o){let e=o.leftNode;if(e)return o.leftNode=e.rightNode,e.rightNode=o,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,e}return o}leftRotate(o){if(o){let e=o.rightNode;if(e){let t=e.leftNode;return e.leftNode=o,o.rightNode=t,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(o.rightNode))+1,e}}return o}getHeight(o){return o?o.height:0}getBalanceFactor(o){return null==o?0:this.getHeight(o.leftNode)-this.getHeight(o.rightNode)}getFromNode(o,e){return e&&(o==e.key?e:o<e.key?this.getFromNode(o,e.leftNode):o>e.key?this.getFromNode(o,e.rightNode):e)}removeNode(o,e){if(null==o)return o;if(o.key>e)return o.leftNode=this.removeNode(o.leftNode,e),o;if(o.key<e)return o.rightNode=this.removeNode(o.rightNode,e),o;if(null==o.leftNode){let l=o.rightNode;return o=null,l}if(null==o.rightNode){let l=o.leftNode;return o=null,l}var t=this.inOrderSuccessor(o.rightNode);return o.value=t.value,o.key=t.key,o.rightNode=this.removeNode(o.rightNode,t.key),o}countNodeBelow(o){return null==o?0:1+this.countNodeBelow(o.leftNode)+this.countNodeBelow(o.rightNode)}inOrderSuccessor(o){for(;null!=o.leftNode;)o=o.leftNode;return o}}var wi=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};let qo=(()=>{class k{static compositeKey(e,t){return("0000"+e.toString(16).toUpperCase()).slice(-4)+("0000"+t.toString(16).toUpperCase()).slice(-4)}static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static waitForDataToLoad(){return wi(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.checkFlag(e),setTimeout(()=>{t("not")},25e3)})})}static checkFlag(e){if(c.B.isDataLoaded)return e("done");setTimeout(k.checkFlag,1e3,e)}static addConceptToTree(e,t,l=999){let u=this.compositeKey(t,l);var v=new xl(u,e,null,null);this.addNodeToTree(v)}static getNodeFromTree(e,t){return wi(this,void 0,void 0,function*(){let l=this.compositeKey(e,t);return this.root?this.root.getFromNode(l,this.root):null})}static removeNodeFromTree(e){return wi(this,arguments,void 0,function*(t,l=999){if(this.root){let u=this.compositeKey(t,l);this.root=this.root.removeNode(this.root,u)}})}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}return k.root=null,k})();var Fr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Er(k,o){return Fr(this,arguments,void 0,function*(e,t,l=999){let u=yield qo.getNodeFromTree(e,l),v=(0,Ti.u)();if(u)for(let L=0;L<u.value.length;L++){let g=u.value[L];g.ghostId==t&&(v=g)}return v})}function Br(k,o){return Fr(this,arguments,void 0,function*(e,t,l=999){qo.addConceptToTree(e,t,l)})}var so=_(5312),Ii=_(1213),Dr=_(3729),Fl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},El=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Gr(k,o,e){return El(this,void 0,void 0,function*(){try{if(wt)try{return(yield Bt("GetRelationLocal",{id:k,relation:o,userId:e})).data}catch(v){console.error("GetRelationLocal error sw: ",v),Wt(v)}let t=yield(0,s.$I)(o),l=[];0!=t.id&&(l=yield function(v,L){return Fl(this,void 0,void 0,function*(){try{return yield D.G.GetConnectionOfCompositionAndTypeLocal(L,v)}catch(g){throw g}})}(k,t.id));let u=[];for(let v=0;v<l.length;v++){let L=yield W(l[v].toTheConceptId);u.push(L)}return u}catch(t){throw t}})}var Bl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ki(k){return Bl(this,void 0,void 0,function*(){let o=[];try{var e=(0,r.Xr)();const t=yield fetch(a.B.ViewInternalDataUrl(),{method:"POST",headers:e,body:JSON.stringify(k)});if(t.ok){let l=yield t.json(),u={};for(let v=0;v<l.length;v++){o=l[v].connections;let g=l[v].id;(0,Io.r)(l[v].concepts),u[g]=o}return u}return console.log("View Internal Data error",t.status),(0,d.ry)(t),o}catch(t){throw t instanceof Error?console.log(" This is the view internal data error message: ",t.message):console.log(" This is the view internal data unexpected error: ",t),t}})}var Dl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function bi(k){return Dl(this,void 0,void 0,function*(){var o;try{let e=yield ki(k),t=[];for(let l=0;l<k.length;l++){let u=k[l],v=e[u];if(u&&v){let L=[],g={};for(let n=0;n<v.length;n++)L.includes(v[n].ofTheConceptId)||L.push(v[n].ofTheConceptId);let i=yield(0,m.zN)(u,v,L);g.data=i,g.id=u,t.push(g)}else{let L={};L.id=u;let g=yield(0,be.A)(u),i={};g.type&&(i[null===(o=g?.type)||void 0===o?void 0:o.characterValue]=g.characterValue,L.data=i,t.push(L))}}return t}catch(e){throw e}})}var Jo=_(176),Ur=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})},Rr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Or(k){return Rr(this,arguments,void 0,function*(o,e=""){try{let t=yield function(l){return Ur(this,arguments,void 0,function*(u,v=""){var L=(0,r.ab)("application/json",v);let g=a.B.SearchInternalWithAuthenticatedCcsUrl();g=g+"?composition="+u.composition+"&search="+u.search+"&internalComposition="+u.internalComposition+"&type="+u.type+"&inpage="+u.inpage+"&page="+u.page;try{const i=yield fetch(g,{method:"GET",headers:L});return i.ok?yield i.json():(console.log("This is the searching internal error",i.status),(0,d.ry)(i),[])}catch(i){console.log("This is the searching internal error",i),(0,d.Mb)(i,g)}})}(o,e);return yield bi(t)}catch(t){throw t}})}function Mr(k){return Rr(this,arguments,void 0,function*(o,e=""){try{return yield function(t){return Ur(this,void 0,void 0,function*(){var l=(0,r.ab)("application/json","");let u=a.B.SearchInternalWithCcsUrl();u=u+"?composition="+t.composition+"&search="+t.search+"&internalComposition="+t.internalComposition+"&type="+t.type+"&inpage="+t.inpage+"&page="+t.page;try{const v=yield fetch(u,{method:"GET",headers:l});return v.ok?yield v.json():(console.log("This is the searching internal error",v.status),(0,d.ry)(v),[])}catch(v){console.log("This is the searching internal error",v),(0,d.Mb)(v,u)}})}(o)}catch(t){throw t}})}var Ai=_(8095),Gl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Pr(k){return Gl(this,void 0,void 0,function*(){if(wt)try{return(yield Bt("DeleteConceptLocal",{id:k})).data}catch(e){console.error("DeleteConceptLocal error sw: ",e),Wt(e)}let o=yield(0,Ii.f)(k);b.v.RemoveConcept(o)})}var Wr=_(2803),Ul=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Vr(k,o,e,t){return Ul(this,arguments,void 0,function*(l,u,v,L,g=!0){var i,n;const S=Ce.V.logfunction("GetConnectionBetweenTwoConceptsLinker")||{};if(wt){S.serviceWorker=!0;try{const V=yield Bt("GetConnectionBetweenTwoConceptsLinker",{ofTheConcept:l,toTheConcept:u,linker:v,fullLinker:L,forward:g});return Ce.V.logUpdate(S),V.data}catch(V){console.error("GetConnectionBetweenTwoConceptsLinker sw error: ",V),(0,d.ey)(S,"GetConnectionBetweenTwoConceptsLinker",V),Wt(V)}}let R=(0,we.o)();if(""!=v){let V="";V=g?(null===(i=l.type)||void 0===i?void 0:i.characterValue)+"_s_"+v+"_s":(null===(n=u.type)||void 0===n?void 0:n.characterValue)+"_s_"+v+"_by",R=yield(0,rt.A)("connection",V,!1,999)}""!=L&&(R=yield ro(L,999));let Q=[];return Q=g?yield(0,Wr.x)(l.id,u.id,R.id):yield(0,Wr.x)(u.id,l.id,R.id),Ce.V.logUpdate(S),Q})}function $r(k,o){return new Promise((e,t)=>{setTimeout(()=>{e(o)},k)})}var Et=_(3130);const jr=3,Hr=4,qr=5;var Rl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Li(k,o){return Rl(this,arguments,void 0,function*(e,t,l=""){let u=a.B.SearchAllTypeWithLinker(e.auth);var v=(0,r.ab)("application/json",l);u=u+"?search="+e.search+"&type="+e.type+"&inpage="+e.inpage+"&page="+e.page;const L=JSON.stringify(t);try{const g=yield fetch(u,{method:"POST",headers:v,body:L});return g.ok?yield g.json():((0,d.ry)(g),console.log("This is the searching multiple error",g.status),[])}catch(g){console.log("This is the searching SearchWithTypeAndLinker error",g),(0,d.Mb)(g,u)}})}var to=_(4287);class Ni extends to.w{constructor(o,e,t=Et.y0){super(),this.searchQuery=[],this.format=Et.y0,this.searchQuery=o,this.format=t}bind(){return o=this,t=function*(){return this.data=yield(0,so.cf)(this.searchQuery,"",this,this.format),this.mainConcept=this.searchQuery[0].composition,this.listenToEvent(this.mainConcept),console.log("this is the data",this.data),this.data},new((e=void 0)||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(o,[])).next())});var o,e,t}}function Jr(k,o,e=Et.y0){return new Ni(k,o??"",e)}var zr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Ol extends to.w{constructor(o,e=Et.ZJ){super(),this.id=o,this.format=e}bind(){return zr(this,void 0,void 0,function*(){if(!this.isDataLoaded){let o=yield(0,m.hL)(this.id);this.mainConcept=this.id,this.compositionIds=o.compositionList;let e=o.connectionList;for(let t=0;t<e.length;t++)this.internalConnections.push(e[t].id);this.isDataLoaded=!0,this.listenToEvent(this.mainConcept)}return yield this.build()})}build(){return zr(this,void 0,void 0,function*(){let o=[],e=this.internalConnections;for(let t=0;t<e.length;t++)o.push(yield In.d.GetConnection(e[t]));return this.data=this.format==Et.ZJ?yield(0,m.ay)(this.mainConcept,o,this.compositionIds):this.format==Et.y0?yield(0,m.$V)(this.mainConcept,o,this.compositionIds):this.format==Et.yv?yield(0,m.re)(this.mainConcept,o,this.compositionIds):yield(0,m.ay)(this.mainConcept,o,this.compositionIds),this.data})}}function Zr(k,o=Et.ZJ){return new Ol(k,o)}var Qr=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Ml extends to.w{constructor(o,e,t,l,u){super(),this.data=[],this.startPage=0,this.compositionName=o,this.userId=e,this.inpage=t,this.page=l,this.format=u}bind(){return Qr(this,void 0,void 0,function*(){if(!this.isDataLoaded){var o=yield(0,y.A)(this.compositionName);if(o){yield C(this.compositionName,this.userId);let l=yield N.I.GetConceptsByTypeIdAndUser(o.id,this.userId);for(var e=this.inpage*(this.page-1),t=e;t<e+this.inpage;t++)l[t]&&this.compositionIds.push(l[t].id)}yield(0,T.Y)(this.compositionIds),this.isDataLoaded=!0,this.listenToEventType(o.id);for(let l=0;l<this.compositionIds.length;l++)this.listenToEvent(this.compositionIds[l])}return yield this.build()})}build(){return Qr(this,void 0,void 0,function*(){if(this.data=[],this.format==Et.ZJ){for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,m.kx)(this.compositionIds[o]);this.data.push(e)}}else if(this.format==Et.y0){for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,m.RW)(this.compositionIds[o]);this.data.push(e)}}else if(this.format==Et.yv){for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,m.XI)(this.compositionIds[o]);this.data.push(e)}}else for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,m.kx)(this.compositionIds[o]);this.data.push(e)}return this.data})}}function Kr(k,o,e,t,l=Et.ZJ){return new Ml(k,o,e,t,l)}var lo=_(7106),Yr=_(5328),Si=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Pl extends to.w{constructor(o,e,t="",l){super(),this.searchText="",this.connections=[],this.externalConnectionIds=[],this.data=[],this.mainConcept=o,this.searchLinkers=e,this.textSearch=t,l&&(this.format=l)}listenToEvent(o){window.addEventListener(`${o}`,e=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let t=this;setTimeout(function(){return Si(this,void 0,void 0,function*(){let l=yield In.d.GetConnectionByOfTheConceptAndType(o,o);for(let u=0;u<l.length;u++)yield In.d.GetConnection(l[u]).then(v=>{v.typeId==t.mainConcept?t.internalConnections.includes(v.id)||t.internalConnections.push(v.id):t.linkers.includes(v.id)||t.linkers.push(v.id),t.conceptIds.includes(v.toTheConceptId)||t.conceptIds.push(v.toTheConceptId),t.compositionIds.includes(v.ofTheConceptId)||t.compositionIds.push(v.ofTheConceptId),t.compositionIds.includes(v.toTheConceptId)||t.compositionIds.push(v.toTheConceptId)});t.isUpdating=!1,yield t.bind(),t.notify()})},200)}})}bind(){return Si(this,void 0,void 0,function*(){if(!this.isDataLoaded){this.isDataLoaded=!0;const o=yield li(this.mainConcept,this.searchLinkers,this.textSearch);this.compositionIds=o.compositionIds||[],this.internalConnections=o.internalConnections||[],this.externalConnectionIds=o.externalConnections||[],this.linkers=this.externalConnectionIds,this.connections=yield(0,jo.j)(this.externalConnectionIds);for(let e=0;e<this.compositionIds.length;e++)this.listenToEvent(this.compositionIds[e]);this.listenToEvent(this.mainConcept)}return yield this.build()})}build(){return Si(this,void 0,void 0,function*(){return this.externalConnectionIds=this.linkers,this.data=this.format&&this.format==Et.XZ?{compositionIds:this.compositionIds,internalConnections:this.internalConnections,externalConnections:this.externalConnectionIds}:yield(0,on.p8)(this.compositionIds,this.internalConnections),this.data})}}function Xr(k,o,e="",t){return new Pl(k,o,e,t)}var xi=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Wl extends to.w{constructor(o,e,t,l=Et.y0){super(),this.searchQuery=[],this.format=Et.y0,this.mainCompositionIds=[],this.searchCharacter="",this.token="",this.searchStructure=o,this.searchQuery=e,this.searchQuery[0].type=o.composition,this.searchCharacter=o.composition,this.format=l,this.token=dn.b.BearerAccessToken}listenToEventType(o){window.addEventListener(`${o}`,e=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let t=this;setTimeout(function(){return xi(this,void 0,void 0,function*(){let l=e;t.mainCompositionIds.includes(l?.detail)||(t.mainCompositionIds.unshift(l?.detail),t.conceptIds.push(l?.detail),t.listenToEvent(l?.detail),In.d.GetConnectionsOfConcept(l?.detail).then(u=>{for(let v=0;v<u.length;v++)t.linkers.push(u[v].id)})),t.isUpdating=!1,yield t.bind(),t.notify()})},200)}})}bind(){return xi(this,void 0,void 0,function*(){if(!this.isDataLoaded){this.isDataLoaded=!0;var o=yield(0,y.A)(this.searchCharacter);let e=yield Li(this.searchStructure,this.searchQuery,this.token);this.conceptIds=e.compositionIds,this.internalConnections=e.internalConnections,this.linkers=e.linkers,this.reverse=e.reverse,this.mainCompositionIds=e.mainCompositionIds,this.listenToEventType(o.id);for(let t=0;t<this.mainCompositionIds.length;t++)this.listenToEvent(this.mainCompositionIds[t])}return yield this.build()})}build(){return xi(this,void 0,void 0,function*(){return yield(0,Io.r)(this.conceptIds),this.data=this.format==Et.y0?yield(0,lo.yV)(this.linkers,this.conceptIds,this.internalConnections,this.mainCompositionIds,this.reverse):yield(0,lo._W)(this.linkers,this.conceptIds,this.internalConnections,this.mainCompositionIds,this.reverse),this.data})}}function ea(k,o,e,t=Et.y0){return new Wl(k,o,e,t)}var ta=_(2615);class na{constructor(o,e,t,l,u,v,L,g=!1,i,n,S){this.structureType="lconcept",this.isComposition=!1,this.isTemp=!1,this.isSynced=!1,this.applicationId=a.B.getRandomizer(),this.id=o,this.userId=e,this.typeId=t,this.ghostId=o,this.categoryId=l,this.characterValue=v,this.accessId=u,this.type=null,this.isNew=g,this.typeCharacter=L,this.entryTimeStamp=i,this.updatedTimeStamp=n,this.isSynced=!1,this.referentId=S}getType(){console.log(this.typeId)}}class oa{constructor(o,e,t,l,u,v){this.isTemp=!1,this.applicationId=a.B.getRandomizer(),this.type=(0,we.o)(),this.id=o,this.ofTheConceptId=e,this.toTheConceptId=t,this.typeId=l,this.ghostId=o,this.orderId=u,this.typeCharacter="",this.accessId=v,this.typeCharacter="",this.entryTimeStamp=new Date,this.terminationDateTime=new Date,this.localSyncTime=new Date}}class ia{constructor(){this.compositionId=0,this.userId=999,this.sessionId=999,this.accessId=4,this.ofTheCompositionId=0,this.patchObject={}}}class ra{constructor(){this.id="0",this.remote_address="",this.server_port="",this.server_address="",this.server_name="",this.server_software="",this.http_user_agent="",this.self="",this.port="",this.userId="",this.email=""}}var bo=_(628);class zo{constructor(){this.type="",this.search="",this.logicoperator="=",this.index=0,this.composition=!0,this.name="",this.operateon=""}}class aa{constructor(){this.type="",this.search="",this.composition="",this.internalComposition="",this.userId=999,this.inpage=10,this.page=1,this.auth=!0}}var ca=_(7887),sa=_(3075),Vl=_(7869),la=_(9635),Ce=_(9700);class $l{static initialize(){try{console.warn("Initialized Application Monitoring for tracking errors..."),this.initGlobalErrorHandlers(),this.logCatchError(),this.logErrorEvent(),this.logUnhandledError(),this.logUserInteractions(),this.logNetworkRequests(),this.logRouteChanges(),this.logPerformanceMetrics(),this.logWebSocketEvents()}catch(o){console.error("Error during Application Monitoring initialization:",o)}}static initGlobalErrorHandlers(){try{if(console.log("this is the window",window),void 0===typeof window)return;const o=dn.b.sessionId||"unknown";window.onerror=(e,t,l,u,v)=>{const L={message:e,source:t,lineno:l,colno:u,stack:v?.stack||"undefined",requestFrom:a.B.BASE_APPLICATION,sessionId:o};Ce.V.logApplication("ERROR","Runtime Error",L),Ce.V.log("ERROR","Runtime Error",L)},window.onunhandledrejection=e=>{Ce.V.logApplication("ERROR","Unhandled Promise Rejection",{message:e.reason?e.reason.message:e.reason,stack:e.reason?e.reason.stack:null,requestFrom:a.B.BASE_APPLICATION,sessionId:o}),Ce.V.log("ERROR","Unhandled Promise Rejection",{message:e.reason?e.reason.message:e.reason,stack:e.reason?e.reason.stack:null,requestFrom:a.B.BASE_APPLICATION,sessionId:o})}}catch(o){console.warn("Failed to initialize global error handlers:",o)}}static logCatchError(){try{const o=console.error;console.log("Inside originalConsoleError...");const e=dn.b.sessionId||"unknown";console.error=function(...t){const l="Console Error",u={arguments:t.map(v=>da(v)),requestFrom:a.B.BASE_APPLICATION,sessionId:e};Ce.V.logApplication("ERROR",l,u),Ce.V.log("ERROR",l,u),o.apply(console,t)}}catch(o){console.warn("Failed to override console.error:",o)}}static logErrorEvent(){try{window.addEventListener("error",o=>{var e;console.log("Inside error event...");const t=dn.b.sessionId||"unknown",l={error:(null===(e=o.error)||void 0===e?void 0:e.message)||o.message,source:o.filename,line:o.lineno,column:o.colno,stack:o.error?da(o.error.stack):void 0,requestFrom:a.B.BASE_APPLICATION,sessionId:t},u="Unhandled Error";Ce.V.logApplication("ERROR",u,l),Ce.V.log("ERROR",u,l)})}catch(o){console.warn("Failed to add error event listener:",o)}}static logUnhandledError(){try{window.addEventListener("unhandledrejection",o=>{var e,t;console.log("Inside unhandledrejection...");const l=dn.b.sessionId||"unknown",u={reason:(null===(e=o.reason)||void 0===e?void 0:e.message)||String(o.reason),stack:(null===(t=o.reason)||void 0===t?void 0:t.stack)||"No stack trace available",requestFrom:a.B.BASE_APPLICATION,sessionId:l};Ce.V.logApplication("ERROR","Unhandled Promise Rejection",u),Ce.V.log("ERROR","Unhandled Promise Rejection",u)})}catch(o){console.warn("Failed to add unhandled rejection event listener:",o)}}static logUserInteractions(){document.addEventListener("click",o=>{var e;const t=dn.b.sessionId||"unknown",l=o.target,u={element:l.tagName,id:l.id,classes:l.className,text:null===(e=l.innerText)||void 0===e?void 0:e.slice(0,50),requestFrom:a.B.BASE_APPLICATION,sessionId:t};Ce.V.logApplication("INFO","User Click",u)}),document.addEventListener("input",o=>{}),document.addEventListener("scroll",()=>{window})}static logNetworkRequests(){try{if(void 0===typeof window)return;const o=dn.b.sessionId||"unknown",e=window?.fetch;if(!e)throw new Error("Original fetch is not available.");const t=[a.B.PostLogger(),a.B.PostPrefetchConceptConnections()];window.fetch=(...l)=>{return u=this,L=function*(){const[g,i]=l,n=g instanceof Request?g.url:g instanceof URL?g.toString():g;if(t.includes(n))return console.log("Ignored URLs detected : ",n),e(...l);let S={request:{type:"REQUEST",message:"Network Request",method:i?.method||"GET",url:n,body:i?.body,requestFrom:a.B.BASE_APPLICATION,sessionId:o}};try{const R=yield e(...l);return S.response={type:"RESPONSE",message:"Network Response",url:n,status:R.status,requestFrom:a.B.BASE_APPLICATION,sessionId:o},R}catch(R){throw S.response={type:"ERROR",message:"Network Request Failed",url:n,error:R instanceof Error?R.message:String(R),requestFrom:a.B.BASE_APPLICATION,sessionId:o},Ce.V.logApplication("ERROR","Failed Network Request",S),new Error(`Network request failed for ${n}: ${R.message}`)}},new((v=void 0)||(v=Promise))(function(g,i){function n(Q){try{R(L.next(Q))}catch(V){i(V)}}function S(Q){try{R(L.throw(Q))}catch(V){i(V)}}function R(Q){var V;Q.done?g(Q.value):(V=Q.value,V instanceof v?V:new v(function(te){te(V)})).then(n,S)}R((L=L.apply(u,[])).next())});var u,v,L}}catch(o){console.warn("Failed to override network requests:",o)}}static logPerformanceMetrics(){void 0!==typeof window&&window?.addEventListener("load",()=>{performance})}static logRouteChanges(){const o=history.pushState,e=dn.b.sessionId||"unknown";history.pushState=function(...t){var l;const u={url:null===(l=t[2])||void 0===l?void 0:l.toString(),requestFrom:a.B.BASE_APPLICATION,sessionId:e};return Ce.V.logApplication("INFO","Route Change",u),o.apply(this,t)},window?.addEventListener("popstate",()=>{const t={url:location.href,requestFrom:a.B.BASE_APPLICATION,sessionId:e};Ce.V.logApplication("INFO","Route Changed (Back/Forward)",t)})}static logWebSocketEvents(){if(void 0===typeof window)return;const o=dn.b.sessionId||"unknown",e=WebSocket;window.WebSocket=class extends e{constructor(t,l){super(t,l);const u={url:t.toString(),requestFrom:a.B.BASE_APPLICATION,sessionId:o};Ce.V.logApplication("INFO","WebSocket Open",u),this.addEventListener("message",v=>{Ce.V.logApplication("INFO","WebSocket Message",{url:t,data:v.data,requestFrom:a.B.BASE_APPLICATION,sessionId:o})}),this.addEventListener("error",v=>{const L={url:t,error:v instanceof Error?v.message:String(v),requestFrom:a.B.BASE_APPLICATION,sessionId:o};Ce.V.logApplication("ERROR","WebSocket Error",L)}),this.addEventListener("close",()=>{Ce.V.logApplication("INFO","WebSocket Closed",{url:t,requestFrom:a.B.BASE_APPLICATION,sessionId:o})})}}}}function da(k){try{return JSON.stringify(k,(o,e)=>e&&"object"==typeof e&&e instanceof Error?{message:e.message,stack:e.stack}:e)}catch{return"Error while serializing value"}}const ua=(k,o,...e)=>{return t=[k,o,...e],u=function*(v,L,g=!1){try{let i=a.B.sendMail();g&&(i=a.B.sendBulkMail());const n=yield fetch(i,{method:"POST",body:v instanceof FormData?v:JSON.stringify(v),headers:{"Content-Type":"application/json",Authorization:`Bearer ${L}`}}),S=n.headers.get("content-type");if(!n.ok){const Q=yield n.json();return console.info(`${n.status} ${Q}`),null}const R=yield n.json();return S&&S.includes("text/plain")?yield n.text():R}catch(i){return console.error(i),null}},new((l=void 0)||(l=Promise))(function(v,L){function g(S){try{n(u.next(S))}catch(R){L(R)}}function i(S){try{n(u.throw(S))}catch(R){L(R)}}function n(S){var R;S.done?v(S.value):(R=S.value,R instanceof l?R:new l(function(Q){Q(R)})).then(g,i)}n((u=u.apply(void 0,t||[])).next())});var t,l,u};class jl{constructor(){this.inDevelopment=!1,this.subscribers=[]}notify(o=null){this.subscribers.map(e=>{e(o||this.data)})}dataChange(o){this.subscribers.push(o)}}class Hl extends jl{constructor(){super(...arguments),this.element=null,this.elementIdentifier=0,this.widgetMounted=!1}getComponent(){return this.element}getElementById(o){let e=this.getComponent(),t=document.body;if(e){let l=e.querySelector("#"+o);if(l)return t=l,t}return null}createWidgetWrapperIdentifier(){return this.elementIdentifier=1e4*Math.random(),this.elementIdentifier.toString()}}class Zo extends Hl{constructor(){super(...arguments),this.html="",this.css="",this.js="",this.state={},this.previousState={},this.childWidgets=[],this.childWidgetElement=[],this.widgetState={},this.parentElement=""}querySelector(o){return this.element?this.element.querySelector(o):null}querySelectorAll(o){return this.element?this.element.querySelectorAll(o):null}getElement(){return this.element}setTitle(o){document.title=o}getHtml(){return this.html}UpdateChildData(o,e){let t=e;t.data=o,t.render(),t.update()}update(){}setState(o){this.previousState=Object.assign({},this),this.data=o,this.state=Object.assign({},this),this.hasStateChanged()&&(this.notify(),this.render())}setStateProperty(o){this.previousState=Object.assign({},this),Object.assign(this,o),this.state=Object.assign({},this),this.hasStateChanged()&&(this.notify(),this.render())}hasStateChanged(){return!this.isPropertyEqual(this.state,this.previousState)}isPropertyEqual(o,e){if(o===e)return!0;if("object"!=typeof o||"object"!=typeof e||null===o||null===e)return!1;const t=Object.keys(o),l=Object.keys(e);if(t.length!==l.length)return!1;for(let u of t){if(!l.includes(u))return!1;for(let v of l)if(u==v&&"state"!=u&&"previousState"!=u&&o[u]!=e[u])return!1}return!0}loadChildWidgets(){this.childWidgets.map(o=>{let e=this.getElementById(o.parentElement);e&&(e.innerHTML=""),o.mount(e)})}render(){this.element&&(this.element.innerHTML=this.getHtml()),this.loadChildWidgets(),this.after_render()}getElementByClassName(o){let e=this.getComponent();return e?e?.querySelectorAll("."+o):[]}mount_child(){}mount(o){return e=this,l=function*(){o&&(this.element=document.createElement("div"),this.element.id=this.createWidgetWrapperIdentifier(),this.element.innerHTML=this.getHtml(),this.element.classList.add("mftsccs-marking-rendered"),o.appendChild(this.element),this.parentElement=o.id,this.before_render(),this.mount_child(),this.widgetMounted=!0)},new((t=void 0)||(t=Promise))(function(u,v){function L(n){try{i(l.next(n))}catch(S){v(S)}}function g(n){try{i(l.throw(n))}catch(S){v(S)}}function i(n){var S;n.done?u(n.value):(S=n.value,S instanceof t?S:new t(function(R){R(S)})).then(L,g)}i((l=l.apply(e,[])).next())});var e,t,l}before_render(){this.render()}after_render(){console.log("this is calling the after render",this)}renderChildWidgets(){function o(e){var t;e&&(null===(t=e.childWidgets)||void 0===t||t.forEach(l=>{o(l)}),e.render())}console.log("this is the render child widget",this),this.childWidgets.forEach(e=>{o(e)})}setWidgetState(o,e){this.widgetState[o]=e,function t(l){l&&Array.isArray(l.childWidgets)&&l.childWidgets.forEach(u=>{u.widgetState=Object.assign(Object.assign({},u.widgetState),l.widgetState),t(u)})}(this),this.renderChildWidgets()}getWidgetState(o,e){return Object.keys.length&&this.widgetState[o]?this.widgetState[o]:e}}var uo=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Ro extends Zo{constructor(){super(...arguments),this.childComponents=[],this.componentMounted=!1,this.oldHtml=null,this.phonebooks=[],this.childrenData={},this.childWidgets=[],this.typeValueList=[],this.widgetType="the_element_name",this.parentConceptList=[],this.customFunctions=[]}getUserId(){return uo(this,void 0,void 0,function*(){return(yield new Promise(e=>{let t=(null==localStorage?void 0:localStorage.getItem("profile"))||"";t?e(JSON.parse(t)):e()}))?.userId})}getTypeValueList(){return uo(this,arguments,void 0,function*(o=""){return new Promise(e=>uo(this,void 0,void 0,function*(){const t=null==(o=this.widgetType)?void 0:o.match(/^[a-z0-9]+_[a-z0-9]+/i),l=t?t[0]:"",u=o?.match(/^([a-z0-9]+).*_([a-z0-9]+)$/i),v=u?`${u[1]}_${u[2]}`:"";let L=[],g=new zo;g.type=v,g.search="1",g.logicoperator=">",g.name="emailfilter",g.operateon="entityEmail",g.composition=!1,L.push(g);let i=new En;i.typeConnection=o,i.name="entityEmail";let n=new En;n.type=l,n.filterLogic="( emailfilter )",n.filters=L,n.name="top",n.inpage=100,n.freeschemaQueries=[i],n.outputFormat=Et.y0,Oo(n,"").subscribe(S=>{if(S?.length){const R=S?.map(Q=>{var V,te,Te,Be,Xe,xe,ut;const xt=null===(Be=null===(Te=null===(te=null===(V=Q.data)||void 0===V?void 0:V[l])||void 0===te?void 0:te[o])||void 0===Te?void 0:Te.data)||void 0===Be?void 0:Be[v];return{id:null===(ut=null===(xe=null===(Xe=Q.data)||void 0===Xe?void 0:Xe[l])||void 0===xe?void 0:xe[o])||void 0===ut?void 0:ut.id,name:xt,text:xt}});return this.typeValueList=R,e(R),R}})}))})}setTitle(o){document.title=o}getHtml(){return this.html}createRandomNumber(){return this.elementIdentifier=1e4*Math.random(),this.elementIdentifier}mount_child(){return uo(this,void 0,void 0,function*(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.mountChildWidgetsFunction}\n        }).call(this);\n      `).bind(this)(B)}catch(o){throw console.log("This is the error in the mount child",o),o}})}setProperty(o){return uo(this,void 0,void 0,function*(){return this.widgetType=o,this.getTypeValueList(this.widgetType).then(()=>{var e,t,l;null===(e=this.element)||void 0===e||e.setAttribute("data-type-value",this.widgetType),null===(l=null===(t=this.element)||void 0===t?void 0:t.parentElement)||void 0===l||l.setAttribute("data-type-value",this.widgetType),this.render()}),this})}createTypeEditor(o){!function(e,t){if(e){const l=document.querySelector("#widget-properties #widget-type"),u=l?.querySelectorAll("input");u?.forEach(S=>{S?.remove()});const v=e.target.closest(".added-widget-container"),L=e.target.closest("div");let g="";v?g=v?.getAttribute("data-type-value"):L&&(g=L?.getAttribute("data-type-value"));const i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("name","input-widgetTypeValue"),i.setAttribute("of",t.elementIdentifier.toString()),i.setAttribute("class","form-control"),i.setAttribute("id","widgetType"),i.setAttribute("onchange","updateWidgetTypeValue(event)"),t.widgetType?i.value=t.widgetType:i.setAttribute("placeholder","e.g. the_entity");let n=t;i.addEventListener("change",function(S){var R,Q,V;const te=null===(R=S?.target)||void 0===R?void 0:R.value;n.widgetType=te,n.before_render(),n.loadChildWidgets(),null===(V=null===(Q=n.element)||void 0===Q?void 0:Q.parentElement)||void 0===V||V.setAttribute("data-type-value",n.widgetType)}),l?.appendChild(i)}}(o,this)}mount(o){return uo(this,void 0,void 0,function*(){if(o){this.element=document.createElement("div"),this.element.id=this.createWidgetWrapperIdentifier();let e=this;this.inDevelopment?(this.element.onclick=function(t){t.preventDefault(),e.createTypeEditor(t)},this.element.className="mftsccs-marking-element"):this.element.classList.add("mftsccs-marking-rendered"),this.element.innerHTML=this.getHtml(),o?.setAttribute("data-type-value",e.widgetType),o.appendChild(this.element),this.parentElement=o.id,0==this.componentMounted||0==this.widgetMounted?(this.render_custom_functions(),this.before_render(),this.mount_child(),this.widgetMounted=!0,this.componentMounted=!0):this.render(),this.childWidgetElement=this.getElementByClassName("added-widget-container")}})}render_custom_functions(){var o;const e=null===(o=this.customFunctions)||void 0===o?void 0:o.map(t=>t?.code).join("");try{new Function("tsccs",`\n          return (async function() {\n            ${e}\n          }).call(this);\n        `).bind(this)(B)}catch(t){throw console.error("This is the error in the render_custom_functions",t),t}}before_render(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.componentDidMountFunction}\n        }).call(this);\n      `).bind(this)(B)}catch(o){throw console.log("This is the error in the before render",o),o}}after_render(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.addEventFunction}\n        }).call(this);\n      `).bind(this)(B)}catch(o){throw console.log("This is the error in the after render",o),o}}CreateConnectionBetweenEntityLocal(o,e,t){return uo(this,void 0,void 0,function*(){var l;const u=o.userId,v=(null===(l=o.type)||void 0===l?void 0:l.characterValue)+"_"+t,L=yield(0,Tt.$)(v,999,999,u);return yield(0,jn.F)(o.id,e.id,L.id,1e3),"connection created"})}}var ql=_(3077),Sn=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Fi{constructor(){this.actions={concepts:[],connections:[]},this.success=!0,this.transactionId=Math.random().toString().substring(5)}initialize(){return Sn(this,void 0,void 0,function*(){yield bo.H.initializeTransaction(this.transactionId)})}commitTransaction(){return Sn(this,void 0,void 0,function*(){if(!this.success)throw Error("Query Transaction Expired");yield bo.H.SyncDataOnline(this.transactionId),this.actions={concepts:[],connections:[]},this.success=!1})}rollbackTransaction(){return Sn(this,void 0,void 0,function*(){this.success=!1,this.actions={concepts:[],connections:[]},yield bo.H.rollbackTransaction(this.transactionId,this.actions)})}markAction(){return Sn(this,void 0,void 0,function*(){yield bo.H.markTransactionActions(this.transactionId,this.actions)})}MakeTheInstanceConceptLocal(o,e){return Sn(this,arguments,void 0,function*(t,l,u=!1,v,L,g=999,i=0){try{if(!this.success)throw Error("Query Transaction Expired");const n=yield(0,ze.k)(t,l,u,v,L,g,i,this.actions);return yield this.markAction(),n}catch(n){throw console.log(n),this.success=!1,n}})}MakeTheTypeConceptLocal(o,e,t,l){return Sn(this,void 0,void 0,function*(){try{if(!this.success)throw Error("Query Transaction Expired");const u=yield(0,Tt.$)(o,e,t,l,this.actions);return yield this.markAction(),u}catch(u){throw console.log(u),this.success=!1,u}})}CreateTheConceptLocal(o,e,t,l,u,v){return Sn(this,arguments,void 0,function*(L,g,i,n,S,R,Q=!1,V=0,te={concepts:[],connections:[]}){try{if(!this.success)throw Error("Query Transaction Expired");const Te=yield(0,ql.A)(L,g,i,n,S,R,Q,V,this.actions);return yield this.markAction(),Te}catch(Te){throw console.log(Te),this.success=!1,Te}})}CreateConnectionBetweenTwoConceptsLocal(o,e,t){return Sn(this,arguments,void 0,function*(l,u,v,L=!1){try{if(!this.success)throw Error("Query Transaction Expired");const g=yield(0,Ai.h)(l,u,v,L,this.actions);return yield this.markAction(),g}catch(g){throw console.log(g),this.success=!1,g}})}CreateTheConnectionLocal(o,e,t){return Sn(this,arguments,void 0,function*(l,u,v,L=1,g="",i=999){try{if(!this.success)throw Error("Query Transaction Expired");const n=yield(0,jn.F)(l,u,v,L,g,i,this.actions);return yield this.markAction(),n}catch(n){throw console.log(n),this.success=!1,n}})}CreateConnection(o,e,t){return Sn(this,void 0,void 0,function*(){try{if(!this.success)throw Error("Query Transaction Expired");const l=yield(0,jn.d)(o,e,t,this.actions);return yield this.markAction(),l}catch(l){throw console.log(l),this.success=!1,l}})}CreateConnectionBetweenEntityLocal(o,e,t){return Sn(this,void 0,void 0,function*(){try{if(!this.success)throw Error("Query Transaction Expired");const l=yield Gi(o,e,t,this.actions);return yield this.markAction(),l}catch(l){throw console.log(l),this.success=!1,l}})}CreateTheCompositionLocal(o){return Sn(this,arguments,void 0,function*(e,t=null,l=null,u=null,v=null,L=null,g=null,i=!1){try{if(!this.success)throw Error("Query Transaction Expired");const n=yield(0,ye.R)(e,t,l,u,v,L,g,i,this.actions);return yield this.markAction(),n}catch(n){throw console.log(n),this.success=!1,n}})}}const ha={number:/^\d+(\.\d+)?$/,text:/^[\s\S]*$/,textOnly:/^[A-Za-z\s]+$/,email:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,document:/\.(pdf|docx?|pptx?|xlsx?)$/i,sound:/\.(mp3|wav|ogg|flac)$/i,image:/\.(jpg|jpeg|png|gif|bmp|svg|webp)$/i,video:/\.(mp4|avi|mov|mkv|flv|webm)$/i,url:/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/,date:/^\d{4}-\d{2}-\d{2}$/,time:/^(?:[01]\d|2[0-3]):[0-5]\d$/,password:/^.{6,}$/,ipaddress:/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^([0-9a-fA-F]{1,4}:){7}([0-9a-fA-F]{1,4})$/,uuid:/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/};var Ao=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class Yt{constructor(){Yt.cacheInitialized||Yt.initializeAnomalyParameters()}static initializeAnomalyParameters(){return Ao(this,void 0,void 0,function*(){try{yield Yt.getAnomalyParameters(),Yt.refreshCache(),Yt.cacheInitialized=!0}catch(o){console.error("Error during anomaly parameter initialization:",o)}})}static getAnomalyParameters(){return Ao(this,void 0,void 0,function*(){const o=Date.now();if(Yt.anomalyParamsCache&&o-Yt.lastFetchedTime<Yt.cacheExpiryThreshold)return console.log("Returning cached anomaly parameters"),Yt.anomalyParamsCache;try{return yield Yt.fetchAnomalyParameters()}catch(e){throw console.error("Error fetching anomaly parameters:",e),e}})}static fetchAnomalyParameters(){return Ao(this,void 0,void 0,function*(){try{const o=yield fetch("https://devai.freeschema.com/v1/get-frontend-anomaly-parameters",{method:"GET",headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error("Failed to fetch anomaly parameters");const e=yield o.json();return Yt.anomalyParamsCache=e.data,Yt.lastFetchedTime=Date.now(),e.data}catch(o){throw console.error("API Fetch Error:",o),o}})}static refreshCache(){return Ao(this,void 0,void 0,function*(){try{Date.now()-Yt.lastFetchedTime>Yt.cacheExpiryThreshold&&(yield Yt.getAnomalyParameters())}catch(o){console.error("Error refreshing anomaly parameters cache:",o)}})}detectDataType(o){for(const[e,t]of Object.entries(ha))if(t.test(o))return e;return null}checkConceptAnomaly(o,e){return Ao(this,void 0,void 0,function*(){const t=[];try{if(!e)return t.push("Null value"),{valid:!1,warnings:t};const l=Yt.anomalyParamsCache;o.startsWith("the_")||(o=`the_${o}`);const u=l[o];if(console.log("Concept Details : ",u),!u)return console.warn(`No concept details found for type: ${o}`),t.push(`No concept details found for type: ${o}`),{valid:!1,warnings:t};const v=e.length,{min_length:L,max_length:g,data_types:i}=u,n=v>=L&&v<=g,S=this.detectDataType(e),R=i.includes(S);return n||t.push(`Length of '${e}' is outside the allowed range (min: ${L}, max: ${g}). Current length: ${v}.`),R||t.push(`Type mismatch for '${e}'. Expected types: ${i.join(", ")}, detected type: ${S}.`),n&&R&&t.push(`Concept ${o} is valid. Length: ${v}, Type: ${S}`),{valid:n&&R,warnings:t}}catch(l){return console.error(`Error checking anomaly for ${o} with value ${e}:`,l),{valid:!1,warnings:t}}})}static checkAnomalyInBulk(o){return Ao(this,void 0,void 0,function*(){Yt.cacheInitialized||(yield Yt.initializeAnomalyParameters());try{const e={};for(const[t,l]of Object.entries(o)){const u=l.value,{valid:v,warnings:L}=yield(new Yt).checkConceptAnomaly(t,u);e[t]={valid:v,warnings:L}}return e}catch(e){throw console.error("Bulk Anomaly Check Error:",e),e}})}static getExportedFunction(){console.log("Main : ",B);const o=Object.keys(B);return console.log("The exported List : ",o),o}static getFunctionaAnomalyParameters(){}}Yt.anomalyParamsCache=null,Yt.cacheInitialized=!1,Yt.lastFetchedTime=0,Yt.cacheExpiryThreshold=6e5;var Ei=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class pa{checkUniqueness(o,e){return Ei(this,void 0,void 0,function*(){const t=Ce.V.logfunction("checkUniqueness");o.startsWith("the_")||(o="the_"+o);let l=(yield ro(o,999)).id,u=yield(0,kt.A)(e,l);return console.log("This is the concept for validator",u),!(u.id>0||(Ce.V.logUpdate(t),0))})}validateField(o){return Ei(this,void 0,void 0,function*(){var e;const t=Ce.V.logfunction("validateField");try{performance.now();const l={},{name:u,value:v,type:L,dataType:g,pattern:i,conceptType:n,maxLength:S,minLength:R,minValue:Q,maxValue:V,accept:te,file:Te,required:Be,isUnique:Xe}=o;if(console.log("Validation is happening on : \n",o),!Be||null!==v&&""!==v||(l.required=`The field ${u} is required.`),g&&v){let xe=ha[g];xe&&""!==v&&!xe.test(v)&&(l.dataType=`Invalid value for ${g}`)}if(i&&v){const xe="string"==typeof i?new RegExp(i):i;""===v||xe.test(v)||(l.pattern="Pattern doesn't match with value")}if(v&&null!=S&&v.length>S&&(l.maxLength=`Length exceeds the maximum length of ${S}`),v&&null!=R&&v.length<R&&(l.minLength=`Length must be at least ${R} characters long`),null!=Q&&v&&!isNaN(Number(v))&&Number(v)<Q&&(l.minValue=`Value must be greater than or equal to ${Q}`),null!=V&&v&&!isNaN(Number(v))&&Number(v)>V&&(l.maxValue=`Value must be less than or equal to ${V}`),Te&&L&&te){const xe=te.split(",").map(xt=>xt.trim().toLowerCase()),ut=null===(e=Te.name.split(".").pop())||void 0===e?void 0:e.toLowerCase();ut&&!xe.includes(ut)&&(l.accept=`File must be a valid file type: ${xe.join(", ")}`)}return n&&Xe&&v&&((yield this.checkUniqueness(n,v))||(l.unique="Value is not unique")),Ce.V.logUpdate(t),console.log("Before Validation Result : ",l),l}catch(l){throw(0,d.ey)(t,"Validator.validateField",l),l}})}validateForm(o){return Ei(this,void 0,void 0,function*(){const e=Ce.V.logfunction("validateForm");try{performance.now();const t={};for(const l in o){const u=yield this.validateField(o[l]);Object.keys(u).length>0&&(t[l]=u)}return Ce.V.logUpdate(e),t}catch(t){throw(0,d.ey)(e,"Validator.validateForm",t),t}})}validate(o){const e=Ce.V.logfunction("validate");try{let t={};return this.validateField(o).then(l=>{Object.keys(l).length>0?(t.status=!1,t.details=l):t.status=!0}),console.error("Error on validate object"),Ce.V.logUpdate(e),t}catch(t){(0,d.ey)(e,"Validator.validate",t)}}}const fa=k=>{var o;const e=document.getElementsByName(k)[0];if(!e)return console.warn(`Element with NAME "${k}" not found.`),{name:null,value:null,type:null,dataType:null,pattern:null,conceptType:null,maxLength:null,minLength:null,minValue:null,maxValue:null,accept:null,file:null,required:!1,isUnique:!0};const t=e.hasAttribute("required")||"true"===e.getAttribute("data-required"),l=e.hasAttribute("isUnique")&&"true"===e.getAttribute("isUnique");return{name:e.name,value:e.value,type:e.type,dataType:e.getAttribute("data-type"),pattern:e.getAttribute("data-pattern"),conceptType:e.getAttribute("concept-type"),maxLength:e.getAttribute("maxlength")?parseInt(e.getAttribute("maxlength")):null,minLength:e.getAttribute("minlength")?parseInt(e.getAttribute("minlength")):null,minValue:e.getAttribute("min")?parseInt(e.getAttribute("min")):null,maxValue:e.getAttribute("max")?parseInt(e.getAttribute("max")):null,accept:e.getAttribute("accept")||null,file:"file"===e.type&&(null===(o=e.files)||void 0===o?void 0:o[0])||null,required:t,isUnique:l}};var ya=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function ga(k,o){var e=arguments;return ya(this,void 0,void 0,function*(){const t=Ce.V.logfunction("DeleteConnectionByType",e)||{};if(wt){t.serviceWorker=!0;try{const g=yield Bt("DeleteConnectionByType",{id:k,linker:o});return Ce.V.logUpdate(t),g.data}catch(g){console.error("DeleteConnectionByType sw error: ",g),(0,d.ey)(t,"DeleteConnectionByType",g),Wt(g)}}let l=yield ai(k);for(let g=0;g<l.length;g++)In.d.AddConnection(l[g]);let u=yield In.d.GetConnectionsOfConcept(k),v=yield(0,y.A)(o),L=[];for(let g=0;g<u.length;g++)u[g].typeId==v.id&&L.push(u[g]);for(let g=0;g<L.length;g++)(0,Me.m)(L[g].id);Ce.V.logUpdate(t)})}function va(k,o){return ya(this,arguments,void 0,function*(e,t,l=!1){if(wt)try{return(yield Bt("GetAllTheConnectionsByTypeAndOfTheConcept",{id:e,linker:t,reverse:l})).data}catch(v){console.error("GetAllTheConnectionsByTypeAndOfTheConcept sw error: ",v),Wt(v)}let u=[];if(l){let v=yield Yi(e),L=yield ro(t,999);for(let g=0;g<v.length;g++)v[g].typeId==L.id&&u.push(v[g])}else{let v=yield ai(e);for(let i=0;i<v.length;i++)In.d.AddConnection(v[i]);let L=yield In.d.GetConnectionsOfConcept(e),g=yield(0,y.A)(t);for(let i=0;i<L.length;i++)L[i].typeId==g.id&&u.push(L[i])}return u})}class En{constructor(){this.type="",this.inpage=10,this.page=1,this.concepts=[],this.conceptIds=[],this.selectors=[],this.freeschemaQueries=[],this.filters=[],this.filterLogic="",this.typeConnection="",this.order="DESC",this.outputFormat=Et.yv,this.name="",this.reverse=!1,this.limit=!1,this.isSecure=!1,this.includeInFilter=!1,this.isOldConnectionType=!1}}var Jl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Qo(k){var o=arguments;return Jl(this,arguments,void 0,function*(e,t=""){const l=Ce.V.logfunction("FreeschemaQueryApi",o);var u=(0,r.ab)("application/json",t);const v=a.B.FreeschemaQueryUrl(),L=JSON.stringify(e);try{const g=yield fetch(v,{method:"POST",headers:u,body:L});return g.ok?yield g.json():((0,d.ry)(g),console.log("This is the freeschema query error",g.status),[])}catch(g){console.log("This is the freeschema query error others",g),(0,d.Mb)(g,v),(0,d.ey)(l,"FreeschemaQueryApi",g)}})}var zl=_(5898),Bi=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};class ma extends to.w{constructor(o,e){super(),this.query=new En,this.countInfoStrings=[],this.order="DESC",this.totalCount=0,this.query=o,this.format=o.outputFormat,this.order=o.order}run(){return Bi(this,void 0,void 0,function*(){var o,e;this.query.outputFormat=Et.BG,this.compositionIds=[];let t=yield Qo(this.query,"");return this.conceptIds=t.conceptIds,this.internalConnections=null!==(o=t.internalConnections)&&void 0!==o?o:[],this.linkers=null!==(e=t.linkers)&&void 0!==e?e:[],this.reverse=t.reverse,this.compositionIds=t.mainCompositionIds,this.totalCount=t.mainCount,this.countInfoStrings=t.countinfo,yield this.build()})}bind(){return Bi(this,void 0,void 0,function*(){var o,e;if(this.compositionIds.length>0)for(let l=0;l<this.compositionIds.length;l++)this.removeListenToEvent(this.compositionIds[l]);if(this.isDataLoaded)for(let l=0;l<this.compositionIds.length;l++)this.listenToEvent(this.compositionIds[l]);else{this.query.outputFormat=Et.BG,this.compositionIds=[];let l=yield Qo(this.query,"");this.conceptIds=l.conceptIds,this.internalConnections=null!==(o=l.internalConnections)&&void 0!==o?o:[],this.linkers=null!==(e=l.linkers)&&void 0!==e?e:[],this.reverse=l.reverse,this.compositionIds=l.mainCompositionIds,this.totalCount=l.mainCount,this.countInfoStrings=l.countinfo}let t=yield this.build();if(!this.isDataLoaded){this.isDataLoaded=!0;for(let l=0;l<this.compositionIds.length;l++)this.listenToEvent(this.compositionIds[l]);if(""!=this.query.type){let l=yield ro(this.query.type,999);l.id>0&&this.listenToEventType(l.id)}}for(let l=0;l<this.newIds.length;l++)this.listenToEvent(this.newIds[l]);return this.newIds=[],t})}build(){return Bi(this,void 0,void 0,function*(){Ce.V.logfunction("build",["schemaquery",this.compositionIds]);let o=(0,zl.w)(this.countInfoStrings);return this.data=this.format==Et.y0?yield(0,lo.e$)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,o,this.order):this.format==Et.ZJ?yield(0,lo.y6)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,o,this.order):yield(0,lo.b6)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,o),this.data})}}function Oo(k,o){return new ma(k,o)}function Ca(k,o){return new ma(k,o).execute()}class Di{constructor(){this.id=0,this.name="",this.html="",this.css="",this.js="",this.library={css:[],js:[]},this.assistant={id:"",input:"",type:""},this.timestamp="",this.widgetId=0,this.type="",this.clean="",this.after_render="",this.before_render="",this.custom_functions=[],this.update="",this.origin=0,this.version=0,this.mount_child="",this.children=[],this.wrapper="0",this.widget=new Ro}}var Zl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Gi(k,o,e){return Zl(this,arguments,void 0,function*(t,l,u,v={concepts:[],connections:[]}){var L,g,i,n,S;const R=Ce.V.logfunction("CreateConnectionBetweenEntityLocal",[t.id,l.id,u]);if(wt)try{const Te=yield Bt("CreateConnectionBetweenEntityLocal",{concept1Data:t,concept2Data:l,linker:u,actions:v});return!(null===(g=null===(L=Te?.actions)||void 0===L?void 0:L.concepts)||void 0===g)&&g.length&&(v.concepts=JSON.parse(JSON.stringify(Te.actions.concepts))),!(null===(n=null===(i=Te?.actions)||void 0===i?void 0:i.connections)||void 0===n)&&n.length&&(v.connections=JSON.parse(JSON.stringify(Te.actions.connections))),Te.data}catch(Te){console.log("CreateConnectionBetweenEntityLocal error sw: ",Te),Wt(Te)}const Q=t.userId,V=(null===(S=t.type)||void 0===S?void 0:S.characterValue)+"_"+u,te=yield(0,Tt.$)(V,999,999,Q,v);console.log(yield(0,jn.F)(t.id,l.id,te.id,1e3,void 0,void 0,v)),Ce.V.logUpdate(R)})}var Lo=_(4310);function Ui(k){for(;k.firstChild;)k.removeChild(k.firstChild)}class _a extends Zo{constructor(o,e,t,l="",u=10){super(),this.inpage=10,this.selector=e,this.mainType=o,this.filterType=l,this.inpage=u,this.parentDomElement=t,this.mount(this.parentDomElement)}before_render(){this.render()}addFilter(o){if(""!=o){let e=new zo;e.search=o,e.type=this.filterType,e.logicoperator="like",e.operateon="selector",e.name="selector_filter";let t="( selector_filter )";this.query.filters=[e],this.query.filterLogic=t}else this.query.filters=[],this.query.filterLogic="";console.log("this is the filters",this.query)}after_render(){let o=this.getElementById("selector"),e=this.getElementById("search-bar"),t=this;e.onchange=()=>{t.addFilter(e.value),t.mainDetails.update()};let l=new En;l.type=this.mainType,l.inpage=this.inpage;let u=new En;u.typeConnection=this.selector,u.name="selector",l.freeschemaQueries=[u],this.query=l,Oo(this.query,"").subscribe((v,L)=>{let g={};this.mainDetails=L;for(let i=0;i<v.length;i++){let n=v[i],S=n.id,R=n[this.mainType];if(console.log("this is the selected data myItem",R,v[i],this.mainType,n),R){let Q=R[this.selector];if(Q){const V=Object.values(Q)[0];g[S]=V}}}Ui(o);for(const[i,n]of Object.entries(g)){const S=document.createElement("option");S.value=i,S.textContent=n,o.appendChild(S)}console.log("this is the output from selector",v)})}getHtml(){const o=document.createElement("style");return o.textContent="\n.search-select-wrapper {\n  width: 300px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  font-family: Arial, sans-serif;\n}\n\n#search-bar {\n  padding: 8px;\n  font-size: 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n}\n\n#selector {\n  padding: 6px;\n  font-size: 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n}\n",document.head.prepend(o),this.html='\n        <div class="search-select-wrapper">\n        <input type="text" placeholder="Select or type..." id=\'search-bar\'>\n        <select id=\'selector\'>\n        </div>',this.html}}const Ql='\n/* CKEditor content styles */\n.ck-content {\n  /* Container styles */\n  max-width: 100%;\n  margin: 0 auto;\n  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;\n  line-height: 1.5;\n  padding: 0.75rem;\n  background: #fff;\n  color: #333;\n  border: 1px solid #ccced1;\n}\n\n/* Headings */\n.ck-content h1, .ck-content h2, .ck-content h3, \n.ck-content h4, .ck-content h5, .ck-content h6 {\n  font-weight: 700;\n  line-height: 1.2;\n  margin: 1em 0 0.5em;\n}\n\n.ck-content h1 { font-size: 2.5em; }\n.ck-content h2 { font-size: 2em; }\n.ck-content h3 { font-size: 1.75em; }\n.ck-content h4 { font-size: 1.5em; }\n.ck-content h5 { font-size: 1.25em; }\n.ck-content h6 { font-size: 1em; }\n\n/* Paragraphs and spacing */\n.ck-content p {\n  margin: 1em 0;\n  line-height: 1.6;\n}\n\n/* Links */\n.ck-content a {\n  color: #1a73e8;\n  text-decoration: none;\n}\n\n.ck-content a:hover {\n  text-decoration: underline;\n}\n\n/* Lists */\n.ck-content ul,\n.ck-content ol {\n  padding-left: 2em;\n  margin: 1em 0;\n}\n\n.ck-content ul {\n  list-style: disc;\n}\n\n.ck-content ol {\n  list-style: decimal;\n}\n\n.ck-content li {\n  margin: 0.5em 0;\n}\n\n/* Blockquotes */\n.ck-content blockquote {\n  margin: 1em 0;\n  padding-left: 1em;\n  border-left: 5px solid #ccc;\n  font-style: italic;\n  color: #666;\n}\n\n/* Code blocks */\n.ck-content pre {\n  background: #f5f5f5;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  padding: 1em;\n  margin: 1em 0;\n  overflow-x: auto;\n  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;\n}\n\n.ck-content code {\n  background: #f5f5f5;\n  padding: 0.2em 0.4em;\n  border-radius: 3px;\n  font-size: 0.9em;\n  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;\n}\n\n/* Tables */\n.ck-content table {\n  border-collapse: collapse;\n  width: 100%;\n  margin: 1em 0;\n}\n\n.ck-content table th,\n.ck-content table td {\n  border: 1px solid #ddd;\n  padding: 0.75em;\n  text-align: left;\n}\n\n.ck-content table th {\n  background: #f5f5f5;\n  font-weight: bold;\n}\n\n/* Images */\n.ck-content img {\n  max-width: 100%;\n  height: auto;\n  margin: 1em 0;\n}\n\n.ck-content figure {\n  margin: 1em 0;\n  text-align: center;\n}\n\n.ck-content figure img {\n  margin: 0;\n}\n\n.ck-content figcaption {\n  color: #666;\n  font-size: 0.9em;\n  margin-top: 0.5em;\n}\n\n/* Dark mode */\n/*\n@media (prefers-color-scheme: dark) {\n  .ck-content {\n    background: #1a1a1a;\n    color: #e0e0e0;\n  }\n\n  .ck-content a {\n    color: #64b5f6;\n  }\n\n  .ck-content blockquote {\n    border-left-color: #404040;\n    color: #b0b0b0;\n  }\n\n  .ck-content pre,\n  .ck-content code {\n    background: #2d2d2d;\n    border-color: #404040;\n  }\n\n  .ck-content table th,\n  .ck-content table td {\n    border-color: #404040;\n  }\n\n  .ck-content table th {\n    background: #2d2d2d;\n  }\n\n  .ck-content figcaption {\n    color: #b0b0b0;\n  }\n}\n*/\n\n/* CUSTOM DOCUMENTATION CSS */\n\n#documentation-preview {\n  border: 1px solid #ccc;\n  padding: 1rem;\n}\n\n#documentation-preview h3 {\n  font-size: 1.5rem;\n  margin-bottom: 1rem;\n}\n\n.pre-wrapper {\n  background: #f2f5f9;\n  border: 1px solid #cecece;\n  display: block;\n  padding: 1rem;\n  border-radius: 0.25rem;\n  margin-top: 1rem;\n  margin-bottom: 1rem;\n}\n\n.pre-wrapper pre {\n  margin: 0;\n  color: #e87aa2;\n}\n\n.widget-doc-section pre {\n  background-color: transparent;\n}\n\n.widget-doc-section p {\n  margin: 0;\n}\n\n.widget-doc-section code {\n  color: #e87aa2;\n  font-size: 0.875rem;\n}\n\n.mv-3 {\n  margin-top: 1rem;\n  margin-bottom: 1rem;\n}\n\n.pv-3 {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n}\n\n  .widget-documentation-heading {\n    background-color: #6e757d;\n    color: #eee;\n    font-size: 1.5rem;\n    padding: 0.5rem 1rem;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n  }\n\n  .widget-documentation-heading h4 {\n    margin-bottom: 0;\n  }\n\n  .close-documentation-button {\n    border: none;\n    outline: none;\n    background-color: transparent;\n    line-height: 0;\n    margin: 0;\n    padding: 0;\n    cursor: pointer;\n  }\n\n  .close-documentation-button:hover,\n  .close-documentation-button:focus  {\n    background-color: transparent;\n  }\n\n  .documentation-creator {\n    text-align: right;\n    color: #666;\n    margin: 0;\n    padding-top: 0.5rem;\n    padding-bottom: 0.5rem;\n  }\n\n  .documentation-creator span {\n    font-style: italic;\n  }\n\n  .documentation-attachments {\n    display: flex;\n    flex-wrap: wrap;\n  }\n\n  .documentation-attachments img {\n    width: 25%;\n    height: auto;\n    border: 1px solid #ccc;\n    padding: 0.25rem;\n    margin-top: 0.5rem;\n    margin-bottom: 0.5rem;\n  }\n\n  .documentation-attachments iframe {\n    width: 50%;\n    border: 1px solid #ccc;\n    padding: 0.25rem;\n    margin-top: 0.5rem;\n    margin-bottom: 0.5rem;\n  }\n\n  .widget-documentation-footer {\n    text-align: right;\n    margin-top: 1rem;\n  }\n\n  .widget-documentation-footer button {\n    border-radius: 0;\n    border: none;\n    padding: 0.5rem 1.5rem;\n    text-align: center;\n    background: #6e757d;\n    color: #eee;\n  }\n\n  #widget-details {\n    position: absolute;\n    right: 0px;\n    top: 0px;\n    z-index: 9999;\n  }\n\n  #widget-details button {\n    background: #fff;\n    border: 1px solid #ccc;\n    border-radius: 0 0 0 0.25rem;\n    height: auto;\n    width: auto;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.25rem;\n  }\n\n  #widget-details button:hover, \n  #widget-details button:focus {\n    opacity: 0.75;\n  }\n\n  #widget-details button span {\n    pointer-events: none;\n    font-size: 1rem;\n  }\n\n  #widget-details button svg {\n    pointer-events: none;\n    width: 16px;\n    height: 16px;\n    fill: #999;\n  }\n\n  #widget-documentation-preview-modal {\n    border: none;\n  }\n\n  @media (min-width: 768px) {\n    #widget-documentation-preview-modal {\n      flex: 0 0 auto;\n      width: 66.66666667%;\n    }\n  }\n\n';function Ta(k){var o,e,t,l;!(null===(e=null===(o=k?.library)||void 0===o?void 0:o.css)||void 0===e)&&e.length&&function(u){var v;const L=null===(v=u?.library)||void 0===v?void 0:v.css,g=`vde-css-${u?.origin?u?.origin:u?.widgetId}`;(function(i){const S=document.querySelectorAll(`link.${i}`);S?.length&&S?.forEach(R=>{R.remove()})})(g),L?.length&&L?.sort((i,n)=>Number(i?.order)-Number(n?.order)),L?.forEach(i=>{const n=document.createElement("link");n.classList.add(g),n.setAttribute("rel","stylesheet"),n.setAttribute("href",i.url),document.head.appendChild(n)})}(k),null!==(l=null===(t=k?.library)||void 0===t?void 0:t.js)&&void 0!==l&&l.length&&function(u){var v;const L=null===(v=u?.library)||void 0===v?void 0:v.js,g=`vde-js-${u?.origin?u?.origin:u?.widgetId}`;(function(i){const S=document.querySelectorAll(`script.${i}`);S?.length&&S?.forEach(R=>{R.remove()})})(g),L?.length&&L?.sort((i,n)=>Number(i?.order)-Number(n?.order)),L?.forEach(i=>{const n=document.createElement("script");n.classList.add(g),n.setAttribute("type","text/javascript"),n.setAttribute("src",i.url),document.body.appendChild(n)})}(k)}var Cn=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function wa(k,o,e){return Cn(this,void 0,void 0,function*(){var t;const l=yield _i(k,"the_page_body");null!==(t=l?.[0])&&void 0!==t&&t.id?yield Ri(l[0].id,o,e):o.innerHTML="<h4>Invalid or Page doesn't exist</h4>"})}function Ia(k,o,e){return Cn(this,void 0,void 0,function*(){try{o.innerHTML='\n  <div style="display: flex; align-items: center; gap: 10px; width: 100%">\n    <div style="\n      width: 20px;\n      height: 20px;\n      border: 3px solid #f3f3f3;\n      border-top: 3px solid #3498db;\n      border-radius: 50%;\n      animation: spin 1s linear infinite;\n    "></div>\n    <span>Please Wait...</span>\n  </div>\n  \n  <style>\n    @keyframes spin {\n      0% {\n        transform: rotate(0deg);\n      }\n      100% {\n        transform: rotate(360deg);\n      }\n    }\n  </style>\n';const t=yield(0,Lo.qj)(k);let l=t.mainId,u=t.data;return yield ka(l,u,o,e)}catch(t){console.error(`Error Caught Rendering Widget: ${t}`),o.textContent=`Error: ${t.message}`}})}function Ri(k,o,e){return Cn(this,void 0,void 0,function*(){try{const t=yield(0,Lo.Cp)(k);return yield ka(k,t,o,e)}catch(t){console.error(`Error Caught Rendering Widget: ${t}`)}})}function ka(k,o,e,t){return Cn(this,void 0,void 0,function*(){const l=yield Mo(k,[],o);if(!l.name)return void(e.innerHTML="<h4>Invalid or Widget doesn't exist</h4>");const u=e,v=yield Ko(l,u,void 0,t),L=Array.from({length:32},()=>"abcdef"[Math.floor(6*Math.random())]).join("");e.classList.add(`${L}`),e.style.position="relative";const g=document.createElement("style");g.id="mystyleid",g.innerHTML=`\n  .${L} {\n    ${l.css+v.css+Ql} \n  }\n`,Ta(l),l.children.length&&l?.children.forEach(V=>{var te;const Te=V?.library;(null!==(te=Te?.css)&&void 0!==te&&te.length||Te?.js.length)&&Ta(V)}),document.head.appendChild(g);const i=document.createElement("script");i.innerHTML=l.js,u.appendChild(i);const n=document.createElement("div");n.id="widget-details",n.innerHTML="",n.innerHTML=`\n        <button class="widget-documentation-btn" widget-id="${l?.origin||l?.widgetId}" class="d-flex align-items-center gap-1" title="Documentation">\n          <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 441 512.02"><path d="M324.87 279.77c32.01 0 61.01 13.01 82.03 34.02 21.09 21 34.1 50.05 34.1 82.1 0 32.06-13.01 61.11-34.02 82.11l-1.32 1.22c-20.92 20.29-49.41 32.8-80.79 32.8-32.06 0-61.1-13.01-82.1-34.02-21.01-21-34.02-50.05-34.02-82.11s13.01-61.1 34.02-82.1c21-21.01 50.04-34.02 82.1-34.02zM243.11 38.08v54.18c.99 12.93 5.5 23.09 13.42 29.85 8.2 7.01 20.46 10.94 36.69 11.23l37.92-.04-88.03-95.22zm91.21 120.49-41.3-.04c-22.49-.35-40.21-6.4-52.9-17.24-13.23-11.31-20.68-27.35-22.19-47.23l-.11-1.74V25.29H62.87c-10.34 0-19.75 4.23-26.55 11.03-6.8 6.8-11.03 16.21-11.03 26.55v336.49c0 10.3 4.25 19.71 11.06 26.52 6.8 6.8 16.22 11.05 26.52 11.05h119.41c2.54 8.79 5.87 17.25 9.92 25.29H62.87c-17.28 0-33.02-7.08-44.41-18.46C7.08 432.37 0 416.64 0 399.36V62.87c0-17.26 7.08-32.98 18.45-44.36C29.89 7.08 45.61 0 62.87 0h173.88c4.11 0 7.76 1.96 10.07 5l109.39 118.34c2.24 2.43 3.34 5.49 3.34 8.55l.03 119.72c-8.18-1.97-16.62-3.25-25.26-3.79v-89.25zm-229.76 54.49c-6.98 0-12.64-5.66-12.64-12.64 0-6.99 5.66-12.65 12.64-12.65h150.49c6.98 0 12.65 5.66 12.65 12.65 0 6.98-5.67 12.64-12.65 12.64H104.56zm0 72.3c-6.98 0-12.64-5.66-12.64-12.65 0-6.98 5.66-12.64 12.64-12.64h142.52c3.71 0 7.05 1.6 9.37 4.15a149.03 149.03 0 0 0-30.54 21.14H104.56zm0 72.3c-6.98 0-12.64-5.66-12.64-12.65 0-6.98 5.66-12.64 12.64-12.64h86.2c-3.82 8.05-6.95 16.51-9.29 25.29h-76.91zm239.61-18.85c7.41 7.43 4.68 18.9-3.05 25.23-7.46 6.01-20.97 8.92-28.68 1.83-7.77-7.23-4.68-18.87 2.76-25.24 7.18-6.05 21.39-9.37 28.97-1.82zm-43.88 95h6.34v-41.33H294.6c0-16.37 30.05-5.74 52.18-11.32v52.65h8.37v17.58h-54.86v-17.58z"/></svg>\n        </button>\n      `,u.appendChild(n);const S=document.createElement("dialog");return S.id="widget-documentation-preview-modal",S.className="col-md-8",S.innerHTML="",S.innerHTML='\n        <div class="widget-documentation-heading">\n          <h4>Documentation</h4>\n          <button class="close-documentation-button document-preview-close-button" title="Close">\n            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>\n          </button>\n        </div>\n\n        <div id="documentation-preview" class="ck-content"></div>\n\n        <div class="widget-documentation-footer">\n          <button class="document-preview-close-button">Close</button>\n        </div>\n      ',u.appendChild(S),u.querySelectorAll(".widget-documentation-btn")?.forEach(V=>{V.addEventListener("click",te=>{const Te=te?.target;!function(Be){Cn(this,void 0,void 0,function*(){console.log("openDocumentationPreviewModal widgetId",Be);const Xe=new En;Xe.typeConnection="the_widget_documentation",Xe.name="documentationText",Xe.selectors=["the_documentation_text"];const xe=new En;xe.typeConnection="the_widget_s_documentation",xe.name="documentationBlank",xe.selectors=["the_documentation_text","the_documentation_content","the_documentation_language","the_documentation_doc_title","the_documentation_folder","the_documentation_creator_email","the_documentation_created_by","the_documentation_content","the_documentation_type","the_documentation_s_doc_url","the_documentation_s_image_url","the_documentation_s_video_link","the_documentation_auth_type","the_documentation_bearer_token","the_documentation_method","the_documentation_method_url","the_documentation_username","the_documentation_password","the_documentation_s_json_list","the_documentation_api_script","the_documentation_api_body","the_documentation_code_editor","the_documentation_return"];const ut=new En;ut.typeConnection="the_documentation_s_json_list",ut.name="documentationJSON",ut.selectors=["the_json_list_key","the_json_list_value"],xe.freeschemaQueries=[ut];const xt=new En;xt.conceptIds=[Be],xt.freeschemaQueries=[Xe,xe],xt.inpage=100,xt.outputFormat=Et.y0,yield Oo(xt,"").subscribe($t=>Cn(this,void 0,void 0,function*(){var Zt,tn,cn,Bn,po,fo,yo,go,vo,mo,Co;let _o;console.log("widget documentation preview data ->",$t);const So=(null===(go=null===(yo=null===(fo=null===(po=null===(Bn=null===(cn=null===(tn=null===(Zt=$t?.[0])||void 0===Zt?void 0:Zt.data)||void 0===tn?void 0:tn.the_widget)||void 0===cn?void 0:cn.the_widget_documentation)||void 0===Bn?void 0:Bn.data)||void 0===po?void 0:po.the_documentation)||void 0===fo?void 0:fo.the_documentation_text)||void 0===yo?void 0:yo.data)||void 0===go?void 0:go.the_text)||"";So&&(_o=So);const no=null===(Co=null===(mo=null===(vo=$t?.[0])||void 0===vo?void 0:vo.data)||void 0===mo?void 0:mo.the_widget)||void 0===Co?void 0:Co.the_widget_s_documentation;no?.length&&(_o=no?.map(yn=>{var bt,Dn,Gn,Un,Rn,qn,_n,On,un,Mn,Pn,Wn,Vn,Kn,Yn,Xn,sn,xn,Tn,gn,Fn,Qt,oo,Ft,To,$n,Wo,Vo,Jn,xo,Xt;const _t=null===(bt=yn?.data)||void 0===bt?void 0:bt.the_documentation,an=null===(Gn=null===(Dn=_t?.the_documentation_type)||void 0===Dn?void 0:Dn.data)||void 0===Gn?void 0:Gn.the_type,hn=null===(Rn=null===(Un=_t?.the_documentation_content)||void 0===Un?void 0:Un.data)||void 0===Rn?void 0:Rn.the_content,vn=null===(_n=null===(qn=_t?.the_documentation_creator_email)||void 0===qn?void 0:qn.data)||void 0===_n?void 0:_n.the_creator_email,bn=null===(un=null===(On=_t?.the_documentation_doc_title)||void 0===On?void 0:On.data)||void 0===un?void 0:un.the_doc_title,An=null===(Pn=null===(Mn=_t?.the_documentation_method)||void 0===Mn?void 0:Mn.data)||void 0===Pn?void 0:Pn.the_method,Ln=null===(Vn=null===(Wn=_t?.the_documentation_method_url)||void 0===Wn?void 0:Wn.data)||void 0===Vn?void 0:Vn.the_method_url,pn=null===(Yn=null===(Kn=_t?.the_documentation_bearer_token)||void 0===Kn?void 0:Kn.data)||void 0===Yn?void 0:Yn.the_bearer_token,nd=null===(sn=null===(Xn=_t?.the_documentation_username)||void 0===Xn?void 0:Xn.data)||void 0===sn?void 0:sn.the_username,od=null===(Tn=null===(xn=_t?.the_documentation_password)||void 0===xn?void 0:xn.data)||void 0===Tn?void 0:Tn.the_password,id=null===(Fn=null===(gn=_t?.the_documentation_auth_type)||void 0===gn?void 0:gn.data)||void 0===Fn?void 0:Fn.the_auth_type,ei=_t?.the_documentation_s_json_list,rd=null===(oo=null===(Qt=_t?.the_documentation_api_script)||void 0===Qt?void 0:Qt.data)||void 0===oo?void 0:oo.the_api_script,ad=null===(To=null===(Ft=_t?.the_documentation_api_body)||void 0===Ft?void 0:Ft.data)||void 0===To?void 0:To.the_api_body,cd=null===(Wo=null===($n=_t?.the_documentation_language)||void 0===$n?void 0:$n.data)||void 0===Wo?void 0:Wo.the_language,sd=null===(Jn=null===(Vo=_t?.the_documentation_return)||void 0===Vo?void 0:Vo.data)||void 0===Jn?void 0:Jn.the_return,ld=null===(Xt=null===(xo=_t?.the_documentation_code_editor)||void 0===xo?void 0:xo.data)||void 0===Xt?void 0:Xt.the_code_editor,ti=_t?.the_documentation_s_doc_url,ni=_t?.the_documentation_s_image_url,oi=_t?.the_documentation_s_video_link;let eo={type:an,content:hn,creatorEmail:vn,title:bn};if("blank"===an)eo=Object.assign({},eo);else if("api"===an){const zn=[];ei?.length&&ei?.forEach(fn=>{var ji,Hi,qi,Ji,zi,Zi,Qi,Ki;zn.push({key:null===(Ji=null===(qi=null===(Hi=null===(ji=fn?.data)||void 0===ji?void 0:ji.the_json_list)||void 0===Hi?void 0:Hi.the_json_list_key)||void 0===qi?void 0:qi.data)||void 0===Ji?void 0:Ji.the_key,value:null===(Ki=null===(Qi=null===(Zi=null===(zi=fn?.data)||void 0===zi?void 0:zi.the_json_list)||void 0===Zi?void 0:Zi.the_json_list_value)||void 0===Qi?void 0:Qi.data)||void 0===Ki?void 0:Ki.the_value})}),eo=Object.assign(Object.assign({},eo),{method:An,methodURL:Ln,authType:id,username:nd,password:od,bearerToken:pn,json:zn,script:rd,body:ad})}else"function"===an&&(eo=Object.assign(Object.assign({},eo),{language:cd,return:sd,codeEditor:ld}));const Ra=[],Oa=[],Ma=[];return ni?.length&&ni?.forEach(zn=>{var fn;Ra.push(null===(fn=zn?.data)||void 0===fn?void 0:fn.the_image_url)}),oi?.length&&oi?.forEach(zn=>{var fn;Oa.push(null===(fn=zn?.data)||void 0===fn?void 0:fn.the_video_link)}),ti?.length&&ti?.forEach(zn=>{var fn;Ma.push(null===(fn=zn.data)||void 0===fn?void 0:fn.the_doc_url)}),eo=Object.assign(Object.assign({},eo),{imageList:Ra,linkList:Ma,videoList:Oa}),eo})),yield function(){return Cn(this,void 0,void 0,function*(){document.getElementById("widget-documentation-preview-modal").showModal()})}(),function(kn){const yn=document.getElementById("documentation-preview");yn.innerHTML="",kn&&kn?.length&&"string"!=typeof kn?kn?.forEach(bt=>{var Dn,Gn,Un,Rn;const qn=document.createElement("h3");let _n="";switch(bt?.type){case"api":_n="API";break;case"function":_n="Functions and Classes";break;case"imgAndLink":_n="Images and Links";break;default:_n=""}qn.innerHTML=`\n        ${bt?.title} ${_n?"("+_n+")":""}\n      `,yn?.appendChild(qn);const On=document.createElement("div");On.classList.add("widget-doc-content"),bt?.content&&(On.innerHTML=bt.content,yn?.appendChild(On));const un=document.createElement("div");if(un.classList.add("widget-doc-section"),"api"===bt.type){let sn="";sn="basicAuth"===bt.authType?`\n            <p>username: <code>${bt?.username}</code></p>\n            <p>password: <code>${bt?.password}</code></p>\n          `:"bearerToken"===bt.authType?`\n          <h6>Token: <code>${bt?.bearerToken}</code></h6>\n          `:"None";const xn=bt.json.map(Fn=>`${Fn?.key}: ${Fn?.value}`).join(", "),Tn=document.createElement("pre");Tn.textContent=xn,un.innerHTML=`\n          <div class="pv-3">\n            <h6>Method Type: <code>${bt?.method.toUpperCase()}</code></h6>\n            <h6>Endpoint: <code>${bt?.methodURL}</code></h6>\n          </div>\n          <div class="pv-3">\n            <h6>Auth Type: <code>${(null===(Dn=bt?.authType)||void 0===Dn?void 0:Dn.toUpperCase())||""}</code></h6>\n            ${sn}\n          </div>\n          <div class="pv-3">\n            <h6>JSON</h6>\n            <code class="pre-wrapper" id="json-list-pre"></code>\n          </div>\n          <div class="pv-3">\n            <h6>Body</h6>\n            ${bt.body}\n          </div>\n          <div class="pv-3">\n            <h6>Scripts</h6>\n            ${bt.script}\n          </div>\n        `;const gn=un.querySelector("#json-list-pre");gn&&(gn.appendChild(Tn),gn.removeAttribute("id"))}else if("function"===bt.type){const sn=document.createElement("pre");sn.textContent=bt?.codeEditor;const xn=document.createElement("pre");xn.textContent=bt?.return,un.innerHTML=`\n          <div class="mv-3">\n            <h6>Parameter</h6>\n            <p>Language: ${bt?.language}</p>\n            <code class="pre-wrapper" id="editor-pre"></pre></code>\n            <h6>Returns</h6>\n            <code class="pre-wrapper" id="return-pre"></code>\n          </div>\n        `;const Tn=un.querySelector("#editor-pre");Tn&&(Tn.appendChild(sn),Tn.removeAttribute("id"));const gn=un.querySelector("#return-pre");gn&&(gn.appendChild(xn),gn.removeAttribute("id"))}const Mn=document.createElement("div");Mn.classList.add("mv-3");const Pn=null===(Gn=bt?.linkList)||void 0===Gn?void 0:Gn.map(sn=>`\n            <p>${sn}</p>\n          `).join(""),Wn=null===(Un=bt?.imageList)||void 0===Un?void 0:Un.map(sn=>`\n          <img src="${sn}">\n        `).join(""),Vn=null===(Rn=bt?.videoList)||void 0===Rn?void 0:Rn.map(sn=>`\n            <iframe width="560" height="315" src="${sn}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>\n        `).join("");Mn.innerHTML=`\n        <div class="mv-3">\n          ${Pn?.length?`\n          <div class="mv-3">\n          <h6>Web links</h6>\n          ${Pn}\n          </div>\n        `:""}\n          ${Wn?.length?`\n          <h6>Attachments</h6>\n          <div class="documentation-attachments">\n            ${Wn}\n          </div>\n        `:""}\n          ${Vn?.length?`\n            <h6>Videos</h6>\n            <div class="documentation-attachments">\n              ${Vn}\n            </div>\n            `:""}\n        </div>\n        <p class="documentation-creator">- added by: <span>${bt?.creatorEmail}</span></p>\n      `,un?.appendChild(Mn),yn?.appendChild(un)}):void 0!==kn&&(yn.innerHTML=kn)}(_o)}))})}(Te?.getAttribute("widget-id"))})}),u.querySelectorAll(".document-preview-close-button")?.forEach(V=>{V.addEventListener("click",()=>{!function(){Cn(this,void 0,void 0,function*(){const te=document.getElementById("widget-documentation-preview-modal"),Te=te?.querySelector("form");Te?.reset(),te?.close()})}()})}),u.querySelectorAll(".wb-initial-empty").forEach(V=>{V.classList.remove("wb-initial-empty")}),document.querySelectorAll('[onclick="widgetSelected(event)"]').forEach(V=>{V.removeAttribute("onclick")}),v})}function ba(k){return Cn(this,arguments,void 0,function*(o,e=[],t=""){const l=yield(0,Lo.Cp)(o);return yield Mo(o,[],l)})}function Mo(k){return Cn(this,arguments,void 0,function*(o,e=[],t,l=""){var u,v,L,g,i,n,S,R,Q,V,te,Te,Be,Xe,xe,ut,xt,$t,Zt,tn,cn,Bn,po,fo,yo,go,vo,mo,Co,_o,So,no,kn,yn,bt,Dn,Gn,Un,Rn,qn,_n,On,un,Mn,Pn,Wn,Vn,Kn,Yn,Xn,sn,xn,Tn,gn,Fn;try{const Qt=new Di,oo=(0,Lo.ix)(t,o);console.log("getWidgetBulkFromId output ->",oo),e.push(o);const Ft=null===(u=oo?.data)||void 0===u?void 0:u.the_widget;Qt.name=null===(L=null===(v=Ft?.the_widget_name)||void 0===v?void 0:v.data)||void 0===L?void 0:L.the_name,Qt.html=null===(i=null===(g=Ft?.the_widget_html)||void 0===g?void 0:g.data)||void 0===i?void 0:i.the_html,Qt.css=null===(S=null===(n=Ft?.the_widget_css)||void 0===n?void 0:n.data)||void 0===S?void 0:S.the_css,Qt.js=null===(Q=null===(R=Ft?.the_widget_js)||void 0===R?void 0:R.data)||void 0===Q?void 0:Q.the_js,Qt.origin=Number(null===(te=null===(V=Ft?.the_widget_origin)||void 0===V?void 0:V.data)||void 0===te?void 0:te.the_origin),Qt.version=null===(Be=null===(Te=Ft?.the_widget_version)||void 0===Te?void 0:Te.data)||void 0===Be?void 0:Be.the_version,Qt.clean=null===(xe=null===(Xe=Ft?.the_widget_clean)||void 0===Xe?void 0:Xe.data)||void 0===xe?void 0:xe.the_clean,Qt.timestamp=null===(xt=null===(ut=Ft?.the_widget_timestamp)||void 0===ut?void 0:ut.data)||void 0===xt?void 0:xt.the_timestamp,Qt.id=oo.id;const To=null===(Zt=null===($t=Ft?.the_widget_type)||void 0===$t?void 0:$t.data)||void 0===Zt?void 0:Zt.the_type;Qt.type="null"==To||null==To?"the_element_name":To,Qt.after_render=null===(cn=null===(tn=Ft?.the_widget_after_render)||void 0===tn?void 0:tn.data)||void 0===cn?void 0:cn.the_after_render,Qt.before_render=null===(po=null===(Bn=Ft?.the_widget_before_render)||void 0===Bn?void 0:Bn.data)||void 0===po?void 0:po.the_before_render,Qt.update=null===(yo=null===(fo=Ft?.the_widget_update)||void 0===fo?void 0:fo.data)||void 0===yo?void 0:yo.the_update,Qt.widgetId=o,Qt.mount_child=null===(vo=null===(go=Ft?.the_widget_mount_child)||void 0===go?void 0:go.data)||void 0===vo?void 0:vo.the_mount_child;const $n=Ft?.the_widget_s_child,Wo=null===(mo=Ft?.the_widget_s_css_library)||void 0===mo?void 0:mo.map(Xt=>{var _t,an,hn,vn,bn,An,Ln,pn;return{order:null===(vn=null===(hn=null===(an=null===(_t=Xt?.data)||void 0===_t?void 0:_t.the_css_library)||void 0===an?void 0:an.the_css_library_order)||void 0===hn?void 0:hn.data)||void 0===vn?void 0:vn.the_order,url:null===(pn=null===(Ln=null===(An=null===(bn=Xt?.data)||void 0===bn?void 0:bn.the_css_library)||void 0===An?void 0:An.the_css_library_url)||void 0===Ln?void 0:Ln.data)||void 0===pn?void 0:pn.the_url}}),Vo=null===(Co=Ft?.the_widget_s_js_library)||void 0===Co?void 0:Co.map(Xt=>{var _t,an,hn,vn,bn,An,Ln,pn;return{order:null===(vn=null===(hn=null===(an=null===(_t=Xt?.data)||void 0===_t?void 0:_t.the_js_library)||void 0===an?void 0:an.the_js_library_order)||void 0===hn?void 0:hn.data)||void 0===vn?void 0:vn.the_order,url:null===(pn=null===(Ln=null===(An=null===(bn=Xt?.data)||void 0===bn?void 0:bn.the_js_library)||void 0===An?void 0:An.the_js_library_url)||void 0===Ln?void 0:Ln.data)||void 0===pn?void 0:pn.the_url}});Qt.library={css:Wo||[],js:Vo||[]};const Jn=null===(So=null===(_o=Ft?.the_widget_assistant)||void 0===_o?void 0:_o.data)||void 0===So?void 0:So.the_assistant;Qt.assistant={id:null===(kn=null===(no=Jn?.the_assistant_id)||void 0===no?void 0:no.data)||void 0===kn?void 0:kn.the_id,input:null===(bt=null===(yn=Jn?.the_assistant_input)||void 0===yn?void 0:yn.data)||void 0===bt?void 0:bt.the_input,type:null===(Gn=null===(Dn=Jn?.the_assistant_type)||void 0===Dn?void 0:Dn.data)||void 0===Gn?void 0:Gn.the_type};const xo=null===(Un=Ft?.the_widget_s_custom_function)||void 0===Un?void 0:Un.map(Xt=>{var _t,an,hn,vn,bn,An,Ln;const pn=null===(_t=Xt?.data)||void 0===_t?void 0:_t.the_custom_function;return{id:Xt?.id,name:null===(hn=null===(an=pn?.the_custom_function_name)||void 0===an?void 0:an.data)||void 0===hn?void 0:hn.the_name,slug:null===(bn=null===(vn=pn?.the_custom_function_slug)||void 0===vn?void 0:vn.data)||void 0===bn?void 0:bn.the_slug,code:null===(Ln=null===(An=pn?.the_custom_function_code)||void 0===An?void 0:An.data)||void 0===Ln?void 0:Ln.the_code}});if(console.log("customFunctionList -> ",xo),Qt.custom_functions=xo,$n?.length)for(let Xt=0;Xt<$n.length;Xt++){const _t=(null===(_n=null===(qn=null===(Rn=$n[Xt])||void 0===Rn?void 0:Rn.data.the_child_widget)||void 0===qn?void 0:qn.the_child_widget_info)||void 0===_n?void 0:_n.id)||(null===(Pn=null===(Mn=null===(un=null===(On=$n[Xt])||void 0===On?void 0:On.data.the_child_widget)||void 0===un?void 0:un.the_child_widget_parent)||void 0===Mn?void 0:Mn.data)||void 0===Pn?void 0:Pn.the_parent),an=yield Mo(_t,e,t,l),hn=null===(Xn=null===(Yn=null===(Kn=null===(Vn=null===(Wn=$n[Xt])||void 0===Wn?void 0:Wn.data)||void 0===Vn?void 0:Vn.the_child_widget)||void 0===Kn?void 0:Kn.the_child_widget_type)||void 0===Yn?void 0:Yn.data)||void 0===Xn?void 0:Xn.the_type,vn=null===(Fn=null===(gn=null===(Tn=null===(xn=null===(sn=$n[Xt])||void 0===sn?void 0:sn.data)||void 0===xn?void 0:xn.the_child_widget)||void 0===Tn?void 0:Tn.the_child_widget_wrapper)||void 0===gn?void 0:gn.data)||void 0===Fn?void 0:Fn.the_wrapper;an.type="null"==hn||null==hn?"the_element_name":hn,an.wrapper=vn,Qt.children.push(an)}return Qt}catch(Qt){throw console.error("error",Qt),Qt}})}function Ko(k,o){return Cn(this,arguments,void 0,function*(e,t,l=!0,u,v){var L,g;const i=new Ro;i.html=e.html,i.widgetType=e.type,i.componentDidMountFunction=e.before_render,i.addEventFunction=e.after_render,i.mountChildWidgetsFunction=e.mount_child,i.widgetState=Object.assign({},v),i.customFunctions=e.custom_functions,i.css=`#${e.id} { ${e.css} }`,u&&(i.data=u),t.innerHTML="";const n=t;if(n&&(yield i.mount(n),e.widget=i,e.children.length>0&&(null===(L=i.childWidgetElement)||void 0===L?void 0:L.length)>0))for(let S=0;S<(null===(g=e.children)||void 0===g?void 0:g.length);S++){const R=e.children[S];for(let Q=0;Q<i.childWidgetElement.length;Q++){const V=i.childWidgetElement[Q];if(R.wrapper===V.id){const te=Aa(R);R.html=`<div id="${R.wrapper}">${R.html}</div>`;const Te=yield Ko(te,V,!1,i.data,i.widgetState);i.childWidgets.push(Te),i.css=i.css+Te.css+`#${V.id} { ${R.css} }`,Te.dataChange(Be=>{var Xe;const xe=null===(Xe=Be?.type)||void 0===Xe?void 0:Xe.characterValue;xe&&(i.childrenData[xe]=Be)})}}}return console.log("newWidget ->",i,e),yield Mi(t,".widget_container"),i})}function Oi(k,o){return Cn(this,arguments,void 0,function*(e,t,l=!0,u,v){var L,g;let i=new Ro;i.html=e.html,i.widgetState=Object.assign({},u),i.widgetType=e.type,i.componentDidMountFunction=e.before_render,i.addEventFunction=e.after_render,i.mountChildWidgetsFunction=e.mount_child,i.customFunctions=e.custom_functions,i.inDevelopment=!1!==v,t.innerHTML="";let n=t;if(n&&(yield i.mount(n),e.widget=i,e.children.length>0&&(null===(L=i.childWidgetElement)||void 0===L?void 0:L.length)>0))for(let S=0;S<(null===(g=e.children)||void 0===g?void 0:g.length);S++){let R=e.children[S];for(let Q=0;Q<i.childWidgetElement.length;Q++){let V=i.childWidgetElement[Q];if(R.wrapper===V.id){const te=Aa(R),Te=yield Oi(te,V,!1,i.widgetState,v);i.childWidgets.push(Te),i.css=i.css+Te.css+`#${V.id} { ${R.css} }`,Te.dataChange(Be=>{var Xe;console.log("This is the data change in child",Be);let xe=null===(Xe=Be?.type)||void 0===Xe?void 0:Xe.characterValue;xe&&(i.childrenData[xe]=Be),console.log("new child data",i.childrenData)})}}}return console.log("newWidget ->",i,e),i})}function Aa(k){return k.html=k.html.replace(/<[^>]*\bclass=["'][^"']*\bwidget_container\b[^"']*["'][^>]*>/g,o=>o.replace(/\bwidget_container\b/g,"").trim()),k.html=k.html.replace(/<[^>]*\bdraggable=["'][^"']*\btrue\b[^"']*["'][^>]*>/g,o=>o.replace(/\btrue\b/g,"false").trim()),k.html=k.html.replace(/<[^>]*\bclass=["'][^"']*\bhover-element\b[^"']*["'][^>]*>/g,o=>o.replace(/\bhover-element\b/g,"").trim()),k.html=k.html.replace(/<[^>]*\bclass=["'][^"']*\bwb-block\b[^"']*["'][^>]*>/g,o=>o.replace(/\bwb-block\b/g,"").trim()),k.html=k.html.replace(/<[^>]*onclick="widgetSelected\(event\)"\s*,?\s*ondragover="_dragService\.dragOverWidgetElement\(event\)"\s*,?\s*ondrop="_dragService\.dropWidgetElement\(event\)"\s*,?\s*ondragstart="_dragService\.dragStartWidgetElement\(event\)"\s*,?\s*ondragend="_dragService\.dragEndWidgetElement\(event\)"[^>]*>/g,o=>o.replace(/onclick="widgetSelected\(event\)"/g,'onclick=""').replace(/ondragover="_dragService\.dragOverWidgetElement\(event\)"/g,'ondragover=""').replace(/ondrop="_dragService\.dropWidgetElement\(event\)"/g,'ondrop=""').replace(/ondragstart="_dragService\.dragStartWidgetElement\(event\)"/g,'ondragstart=""').replace(/ondragend="_dragService\.dragEndWidgetElement\(event\)"/g,'ondragend=""').trim()),k.html=k.html.replace(/<[^>]*\bondragstart=["'][^"']*\b_dragService\.onWidgetDragStart\(event\)\b[^"']*["'][^>]*>/g,o=>o.replace(/\b_dragService\.onWidgetDragStart\(event\)\b/g,"").trim()),k}function Kl(k,o){return Cn(this,void 0,void 0,function*(){return k&&1===k.nodeType&&k.querySelectorAll(o).forEach(e=>{for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.remove()}),k})}function Mi(k,o){return Cn(this,void 0,void 0,function*(){const e=k.querySelectorAll(o);for(const t of e){const l=t.parentElement;if(l){for(;t.firstChild;){const u=yield Kl(t.firstChild,o);l.insertBefore(u,t)}l.removeChild(t)}}})}var Yl=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Yo(k){return Yl(this,arguments,void 0,function*(o,e=null,t="",l={concepts:[],connections:[]}){var u,v,L,g;if(wt)try{const R=yield Bt("CreateData",{json:o,ofConcept:e,typeConcept:t,actions:l});return!(null===(v=null===(u=R?.actions)||void 0===u?void 0:u.concepts)||void 0===v)&&v.length&&(l.concepts=JSON.parse(JSON.stringify(R.actions.concepts))),!(null===(g=null===(L=R?.actions)||void 0===L?void 0:L.connections)||void 0===g)&&g.length&&(l.connections=JSON.parse(JSON.stringify(R.actions.connections))),R.data}catch(R){console.error("CreateTheComposition sw error: ",R),Wt(R)}let i=999,n=999,S=(0,we.o)();for(const R in o){let Q=Xl(R);if("string"!=typeof o[R]&&"number"!=typeof o[R])if(null==e||0==e.id)S=yield(0,ze.k)(Q,"",!0,i,4,n,void 0,l),Array.isArray(o[R])&&(Q=La(Q)),yield Yo(o[R],S,Q,l);else{Array.isArray(o[R])&&(Q=Na(Q));let V=Na(R),te=yield(0,ze.k)(Q,"",!0,i,4,n,void 0,l);S=te;let Te=Sa(t,V),Be=yield(0,Tt.$)(Te,n,i,i,l);yield(0,jn.F)(e.id,te.id,Be.id,1e3,Be.characterValue,i,l),Array.isArray(o[R])&&(Q=La(Q)),yield Yo(o[R],te,Q,l)}else{let V=Sa(t,R),te=yield(0,Tt.$)(V,n,i,i,l),Te=yield(0,ze.k)(R,o[R].toString(),!1,i,4,n,void 0,l);console.log("this is the type concept in down",te,Te),null!=e&&(yield(0,jn.F)(e.id,Te.id,te.id,1e3,V,i,l))}}return S})}function Xl(k){return k.startsWith("the_")?k:"the_"+k}function La(k){return k.endsWith("_s")?k:k+"_s"}function Na(k){return k.replace(/_s$/,"")}const ed=k=>/^[+-]?\d+(\.\d+)?$/.test(k);function Sa(k,o){return ed(o)?k+"_":k+"_"+((e=o).startsWith("the_")?e.slice(4):e);var e}class xa{constructor(){this.prototype="",this.required=[],this.optional=[],this.field="string",this.childPrototypes=[],this.isCompositional=!1,this.options=[],this.isQueryType=!1,this.querySelector=null,this.concepts=[],this.connections=[],this.addedConcepts=[],this.addedConnections=[]}}function Hn(k,o){if(Array.isArray(k)&&Array.isArray(o))for(let e=0;e<o.length;e++)k.push(o[e]);return k}var ho=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};function Pi(k){return ho(this,arguments,void 0,function*(o,e=null){let t=[],l=[],u=[],v=(0,we.o)();try{null==e&&(e=new Fi,yield e.initialize());let L=[];if(o.isCompositional){if(v=yield function(n,S,R,Q){return ho(this,void 0,void 0,function*(){let V=(0,we.o)(),te=yield Q.MakeTheInstanceConceptLocal("the_composition","",!0,999,999,999),Te=yield Q.MakeTheTypeConceptLocal("the_composition_type",999,999,999),Be=yield Q.MakeTheTypeConceptLocal(n,999,999,999),Xe=yield Q.CreateTheConnectionLocal(te.id,Be.id,Te.id,1e3,"the_composition_type");return V=te,S.push(Te),S.push(Be),R.push(Xe),V})}(o.prototype,t,l,e),o.isQueryType){let n=yield function(R,Q,V){return ho(this,void 0,void 0,function*(){let te=[],Te=[],Be="the_composition_filter_type",Xe="the_composition_selector",xe=yield V.MakeTheTypeConceptLocal(Be,999,999,999),ut=yield V.MakeTheTypeConceptLocal(Xe,999,999,999);if(null!=R){let xt=yield V.MakeTheTypeConceptLocal(R.selector,999,999,999);te.push(xt);let $t=yield V.MakeTheTypeConceptLocal(R.filterType,999,999,999);te.push(xt),te.push($t);let Zt=yield V.CreateTheConnectionLocal(Q.id,xt.id,ut.id,1e3,Xe,999);Te.push(Zt);let tn=yield V.CreateTheConnectionLocal(Q.id,$t.id,xe.id,1e3,Be,999);Te.push(tn)}return{concepts:te,connections:Te}})}(o.querySelector,v,e),S=n.concepts;Hn(u,n.connections),Hn(t,S)}if(o.options.length>0){let n=yield function(R,Q,V){return ho(this,void 0,void 0,function*(){let te=[],Te=[],Be="the_composition_s_option",Xe=yield V.MakeTheTypeConceptLocal(Be,999,999,999);for(let xe=0;xe<R.length;xe++){let ut=R[xe].type,xt=R[xe].value,$t=yield V.MakeTheInstanceConceptLocal(ut,xt,!1,999,999,999);te.push($t);let Zt=yield V.CreateTheConnectionLocal(Q.id,$t.id,Xe.id,1e3,Be,999);Te.push(Zt)}return{concepts:te,connections:Te}})}(o.options,v,e),S=n.concepts;Hn(u,n.connections),Hn(t,S)}}else v=yield function(n,S){return ho(this,void 0,void 0,function*(){let R=yield(0,be.A)(5124),Q=yield S.MakeTheTypeConceptLocal(n,999,999,999);return yield function(te,Te,Be,Xe){return ho(this,void 0,void 0,function*(){let xe=yield Xe.CreateTheConceptLocal("",Te.characterValue,999,te.id,Te.id,4,!1);return xe.characterValue=Te.characterValue,xe.typeCharacter=Te.characterValue,xe.isComposition=!0,xe.type=Te,xe})}(R,Q,0,S)})}(o.prototype,e),u=yield Ea(o.required,v,t,e,!0),L=yield Ea(o.optional,v,t,e),t.push(v);let g=Fa(v,!0,!0),i=yield e.MakeTheTypeConceptLocal(g,999,999,999);if(t.push(i),o.childPrototypes.length>0)for(let n=0;n<o.childPrototypes.length;n++){let S=yield Pi(o.childPrototypes[n]),R=S.mainConcept,Q=S.connections,V=S.concepts,te=yield e.CreateTheConnectionLocal(v.id,R.id,i.id,1e3,g,999);u.push(te),Hn(u,Q),Hn(t,V),t.push(R)}Hn(u,L),Hn(u,l),Hn(t,o.addedConcepts),Hn(u,o.addedConnections),o.concepts=t,o.connections=u,console.log("this is the connections",u)}catch{e?.rollbackTransaction()}return{concepts:t,connections:u,mainConcept:v}})}function Fa(k,o=!0,e=!1){var t;let l="the_prototype_of_"+(null===(t=k.type)||void 0===t?void 0:t.characterValue);return l+=o?"_requires":"_optional",e&&(l+="_the_composition"),l}function Ea(k,o,e,t){return ho(this,arguments,void 0,function*(l,u,v,L,g=!1,i=!1){let n=[],S=[],R=Fa(u,g,i),Q=yield L.MakeTheTypeConceptLocal(R,999,999,999);v.push(Q);for(let V=0;V<l.length;V++){let te=yield L.MakeTheTypeConceptLocal(l[V],999,999,999);n.push(te)}for(let V=0;V<n.length;V++){let te=yield L.CreateTheConnectionLocal(u.id,n[V].id,Q.id,1e3,R,999);S.push(te)}for(let V=0;V<n.length;V++)v.push(n[V]);return S})}var wt,rn=function(k,o,e,t){return new(e||(e=Promise))(function(l,u){function v(i){try{g(t.next(i))}catch(n){u(n)}}function L(i){try{g(t.throw(i))}catch(n){u(n)}}function g(i){var n;i.done?l(i.value):(n=i.value,n instanceof e?n:new e(function(S){S(n)})).then(v,L)}g((t=t.apply(k,o||[])).next())})};const td=Date.now().toString(36)+Math.random().toString(36).substring(2);let Wi=[],Qn=[],Vi=!1;function Ba(k){Vi=k}function $i(k="",o){dn.b.BearerAccessToken=k,dn.b.sessionId=null==typeof document?o:parseInt((0,Ce.R)("SessionId")),wt&&Bt("updateAccessToken",{accessToken:k,session:parseInt((0,Ce.R)("SessionId"))})}function Da(){return rn(this,arguments,void 0,function*(k="",o="",e="",t="",l=!0,u="",v,L={},g={}){var i;try{a.B.BASE_URL=k,a.B.AI_URL=o,a.B.NODE_URL=t,a.B.BASE_APPLICATION=u,a.B.LOG_SERVER=null!==(i=g.logserver)&&void 0!==i?i:"https://logdev.freeschema.com",console.log("setting the logserver",a.B.LOG_SERVER,g.logserver),$i(e);let n=Math.floor(1e8*Math.random());a.B.setRandomizer(n);const S={logApplication:!1,logPackage:!1,accessTracker:!1,isTest:!1};if(a.B.FLAGS=S,a.B.FLAGS=Object.assign(Object.assign({},S),L),function(R){const Q=Ce.V.logfunction("initializeFlags",arguments);try{R.logApplication&&($l.initialize(),Ce.V.logApplicationActivationStatus=!0,console.warn("Application log started.")),R.logPackage&&(Ce.V.logPackageActivationStatus=!0,console.warn("Package log started.")),R.accessTracker&&(Eo.J.activateStatus=!0,console.warn("Access Tracker Activated.")),R.isTest&&(c.B.isDataLoaded=!0,c.B.isCharacterLoaded=!0,c.B.isTypeLoaded=!0,c.B.isLocalDataLoaded=!0,c.B.isLocalTypeLoaded=!0,c.B.isLocalCharacterLoaded=!0,c.B.isConnectionLoaded=!0,c.B.isConnectionTypeLoaded=!0,c.B.isLocalConnectionLoaded=!0),Ce.V.logUpdate(Q)}catch(V){throw(0,d.ey)(Q,"initializeFlags",V),V}}(a.B.FLAGS),!("serviceWorker"in navigator))return yield Po(),void console.warn("Service Worker not supported in this browser.");if(yield function(){return rn(this,void 0,void 0,function*(){let R=sessionStorage.getItem("cacheServers");void 0!==R&&"undefined"!==R?(R=JSON.parse(R),R?a.B.NODE_CACHE_URL=Array.isArray(R)&&R.length?R[0]:a.B.BASE_URL:yield function(){return rn(this,void 0,void 0,function*(){try{const Q=yield fetch(a.B.getMyCacheServer(),{method:"POST"});if(!Q.ok)throw new Error("Failed to sync data to the server.");const V=yield Q.json();V.success&&(sessionStorage.setItem("cacheServers",JSON.stringify(V.servers)),a.B.NODE_CACHE_URL=V.servers?V.servers[0]:a.B.BASE_URL)}catch(Q){console.error("error getting cache server",Q.message)}})}(),Bt("SESSION_DATA",{type:"SESSION_DATA",data:a.B.NODE_CACHE_URL})):a.B.NODE_CACHE_URL=a.B.BASE_URL})}(),function(){navigator.serviceWorker.addEventListener("message",R=>rn(this,void 0,void 0,function*(){var Q,V,te,Te;try{if(R.data&&"API_401"===R.data.type){const{requestDetails:Be}=R.data,Xe={method:Be.method,headers:new Headers(Be.headers),body:Be.body},xe=yield fetch(Be.url,Xe),ut=yield xe?.json();null===(V=null===(Q=navigator?.serviceWorker)||void 0===Q?void 0:Q.controller)||void 0===V||V.postMessage({type:"API_RESPONSE",messageId:R.data.messageId,response:new Response(ut,{status:xe.status,statusText:xe.statusText,headers:xe.headers})})}}catch(Be){console.error("Error during listenPostMessage",Be),null===(Te=null===(te=navigator?.serviceWorker)||void 0===te?void 0:te.controller)||void 0===Te||Te.postMessage({type:"API_RESPONSE",messageId:R.data.messageId})}}))}(),function(){la.x.addEventListener("message",R=>rn(this,void 0,void 0,function*(){const{type:Q,payload:V}=R.data;Q&&(Ga[Q]?yield Ga[Q](V):console.warn(`Unable to handle "${Q}" case in BC service worker`))}))}(),v&&v.activate&&v.manual)yield new Promise((R,Q)=>{navigator.serviceWorker.ready.then(V=>rn(this,void 0,void 0,function*(){console.log("registraions ready",V),wt=V.active,yield No(),R("done")})).catch(V=>{console.error("Error: Ready service worker",V),Q(V)}).finally(()=>console.log("Finally service worker ready done")),setTimeout(()=>Q("Timeout ready"),3e4)});else if(v&&v?.activate)try{console.log("service worker initialiing"),yield function(R){var Q=arguments;return rn(this,void 0,void 0,function*(){const V=Ce.V.logfunction("handleRegisterServiceWorker",Q);yield new Promise((te,Te)=>{var Be,Xe;let xe=!1;navigator.serviceWorker.register(null!==(Be=R.pathToSW)&&void 0!==Be?Be:"./serviceWorker.bundle.js",{scope:null!==(Xe=R.scope)&&void 0!==Xe?Xe:"/"}).then(ut=>rn(this,void 0,void 0,function*(){console.log("Service Worker registered:",ut),setInterval(()=>{Qn.length&&Xo()},2e3),console.log("update listen start"),ut.onupdatefound=()=>{const xt=ut.installing;console.log("new worker",xt),xt&&(xt.onstatechange=()=>rn(this,void 0,void 0,function*(){console.warn("on state change triggered",xt.state,navigator.serviceWorker.controller),"installing"===xt.state&&(console.log("Service Worker installing"),wt=void 0),"activated"!==xt.state&&"redundant"!==xt.state||!navigator.serviceWorker.controller||(wt=xt,console.log("New Service Worker is active",ut),setTimeout(()=>{console.log("Message Processed after some time"),Xo()},5e3),yield No(),xe=!0,Xo(),te())}))},ut.addEventListener("controllerchange",()=>rn(this,void 0,void 0,function*(){console.warn("controller change triggered",navigator.serviceWorker.controller),navigator.serviceWorker.controller&&(wt=navigator.serviceWorker.controller,console.warn("Service worker has been activated; controller change"),yield No())})),(ut.installing||ut.waiting||ut.active)&&ut.addEventListener("statechange",xt=>rn(this,void 0,void 0,function*(){var $t;"activating"===(null===($t=xt?.target)||void 0===$t?void 0:$t.state)&&(wt=navigator.serviceWorker.controller,console.warn("Service Worker is activating statechange"),yield No())})),ut.active?(console.log("active sw"),wt=ut.active,yield No(),Xo(),te()):setTimeout(()=>{xe||Te("Not Completed Initialization")},1e4)})).catch(ut=>rn(this,void 0,void 0,function*(){yield Po(),Te(ut),console.error("Service Worker registration failed:",ut),(0,d.ey)(V,"handleRegisterServiceWorker",ut)}))})})}(v)}catch(R){yield Po(),console.error("Unable to start service worker",R)}else yield Po(),console.warn("Service Worker not activated");return!0}catch(n){yield Po(),console.warn("Cannot initialize the system",n)}})}function Bt(k,o){return rn(this,arguments,void 0,function*(e,t,l=0){let u=!1;const v=Math.random().toString(36).substring(2);t.messageId=v,t.TABID=td;const L=JSON.parse(JSON.stringify(t));let g;return"checkProcess"!=e&&0==l&&(g=setInterval(()=>rn(this,void 0,void 0,function*(){if(console.log("process took more than one second",v,e,u),!u&&!(yield function(i,n){return rn(this,void 0,void 0,function*(){var S;try{const R=yield Bt("checkProcess",{checkMessageId:i});if(console.log("check interval data res for type ",n,i,R.data),null===(S=R?.data)||void 0===S?void 0:S.processing)return!0}catch(R){return console.error("error on checing executing process",n,i,R),!1}})}(v,e))&&(clearInterval(g),!u)){if(console.log("Failed to handle type "+e+" message not found "+v,"retrying: ",0==l,e),0==l&&"checkProcess"!=e)return console.log("retrying ",e,v),yield Bt(e,t,l+1);console.log("Failed to handle type "+e+" "+v)}}),2e3)),new Promise((i,n)=>{if(navigator.serviceWorker.controller||wt||console.log("will go to queue",navigator.serviceWorker.controller,wt,e),navigator.serviceWorker.controller||wt){const S=R=>{var Q,V,te,Te,Be,Xe;(null===(Q=R?.data)||void 0===Q?void 0:Q.messageId)==v&&(u=!0,clearInterval(g),R.data.success||(401==(null===(V=R?.data)||void 0===V?void 0:V.status)?n((0,d.ry)(new Response("Unauthorized",{status:401,statusText:null===(te=R?.data)||void 0===te?void 0:te.statusText}))):500==(null===(Te=R?.data)||void 0===Te?void 0:Te.status)?n((0,d.Mb)(new Response("Internal Server Error",{status:500,statusText:null===(Be=R?.data)||void 0===Be?void 0:Be.statusText}))):(console.error("Error in the response from worker:",R),n(`Failed to handle action ${e} ${JSON.stringify(t)}, Response: ${JSON.stringify(R.data)}`))),!(null===(Xe=R.data)||void 0===Xe)&&Xe.actions&&(t.actions=JSON.parse(JSON.stringify(R.data.actions))),i(R.data),navigator.serviceWorker.removeEventListener("message",S))};if(navigator.serviceWorker.addEventListener("message",S),navigator.serviceWorker.controller)"checkProcess"!=e&&console.log("sent to sw",e,v),navigator.serviceWorker.controller.postMessage({type:e,payload:L});else if(wt){console.warn(`controller not found but serviceWorker is available. messageId: ${v}, type: ${e}`);try{wt.postMessage({type:e,payload:L})}catch(R){console.log("Retrying again on catch service worker",R),wt.postMessage({type:e,payload:L})}}else console.warn(`Service Worker hasn't loaded yet. messageId: ${v}, type: ${e}`),console.info("ready",navigator.serviceWorker.ready),setTimeout(()=>{console.warn(`Re-Trying after certain time. messageId: ${v}, type: ${e}`),wt?(console.info("This is triggered "),wt?.postMessage({type:e,payload:t})):(console.log("not ready",e),clearInterval(g),n("Service worker not ready"))},3e4);setTimeout(()=>{clearInterval(g),n(`No response from service worker after timeout: ${e}`),navigator.serviceWorker.removeEventListener("message",S)},21e4)}else Qn.push({message:{type:e,payload:L}}),console.log("Message Queued",e,t),console.log(navigator.serviceWorker.controller,wt,e),"init"==e&&(clearInterval(g),i(null))})})}const Ga={GetLinkListener:k=>rn(void 0,void 0,void 0,function*(){return Wi.find(e=>e.listenerId==k.listenerId)?.callback(k.data),{success:!0}}),dispatchEvent:k=>rn(void 0,void 0,void 0,function*(){if(wt){let o=new CustomEvent(k.id||"",k.data);dispatchEvent(o)}return{success:!0}}),checkInit:k=>rn(void 0,void 0,void 0,function*(){return console.log("service worker init 0"),navigator.serviceWorker.controller&&(console.log("service worker init 1"),wt=navigator.serviceWorker.controller),yield No(),{success:!0}})};function Po(){return rn(this,void 0,void 0,function*(){yield(0,Vl.A)();const k=(new Date).getTime();yield(0,M.A)().then(()=>{let o=(new Date).getTime()-k;console.log("The time taken to prepare concept  data is  ",o)}).catch(o=>{throw o}),yield(0,sa.Ay)().then(()=>{let o=(new Date).getTime()-k;console.log("The time taken to prepare local concept  ",o)}).catch(o=>{throw o}),yield(0,ca.p)().then(()=>{c.B.isLocalConnectionLoaded=!0}).catch(o=>{throw o}),yield(0,sa.xd)().catch(o=>{throw console.log("This is the error in populating binary tree"),o}),yield(0,ca.a)().then(()=>{c.B.isConnectionLoaded=!0,c.B.isConnectionTypeLoaded=!0;let o=(new Date).getTime()-k;console.log("The time taken to prepare connections  ",o)}).catch(o=>{throw o})})}function Ua(k,o={}){if(wt||typeof window<"u"){let e=new CustomEvent(`${k}`,o);dispatchEvent(e)}else la.x.postMessage({type:"dispatchEvent",payload:{id:k,data:o}})}function Xo(){return rn(this,void 0,void 0,function*(){console.log("message queue",Qn);const k=Qn.find(o=>{var e;return"init"==(null===(e=o?.message)||void 0===e?void 0:e.type)});if(k){console.log("Processing Init Queue poped",k?.type,k);const o=Qn.indexOf(k);o>-1&&Qn.splice(o,1),yield Bt(k?.type,k?.payload)}for(console.log("message queue while",Qn);Qn.length>0;){const{message:o}=Qn.shift();console.log("Queue poped",o.type,o),yield Bt(o.type,o.payload)}})}const Wt=k=>{if(k instanceof Oe.z)throw console.error("FreeSchemaResponse Error",k),k;console.error("Service Worker Error",k)};function No(){return rn(this,void 0,void 0,function*(){yield Bt("init",{url:a.B.BASE_URL,aiurl:a.B.AI_URL,accessToken:dn.b.BearerAccessToken,nodeUrl:a.B.NODE_URL,enableAi:!1,applicationName:a.B.BASE_APPLICATION,flags:a.B.FLAGS})})}}},Dt={};function fe(Re){var ne=Dt[Re];if(void 0!==ne)return ne.exports;var _=Dt[Re]={exports:{}};return $e[Re](_,_.exports,fe),_.exports}fe.d=(Re,ne)=>{for(var _ in ne)fe.o(ne,_)&&!fe.o(Re,_)&&Object.defineProperty(Re,_,{enumerable:!0,get:ne[_]})},fe.o=(Re,ne)=>Object.prototype.hasOwnProperty.call(Re,ne),fe.r=Re=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(Re,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Re,"__esModule",{value:!0})};var H=fe(1834),Ve=H.ADMIN,U=H.ALLID,lt=H.AccessTracker,dt=H.AddGhostConcept,nt=H.Anomaly,Je=H.BaseUrl,He=H.BinaryTree,et=H.BuildWidgetFromId,De=H.BuilderStatefulWidget,X=H.Composition,q=H.CompositionBinaryTree,se=H.CompositionNode,ie=H.Concept,le=H.ConceptsData,ce=H.Connection,re=H.ConnectionData,Ae=H.CreateComposition,Ge=H.CreateConnection,Pe=H.CreateConnectionBetweenEntityLocal,ve=H.CreateConnectionBetweenTwoConcepts,ot=H.CreateConnectionBetweenTwoConceptsGeneral,ht=H.CreateConnectionBetweenTwoConceptsLocal,vt=H.CreateData,Pt=H.CreateDefaultConcept,Jt=H.CreateDefaultLConcept,Kt=H.CreateSession,ct=H.CreateSessionVisit,Ut=H.CreateTheCompositionLocal,Vt=H.CreateTheCompositionWithCache,Ht=H.CreateTheConnection,Rt=H.CreateTheConnectionGeneral,Mt=H.CreateTheConnectionLocal,he=H.DATAID,oe=H.DATAIDDATE,J=H.DelayFunctionExecution,ue=H.DeleteConceptById,ee=H.DeleteConceptLocal,j=H.DeleteConnectionById,Y=H.DeleteConnectionByType,pe=H.DeleteUser,Le=H.DependencyObserver,Se=H.FilterSearch,Ze=H.FormatFromConnections,it=H.FormatFromConnectionsAltered,Qe=H.FreeschemaQuery,Fe=H.FreeschemaQueryApi,at=H.GetAllConnectionsOfComposition,It=H.GetAllConnectionsOfCompositionBulk,ft=H.GetAllTheConnectionsByTypeAndOfTheConcept,Gt=H.GetComposition,en=H.GetCompositionBulk,Ot=H.GetCompositionBulkWithDataId,zt=H.GetCompositionFromConnectionsWithDataId,jt=H.GetCompositionFromConnectionsWithDataIdFromConnections,nn=H.GetCompositionFromConnectionsWithDataIdInObject,wn=H.GetCompositionFromConnectionsWithDataIdIndex,Fo=H.GetCompositionFromConnectionsWithIndex,ii=H.GetCompositionFromConnectionsWithIndexFromConnections,ri=H.GetCompositionFromMemoryWithConnections,Pa=H.GetCompositionList,Wa=H.GetCompositionListAll,Va=H.GetCompositionListAllWithId,$a=H.GetCompositionListListener,ja=H.GetCompositionListLocal,Ha=H.GetCompositionListLocalWithId,qa=H.GetCompositionListWithId,Ja=H.GetCompositionListWithIdUpdated,za=H.GetCompositionListener,Za=H.GetCompositionLocal,Qa=H.GetCompositionLocalWithId,Ka=H.GetCompositionWithAllIds,Ya=H.GetCompositionWithCache,Xa=H.GetCompositionWithDataIdBulk,ec=H.GetCompositionWithDataIdWithCache,tc=H.GetCompositionWithId,nc=H.GetCompositionWithIdAndDateFromMemory,oc=H.GetConceptBulk,ic=H.GetConceptByCharacter,rc=H.GetConceptByCharacterAndCategoryLocal,ac=H.GetConceptByCharacterAndType,cc=H.GetConnectionBetweenTwoConceptsLinker,sc=H.GetConnectionBulk,lc=H.GetConnectionById,dc=H.GetConnectionDataPrefetch,uc=H.GetConnectionOfTheConcept,hc=H.GetLink,pc=H.GetLinkListListener,fc=H.GetLinkListener,yc=H.GetLinkRaw,gc=H.GetLinkerConnectionFromConcepts,vc=H.GetLinkerConnectionToConcepts,mc=H.GetRelation,Cc=H.GetRelationLocal,_c=H.GetRelationRaw,Tc=H.GetTheConcept,wc=H.GetTheConceptLocal,Ic=H.GetUserGhostId,kc=H.JUSTDATA,bc=H.LConcept,Ac=H.LConnection,Lc=H.LISTNORMAL,Nc=H.LocalConceptsData,Sc=H.LocalSyncData,xc=H.LocalTransaction,Fc=H.Logger,Ec=H.LoginToBackend,Bc=H.MakeTheInstanceConcept,Dc=H.MakeTheInstanceConceptLocal,Gc=H.MakeTheTimestamp,Uc=H.MakeTheTypeConceptApi,Rc=H.MakeTheTypeConceptLocal,Oc=H.NORMAL,Mc=H.PRIVATE,Pc=H.PUBLIC,Wc=H.PatcherStructure,Vc=H.Prototype,$c=H.RAW,jc=H.RecursiveSearchApi,Hc=H.RecursiveSearchApiNewRawFullLinker,qc=H.RecursiveSearchApiRaw,Jc=H.RecursiveSearchApiRawFullLinker,zc=H.RecursiveSearchApiWithInternalConnections,Zc=H.RecursiveSearchListener,Qc=H.SchemaQuery,Kc=H.SchemaQueryListener,Yc=H.SearchAllConcepts,Xc=H.SearchLinkInternal,es=H.SearchLinkInternalAll,ts=H.SearchLinkMultipleAll,ns=H.SearchLinkMultipleAllObservable,os=H.SearchLinkMultipleApi,is=H.SearchQuery,rs=H.SearchStructure,as=H.SearchWithLinker,cs=H.SearchWithTypeAndLinker,ss=H.SearchWithTypeAndLinkerApi,ls=H.Selector,ds=H.SessionData,us=H.Signin,hs=H.Signup,ps=H.SignupEntity,fs=H.SplitStrings,ys=H.StatefulWidget,gs=H.SyncData,vs=H.TrashTheConcept,ms=H.UpdateComposition,Cs=H.UpdateCompositionLocal,_s=H.UserBinaryTree,Ts=H.Validator,ws=H.ViewInternalData,Is=H.ViewInternalDataApi,ks=H.WidgetTree,bs=H.convertFromConceptToLConcept,As=H.convertFromLConceptToConcept,Ls=H.convertWidgetTreeToWidget,Ns=H.convertWidgetTreeToWidgetWithWrapper,Ss=H.createFormFieldData,xs=H.createPrototypeLocal,Fs=H.dispatchIdEvent,Es=H.getFromDatabaseWithType,Bs=H.getObjectsFromIndexDb,Ds=H.getWidgetBulkFromId,Gs=H.getWidgetFromId,Us=H.handleServiceWorkerException,Rs=H.hasActivatedSW,Os=H.init,Ms=H.recursiveFetch,Ps=H.recursiveFetchNew,Ws=H.removeAllChildren,Vs=H.renderLatestWidget,$s=H.renderPage,js=H.renderWidget,Hs=H.searchLinkMultipleListener,qs=H.sendEmail,Js=H.sendMessage,zs=H.serviceWorker,Zs=H.setHasActivatedSW,Qs=H.storeToDatabase,Ks=H.subscribedListeners,Ys=H.unwrapContainers,Xs=H.updateAccessToken,el=H.uploadAttachment,tl=H.uploadFile,nl=H.uploadImage,ol=H.validDocumentFormats,il=H.validImageFormats},793:(mt,O)=>{Object.defineProperty(O,"__esModule",{value:!0}),O.setConfiguration=O.config=O.myprefix=void 0,O.myprefix="Boomconsole_FMS_2024_",O.config={userToken:"",userId:0,userConcept:0,apiUrl:"",aiUrl:"",nodeUrl:"",icons:{}},O.setConfiguration=function(tt){O.config=Object.assign({},tt)}}},gt={};function je(mt){var O=gt[mt];if(void 0!==O)return O.exports;var tt=gt[mt]={exports:{}};return Nn[mt].call(tt.exports,tt,tt.exports,je),tt.exports}return je.d=(mt,O)=>{for(var tt in O)je.o(O,tt)&&!je.o(mt,tt)&&Object.defineProperty(mt,tt,{enumerable:!0,get:O[tt]})},je.o=(mt,O)=>Object.prototype.hasOwnProperty.call(mt,O),je.r=mt=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(mt,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(mt,"__esModule",{value:!0})},je(156)})()}}]);
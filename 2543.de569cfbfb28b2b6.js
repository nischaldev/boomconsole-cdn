"use strict";(self.webpackChunkngx_boomconsole=self.webpackChunkngx_boomconsole||[]).push([[2543],{2543:(Y,Z,l)=>{l.r(Z),l.d(Z,{RolesModule:()=>me});var d=l(6895),_=l(7518),p=l(4006),a=l(9653);const C=(0,a.PH)("[Roles API] Invoke Roles Fetch API"),S=(0,a.PH)("[Roles API] Fetch API Success",(0,a.Ky)()),y=(0,a.PH)("[Roles API] Invoke save new Role api",(0,a.Ky)()),I=(0,a.PH)("[Roles API] save new Role api success",(0,a.Ky)()),P=(0,a.PH)("[Roles API] Inovke update Role api",(0,a.Ky)()),x=(0,a.PH)("[Roles API] update  Role api success",(0,a.Ky)());var F=l(3223),v=l(8905),e=l(4650),A=l(8154),b=l(9446);function J(s,t){1&s&&(e.TgZ(0,"div",15),e._UZ(1,"span",16),e.qZA())}function k(s,t){if(1&s&&(e.TgZ(0,"div",17),e._uU(1),e.qZA()),2&s){const r=e.oxw();e.xp6(1),e.hij(" ",r.errorMessage," ")}}function O(s,t){1&s&&(e.TgZ(0,"small",18),e._uU(1," Please enter role name. "),e.qZA())}let w=(()=>{const t=class{get name(){return this.createForm.get("name")}constructor(i,o,n,c,u,m){this._fb=i,this._compositionService=o,this._activeModal=n,this._store=c,this._appStore=u,this._router=m,this.loader=!1,this.loginError=!1,this.createForm=this._fb.group({name:new p.NI("",[p.kI.required])})}ngOnInit(){}create(){let i={};i={...this.createForm.value},this.createForm.invalid?this.scrollToFirstInvalidControl():(this.loader=!0,this._store.dispatch(y({role:i})),this._appStore.pipe((0,a.Ys)(F.p)).subscribe(n=>{"success"==n.apiStatus&&(this.loader=!1,window.scroll({top:0,left:0,behavior:"smooth"}),this._activeModal.close(n.apiResponseMessage),this._appStore.dispatch((0,v.T)({apiStatus:{apiResponseMessage:"",apiStatus:""}})))}))}scrollToFirstInvalidControl(){const i=document.querySelectorAll(".ng-invalid");i.length>0&&i[0].scrollIntoView()}};let s=t;return t.\u0275fac=function(o){return new(o||t)(e.Y36(p.qu),e.Y36(A.e),e.Y36(b.Kz),e.Y36(a.yh),e.Y36(a.yh),e.Y36(_.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-create-role"]],decls:20,vars:5,consts:[[3,"formGroup","ngSubmit"],["createMenuFormId","ngForm"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["class","loading",4,"ngIf"],["class","validation_error alert alert-danger",4,"ngIf"],[1,"row"],[1,"col-md-12"],["type","text","placeholder","Role name","formControlName","name",1,"form-control"],["class","err_msg",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"loading"],[1,"loader"],[1,"validation_error","alert","alert-danger"],[1,"err_msg"]],template:function(o,n){if(1&o&&(e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",function(){return n.create()}),e.TgZ(2,"div",2)(3,"h4",3),e._uU(4,"Create Role"),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return n._activeModal.dismiss()}),e.qZA()(),e.TgZ(6,"div",5),e.YNc(7,J,2,0,"div",6),e.YNc(8,k,2,1,"div",7),e.TgZ(9,"div",8)(10,"div",9)(11,"label"),e._uU(12,"Role Name"),e.qZA(),e._UZ(13,"input",10),e.YNc(14,O,2,0,"small",11),e.qZA()()(),e.TgZ(15,"div",12)(16,"button",13),e.NdJ("click",function(){return n._activeModal.close()}),e._uU(17," Close "),e.qZA(),e.TgZ(18,"button",14),e._uU(19," Create "),e.qZA()()()),2&o){const c=e.MAs(1);e.Q6J("formGroup",n.createForm),e.xp6(7),e.Q6J("ngIf",n.loader),e.xp6(1),e.Q6J("ngIf",n.loginError),e.xp6(6),e.Q6J("ngIf",n.name&&n.name.invalid&&(n.name.touched||c.submitted)),e.xp6(4),e.Q6J("disabled",n.loader)}},dependencies:[d.O5,p._Y,p.Fj,p.JJ,p.JL,p.sg,p.u]}),s})();var h=l(7899);const T=(0,a.ZF)("myroles");function Q(s,t){1&s&&(e.TgZ(0,"div",19),e._UZ(1,"span",20),e.qZA())}function L(s,t){if(1&s&&(e.TgZ(0,"div",21),e._uU(1),e.qZA()),2&s){const r=e.oxw();e.xp6(1),e.hij(" ",r.errorMessage," ")}}function $(s,t){if(1&s&&(e.ynx(0),e.TgZ(1,"tr",23)(2,"td",24),e._UZ(3,"input",25),e.qZA(),e.TgZ(4,"td",26),e._UZ(5,"input",27),e.qZA(),e.TgZ(6,"td",26),e._UZ(7,"input",28),e.qZA(),e.TgZ(8,"td",26),e._UZ(9,"input",29),e.qZA(),e.TgZ(10,"td",26),e._UZ(11,"input",30),e.qZA(),e.TgZ(12,"td",26),e._UZ(13,"input",31),e.qZA()(),e.BQk()),2&s){const r=t.index;e.xp6(1),e.Q6J("formGroupName",r),e.xp6(2),e.Q6J("readOnly",!0)}}function E(s,t){if(1&s&&(e.ynx(0),e.YNc(1,$,14,2,"ng-container",22),e.BQk()),2&s){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",null==r.role_permission?null:r.role_permission.controls)}}let N=(()=>{const t=class{constructor(i,o,n,c,u,m){this._fb=i,this._compositionService=o,this._activeModal=n,this._router=c,this._store=u,this._appStore=m,this.loader=!1,this.hasError=!1,this.moduleComp=h.DP,this.assignRoleForm=this._fb.group({role_permission:this._fb.array([])})}get role_permission(){return this.assignRoleForm?.controls.role_permission}permission_submenus(i){return this.role_permission.at(i).get("menus")}ngOnInit(){this._store.pipe((0,a.Ys)((s=>(0,a.P1)(T,t=>{if(typeof t>"u")return null;var r=t.filter(i=>i.id==s);return 0==r?.length?null:r[0]}))(this.itemId))).subscribe(o=>{o&&(this.currentRole={...o},this.currentPermissions=this.currentRole?.permissions,this.roleName=this.currentRole?.name,this.getAllModules())})}getAllModules(){this.loader=!0,this._compositionService.getAll(h.DP,1,50).subscribe({next:i=>{this.loader=!1,this.allModules=i.data.filter(o=>"humanizing"!==o?.data?.modulesetup?.module_application?.toLowerCase()),this.addmodules()},error:i=>{this.loader=!1,console.log(i)}})}addmodules(){console.log(this.currentPermissions,"Current Permissions"),this.allModules.length>0&&this.allModules.forEach(i=>{let o;this.currentPermissions?.length>0&&([o]=this.currentPermissions.filter(u=>i?.data[h.DP]?.module_name==u?.internal_permission?.data?.module_name)??"");let n=i?.data[h.DP]?.menus?.length>0?JSON.stringify(i?.data[h.DP]?.menus):JSON.stringify([]),c=this._fb.group({...i?.data[h.DP],menus:n,view:["true"===o?.internal_permission?.data?.view?.toLowerCase()],create:["true"===o?.internal_permission?.data?.create?.toLowerCase()],update:["true"===o?.internal_permission?.data?.update?.toLowerCase()],remove:["true"===o?.internal_permission?.data?.remove?.toLowerCase()],show_in_menu:["true"===o?.internal_permission?.data?.show_in_menu?.toLowerCase()]});this.role_permission.push(c)})}assignRole(){let o=[...this.role_permission.value].filter(u=>!!u.view),n={name:this.roleName,permissions:o};this.loader=!0,this._store.dispatch(P({updateRole:n,role_id:this.currentRole?.id})),this._appStore.pipe((0,a.Ys)(F.p)).subscribe(u=>{"success"==u.apiStatus&&(this.loader=!1,this._activeModal.close(u.apiResponseMessage),this._appStore.dispatch((0,v.T)({apiStatus:{apiResponseMessage:"",apiStatus:""}})))})}};let s=t;return t.\u0275fac=function(o){return new(o||t)(e.Y36(p.qu),e.Y36(A.e),e.Y36(b.Kz),e.Y36(_.F0),e.Y36(a.yh),e.Y36(a.yh))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-assign-role"]],inputs:{itemId:"itemId"},decls:37,vars:6,consts:[[3,"formGroup","ngSubmit"],["assignRoleFormId","ngForm"],[1,"modal-header"],[1,"modal-title"],[1,"soft-text"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["formGroupName","role_permission",1,"modal-body"],["class","loading",4,"ngIf"],["class","validation_error alert alert-danger",4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"table-responsive"],[1,"table","table-striped"],["rowspan","2"],["colspan","5"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"loading"],[1,"loader"],[1,"validation_error","alert","alert-danger"],[4,"ngFor","ngForOf"],[3,"formGroupName"],[1,"text-capitalize"],["type","text","formControlName","module_name",1,"form-control",3,"readOnly"],[1,"text-center"],["formControlName","view","type","checkbox",1,"form-check-input"],["formControlName","create","type","checkbox",1,"form-check-input"],["formControlName","update","type","checkbox",1,"form-check-input"],["formControlName","remove","type","checkbox",1,"form-check-input"],["formControlName","show_in_menu","type","checkbox",1,"form-check-input"]],template:function(o,n){if(1&o&&(e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",function(){return n.assignRole()}),e.TgZ(2,"div",2)(3,"h4",3)(4,"span",4),e._uU(5,"Assign Permission for:"),e.qZA(),e._uU(6),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(){return n._activeModal.dismiss()}),e.qZA()(),e.TgZ(8,"div",6),e.YNc(9,Q,2,0,"div",7),e.YNc(10,L,2,1,"div",8),e.TgZ(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"tr")(16,"th",13),e._uU(17,"Module Name"),e.qZA(),e.TgZ(18,"th",14),e._uU(19,"Permissions"),e.qZA()(),e.TgZ(20,"tr")(21,"th"),e._uU(22,"View"),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Create"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Edit"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Remove"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"Show in menu"),e.qZA()(),e.YNc(31,E,2,1,"ng-container",15),e.qZA()()()()(),e.TgZ(32,"div",16)(33,"button",17),e.NdJ("click",function(){return n._activeModal.dismiss()}),e._uU(34," Close "),e.qZA(),e.TgZ(35,"button",18),e._uU(36," Update "),e.qZA()()()),2&o){let c;e.Q6J("formGroup",n.assignRoleForm),e.xp6(6),e.hij(" ",null!==(c=null==n.currentRole?null:n.currentRole.name)&&void 0!==c?c:"..."," "),e.xp6(3),e.Q6J("ngIf",n.loader),e.xp6(1),e.Q6J("ngIf",n.hasError),e.xp6(21),e.Q6J("ngIf",n.role_permission.length>0),e.xp6(4),e.Q6J("disabled",n.loader)}},dependencies:[d.sg,d.O5,p._Y,p.Fj,p.Wl,p.JJ,p.JL,p.sg,p.u,p.x0],styles:[".table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;line-height:1em;border:1px solid #ccc}"]}),s})();var B=l(8502),G=l(262),D=l(9646),R=l(4004),U=l(7009),z=l(8180);function K(s,t){1&s&&(e.TgZ(0,"div",7),e._UZ(1,"span",8),e.qZA())}function j(s,t){1&s&&(e.TgZ(0,"div",7),e._UZ(1,"span",8),e.qZA())}function W(s,t){1&s&&(e.TgZ(0,"tr")(1,"td",14),e._uU(2,"Looking for data..."),e.qZA()())}function H(s,t){if(1&s&&e.YNc(0,W,3,0,"tr",12),2&s){const r=e.oxw().ngIf;e.Q6J("ngIf",!r.error)}}function X(s,t){1&s&&(e.TgZ(0,"tr")(1,"td",14),e._uU(2,"Couldnot find data.."),e.qZA()())}function V(s,t){if(1&s){const r=e.EpF();e.TgZ(0,"tr")(1,"td",16),e._uU(2),e.qZA(),e.TgZ(3,"td",10)(4,"button",17),e.NdJ("click",function(){const n=e.CHM(r).$implicit,c=e.oxw(3);return e.KtG(c.assignPermission(null==n?null:n.id))}),e.TgZ(5,"span",18),e._uU(6," admin_panel_settings "),e.qZA()()()()}if(2&s){const r=t.$implicit;e.xp6(2),e.hij(" ",null==r?null:r.name," ")}}function ee(s,t){if(1&s&&(e.ynx(0),e.YNc(1,V,7,1,"tr",15),e.BQk()),2&s){const r=e.oxw().ngIf;e.xp6(1),e.Q6J("ngForOf",r.allRoles)}}function te(s,t){if(1&s&&(e.TgZ(0,"table",9)(1,"thead")(2,"tr")(3,"th"),e._uU(4,"Role Name"),e.qZA(),e.TgZ(5,"th",10),e._uU(6,"Assign"),e.qZA()()(),e.TgZ(7,"tbody"),e.YNc(8,H,1,1,"ng-template",null,11,e.W1O),e.YNc(10,X,3,0,"tr",12),e.YNc(11,ee,2,1,"ng-container",13),e.qZA()()),2&s){const r=t.ngIf,i=e.MAs(9);e.xp6(10),e.Q6J("ngIf",!!r.error),e.xp6(1),e.Q6J("ngIf",(null==r.allRoles?null:r.allRoles.length)>0)("ngIfElse",i)}}const se=function(s,t){return{allRoles:s,error:t}},oe=[{component:(()=>{const t=class{constructor(i,o,n,c,u){this.itemService=i,this.modalService=o,this._snackBar=n,this._store=c,this._snackbarService=u,this.pageTitle="All Roles",this.compositionName=h.ER,this.page=1,this.loader=!1,this.allRoles$=this._store.pipe((0,a.Ys)(T)),this.allRolesError$=this.allRoles$.pipe((0,B.l)(),(0,G.K)(m=>(0,D.of)(m)),(0,R.U)(m=>(console.log(m),m)))}ngOnInit(){this._store.dispatch(C())}createDialog(){this.modalService.open(w,{size:"md"}).result.then(o=>{this._snackbarService.openSnackBar(o,"success")}).catch(o=>{this._snackbarService.openSnackBar(o,"error")})}assignPermission(i){const o=this.modalService.open(N,{size:"lg"});o.componentInstance.itemId=i,o.result.then(n=>{n&&this._snackbarService.openSnackBar(n,"success")}).catch(n=>{this._snackbarService.openSnackBar(n,"error")})}};let s=t;return t.\u0275fac=function(o){return new(o||t)(e.Y36(A.e),e.Y36(b.FF),e.Y36(U.ux),e.Y36(a.yh),e.Y36(z.o))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-all-roles"]],decls:13,vars:10,consts:[[1,"page-title"],[1,"btn","btn-primary",3,"click"],[1,"page-card"],["class","loading",4,"ngIf"],["loading",""],[1,"table-responsive"],["class","table",4,"ngIf"],[1,"loading"],[1,"loader"],[1,"table"],[1,"text-right"],["loadingRoles",""],[4,"ngIf"],[4,"ngIf","ngIfElse"],["colspan","2"],[4,"ngFor","ngForOf"],[1,"text-capitalize"],["type","button",1,"btn-top_header",3,"click"],[1,"material-symbols-outlined"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2),e.qZA(),e.TgZ(3,"a",1),e.NdJ("click",function(){return n.createDialog()}),e._uU(4,"Create +"),e.qZA()(),e.TgZ(5,"div",2),e.YNc(6,K,2,0,"div",3),e.YNc(7,j,2,0,"ng-template",null,4,e.W1O),e.TgZ(9,"div",5),e.YNc(10,te,12,3,"table",6),e.ALo(11,"async"),e.ALo(12,"async"),e.qZA()()),2&o&&(e.xp6(2),e.Oqu(n.pageTitle),e.xp6(4),e.Q6J("ngIf",n.loader),e.xp6(4),e.Q6J("ngIf",e.WLB(7,se,e.lcZ(11,3,n.allRoles$),e.lcZ(12,5,n.allRolesError$))))},dependencies:[d.sg,d.O5,d.Ov],styles:[".table[_ngcontent-%COMP%]{width:400px}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{width:70%}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:30%}"]}),s})(),path:""},{component:N,path:"assign-role"}];let ne=(()=>{const t=class{};let s=t;return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[_.Bz.forChild(oe),_.Bz]}),s})();var g=l(493),ie=l(1365),ae=l(5577),re=l(515),M=l(3900);let le=(()=>{const t=class{constructor(i,o,n,c,u){this.actions$=i,this.apiServices=o,this.store=n,this.appStore=c,this.snackBar=u,this.compositionName=h.ER,this.loadAllItems$=(0,g.GW)(()=>this.actions$.pipe((0,g.l4)(C),(0,ie.M)(this.store.pipe((0,a.Ys)(T))),(0,ae.z)(([,m])=>m.length>0?re.E:this.apiServices.getAllRoles().pipe((0,R.U)(f=>S({allRoles:f})))))),this.saveNewItem$=(0,g.GW)(()=>this.actions$.pipe((0,g.l4)(y),(0,M.w)(m=>(this.appStore.dispatch((0,v.T)({apiStatus:{apiResponseMessage:"",apiStatus:""}})),this.apiServices.createRole(m.role).pipe((0,R.U)(f=>(this.appStore.dispatch((0,v.T)({apiStatus:{apiResponseMessage:f?.response?.message,apiStatus:"success"}})),console.log(f),I({role:f?.response?.data})))))))),this.updateRoleAPI$=(0,g.GW)(()=>this.actions$.pipe((0,g.l4)(P),(0,M.w)(m=>(this.appStore.dispatch((0,v.T)({apiStatus:{apiResponseMessage:"",apiStatus:""}})),this.apiServices.addPermission(m.updateRole).pipe((0,R.U)(f=>(this.appStore.dispatch((0,v.T)({apiStatus:{apiResponseMessage:f?.response?.message,apiStatus:"success"}})),x({updateRole:f?.data}))))))))}};let s=t;return t.\u0275fac=function(o){return new(o||t)(e.LFG(g.eX),e.LFG(A.e),e.LFG(a.yh),e.LFG(a.yh),e.LFG(U.ux))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),s})();const pe=(0,a.Lq)([],(0,a.on)(S,(s,{allRoles:t})=>t),(0,a.on)(I,(s,{role:t})=>{let r=[...s];return r.unshift(t),r}),(0,a.on)(x,(s,{updateRole:t})=>{let r=s.filter(i=>i.id!=t.id);return r.unshift(t),r}));let me=(()=>{const t=class{};let s=t;return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.ez,ne,p.u5,p.UX,a.Aw.forFeature("myroles",pe),g.sQ.forFeature([le])]}),s})()},3223:(Y,Z,l)=>{l.d(Z,{p:()=>_});const _=(0,l(9653).ZF)("appState")}}]);